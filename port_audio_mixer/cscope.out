cscope 16 G:\testSound"               0000502835
	@pa_tests/debug_dual.c

38 
	~<¡dio.h
>

39 
	~<m©h.h
>

40 
	~"pÜudio.h
"

41 
	#DEV_ID_1
 (13)

	)

42 
	#DEV_ID_2
 (15)

	)

43 
	#NUM_SECONDS
 (8)

	)

44 
	#SLEEP_DUR
 (800)

	)

45 
	#SAMPLE_RATE
 (44100)

	)

46 
	#FRAMES_PER_BUFFER
 (256)

	)

48 
	#MIN_LATENCY_MSEC
 (200)

	)

49 
	#NUM_BUFFERS
 ((
MIN_LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

51 
	#NUM_BUFFERS
 (0)

	)

53 
	#MIN_FREQ
 (100.0f)

	)

54 
	#MAX_FREQ
 (4000.0f)

	)

55 
	#FREQ_SCALAR
 (1.00002f)

	)

56 
	#C®cPha£Inüem’t
(
äeq
è(äeq/
SAMPLE_RATE
)

	)

57 #iâdeà
M_PI


58 
	#M_PI
 (3.14159265)

	)

60 
	#TABLE_SIZE
 (400)

	)

63 
	msše
[
TABLE_SIZE
 + 1];

64 
	mpha£_šüem’t
;

65 
	mËá_pha£
;

66 
	mright_pha£
;

68 
	t·Te¡D©a
;

72 
LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 );

73 
	$LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 )

75 
fIndex
 = 
pha£
*
TABLE_SIZE
;

76 
šdex
 = (è
fIndex
;

77 
äaù
 = 
fIndex
 - 
šdex
;

78 
lo
 = 
d©a
->
sše
[
šdex
];

79 
hi
 = 
d©a
->
sše
[
šdex
+1];

80 
v®
 = 
lo
 + 
äaù
*(
hi
-lo);

81  
v®
;

82 
	}
}

87 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

88 
äamesP”Bufãr
,

89 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

91 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

92 *
out
 = (*)
ouutBufãr
;

93 
i
;

94 
fšished
 = 0;

95 (è
outTime
;

96 (è
šputBufãr
;

99  
i
=0; i<
äamesP”Bufãr
; i++ )

101 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
Ëá_pha£
);

102 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
right_pha£
);

103 
d©a
->
Ëá_pha£
 +ğd©a->
pha£_šüem’t
;

104 ifĞ
d©a
->
Ëá_pha£
 >= 1.0f ) data->left_phase -= 1.0f;

105 
d©a
->
right_pha£
 +ğ(d©a->
pha£_šüem’t
 * 1.5f);

106 ifĞ
d©a
->
right_pha£
 >= 1.0f ) data->right_phase -= 1.0f;

108 
d©a
->
pha£_šüem’t
 *ğ
FREQ_SCALAR
;

109 ifĞ
d©a
->
pha£_šüem’t
 > 
	`C®cPha£Inüem’t
(
MAX_FREQ
èèd©a->pha£_šüem’ˆğC®cPha£Inüem’t(
MIN_FREQ
);

112 
	}
}

114 
PaE¼Ü
 
Te¡S¹
Ğ
PÜtAudioSŒ—m
 **
¡»amPŒ
, 
PaDeviûID
 
devID
,

115 
·Te¡D©a
 *
d©a
 );

117 
maš
();

118 
	$maš
()

120 
PÜtAudioSŒ—m
 *
¡»am1
, *
¡»am2
;

121 
PaE¼Ü
 
”r
;

122 
·Te¡D©a
 
DATA1
, 
DATA2
;

123 
	`´štf
("PÜtAudiØTe¡: DUAL sšsw“p.‡sk fÜ %d bufãrs\n", 
NUM_BUFFERS
 );

124 
”r
 = 
	`Pa_In™Ÿlize
();

125 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

126 
”r
 = 
	`Te¡S¹
Ğ&
¡»am1
, 
DEV_ID_1
, &
DATA1
 );

127 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

128 
”r
 = 
	`Te¡S¹
Ğ&
¡»am2
, 
DEV_ID_2
, &
DATA2
 );

129 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

130 
	`´štf
("Hit ENTER\n");

131 
	`g‘ch¬
();

132 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am1
 );

133 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

134 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am2
 );

135 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

136 
	`Pa_T”mš©e
();

137 
	`´štf
("Test finished.\n");

138  
”r
;

139 
”rÜ
:

140 
	`Pa_T”mš©e
();

141 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

142 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

143 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

144  
”r
;

145 
	}
}

146 
PaE¼Ü
 
	$Te¡S¹
Ğ
PÜtAudioSŒ—m
 **
¡»amPŒ
, 
PaDeviûID
 
devID
, 
·Te¡D©a
 *
d©a
 )

148 
PÜtAudioSŒ—m
 *
¡»am
;

149 
PaE¼Ü
 
”r
;

150 
i
;

152  
i
=0; i<
TABLE_SIZE
; i++ )

154 
d©a
->
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

156 
d©a
->
sše
[
TABLE_SIZE
] = data->sine[0];

157 
d©a
->
Ëá_pha£
 = d©a->
right_pha£
 = 0.0;

158 
d©a
->
pha£_šüem’t
 = 
	`C®cPha£Inüem’t
(
MIN_FREQ
);

159 
	`´štf
("PÜtAudiØTe¡: ouuˆdeviû = %d\n", 
devID
 );

160 
”r
 = 
	`Pa_O³nSŒ—m
(

161 &
¡»am
,

162 
·NoDeviû
,

164 
·Flßt32
,

165 
NULL
,

166 
devID
,

168 
·Flßt32
,

169 
NULL
,

170 
SAMPLE_RATE
,

171 
FRAMES_PER_BUFFER
,

172 
NUM_BUFFERS
,

173 
·ClOff
|
·D™h”Off
,

174 
·‹¡C®lback
,

175 
d©a
 );

176 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

177 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

178 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

179 *
¡»amPŒ
 = 
¡»am
;

181 
”rÜ
:

182  
”r
;

183 
	}
}

	@pa_tests/debug_multi_in.c

38 
	~<¡dio.h
>

39 
	~<m©h.h
>

40 
	~<¡ršg.h
>

41 
	~"pÜudio.h
"

43 
	#OUTPUT_DEVICE
 (
	`Pa_G‘DeçuÉOuutDeviûID
())

	)

45 
	#SAMPLE_RATE
 (22050)

	)

46 
	#FRAMES_PER_BUFFER
 (256)

	)

47 
	#MIN_LATENCY_MSEC
 (400)

	)

48 
	#NUM_BUFFERS
 ((
MIN_LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

49 #iâdeà
M_PI


50 
	#M_PI
 (3.14159265)

	)

54 
	mliveChªÃl
;

55 
	mnumChªÃls
;

57 
	t·Te¡D©a
;

62 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

66 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

67 *
out
 = (*)
ouutBufãr
;

68 *
š
 = (*)
šputBufãr
;

69 
i
;

70 
fšished
 = 0;

71 (è
outTime
;

72 (è
šputBufãr
;

74 ifĞ
š
 =ğ
NULL
 )  0;

75  
i
=0; i<()
äamesP”Bufãr
; i++ )

78 *
out
++ = 
š
[
d©a
->
liveChªÃl
];

79 *
out
++ = 
š
[
d©a
->
liveChªÃl
];

80 
š
 +ğ
d©a
->
numChªÃls
;

83 
	}
}

85 
	$PaFšdDeviûByName
ĞcÚ¡ *
Çme
 )

87 
i
;

88 
numDeviûs
;

89 cÚ¡ 
PaDeviûInfo
 *
pdi
;

90 
Ën
 = 
	`¡¾’
Ğ
Çme
 );

91 
PaDeviûID
 
»suÉ
 = 
·NoDeviû
;

92 
numDeviûs
 = 
	`Pa_CouÁDeviûs
();

93  
i
=0; i<
numDeviûs
; i++ )

95 
pdi
 = 
	`Pa_G‘DeviûInfo
Ğ
i
 );

96 ifĞ
	`¡ºcmp
Ğ
Çme
, 
pdi
->Çme, 
Ën
 ) == 0 )

98 
»suÉ
 = 
i
;

102  
»suÉ
;

103 
	}
}

105 
maš
();

106 
	$maš
()

108 
PÜtAudioSŒ—m
 *
¡»am
;

109 
PaE¼Ü
 
”r
;

110 
·Te¡D©a
 
d©a
;

111 
i
;

112 
PaDeviûID
 
šputDeviû
;

113 cÚ¡ 
PaDeviûInfo
 *
pdi
;

114 
	`´štf
("PÜtAudiØTe¡: iÅuˆsigÇÈäomƒach chªÃl. %d bufãrs\n", 
NUM_BUFFERS
 );

115 
d©a
.
liveChªÃl
 = 0;

116 
”r
 = 
	`Pa_In™Ÿlize
();

117 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

118 #ifdeà
INPUT_DEVICE_NAME


119 
	`´štf
("TryØu£ deviû: %s\n", 
INPUT_DEVICE_NAME
 );

120 
šputDeviû
 = 
	`PaFšdDeviûByName
(
INPUT_DEVICE_NAME
);

121 ifĞ
šputDeviû
 =ğ
·NoDeviû
 )

123 
	`´štf
("Could‚Ù fšd %s. Usšg deçuÉ in¡—d.\n", 
INPUT_DEVICE_NAME
 );

124 
šputDeviû
 = 
	`Pa_G‘DeçuÉIÅutDeviûID
();

127 
	`´štf
("Using default input device.\n");

128 
šputDeviû
 = 
	`Pa_G‘DeçuÉIÅutDeviûID
();

130 
pdi
 = 
	`Pa_G‘DeviûInfo
Ğ
šputDeviû
 );

131 ifĞ
pdi
 =ğ
NULL
 )

133 
	`´štf
("Could‚ot get device info!\n");

134 
”rÜ
;

136 
d©a
.
numChªÃls
 = 
pdi
->
maxIÅutChªÃls
;

137 
	`´štf
("IÅuˆDeviû‚ami %s\n", 
pdi
->
Çme
 );

138 
	`´štf
("IÅuˆDeviû ha %d chªÃls.\n", 
pdi
->
maxIÅutChªÃls
);

139 
”r
 = 
	`Pa_O³nSŒ—m
(

140 &
¡»am
,

141 
šputDeviû
,

142 
pdi
->
maxIÅutChªÃls
,

143 
·Flßt32
,

144 
NULL
,

145 
OUTPUT_DEVICE
,

147 
·Flßt32
,

148 
NULL
,

149 
SAMPLE_RATE
,

150 
FRAMES_PER_BUFFER
,

151 
NUM_BUFFERS
,

152 
·ClOff
,

153 
·‹¡C®lback
,

154 &
d©a
 );

155 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

156 
d©a
.
liveChªÃl
 = 0;

157 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

158 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

159  
i
=0; i<
d©a
.
numChªÃls
; i++ )

161 
d©a
.
liveChªÃl
 = 
i
;

162 
	`´štf
("ChªÃÈ%d bešg s’ˆtØouut. H™ ENTER fÜ‚exˆchªÃl.", 
i
 );

163 
	`fæush
(
¡dout
);

164 
	`g‘ch¬
();

166 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

167 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

169 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

170 
	`Pa_T”mš©e
();

171 
	`´štf
("Test finished.\n");

172  
”r
;

173 
”rÜ
:

174 
	`Pa_T”mš©e
();

175 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

176 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

177 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

178  
”r
;

179 
	}
}

	@pa_tests/debug_multi_out.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

41 
	#OUTPUT_DEVICE
 (
	`Pa_G‘DeçuÉOuutDeviûID
())

	)

42 
	#SAMPLE_RATE
 (44100)

	)

43 
	#FRAMES_PER_BUFFER
 (256)

	)

44 
	#FREQ_INCR
 (300.0 / 
SAMPLE_RATE
)

	)

45 
	#MAX_CHANNELS
 (64)

	)

47 #iâdeà
M_PI


48 
	#M_PI
 (3.14159265)

	)

53 
	mnumChªÃls
;

54 
	mpha£s
[
MAX_CHANNELS
];

56 
	t·Te¡D©a
;

62 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

66 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

67 *
out
 = (*)
ouutBufãr
;

68 
äameIndex
, 
chªÃlIndex
;

69 
fšished
 = 0;

70 (è
outTime
;

71 (è
šputBufãr
;

73  
äameIndex
=0; f¿meIndex<()
äamesP”Bufãr
; frameIndex++ )

75  
chªÃlIndex
=0; chªÃlIndex<
d©a
->
numChªÃls
; channelIndex++ )

78 *
out
++ = (è
	`sš
(
d©a
->
pha£s
[
chªÃlIndex
]);

81 
d©a
->
pha£s
[
chªÃlIndex
] +ğ
FREQ_INCR
 * (4 + channelIndex);

82 ifĞ
d©a
->
pha£s
[
chªÃlIndex
] >ğ(2.0 * 
M_PI
) ) data->phases[channelIndex] -= (2.0 * M_PI);

87 
	}
}

89 
maš
();

90 
	$maš
()

92 
PÜtAudioSŒ—m
 *
¡»am
;

93 
PaE¼Ü
 
”r
;

94 cÚ¡ 
PaDeviûInfo
 *
pdi
;

95 
·Te¡D©a
 
d©a
 = {0};

96 
	`´štf
("PortAudio Test: output sine wave onƒach channel.\n" );

98 
”r
 = 
	`Pa_In™Ÿlize
();

99 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

101 
pdi
 = 
	`Pa_G‘DeviûInfo
Ğ
OUTPUT_DEVICE
 );

102 
d©a
.
numChªÃls
 = 
pdi
->
maxOuutChªÃls
;

103 ifĞ
d©a
.
numChªÃls
 > 
MAX_CHANNELS
 ) data.numChannels = MAX_CHANNELS;

104 
	`´štf
("Numb” oàChªÃl ğ%d\n", 
d©a
.
numChªÃls
 );

106 
”r
 = 
	`Pa_O³nSŒ—m
(

107 &
¡»am
,

108 
·NoDeviû
,

110 
·Flßt32
,

111 
NULL
,

112 
OUTPUT_DEVICE
,

113 
d©a
.
numChªÃls
,

114 
·Flßt32
,

115 
NULL
,

116 
SAMPLE_RATE
,

117 
FRAMES_PER_BUFFER
,

119 
·ClOff
,

120 
·‹¡C®lback
,

121 &
d©a
 );

122 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

124 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

125 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

127 
	`´štf
("Hit ENTERo stop sound.\n");

128 
	`fæush
(
¡dout
);

129 
	`g‘ch¬
();

131 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

132 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

134 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

135 
	`Pa_T”mš©e
();

136 
	`´štf
("Test finished.\n");

137  
”r
;

138 
”rÜ
:

139 
	`Pa_T”mš©e
();

140 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

141 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

142 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

143  
”r
;

144 
	}
}

	@pa_tests/debug_record.c

38 
	~<¡dio.h
>

39 
	~<¡dlib.h
>

40 
	~"pÜudio.h
"

42 
	#SAMPLE_RATE
 (22050)

	)

43 
	#NUM_SECONDS
 (6)

	)

44 
	#NUM_CHANNELS
 (2)

	)

45 
	#FRAMES_PER_BUFFER
 (64)

	)

47 
	#DITHER_FLAG
 (0)

	)

51 
	#PA_SAMPLE_TYPE
 
·Flßt32


	)

52 
	tSAMPLE
;

53 
	#SAMPLE_SILENCE
 (0.0f)

	)

56 
	#PA_SAMPLE_TYPE
 
·IÁ32


	)

57 
	tSAMPLE
;

58 
	#SAMPLE_SILENCE
 (0)

	)

61 
	#PA_SAMPLE_TYPE
 
·IÁ16


	)

62 
	tSAMPLE
;

63 
	#SAMPLE_SILENCE
 (0)

	)

66 
	#PA_SAMPLE_TYPE
 
·IÁ8


	)

67 
	tSAMPLE
;

68 
	#SAMPLE_SILENCE
 (0)

	)

71 
	#PA_SAMPLE_TYPE
 
·UIÁ8


	)

72 
	tSAMPLE
;

73 
	#SAMPLE_SILENCE
 (128)

	)

79 
	mäameIndex
;

80 
	mmaxF¿meIndex
;

81 
SAMPLE
 *
	m»cÜdedSam¶es
;

83 
	t·Te¡D©a
;

88 
	$»cÜdC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

89 
äamesP”Bufãr
,

90 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

92 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

93 
SAMPLE
 *
½Œ
 = (SAMPLE*)
šputBufãr
;

94 
SAMPLE
 *
w±r
 = &
d©a
->
»cÜdedSam¶es
[d©a->
äameIndex
 * 
NUM_CHANNELS
];

95 
äamesToC®c
;

96 
i
;

97 
fšished
;

98 
äamesLeá
 = 
d©a
->
maxF¿meIndex
 - d©a->
äameIndex
;

100 (è
ouutBufãr
;

101 (è
outTime
;

103 ifĞ
äamesLeá
 < 
äamesP”Bufãr
 )

105 
äamesToC®c
 = 
äamesLeá
;

106 
fšished
 = 1;

110 
äamesToC®c
 = 
äamesP”Bufãr
;

111 
fšished
 = 0;

113 ifĞ
šputBufãr
 =ğ
NULL
 )

115  
i
=0; i<
äamesToC®c
; i++ )

117 *
w±r
++ = 
SAMPLE_SILENCE
;

118 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = 
SAMPLE_SILENCE
;

123  
i
=0; i<
äamesToC®c
; i++ )

125 *
w±r
++ = *
½Œ
++;

126 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

129 
d©a
->
äameIndex
 +ğ
äamesToC®c
;

130  
fšished
;

131 
	}
}

137 
	$¶ayC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

138 
äamesP”Bufãr
,

139 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

141 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

142 
SAMPLE
 *
½Œ
 = &
d©a
->
»cÜdedSam¶es
[d©a->
äameIndex
 * 
NUM_CHANNELS
];

143 
SAMPLE
 *
w±r
 = (SAMPLE*)
ouutBufãr
;

144 
i
;

145 
fšished
;

146 
äamesLeá
 = 
d©a
->
maxF¿meIndex
 - d©a->
äameIndex
;

147 (è
šputBufãr
;

148 (è
outTime
;

150 ifĞ
äamesLeá
 < 
äamesP”Bufãr
 )

153  
i
=0; i<
äamesLeá
; i++ )

155 *
w±r
++ = *
½Œ
++;

156 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

158  ; 
i
<
äamesP”Bufãr
; i++ )

160 *
w±r
++ = 0;

161 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = 0;

163 
d©a
->
äameIndex
 +ğ
äamesLeá
;

164 
fšished
 = 1;

168  
i
=0; i<
äamesP”Bufãr
; i++ )

170 *
w±r
++ = *
½Œ
++;

171 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

173 
d©a
->
äameIndex
 +ğ
äamesP”Bufãr
;

174 
fšished
 = 0;

176  
fšished
;

177 
	}
}

180 
maš
();

181 
	$maš
()

183 
PÜtAudioSŒ—m
 *
¡»am
;

184 
PaE¼Ü
 
”r
;

185 
·Te¡D©a
 
d©a
;

186 
i
;

187 
tÙ®F¿mes
;

188 
numSam¶es
;

189 
numBy‹s
;

190 
SAMPLE
 
max
, 
av”age
, 
v®
;

192 
	`´štf
("debug_record.c, sampleRate = %d,‚umChannels = %d\n",

193 
SAMPLE_RATE
, 
NUM_CHANNELS
 );

194 
	`fæush
(
¡dout
);

196 
d©a
.
maxF¿meIndex
 = 
tÙ®F¿mes
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

197 
d©a
.
äameIndex
 = 0;

198 
numSam¶es
 = 
tÙ®F¿mes
 * 
NUM_CHANNELS
;

200 
numBy‹s
 = 
numSam¶es
 * (
SAMPLE
);

201 
d©a
.
»cÜdedSam¶es
 = (
SAMPLE
 *è
	`m®loc
Ğ
numBy‹s
 );

202 ifĞ
d©a
.
»cÜdedSam¶es
 =ğ
NULL
 )

204 
	`´štf
("Could‚ot‡llocate„ecord‡rray.\n");

205 
	`ex™
(1);

207  
i
=0; i<
numSam¶es
; i++ ) 
d©a
.
»cÜdedSam¶es
[i] = 0;

209 
”r
 = 
	`Pa_In™Ÿlize
();

210 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

213 
”r
 = 
	`Pa_O³nSŒ—m
(

214 &
¡»am
,

215 
	`Pa_G‘DeçuÉIÅutDeviûID
(),

216 
NUM_CHANNELS
,

217 
PA_SAMPLE_TYPE
,

218 
NULL
,

219 
·NoDeviû
,

221 
PA_SAMPLE_TYPE
,

222 
NULL
,

223 
SAMPLE_RATE
,

224 
FRAMES_PER_BUFFER
,

227 
»cÜdC®lback
,

228 &
d©a
 );

229 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

231 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

232 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

233 
	`´štf
("S¹„ecÜdšg!!\n"); 
	`fæush
(
¡dout
);

235  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

237 
	`Pa_SË•
(1000);

238 
	`´štf
("šdex = %d\n", 
d©a
.
äameIndex
 ); 
	`fæush
(
¡dout
);

240 
	`´štf
("Stİ„ecÜdšg!!\n"); 
	`fæush
(
¡dout
);

241 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

242 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

245 
max
 = 0;

246 
av”age
 = 0;

247  
i
=0; i<
numSam¶es
; i++ )

249 
v®
 = 
d©a
.
»cÜdedSam¶es
[
i
];

250 ifĞ
v®
 < 0 ) val = -val;

251 ifĞ
v®
 > 
max
 )

253 
max
 = 
v®
;

255 
av”age
 +ğ
v®
;

258 
av”age
 =‡v”ag/ 
numSam¶es
;

260 ifĞ
PA_SAMPLE_TYPE
 =ğ
·Flßt32
 )

262 
	`´štf
("§m¶max‡m¶™udğ%f\n", (è
max
 );

263 
	`´štf
("§m¶av”agğ%f\n", (è
av”age
 );

267 
	`´štf
("§m¶max‡m¶™udğ%d\n", (è
max
 );

268 
	`´štf
("§m¶av”agğ%d\n", (è
av”age
 );

274 
FILE
 *
fid
;

275 
fid
 = 
	`fİ’
("recorded.raw", "wb");

276 ifĞ
fid
 =ğ
NULL
 )

278 
	`´štf
("Could‚ot open file.");

282 
	`fwr™e
Ğ
d©a
.
»cÜdedSam¶es
, 
NUM_CHANNELS
 * (
SAMPLE
), 
tÙ®F¿mes
, 
fid
 );

283 
	`fşo£
Ğ
fid
 );

284 
	`´štf
("Wrote datao 'recorded.raw'\n");

290 
d©a
.
äameIndex
 = 0;

291 
	`´štf
("Begš…Ïyback.\n"); 
	`fæush
(
¡dout
);

292 
”r
 = 
	`Pa_O³nSŒ—m
(

293 &
¡»am
,

294 
·NoDeviû
,

296 
PA_SAMPLE_TYPE
,

297 
NULL
,

298 
	`Pa_G‘DeçuÉOuutDeviûID
(),

299 
NUM_CHANNELS
,

300 
PA_SAMPLE_TYPE
,

301 
NULL
,

302 
SAMPLE_RATE
,

303 
FRAMES_PER_BUFFER
,

305 
·ClOff
,

306 
¶ayC®lback
,

307 &
d©a
 );

308 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

310 ifĞ
¡»am
 )

312 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

313 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

314 
	`´štf
("S¹…Ïyback!!\n"); 
	`fæush
(
¡dout
);

316  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

318 
	`Pa_SË•
(1000);

319 
	`´štf
("šdex = %d\n", 
d©a
.
äameIndex
 ); 
	`fæush
(
¡dout
);

322 
	`´štf
("Stİ…Ïyback!!\n"); 
	`fæush
(
¡dout
);

323 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

324 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

325 
	`´štf
("DÚe.\n"); 
	`fæush
(
¡dout
);

327 
	`ä“
Ğ
d©a
.
»cÜdedSam¶es
 );

329 
	`Pa_T”mš©e
();

332 
”rÜ
:

333 
	`Pa_T”mš©e
();

334 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

335 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

336 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

338 
	}
}

	@pa_tests/debug_sine.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

40 
	#OUTPUT_DEVICE
 (
	`Pa_G‘DeçuÉOuutDeviûID
())

	)

42 
	#NUM_SECONDS
 (8)

	)

43 
	#SLEEP_DUR
 (800)

	)

44 
	#SAMPLE_RATE
 (44100)

	)

45 
	#FRAMES_PER_BUFFER
 (4096)

	)

47 
	#MSEC_PER_BUFFER
 (1000 * 
FRAMES_PER_BUFFER
 / 
SAMPLE_RATE
)

	)

50 
	#MIN_LATENCY_MSEC
 (200)

	)

51 
	#NUM_BUFFERS
 ((
MIN_LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

53 
	#NUM_BUFFERS
 (0)

	)

56 
	#MIN_FREQ
 (100.0f)

	)

57 
	#MAX_FREQ
 (4000.0f)

	)

58 
	#FREQ_SCALAR
 (1.00002f)

	)

59 
	#C®cPha£Inüem’t
(
äeq
è(äeq/
SAMPLE_RATE
)

	)

60 #iâdeà
M_PI


61 
	#M_PI
 (3.14159265)

	)

63 
	#TABLE_SIZE
 (400)

	)

66 
	msše
[
TABLE_SIZE
 + 1];

67 
	mpha£_šüem’t
;

68 
	mËá_pha£
;

69 
	mright_pha£
;

70 
	mäamesToGo
;

72 
	t·Te¡D©a
;

76 
LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 );

77 
	$LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 )

79 
fIndex
 = 
pha£
*
TABLE_SIZE
;

80 
šdex
 = (è
fIndex
;

81 
äaù
 = 
fIndex
 - 
šdex
;

82 
lo
 = 
d©a
->
sše
[
šdex
];

83 
hi
 = 
d©a
->
sše
[
šdex
+1];

84 
v®
 = 
lo
 + 
äaù
*(
hi
-lo);

85  
v®
;

86 
	}
}

91 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

92 
äamesP”Bufãr
,

93 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

95 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

96 *
out
 = (*)
ouutBufãr
;

97 
äamesToC®c
;

98 
i
;

99 
fšished
 = 0;

100 (è
outTime
;

101 (è
šputBufãr
;

103 ifĞ
d©a
->
äamesToGo
 < 
äamesP”Bufãr
 )

105 
äamesToC®c
 = 
d©a
->
äamesToGo
;

106 
d©a
->
äamesToGo
 = 0;

107 
fšished
 = 1;

111 
äamesToC®c
 = 
äamesP”Bufãr
;

112 
d©a
->
äamesToGo
 -ğ
äamesP”Bufãr
;

115  
i
=0; i<
äamesToC®c
; i++ )

117 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
Ëá_pha£
);

118 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
right_pha£
);

119 
d©a
->
Ëá_pha£
 +ğd©a->
pha£_šüem’t
;

120 ifĞ
d©a
->
Ëá_pha£
 >= 1.0f ) data->left_phase -= 1.0f;

121 
d©a
->
right_pha£
 +ğ(d©a->
pha£_šüem’t
 * 1.5f);

122 ifĞ
d©a
->
right_pha£
 >= 1.0f ) data->right_phase -= 1.0f;

124 
d©a
->
pha£_šüem’t
 *ğ
FREQ_SCALAR
;

125 ifĞ
d©a
->
pha£_šüem’t
 > 
	`C®cPha£Inüem’t
(
MAX_FREQ
èèd©a->pha£_šüem’ˆğC®cPha£Inüem’t(
MIN_FREQ
);

128  ; 
i
<()
äamesP”Bufãr
; i++ )

130 *
out
++ = 0;

131 *
out
++ = 0;

136  
fšished
;

137 
	}
}

139 
maš
();

140 
	$maš
()

142 
PÜtAudioSŒ—m
 *
¡»am
;

143 
PaE¼Ü
 
”r
;

144 
·Te¡D©a
 
d©a
;

145 
i
;

146 
tÙ®Samps
;

147 
	`´štf
("PÜtAudiØTe¡: ouuˆsšsw“p.‡sk fÜ %d bufãrs\n", 
NUM_BUFFERS
 );

148 
	`´štf
("MSEC_PER_BUFFER = %d\n", 
MSEC_PER_BUFFER
 );

151  
i
=0; i<
TABLE_SIZE
; i++ )

153 
d©a
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

155 
d©a
.
sše
[
TABLE_SIZE
] = data.sine[0];

156 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0.0;

157 
d©a
.
pha£_šüem’t
 = 
	`C®cPha£Inüem’t
(
MIN_FREQ
);

158 
d©a
.
äamesToGo
 = 
tÙ®Samps
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

159 
	`´štf
("tÙ®Samp ğ%d\n", 
tÙ®Samps
 );

160 
”r
 = 
	`Pa_In™Ÿlize
();

161 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

162 
	`´štf
("PÜtAudiØTe¡: ouuˆdeviû = %d\n", 
OUTPUT_DEVICE
 );

163 
”r
 = 
	`Pa_O³nSŒ—m
(

164 &
¡»am
,

165 
·NoDeviû
,

167 
·Flßt32
,

168 
NULL
,

169 
OUTPUT_DEVICE
,

171 
·Flßt32
,

172 
NULL
,

173 
SAMPLE_RATE
,

174 
FRAMES_PER_BUFFER
,

175 
NUM_BUFFERS
,

176 
·ClOff
|
·D™h”Off
,

177 
·‹¡C®lback
,

178 &
d©a
 );

179 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

180 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

181 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

182 
	`´štf
("Is callback being called?\n");

183  
i
=0; i<((
NUM_SECONDS
+1)*1000); i+=
SLEEP_DUR
 )

185 
	`´štf
("d©a.äamesToGØğ%d\n", 
d©a
.
äamesToGo
 ); 
	`fæush
(
¡dout
);

186 
	`Pa_SË•
Ğ
SLEEP_DUR
 );

189 
	`´štf
("Call Pa_StopStream()\n");

190 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

191 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

192 
	`Pa_T”mš©e
();

193 
	`´štf
("Test finished.\n");

194  
”r
;

195 
”rÜ
:

196 
	`Pa_T”mš©e
();

197 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

198 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

199 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

200  
”r
;

201 
	}
}

	@pa_tests/debug_test1.c

10 
	~<¡dio.h
>

11 
	~<m©h.h
>

12 
	~"pÜudio.h
"

13 #iâdeà
M_PI


14 
	#M_PI
 (3.14159265)

	)

18 
	msše
[100];

19 
	mpha£
;

20 
	m§mpsToGo
;

22 
	t·‹¡1d©a
;

23 
	$·‹¡1C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

24 
bufãrF¿mes
,

25 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

27 
·‹¡1d©a
 *
d©a
 = (·‹¡1d©a*)
u£rD©a
;

28 *
š
 = (*)
šputBufãr
;

29 *
out
 = (*)
ouutBufãr
;

30 
äamesToC®c
 = 
bufãrF¿mes
;

31 
i
;

32 
fšished
 = 0;

33 if(
šputBufãr
 =ğ
NULL
)  0;

34 ifĞ
d©a
->
§mpsToGo
 < 
bufãrF¿mes
 )

36 
fšished
 = 1;

38  
i
=0; i<
bufãrF¿mes
; i++ )

40 *
out
++ = *
š
++;

41 *
out
++ = *
š
++;

42 ifĞ
d©a
->
pha£
 >= 100 )

43 
d©a
->
pha£
 = 0;

45 
d©a
->
§mpsToGo
 -ğ
bufãrF¿mes
;

47  ; 
i
<
bufãrF¿mes
; i++ )

49 *
out
++ = 0;

50 *
out
++ = 0;

52  
fšished
;

53 
	}
}

54 
maš
(
¬gc
, * 
¬gv
[]);

55 
	$maš
(
¬gc
, * 
¬gv
[])

57 
PaSŒ—m
 *
¡»am
;

58 
PaE¼Ü
 
”r
;

59 
·‹¡1d©a
 
d©a
;

60 
i
;

61 
šputDeviû
 = 
	`Pa_G‘DeçuÉIÅutDeviûID
();

62 
ouutDeviû
 = 
	`Pa_G‘DeçuÉOuutDeviûID
();

64  
i
=0; i<100; i++ )

65 
d©a
.
sše
[
i
] = 
	`sš
Ğ(()i/100.è* 
M_PI
 * 2. );

66 
d©a
.
pha£
 = 0;

67 
d©a
.
§mpsToGo
 = 44100 * 4;

69 
	`Pa_In™Ÿlize
();

70 
”r
 = 
	`Pa_O³nSŒ—m
(

71 &
¡»am
,

72 
šputDeviû
,

74 
·Flßt32
,

75 
NULL
,

76 
ouutDeviû
,

78 
·Flßt32
,

79 
NULL
,

85 
·ClOff
,

86 
·‹¡1C®lback
,

87 &
d©a
 );

88 ifĞ
”r
 =ğ
·NoE¼Ü
 )

90 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

95 
	`´štf
( "Waiting for streamo complete...\n" );

97  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

98 
	`Pa_SË•
(1000);

100 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

104 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while openinghe…ortaudio stream\n" );

105 ifĞ
”r
 =ğ
·Ho¡E¼Ü
 )

106 
	`årštf
Ğ
¡d”r
, "Ho¡ƒ¼Ü‚umb”: %d\n", 
	`Pa_G‘Ho¡E¼Ü
() );

108 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

110 
	`Pa_T”mš©e
();

111 
	`´štf
( "bye\n" );

114 
	}
}

	@pa_tests/pa_devs.c

36 
	~<¡dio.h
>

37 
	~<m©h.h
>

38 
	~"pÜudio.h
"

41 
maš
();

42 
	$maš
()

44 
i
,
j
;

45 
numDeviûs
;

46 cÚ¡ 
PaDeviûInfo
 *
pdi
;

47 
PaE¼Ü
 
”r
;

48 
	`Pa_In™Ÿlize
();

49 
numDeviûs
 = 
	`Pa_CouÁDeviûs
();

50 ifĞ
numDeviûs
 < 0 )

52 
	`´štf
("ERROR: Pa_CouÁDeviû »tuºed 0x%x\n", 
numDeviûs
 );

53 
”r
 = 
numDeviûs
;

54 
”rÜ
;

56 
	`´štf
("Numb” oàdeviû ğ%d\n", 
numDeviûs
 );

57  
i
=0; i<
numDeviûs
; i++ )

59 
pdi
 = 
	`Pa_G‘DeviûInfo
Ğ
i
 );

60 
	`´štf
("---------------------------------------------- #%d", 
i
 );

61 ifĞ
i
 =ğ
	`Pa_G‘DeçuÉIÅutDeviûID
(èè
	`´štf
(" DefaultInput");

62 ifĞ
i
 =ğ
	`Pa_G‘DeçuÉOuutDeviûID
(èè
	`´štf
(" DefaultOutput");

63 
	`´štf
("\nNam = %s\n", 
pdi
->
Çme
 );

64 
	`´štf
("Max IÅut  = %d", 
pdi
->
maxIÅutChªÃls
 );

65 
	`´štf
(", Max Ouut ğ%d\n", 
pdi
->
maxOuutChªÃls
 );

66 ifĞ
pdi
->
numSam¶eR©es
 == -1 )

68 
	`´štf
("Sam¶R©Rªgğ%àtØ%f\n", 
pdi
->
§m¶eR©es
[0],…di->sampleRates[1] );

72 
	`´štf
("Sample Rates =");

73  
j
=0; j<
pdi
->
numSam¶eR©es
; j++ )

75 
	`´štf
(" %8.2f,", 
pdi
->
§m¶eR©es
[
j
] );

77 
	`´štf
("\n");

79 
	`´štf
("Native Sample Formats = ");

80 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·IÁ8
 ) 
	`´štf
("paInt8, ");

81 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·UIÁ8
 ) 
	`´štf
("paUInt8, ");

82 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·IÁ16
 ) 
	`´štf
("paInt16, ");

83 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·IÁ32
 ) 
	`´štf
("paInt32, ");

84 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·Flßt32
 ) 
	`´štf
("paFloat32, ");

85 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·IÁ24
 ) 
	`´štf
("paInt24, ");

86 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·PackedIÁ24
 ) 
	`´štf
("paPackedInt24, ");

87 
	`´štf
("\n");

89 
	`Pa_T”mš©e
();

91 
	`´štf
("----------------------------------------------\n");

93 
”rÜ
:

94 
	`Pa_T”mš©e
();

95 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

96 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

97 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

98  
”r
;

99 
	}
}

	@pa_tests/pa_fuzz.c

36 
	~<¡dio.h
>

37 
	~<m©h.h
>

38 
	~"pÜudio.h
"

44 
	#SAMPLE_RATE
 (44100)

	)

45 
	#PA_SAMPLE_TYPE
 
·Flßt32


	)

46 
	#FRAMES_PER_BUFFER
 (64)

	)

48 
	tSAMPLE
;

50 
CubicAm¶if›r
Ğ
šput
 );

51 
fuzzC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

52 
äamesP”Bufãr
,

53 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

56 
	$CubicAm¶if›r
Ğ
šput
 )

58 
ouut
, 
‹mp
;

59 ifĞ
šput
 < 0.0 )

61 
‹mp
 = 
šput
 + 1.0f;

62 
ouut
 = (
‹mp
 *emp *emp) - 1.0f;

66 
‹mp
 = 
šput
 - 1.0f;

67 
ouut
 = (
‹mp
 *emp *emp) + 1.0f;

70  
ouut
;

71 
	}
}

72 
	#FUZZ
(
x
è
	`CubicAm¶if›r
(CubicAm¶if›r(CubicAm¶if›r(CubicAm¶if›r(x))))

	)

74 
	ggNumNoIÅuts
 = 0;

79 
	$fuzzC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

80 
äamesP”Bufãr
,

81 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

83 
SAMPLE
 *
out
 = (SAMPLE*)
ouutBufãr
;

84 
SAMPLE
 *
š
 = (SAMPLE*)
šputBufãr
;

85 
i
;

86 (è
outTime
;

87 (è
u£rD©a
;

89 ifĞ
šputBufãr
 =ğ
NULL
 )

91  
i
=0; i<
äamesP”Bufãr
; i++ )

93 *
out
++ = 0;

94 *
out
++ = 0;

96 
gNumNoIÅuts
 += 1;

100  
i
=0; i<
äamesP”Bufãr
; i++ )

102 *
out
++ = 
	`FUZZ
(*
š
++);

103 *
out
++ = *
š
++;

107 
	}
}

110 
maš
();

111 
	$maš
()

113 
PÜtAudioSŒ—m
 *
¡»am
;

114 
PaE¼Ü
 
”r
;

116 
”r
 = 
	`Pa_In™Ÿlize
();

117 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

119 
”r
 = 
	`Pa_O³nSŒ—m
(

120 &
¡»am
,

121 
	`Pa_G‘DeçuÉIÅutDeviûID
(),

123 
PA_SAMPLE_TYPE
,

124 
NULL
,

125 
	`Pa_G‘DeçuÉOuutDeviûID
(),

127 
PA_SAMPLE_TYPE
,

128 
NULL
,

129 
SAMPLE_RATE
,

130 
FRAMES_PER_BUFFER
,

133 
fuzzC®lback
,

134 
NULL
 );

135 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

137 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

138 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

140 
	`´štf
("Hit ENTERo stop…rogram.\n");

141 
	`fæush
(
¡dout
);

142 
	`g‘ch¬
();

143 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

144 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

146 
	`´štf
("Fšished. gNumNoIÅut ğ%d\n", 
gNumNoIÅuts
 );

147 
	`Pa_T”mš©e
();

150 
”rÜ
:

151 
	`Pa_T”mš©e
();

152 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

153 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

154 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

156 
	}
}

	@pa_tests/pa_minlat.c

37 
	~<¡dio.h
>

38 
	~<¡dlib.h
>

39 
	~<m©h.h
>

40 
	~"pÜudio.h
"

42 #iâdeà
M_PI


43 
	#M_PI
 (3.14159265)

	)

45 
	#TWOPI
 (
M_PI
 * 2.0)

	)

47 
	#DEFAULT_BUFFER_SIZE
 (64)

	)

51 
	mËá_pha£
;

52 
	mright_pha£
;

54 
	t·Te¡D©a
;

57 
	$·mšÏtC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

58 
äamesP”Bufãr
,

59 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

61 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

62 *
out
 = (*)
ouutBufãr
;

63 
i
;

64 
Ëá_pha£Inc
 = 0.02;

65 
right_pha£Inc
 = 0.06;

67 
Ëá_pha£
 = 
d©a
->left_phase;

68 
right_pha£
 = 
d©a
->right_phase;

70  
i
=0; i<
äamesP”Bufãr
; i++ )

72 
Ëá_pha£
 +ğ
Ëá_pha£Inc
;

73 ifĞ
Ëá_pha£
 > 
TWOPI
 )†eft_phase -= TWOPI;

74 *
out
++ = (è
	`sš
Ğ
Ëá_pha£
 );

76 
right_pha£
 +ğ
right_pha£Inc
;

77 ifĞ
right_pha£
 > 
TWOPI
 )„ight_phase -= TWOPI;

78 *
out
++ = (è
	`sš
Ğ
right_pha£
 );

81 
d©a
->
Ëá_pha£
 =†eft_phase;

82 
d©a
->
right_pha£
 =„ight_phase;

84 
	}
}

85 
maš
Ğ
¬gc
, **
¬gv
 );

86 
	$maš
Ğ
¬gc
, **
¬gv
 )

88 
PÜtAudioSŒ—m
 *
¡»am
;

89 
PaE¼Ü
 
”r
;

90 
·Te¡D©a
 
d©a
;

91 
go
;

92 
numBufãrs
 = 0;

93 
mšBufãrs
 = 0;

94 
äamesP”Bufãr
;

95 
§m¶eR©e
 = 44100.0;

96 
¡r
[256];

97 
	`´štf
("paminlat - Determine minimum†atency for your computer.\n");

98 
	`´štf
(" usage:…aminlat {framesPerBuffer}\n");

99 
	`´štf
(" forƒxample:…aminlat 256\n");

100 
	`´štf
("Adjust your stereo until you hear‡ smoothone inƒach speaker.\n");

101 
	`´štf
("Thenryo findhe smallest‚umber of buffershat still sounds smooth.\n");

102 
	`´štf
("Notehathe sound will stop momentarily when you changehe‚umber of buffers.\n");

104 
äamesP”Bufãr
 = ( 
¬gc
 > 1 ) ? 
	`©Ş
Ğ
¬gv
[1] ) : 
DEFAULT_BUFFER_SIZE
;

105 
	`´štf
("F¿me ³¸bufã¸ğ%d\n", 
äamesP”Bufãr
 );

107 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0.0;

108 
”r
 = 
	`Pa_In™Ÿlize
();

109 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

111 
numBufãrs
 = 
mšBufãrs
 = 
	`Pa_G‘MšNumBufãrs
Ğ
äamesP”Bufãr
, 
§m¶eR©e
 );

112 
	`´štf
("NumBufãr £ˆtØ%d ba£d oÀ¨ÿÎØPa_G‘MšNumBufãrs()\n", 
numBufãrs
 );

114 
go
 = 1;

115  
go
 )

118 
	`´štf
("Latency = framesPerBuffer *‚umBuffers = %d * %d = %d frames = %d msecs.\n",

119 
äamesP”Bufãr
, 
numBufãrs
, framesPerBuffer*numBuffers,

120 ()((1000 * 
äamesP”Bufãr
 * 
numBufãrs
è/ 
§m¶eR©e
) );

121 
”r
 = 
	`Pa_O³nSŒ—m
(

122 &
¡»am
,

123 
·NoDeviû
,

125 
·Flßt32
,

126 
NULL
,

127 
	`Pa_G‘DeçuÉOuutDeviûID
(),

129 
·Flßt32
,

130 
NULL
,

131 
§m¶eR©e
,

132 
äamesP”Bufãr
,

133 
numBufãrs
,

134 
·ClOff
,

135 
·mšÏtC®lback
,

136 &
d©a
 );

137 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

138 ifĞ
¡»am
 =ğ
NULL
 ) 
”rÜ
;

140 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

141 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

143 
	`´štf
("\nMove windows‡roundo see ifhe sound glitches.\n");

144 
	`´štf
("NumBufãr cu¼’y %d,ƒÁ”‚ew‚umb”, o¸'q'Øqu™: ", 
numBufãrs
 );

145 
	`g‘s
Ğ
¡r
 );

146 ifĞ
¡r
[0] =ğ'q' ) 
go
 = 0;

149 
numBufãrs
 = 
	`©Ş
Ğ
¡r
 );

150 ifĞ
numBufãrs
 < 
mšBufãrs
 )

152 
	`´štf
Ğ"numBufãr b–ow mšimum oà%d! S‘Ømšimum!!!\n", 
mšBufãrs
 );

153 
numBufãrs
 = 
mšBufãrs
;

157 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

158 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

159 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

160 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

162 
	`´štf
("A good setting for†atency would be somewhat higherhan\n");

163 
	`´štf
("the minimum†atencyhat worked.\n");

164 
	`´štf
("PortAudio: Test finished.\n");

165 
	`Pa_T”mš©e
();

167 
”rÜ
:

168 
	`Pa_T”mš©e
();

169 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

170 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

171 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

172 
	}
}

	@pa_tests/paqa_devs.c

38 
	~<¡dio.h
>

39 
	~<m©h.h
>

40 
	~"pÜudio.h
"

41 
	~"·_Œaû.h
"

43 
	#MODE_INPUT
 (0)

	)

44 
	#MODE_OUTPUT
 (1)

	)

45 
	sPaQaD©a


47 
	mäamesLeá
;

48 
	mnumChªÃls
;

49 
	mby‹sP”Sam¶e
;

50 
	mmode
;

51 
	m§wPha£
;

52 
PaSam¶eFÜm©
 
	mfÜm©
;

53 } 
	tPaQaD©a
;

56 
Te¡Deviûs
Ğ
mode
 );

57 
Te¡FÜm©s
Ğ
mode
, 
PaDeviûID
 
deviûID
, 
§m¶eR©e
,

58 
numChªÃls
 );

59 
Te¡Advªû
Ğ
mode
, 
PaDeviûID
 
deviûID
, 
§m¶eR©e
,

60 
numChªÃls
, 
PaSam¶eFÜm©
 
fÜm©
 );

61 
QaC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

62 
äamesP”Bufãr
,

63 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

66 
	ggNumPas£d
 = 0;

67 
	ggNumFaed
 = 0;

72 
	#EXPECT
(
_exp
) \

75 ià((
_exp
)) {\

77 
gNumPas£d
++; \

80 
	`´štf
("ERROR - 0x%x - % fÜ %s\n", 
»suÉ
, \

81 ((
»suÉ
 =ğ0è? "-" : 
	`Pa_G‘E¼ÜText
(result)), \

83 
gNumFaed
++; \

84 
”rÜ
; \

86 } 0)

	)

92 
	$QaC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

93 
äamesP”Bufãr
,

94 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

96 
i
;

97 
pha£
;

98 
PaQaD©a
 *
d©a
 = (PaQaD©¨*è
u£rD©a
;

99 (è
šputBufãr
;

100 (è
outTime
;

103 ifĞ
d©a
->
mode
 =ğ
MODE_OUTPUT
 )

105 
pha£
 = 
d©a
->
§wPha£
;

106  
d©a
->
fÜm©
 )

108 
·Flßt32
:

110 *
out
 = (*è
ouutBufãr
;

111  
i
=0; i<
äamesP”Bufãr
; i++ )

113 
pha£
 += 0x123;

114 *
out
++ = (è(
pha£
 * (1.0 / 32768.0));

115 ifĞ
d©a
->
numChªÃls
 == 2 )

117 *
out
++ = (è(
pha£
 * (1.0 / 32768.0));

123 
·IÁ32
:

125 *
out
 = (*è
ouutBufãr
;

126  
i
=0; i<
äamesP”Bufãr
; i++ )

128 
pha£
 += 0x123;

129 *
out
++ = ((è
pha£
 ) << 16;

130 ifĞ
d©a
->
numChªÃls
 == 2 )

132 *
out
++ = ((è
pha£
 ) << 16;

137 
·IÁ16
:

139 *
out
 = (*è
ouutBufãr
;

140  
i
=0; i<
äamesP”Bufãr
; i++ )

142 
pha£
 += 0x123;

143 *
out
++ = 
pha£
;

144 ifĞ
d©a
->
numChªÃls
 == 2 )

146 *
out
++ = 
pha£
;

154 *
out
 = (*è
ouutBufãr
;

155 
numBy‹s
 = 
äamesP”Bufãr
 * 
d©a
->
numChªÃls
 * d©a->
by‹sP”Sam¶e
;

156  
i
=0; i<
numBy‹s
; i++ )

158 *
out
++ = 0;

163 
d©a
->
§wPha£
 = 
pha£
;

166 ifĞ
d©a
->
äamesLeá
 > 
äamesP”Bufãr
 )

168 
	`AddT¿ûMes§ge
("QaC®lback:„uÂšg. f¿mesLeá", 
d©a
->
äamesLeá
 );

169 
d©a
->
äamesLeá
 -ğ
äamesP”Bufãr
;

174 
	`AddT¿ûMes§ge
("QaC®lback: DONE! f¿mesLeá", 
d©a
->
äamesLeá
 );

175 
d©a
->
äamesLeá
 = 0;

178 
	}
}

180 
maš
();

181 
	$maš
()

183 
PaE¼Ü
 
»suÉ
;

184 
	`EXPECT
Ğ((
»suÉ
=
	`Pa_In™Ÿlize
()) == 0) );

185 
	`´štf
("Test OUTPUT ---------------\n");

186 
	`Te¡Deviûs
Ğ
MODE_OUTPUT
 );

187 
	`´štf
("Test INPUT ---------------\n");

188 
	`Te¡Deviûs
Ğ
MODE_INPUT
 );

189 
”rÜ
:

190 
	`Pa_T”mš©e
();

191 
	`´štf
("QA R•Üt: %d…as£d, %d faed.\n", 
gNumPas£d
, 
gNumFaed
 );

192 
	}
}

195 
	$Te¡Deviûs
Ğ
mode
 )

197 
id
,
jc
,
kr
;

198 
maxChªÃls
;

199 cÚ¡ 
PaDeviûInfo
 *
pdi
;

200 
numDeviûs
 = 
	`Pa_CouÁDeviûs
();

202  
id
=0; id<
numDeviûs
; id++ )

204 
pdi
 = 
	`Pa_G‘DeviûInfo
Ğ
id
 );

206 
maxChªÃls
 = ( 
mode
 =ğ
MODE_INPUT
 ) ? 
pdi
->
maxIÅutChªÃls
 :…di->
maxOuutChªÃls
;

207  
jc
=1; jc<=
maxChªÃls
; jc++ )

209 
	`´štf
("Nam = %s\n", 
pdi
->
Çme
 );

211 ifĞ
pdi
->
numSam¶eR©es
 == -1 )

213 
low
, 
high
;

214 
low
 = 
pdi
->
§m¶eR©es
[0];

215 
high
 = 
pdi
->
§m¶eR©es
[1];

216 ifĞ
low
 < 8000.0 )†ow = 8000.0;

217 
	`Te¡FÜm©s
Ğ
mode
, 
id
, 
low
, 
jc
 );

218 
	#TESTSR
(
¤
è{if(((¤)>=
low
è&& ((¤)<=
high
)è
	`Te¡FÜm©s
Ğ
mode
, 
id
, (¤), 
jc
 ); }

	)

220 
	`TESTSR
(11025.0);

221 
	`TESTSR
(22050.0);

222 
	`TESTSR
(34567.0);

223 
	`TESTSR
(44100.0);

224 
	`Te¡FÜm©s
Ğ
mode
, 
id
, 
high
, 
jc
 );

228  
kr
=0; kr<
pdi
->
numSam¶eR©es
; kr++ )

230 
	`Te¡FÜm©s
Ğ
mode
, 
id
, 
pdi
->
§m¶eR©es
[
kr
], 
jc
 );

235 
	}
}

237 
	$Te¡FÜm©s
Ğ
mode
, 
PaDeviûID
 
deviûID
, 
§m¶eR©e
,

238 
numChªÃls
 )

240 
	`Te¡Advªû
Ğ
mode
, 
deviûID
, 
§m¶eR©e
, 
numChªÃls
, 
·Flßt32
 );

241 
	`Te¡Advªû
Ğ
mode
, 
deviûID
, 
§m¶eR©e
, 
numChªÃls
, 
·IÁ16
 );

242 
	`Te¡Advªû
Ğ
mode
, 
deviûID
, 
§m¶eR©e
, 
numChªÃls
, 
·IÁ32
 );

243 
	}
}

245 
	$Te¡Advªû
Ğ
mode
, 
PaDeviûID
 
deviûID
, 
§m¶eR©e
,

246 
numChªÃls
, 
PaSam¶eFÜm©
 
fÜm©
 )

248 
PÜtAudioSŒ—m
 *
¡»am
 = 
NULL
;

249 
PaE¼Ü
 
»suÉ
;

250 
PaQaD©a
 
myD©a
;

251 
	#FRAMES_PER_BUFFER
 (64)

	)

252 
	`´štf
("------ TestAdvance: %s, device = %d,„ate = %g,‚umChannels = %d, format = %d -------\n",

253 Ğ
mode
 =ğ
MODE_INPUT
 ) ? "INPUT" : "OUTPUT",

254 
deviûID
, 
§m¶eR©e
, 
numChªÃls
, 
fÜm©
);

255 
	`fæush
(
¡dout
);

257 
myD©a
.
äamesLeá
 = (è(
§m¶eR©e
 * 100);

258 
myD©a
.
numChªÃls
 =‚umChannels;

259 
myD©a
.
mode
 = mode;

260 
myD©a
.
fÜm©
 = format;

261  
fÜm©
 )

263 
·Flßt32
:

264 
·IÁ32
:

265 
·IÁ24
:

266 
myD©a
.
by‹sP”Sam¶e
 = 4;

268 
·PackedIÁ24
:

269 
myD©a
.
by‹sP”Sam¶e
 = 3;

272 
myD©a
.
by‹sP”Sam¶e
 = 2;

275 
	`EXPECT
Ğ((
»suÉ
 = 
	`Pa_O³nSŒ—m
(

276 &
¡»am
,

277 Ğ
mode
 =ğ
MODE_INPUT
 ) ? 
deviûID
 : 
·NoDeviû
,

278 Ğ
mode
 =ğ
MODE_INPUT
 ) ? 
numChªÃls
 : 0,

279 
fÜm©
,

280 
NULL
,

281 Ğ
mode
 =ğ
MODE_OUTPUT
 ) ? 
deviûID
 : 
·NoDeviû
,

282 Ğ
mode
 =ğ
MODE_OUTPUT
 ) ? 
numChªÃls
 : 0,

283 
fÜm©
,

284 
NULL
,

285 
§m¶eR©e
,

286 
FRAMES_PER_BUFFER
,

288 
·ClOff
,

289 
QaC®lback
,

290 &
myD©a
 )

292 ifĞ
¡»am
 )

294 
PaTime¡amp
 
ŞdSmp
, 
ÃwSmp
;

295 
ŞdF¿mes
;

296 
mšD–ay
 = ( 
mode
 =ğ
MODE_INPUT
 ) ? 1000 : 400;

297 
mšNumBufãrs
 = 
	`Pa_G‘MšNumBufãrs
Ğ
FRAMES_PER_BUFFER
, 
§m¶eR©e
 );

298 
m£c
 = (è((
mšNumBufãrs
 * 3 * 1000.0 * 
FRAMES_PER_BUFFER
è/ 
§m¶eR©e
);

299 ifĞ
m£c
 < 
mšD–ay
 ) msec = minDelay;

300 
	`´štf
("m£øğ%d\n", 
m£c
);

301 
	`EXPECT
Ğ((
»suÉ
=
	`Pa_S¹SŒ—m
Ğ
¡»am
 )) == 0) );

303 
»suÉ
 = 
·NoE¼Ü
;

304 
ŞdSmp
 = 
	`Pa_SŒ—mTime
(
¡»am
);

305 
	`fæush
(
¡dout
);

306 
	`Pa_SË•
(
m£c
);

307 
ÃwSmp
 = 
	`Pa_SŒ—mTime
(
¡»am
);

308 
	`´štf
("ŞdSm°ğ%g,ÃwSm°ğ%g\n", 
ŞdSmp
, 
ÃwSmp
 );

309 
	`EXPECT
Ğ(
ŞdSmp
 < 
ÃwSmp
) );

311 
ŞdF¿mes
 = 
myD©a
.
äamesLeá
;

312 
	`Pa_SË•
(
m£c
);

313 
	`´štf
("ŞdF¿me ğ%d, myD©a.äamesLeá = %d\n", 
ŞdF¿mes
, 
myD©a
.
äamesLeá
 );

314 
	`EXPECT
Ğ(
ŞdF¿mes
 > 
myD©a
.
äamesLeá
) );

315 
	`EXPECT
Ğ((
»suÉ
=
	`Pa_Clo£SŒ—m
Ğ
¡»am
 )) == 0) );

316 
¡»am
 = 
NULL
;

318 
”rÜ
:

319 ifĞ
¡»am
 !ğ
NULL
 ) 
	`Pa_Clo£SŒ—m
( stream );

320 
	`fæush
(
¡dout
);

321  
»suÉ
;

322 
	}
}

	@pa_tests/paqa_errs.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

41 
	#MODE_INPUT
 (0)

	)

42 
	#MODE_OUTPUT
 (1)

	)

43 
	#FRAMES_PER_BUFFER
 (64)

	)

44 
	#SAMPLE_RATE
 (44100.0)

	)

45 
	#NUM_BUFFERS
 (0)

	)

46 
	sPaQaD©a


48 
	mäamesLeá
;

49 
	mnumChªÃls
;

50 
	mby‹sP”Sam¶e
;

51 
	mmode
;

53 
	tPaQaD©a
;

55 
Te¡Deviûs
Ğ
mode
 );

56 
Te¡FÜm©s
Ğ
mode
, 
PaDeviûID
 
deviûID
, 
§m¶eR©e
,

57 
numChªÃls
 );

58 
Te¡BadO³ns
( );

59 
Te¡BadAùiÚs
( );

60 
QaC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

61 
äamesP”Bufãr
,

62 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

64 
	ggNumPas£d
 = 0;

65 
	ggNumFaed
 = 0;

69 
	#EXPECT
Ğ
msg
, 
_exp
) \

72 ià((
_exp
)) {\

73 
gNumPas£d
++; \

76 
	`´štf
("\nERROR %s\À - 0x%x - % fÜ %s\n", (
msg
), 
»suÉ
, 
	`Pa_G‘E¼ÜText
(result), #_exp ); \

77 
gNumFaed
++; \

78 
”rÜ
; \

80 } 0)

	)

81 
	#HOPEFOR
Ğ
msg
, 
_exp
) \

84 ià((
_exp
)) {\

85 
gNumPas£d
++; \

88 
	`´štf
("\nERROR %s\À - 0x%x - % fÜ %s\n", (
msg
), 
»suÉ
, 
	`Pa_G‘E¼ÜText
(result), #_exp ); \

89 
gNumFaed
++; \

91 } 0)

	)

97 
	$QaC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

98 
äamesP”Bufãr
,

99 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

101 
i
;

102 *
out
 = (*è
ouutBufãr
;

103 
PaQaD©a
 *
d©a
 = (PaQaD©¨*è
u£rD©a
;

104 (è
šputBufãr
;

105 (è
outTime
;

108 ifĞ
d©a
->
mode
 =ğ
MODE_OUTPUT
 )

110 
numBy‹s
 = 
äamesP”Bufãr
 * 
d©a
->
numChªÃls
 * d©a->
by‹sP”Sam¶e
;

111  
i
=0; i<
numBy‹s
; i++ )

113 *
out
++ = 0;

117 ifĞ
d©a
->
äamesLeá
 > 
äamesP”Bufãr
 )

119 
d©a
->
äamesLeá
 -ğ
äamesP”Bufãr
;

124 
d©a
->
äamesLeá
 = 0;

127 
	}
}

129 
maš
();

130 
	$maš
()

132 
PaE¼Ü
 
»suÉ
;

133 
	`EXPECT
Ğ"š™", ((
»suÉ
=
	`Pa_In™Ÿlize
()) == 0) );

134 
	`Te¡BadAùiÚs
();

135 
	`Te¡BadO³ns
();

136 
”rÜ
:

137 
	`Pa_T”mš©e
();

138 
	`´štf
("QA R•Üt: %d…as£d, %d faed.\n", 
gNumPas£d
, 
gNumFaed
 );

140 
	}
}

142 
	$Te¡BadO³ns
( )

144 
PÜtAudioSŒ—m
 *
¡»am
 = 
NULL
;

145 
PaE¼Ü
 
»suÉ
;

146 
PaQaD©a
 
myD©a
;

148 
myD©a
.
äamesLeá
 = (è(
SAMPLE_RATE
 * 100);

149 
myD©a
.
numChªÃls
 = 1;

150 
myD©a
.
mode
 = 
MODE_OUTPUT
;

151 
	`HOPEFOR
( "No devices specified.",(

152 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

153 &
¡»am
,

154 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

155 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

156 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

157 
·ClOff
,

158 
QaC®lback
,

159 &
myD©a
 )

160 è=ğ
·Inv®idDeviûId
) );

161 
	`HOPEFOR
( "Out of„ange input device specified.",(

162 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

163 &
¡»am
,

164 
	`Pa_CouÁDeviûs
(), 0, 
·Flßt32
, 
NULL
,

165 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

166 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

167 
·ClOff
,

168 
QaC®lback
,

169 &
myD©a
 )

170 è=ğ
·Inv®idDeviûId
) );

172 
	`HOPEFOR
( "Out of„ange output device specified.",(

173 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

174 &
¡»am
,

175 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

176 
	`Pa_CouÁDeviûs
(), 0, 
·Flßt32
, 
NULL
,

177 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

178 
·ClOff
,

179 
QaC®lback
,

180 &
myD©a
 )

181 è=ğ
·Inv®idDeviûId
) );

182 
	`HOPEFOR
( "Zero input channels.",(

183 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

184 &
¡»am
,

185 
	`Pa_G‘DeçuÉIÅutDeviûID
(), 0, 
·Flßt32
, 
NULL
,

186 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

187 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

188 
·ClOff
,

189 
QaC®lback
,

190 &
myD©a
 )

191 è=ğ
·Inv®idChªÃlCouÁ
) );

192 
	`HOPEFOR
( "Zero output channels.",(

193 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

194 &
¡»am
,

195 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

196 
	`Pa_G‘DeçuÉOuutDeviûID
(), 0, 
·Flßt32
, 
NULL
,

197 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

198 
·ClOff
,

199 
QaC®lback
,

200 &
myD©a
 )

201 è=ğ
·Inv®idChªÃlCouÁ
) );

202 
	`HOPEFOR
( "Nonzero input channels but‚o device.",(

203 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

204 &
¡»am
,

205 
	`Pa_G‘DeçuÉIÅutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

206 
·NoDeviû
, 2, 
·Flßt32
, 
NULL
,

207 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

208 
·ClOff
,

209 
QaC®lback
,

210 &
myD©a
 )

211 è=ğ
·Inv®idChªÃlCouÁ
) );

213 
	`HOPEFOR
( "Nonzero output channels but‚o device.",(

214 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

215 &
¡»am
,

216 
·NoDeviû
, 2, 
·Flßt32
, 
NULL
,

217 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

218 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

219 
·ClOff
,

220 
QaC®lback
,

221 &
myD©a
 )

222 è=ğ
·Inv®idChªÃlCouÁ
) );

223 
	`HOPEFOR
( "NULL stream…ointer.",(

224 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

225 
NULL
,

226 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

227 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

228 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

229 
·ClOff
,

230 
QaC®lback
,

231 &
myD©a
 )

232 è=ğ
·BadSŒ—mPŒ
) );

233 
	`HOPEFOR
( "Low sample„ate.",(

234 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

235 &
¡»am
,

236 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

237 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

238 1.0, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

239 
·ClOff
,

240 
QaC®lback
,

241 &
myD©a
 )

242 è=ğ
·Inv®idSam¶eR©e
) );

243 
	`HOPEFOR
( "High sample„ate.",(

244 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

245 &
¡»am
,

246 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

247 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

248 10000000.0, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

249 
·ClOff
,

250 
QaC®lback
,

251 &
myD©a
 )

252 è=ğ
·Inv®idSam¶eR©e
) );

253 
	`HOPEFOR
( "NULL callback.",(

254 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

255 &
¡»am
,

256 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

257 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

258 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

259 
·ClOff
,

260 
NULL
,

261 &
myD©a
 )

262 è=ğ
·NuÎC®lback
) );

263 
	`HOPEFOR
( "Bad flag.",(

264 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

265 &
¡»am
,

266 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

267 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

268 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

270 
QaC®lback
,

271 &
myD©a
 )

272 è=ğ
·Inv®idFÏg
) );

275 
	`HOPEFOR
( "Use input device‡s output device.",(

276 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

277 &
¡»am
,

278 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

279 
	`Pa_G‘DeçuÉIÅutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

280 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

281 
·ClOff
,

282 
QaC®lback
,

283 &
myD©a
 )

284 è=ğ
·Inv®idDeviûId
) );

286 
	`HOPEFOR
( "Use output device‡s input device.",(

287 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

288 &
¡»am
,

289 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

290 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

291 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

292 
·ClOff
,

293 
QaC®lback
,

294 &
myD©a
 )

295 è=ğ
·Inv®idDeviûId
) );

298 ifĞ
¡»am
 !ğ
NULL
 ) 
	`Pa_Clo£SŒ—m
( stream );

299  
»suÉ
;

300 
	}
}

302 
	$Te¡BadAùiÚs
( )

304 
PÜtAudioSŒ—m
 *
¡»am
 = 
NULL
;

305 
PaE¼Ü
 
»suÉ
;

306 
PaQaD©a
 
myD©a
;

308 
myD©a
.
äamesLeá
 = (è(
SAMPLE_RATE
 * 100);

309 
myD©a
.
numChªÃls
 = 1;

310 
myD©a
.
mode
 = 
MODE_OUTPUT
;

312 
	`EXPECT
Ğ"Te¡BadAùiÚs", ((
»suÉ
 = 
	`Pa_O³nSŒ—m
(

313 &
¡»am
,

314 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

315 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

316 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

317 
·ClOff
,

318 
QaC®lback
,

319 &
myD©a
 )

321 
	`HOPEFOR
Ğ"¡¬t", ((
»suÉ
 = 
	`Pa_S¹SŒ—m
Ğ
NULL
 )è=ğ
·BadSŒ—mPŒ
) );

322 
	`HOPEFOR
Ğ"¡İ", ((
»suÉ
 = 
	`Pa_StİSŒ—m
Ğ
NULL
 )è=ğ
·BadSŒ—mPŒ
) );

323 
	`HOPEFOR
Ğ"aùive?", ((
»suÉ
 = 
	`Pa_SŒ—mAùive
Ğ
NULL
 )è=ğ
·BadSŒ—mPŒ
) );

324 
	`HOPEFOR
Ğ"şo£", ((
»suÉ
 = 
	`Pa_Clo£SŒ—m
Ğ
NULL
 )è=ğ
·BadSŒ—mPŒ
) );

325 
	`HOPEFOR
Ğ"time?", ((
»suÉ
 = (
PaE¼Ü
)
	`Pa_SŒ—mTime
Ğ
NULL
 )) != 0) );

326 
	`HOPEFOR
Ğ"CPULßd?", ((
»suÉ
 = (
PaE¼Ü
)
	`Pa_G‘CPULßd
Ğ
NULL
 )) != 0) );

327 
”rÜ
:

328 ifĞ
¡»am
 !ğ
NULL
 ) 
	`Pa_Clo£SŒ—m
( stream );

329  
»suÉ
;

330 
	}
}

	@pa_tests/patest1.c

10 
	~<¡dio.h
>

11 
	~<m©h.h
>

12 
	~"pÜudio.h
"

13 #iâdeà
M_PI


14 
	#M_PI
 (3.14159265)

	)

18 
	msše
[100];

19 
	mpha£
;

20 
	m§mpsToGo
;

22 
	t·‹¡1d©a
;

23 
	$·‹¡1C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

24 
bufãrF¿mes
,

25 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

27 
·‹¡1d©a
 *
d©a
 = (·‹¡1d©a*)
u£rD©a
;

28 *
š
 = (*)
šputBufãr
;

29 *
out
 = (*)
ouutBufãr
;

30 
äamesToC®c
 = 
bufãrF¿mes
;

31 
i
;

32 
fšished
 = 0;

34 if(
šputBufãr
 =ğ
NULL
)  0;

35 ifĞ
d©a
->
§mpsToGo
 < 
bufãrF¿mes
 )

37 
äamesToC®c
 = 
d©a
->
§mpsToGo
;

38 
fšished
 = 1;

40  
i
=0; i<
äamesToC®c
; i++ )

42 *
out
++ = *
š
++ * 
d©a
->
sše
[d©a->
pha£
];

43 *
out
++ = *
š
++ * 
d©a
->
sše
[d©a->
pha£
++];

44 ifĞ
d©a
->
pha£
 >= 100 )

45 
d©a
->
pha£
 = 0;

47 
d©a
->
§mpsToGo
 -ğ
äamesToC®c
;

49  ; 
i
<
bufãrF¿mes
; i++ )

51 *
out
++ = 0;

52 *
out
++ = 0;

54  
fšished
;

55 
	}
}

56 
maš
(
¬gc
, * 
¬gv
[]);

57 
	$maš
(
¬gc
, * 
¬gv
[])

59 
PaSŒ—m
 *
¡»am
;

60 
PaE¼Ü
 
”r
;

61 
·‹¡1d©a
 
d©a
;

62 
i
;

63 
šputDeviû
 = 
	`Pa_G‘DeçuÉIÅutDeviûID
();

64 
ouutDeviû
 = 
	`Pa_G‘DeçuÉOuutDeviûID
();

66  
i
=0; i<100; i++ )

67 
d©a
.
sše
[
i
] = 
	`sš
Ğ(()i/100.è* 
M_PI
 * 2. );

68 
d©a
.
pha£
 = 0;

69 
d©a
.
§mpsToGo
 = 44100 * 20;

71 
	`Pa_In™Ÿlize
();

72 
”r
 = 
	`Pa_O³nSŒ—m
(

73 &
¡»am
,

74 
šputDeviû
,

76 
·Flßt32
,

77 
NULL
,

78 
ouutDeviû
,

80 
·Flßt32
,

81 
NULL
,

85 
·ClOff
,

86 
·‹¡1C®lback
,

87 &
d©a
 );

88 ifĞ
”r
 =ğ
·NoE¼Ü
 )

90 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

91 
	`´štf
( "Press‡ny keyoƒnd.\n" );

92 
	`g‘c
Ğ
¡dš
 );

93 
	`Pa_AbÜtSŒ—m
Ğ
¡»am
 );

95 
	`´štf
( "Waiting for streamo complete...\n" );

97  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

98 
	`Pa_SË•
(1000);

100 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

104 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while openinghe…ortaudio stream\n" );

105 ifĞ
”r
 =ğ
·Ho¡E¼Ü
 )

106 
	`årštf
Ğ
¡d”r
, "Ho¡ƒ¼Ü‚umb”: %d\n", 
	`Pa_G‘Ho¡E¼Ü
() );

108 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

110 
	`Pa_T”mš©e
();

111 
	`´štf
( "bye\n" );

114 
	}
}

	@pa_tests/patest_clip.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

40 
	#NUM_SECONDS
 (4)

	)

41 
	#SAMPLE_RATE
 (44100)

	)

42 #iâdeà
M_PI


43 
	#M_PI
 (3.14159265)

	)

45 
	#TABLE_SIZE
 (200)

	)

46 
	s·Te¡D©a


48 
	msše
[
TABLE_SIZE
];

49 
	mam¶™ude
;

50 
	mËá_pha£
;

51 
	mright_pha£
;

53 
	t·Te¡D©a
;

54 
PaE¼Ü
 
PÏySše
Ğ
·Te¡D©a
 *
d©a
, 
æags
, 
am¶™ude
 );

59 
	$sšeC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

60 
äamesP”Bufãr
,

61 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

63 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

64 *
out
 = (*)
ouutBufãr
;

65 
am¶™ude
 = 
d©a
->amplitude;

66 
i
;

67 (è
šputBufãr
;

68 (è
outTime
;

70  
i
=0; i<
äamesP”Bufãr
; i++ )

72 *
out
++ = 
am¶™ude
 * 
d©a
->
sše
[d©a->
Ëá_pha£
];

73 *
out
++ = 
am¶™ude
 * 
d©a
->
sše
[d©a->
right_pha£
];

74 
d©a
->
Ëá_pha£
 += 1;

75 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

76 
d©a
->
right_pha£
 += 3;

77 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

80 
	}
}

82 
maš
();

83 
	$maš
()

85 
PaE¼Ü
 
”r
;

86 
·Te¡D©a
 
DATA
;

87 
i
;

88 
	`´štf
("PortAudio Test: output sine wave with‡nd without clipping.\n");

90  
i
=0; i<
TABLE_SIZE
; i++ )

92 
DATA
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

94 
	`´štf
("\nH®àam¶™ude. Should sound†iksšwave.\n"); 
	`fæush
(
¡dout
);

95 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·ClOff
 | 
·D™h”Off
, 0.5f );

96 ifĞ
”r
 < 0 ) 
”rÜ
;

97 
	`´štf
("\nFuÎ‡m¶™ude. Should sound†iksšwave.\n"); 
	`fæush
(
¡dout
);

98 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·ClOff
 | 
·D™h”Off
, 0.999f );

99 ifĞ
”r
 < 0 ) 
”rÜ
;

100 
	`´štf
("\nOver„ange with clipping‡nd ditheringurned OFF. Should sound very‚asty.\n");

101 
	`fæush
(
¡dout
);

102 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·ClOff
 | 
·D™h”Off
, 1.1f );

103 ifĞ
”r
 < 0 ) 
”rÜ
;

104 
	`´štf
("\nOver„ange with clipping‡nd ditheringurned ON. Should sound smootherhan…revious.\n");

105 
	`fæush
(
¡dout
);

106 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·NoFÏg
, 1.1f );

107 ifĞ
”r
 < 0 ) 
”rÜ
;

108 
	`´štf
("\nOver„ange with…aClipOff but dithering ON.\n"

110 
	`fæush
(
¡dout
);

111 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·ClOff
, 1.1f );

112 ifĞ
”r
 < 0 ) 
”rÜ
;

114 
”rÜ
:

115 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

116 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

117 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

119 
	}
}

121 
PaE¼Ü
 
	$PÏySše
Ğ
·Te¡D©a
 *
d©a
, 
æags
, 
am¶™ude
 )

123 
PÜtAudioSŒ—m
 *
¡»am
;

124 
PaE¼Ü
 
”r
;

125 
d©a
->
Ëá_pha£
 = d©a->
right_pha£
 = 0;

126 
d©a
->
am¶™ude
 =‡mplitude;

127 
”r
 = 
	`Pa_In™Ÿlize
();

128 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

129 
”r
 = 
	`Pa_O³nSŒ—m
(

130 &
¡»am
,

131 
·NoDeviû
,

133 
·Flßt32
,

134 
NULL
,

135 
	`Pa_G‘DeçuÉOuutDeviûID
(),

137 
·Flßt32
,

138 
NULL
,

139 
SAMPLE_RATE
,

142 
æags
,

143 
sšeC®lback
,

144 
d©a
 );

145 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

146 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

147 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

148 
	`Pa_SË•
Ğ
NUM_SECONDS
 * 1000 );

149 
	`´štf
("CPULßd = %8.6f\n", 
	`Pa_G‘CPULßd
Ğ
¡»am
 ) );

150 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

151 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

152 
	`Pa_T”mš©e
();

153  
·NoE¼Ü
;

154 
”rÜ
:

155  
”r
;

156 
	}
}

	@pa_tests/patest_dither.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

40 
	#NUM_SECONDS
 (4)

	)

41 
	#SAMPLE_RATE
 (44100)

	)

42 #iâdeà
M_PI


43 
	#M_PI
 (3.14159265)

	)

45 
	#TABLE_SIZE
 (200)

	)

46 
	s·Te¡D©a


48 
	msše
[
TABLE_SIZE
];

49 
	mam¶™ude
;

50 
	mËá_pha£
;

51 
	mright_pha£
;

53 
	t·Te¡D©a
;

54 
PaE¼Ü
 
PÏySše
Ğ
·Te¡D©a
 *
d©a
, 
PaSŒ—mFÏgs
 
æags
, 
am¶™ude
 );

55 
sšeC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

56 
äamesP”Bufãr
,

57 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

62 
	$sšeC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

66 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

67 *
out
 = (*)
ouutBufãr
;

68 
am¶™ude
 = 
d©a
->amplitude;

69 
i
;

70 (è
outTime
;

71 (è
šputBufãr
;

72  
i
=0; i<
äamesP”Bufãr
; i++ )

74 *
out
++ = 
am¶™ude
 * 
d©a
->
sše
[d©a->
Ëá_pha£
];

75 *
out
++ = 
am¶™ude
 * 
d©a
->
sše
[d©a->
right_pha£
];

76 
d©a
->
Ëá_pha£
 += 1;

77 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

78 
d©a
->
right_pha£
 += 3;

79 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

82 
	}
}

84 
maš
();

85 
	$maš
()

87 
PaE¼Ü
 
”r
;

88 
·Te¡D©a
 
DATA
;

89 
i
;

90 
am¶™ude
 = 32.0 / (1<<15);

91 
	`´štf
("PortAudio Test: output EXTREMELY QUIET sine wave with‡nd without dithering.\n");

93  
i
=0; i<
TABLE_SIZE
; i++ )

95 
DATA
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

97 
	`´štf
("\nNØŒ—tm’t..\n"); 
	`fæush
(
¡dout
);

98 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·ClOff
 | 
·D™h”Off
, 
am¶™ude
 );

99 ifĞ
”r
 < 0 ) 
”rÜ
;

100 
	`´štf
("\nClip.\n");

101 
	`fæush
(
¡dout
);

102 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·D™h”Off
, 
am¶™ude
 );

103 ifĞ
”r
 < 0 ) 
”rÜ
;

104 
	`´štf
("\nClip‡nd Dither.\n");

105 
	`fæush
(
¡dout
);

106 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·NoFÏg
, 
am¶™ude
 );

107 ifĞ
”r
 < 0 ) 
”rÜ
;

109 
”rÜ
:

110 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

111 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

112 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

114 
	}
}

116 
PaE¼Ü
 
	$PÏySše
Ğ
·Te¡D©a
 *
d©a
, 
PaSŒ—mFÏgs
 
æags
, 
am¶™ude
 )

118 
PÜtAudioSŒ—m
 *
¡»am
;

119 
PaE¼Ü
 
”r
;

120 
d©a
->
Ëá_pha£
 = d©a->
right_pha£
 = 0;

121 
d©a
->
am¶™ude
 =‡mplitude;

122 
”r
 = 
	`Pa_In™Ÿlize
();

123 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

124 
”r
 = 
	`Pa_O³nSŒ—m
(

125 &
¡»am
,

126 
·NoDeviû
,

128 
·Flßt32
,

129 
NULL
,

130 
	`Pa_G‘DeçuÉOuutDeviûID
(),

132 
·Flßt32
,

133 
NULL
,

134 
SAMPLE_RATE
,

137 
æags
,

138 
sšeC®lback
,

139 (*)
d©a
 );

140 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

142 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

143 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

144 
	`Pa_SË•
Ğ
NUM_SECONDS
 * 1000 );

145 
	`´štf
("CPULßd = %8.6f\n", 
	`Pa_G‘CPULßd
Ğ
¡»am
 ) );

146 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

147 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

148 
	`Pa_T”mš©e
();

149  
·NoE¼Ü
;

150 
”rÜ
:

151  
”r
;

152 
	}
}

	@pa_tests/patest_latency.c

36 
	~<¡dio.h
>

37 
	~<m©h.h
>

38 
	~"pÜudio.h
"

40 
	#OUTPUT_DEVICE
 (
	`Pa_G‘DeçuÉOuutDeviûID
())

	)

41 
	#SAMPLE_RATE
 (44100)

	)

42 
	#FRAMES_PER_BUFFER
 (64)

	)

45 
	#MIN_LATENCY_MSEC
 (2000)

	)

46 
	#NUM_BUFFERS
 ((
MIN_LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

48 
	#NUM_BUFFERS
 (0)

	)

51 
	#MIN_FREQ
 (100.0f)

	)

52 
	#C®cPha£Inüem’t
(
äeq
è((äeq)/
SAMPLE_RATE
)

	)

53 #iâdeà
M_PI


54 
	#M_PI
 (3.14159265)

	)

56 
	#TABLE_SIZE
 (400)

	)

59 
	msše
[
TABLE_SIZE
 + 1];

60 
	mpha£_šüem’t
;

61 
	mËá_pha£
;

62 
	mright_pha£
;

64 
	t·Te¡D©a
;

65 
LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 );

69 
	$LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 )

71 
fIndex
 = 
pha£
*
TABLE_SIZE
;

72 
šdex
 = (è
fIndex
;

73 
äaù
 = 
fIndex
 - 
šdex
;

74 
lo
 = 
d©a
->
sše
[
šdex
];

75 
hi
 = 
d©a
->
sše
[
šdex
+1];

76 
v®
 = 
lo
 + 
äaù
*(
hi
-lo);

77  
v®
;

78 
	}
}

83 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

84 
äamesP”Bufãr
,

85 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

87 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

88 *
out
 = (*)
ouutBufãr
;

89 
i
;

90 
fšished
 = 0;

91 (è
outTime
;

92 (è
šputBufãr
;

94  
i
=0; i<
äamesP”Bufãr
; i++ )

96 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
Ëá_pha£
);

97 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
right_pha£
);

98 
d©a
->
Ëá_pha£
 +ğd©a->
pha£_šüem’t
;

99 ifĞ
d©a
->
Ëá_pha£
 >= 1.0f ) data->left_phase -= 1.0f;

100 
d©a
->
right_pha£
 +ğ(d©a->
pha£_šüem’t
 * 1.5f);

101 ifĞ
d©a
->
right_pha£
 >= 1.0f ) data->right_phase -= 1.0f;

104 
	}
}

106 
maš
();

107 
	$maš
()

109 
PÜtAudioSŒ—m
 *
¡»am
;

110 
PaE¼Ü
 
”r
;

111 
·Te¡D©a
 
d©a
;

112 
i
;

113 
dÚe
 = 0;

114 
	`´štf
("PÜtAudiØTe¡:ƒÁ”†‘‹¸th’ h™ ENTER.‚umBufãr ğ%d\n", 
NUM_BUFFERS
 );

116  
i
=0; i<
TABLE_SIZE
; i++ )

118 
d©a
.
sše
[
i
] = 0.90à* (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

120 
d©a
.
sše
[
TABLE_SIZE
] = data.sine[0];

121 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0.0;

122 
d©a
.
pha£_šüem’t
 = 
	`C®cPha£Inüem’t
(
MIN_FREQ
);

124 
”r
 = 
	`Pa_In™Ÿlize
();

125 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

126 
	`´štf
("PÜtAudiØTe¡: ouuˆdeviû = %d\n", 
OUTPUT_DEVICE
 );

127 
”r
 = 
	`Pa_O³nSŒ—m
(

128 &
¡»am
,

129 
·NoDeviû
,

131 
·Flßt32
,

132 
NULL
,

133 
OUTPUT_DEVICE
,

135 
·Flßt32
,

136 
NULL
,

137 
SAMPLE_RATE
,

138 
FRAMES_PER_BUFFER
,

139 
NUM_BUFFERS
,

140 
·ClOff
|
·D™h”Off
,

141 
·‹¡C®lback
,

142 &
d©a
 );

143 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

144 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

145 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

146 
	`´štf
("Play ASCII keyboard. Hit 'q'o stop. (Use RETURN key on Mac)\n");

147 
	`fæush
(
¡dout
);

148  !
dÚe
 )

150 
äeq
;

151 
šdex
;

152 
c
;

155 
c
 = 
	`g‘ch¬
();

157  
c
 < ' ');

159 ifĞ
c
 =ğ'q' ) 
dÚe
 = 1;

160 
šdex
 = 
c
 % 26;

161 
äeq
 = 
MIN_FREQ
 + (
šdex
 * 40.0);

162 
d©a
.
pha£_šüem’t
 = 
	`C®cPha£Inüem’t
(
äeq
);

164 
	`´štf
("Call Pa_StopStream()\n");

165 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

166 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

167 
	`Pa_T”mš©e
();

168 
	`´štf
("Test finished.\n");

169  
”r
;

170 
”rÜ
:

171 
	`Pa_T”mš©e
();

172 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

173 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

174 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

175  
”r
;

176 
	}
}

	@pa_tests/patest_leftright.c

39 
	~<¡dio.h
>

40 
	~<m©h.h
>

41 
	~"pÜudio.h
"

42 
	#NUM_SECONDS
 (8)

	)

43 
	#SAMPLE_RATE
 (44100)

	)

44 
	#FRAMES_PER_BUFFER
 (512)

	)

45 #iâdeà
M_PI


46 
	#M_PI
 (3.14159265)

	)

48 
	#TABLE_SIZE
 (200)

	)

51 
	msše
[
TABLE_SIZE
];

52 
	mËá_pha£
;

53 
	mright_pha£
;

54 
	mtoggË
;

55 
	mcouÁDown
;

57 
	t·Te¡D©a
;

62 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

66 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

67 *
out
 = (*)
ouutBufãr
;

68 
i
;

69 
fšished
 = 0;

70 (è
outTime
;

71 (è
šputBufãr
;

73  
i
=0; i<
äamesP”Bufãr
; i++ )

75 ifĞ
d©a
->
toggË
 )

77 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

78 *
out
++ = 0;

82 *
out
++ = 0;

83 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

86 
d©a
->
Ëá_pha£
 += 1;

87 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

88 
d©a
->
right_pha£
 += 3;

89 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

92 ifĞ
d©a
->
couÁDown
 < 0 )

94 
d©a
->
couÁDown
 = 
SAMPLE_RATE
;

95 
d©a
->
toggË
 = !data->toggle;

97 
d©a
->
couÁDown
 -ğ
äamesP”Bufãr
;

99  
fšished
;

100 
	}
}

103 
maš
();

104 
	$maš
()

106 
PÜtAudioSŒ—m
 *
¡»am
;

107 
PaE¼Ü
 
”r
;

108 
·Te¡D©a
 
d©a
;

109 
i
;

110 
timeout
;

112 
	`´štf
("Play differentone sine waveshat‡lternate between†eft‡nd„ight channel.\n");

113 
	`´štf
("The†owone should be onhe†eft channel.\n");

116  
i
=0; i<
TABLE_SIZE
; i++ )

118 
d©a
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

120 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = d©a.
toggË
 = 0;

121 
d©a
.
couÁDown
 = 
SAMPLE_RATE
;

123 
”r
 = 
	`Pa_In™Ÿlize
();

124 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

126 
”r
 = 
	`Pa_O³nSŒ—m
(

127 &
¡»am
,

128 
·NoDeviû
,

130 
·Flßt32
,

131 
NULL
,

132 
	`Pa_G‘DeçuÉOuutDeviûID
(),

134 
·Flßt32
,

135 
NULL
,

136 
SAMPLE_RATE
,

137 
FRAMES_PER_BUFFER
,

139 
·ClOff
,

140 
·‹¡C®lback
,

141 &
d©a
 );

142 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

144 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

145 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

147 
	`´štf
("Play for several seconds.\n");

148 
timeout
 = 
NUM_SECONDS
 * 4;

149  
timeout
 > 0 )

151 
	`Pa_SË•
( 300 );

152 
timeout
 -= 1;

155 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

156 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

157 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

158 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

159 
	`Pa_T”mš©e
();

160 
	`´štf
("Test finished.\n");

161  
”r
;

162 
”rÜ
:

163 
	`Pa_T”mš©e
();

164 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

165 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

166 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

167  
”r
;

168 
	}
}

	@pa_tests/patest_longsine.c

36 
	~<¡dio.h
>

37 
	~<m©h.h
>

38 
	~"pÜudio.h
"

40 
	#SAMPLE_RATE
 (44100)

	)

42 #iâdeà
M_PI


43 
	#M_PI
 (3.14159265)

	)

46 
	#TABLE_SIZE
 (200)

	)

49 
	msše
[
TABLE_SIZE
];

50 
	mËá_pha£
;

51 
	mright_pha£
;

53 
	t·Te¡D©a
;

59 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

60 
äamesP”Bufãr
,

61 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

63 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

64 *
out
 = (*)
ouutBufãr
;

65 
i
;

66 (è
outTime
;

67 (è
šputBufãr
;

68  
i
=0; i<
äamesP”Bufãr
; i++ )

70 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

71 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

72 
d©a
->
Ëá_pha£
 += 1;

73 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

74 
d©a
->
right_pha£
 += 3;

75 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

78 
	}
}

81 
maš
();

82 
	$maš
()

84 
PÜtAudioSŒ—m
 *
¡»am
;

85 
PaE¼Ü
 
”r
;

86 
·Te¡D©a
 
d©a
;

87 
i
;

88 
	`´štf
("PortAudio Test: output sine wave.\n");

91  
i
=0; i<
TABLE_SIZE
; i++ )

93 
d©a
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

95 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0;

97 
”r
 = 
	`Pa_In™Ÿlize
();

98 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

100 
”r
 = 
	`Pa_O³nSŒ—m
(

101 &
¡»am
,

102 
·NoDeviû
,

104 
·Flßt32
,

105 
NULL
,

106 
	`Pa_G‘DeçuÉOuutDeviûID
(),

108 
·Flßt32
,

109 
NULL
,

110 
SAMPLE_RATE
,

113 
·ClOff
,

114 
·‹¡C®lback
,

115 &
d©a
 );

116 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

118 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

119 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

121 
	`´štf
("Hit ENTERo stop…rogram.\n");

122 
	`g‘ch¬
();

124 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

125 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

126 
	`Pa_T”mš©e
();

128 
	`´štf
("Test finished.\n");

129  
”r
;

131 
”rÜ
:

132 
	`Pa_T”mš©e
();

133 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

134 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

135 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

136  
”r
;

137 
	}
}

	@pa_tests/patest_many.c

36 
	~<¡dio.h
>

37 
	~<¡dlib.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

40 
	#NUM_SECONDS
 (1)

	)

41 
	#SAMPLE_RATE
 (44100)

	)

42 #iâdeà
M_PI


43 
	#M_PI
 (3.14159265)

	)

45 
	#TABLE_SIZE
 (200)

	)

48 
	msše
[
TABLE_SIZE
];

49 
	mËá_pha£
;

50 
	mright_pha£
;

51 
	m§mpsToGo
;

53 
	t·Te¡D©a
;

54 
PaE¼Ü
 
Te¡Onû
( );

55 
·‹¡1C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

56 
äamesP”Bufãr
,

57 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

62 
	$·‹¡1C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

66 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

67 *
out
 = (*)
ouutBufãr
;

68 
i
;

69 
fšished
 = 0;

70 (è
šputBufãr
;

71 (è
outTime
;

73 ifĞ
d©a
->
§mpsToGo
 < 
äamesP”Bufãr
 )

77  
i
=0; i<
d©a
->
§mpsToGo
; i++ )

79 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

80 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

81 
d©a
->
Ëá_pha£
 += 1;

82 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

83 
d©a
->
right_pha£
 += 3;

84 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

87  ; 
i
<
äamesP”Bufãr
; i++ )

89 *
out
++ = 0;

90 *
out
++ = 0;

93 
fšished
 = 1;

97  
i
=0; i<
äamesP”Bufãr
; i++ )

99 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

100 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

101 
d©a
->
Ëá_pha£
 += 1;

102 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

103 
d©a
->
right_pha£
 += 3;

104 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

106 
d©a
->
§mpsToGo
 -ğ
äamesP”Bufãr
;

108  
fšished
;

109 
	}
}

111 #ifdeà
MACINTOSH


112 
maš
();

113 
	$maš
()

115 
i
;

116 
PaE¼Ü
 
”r
;

117 
numLoİs
 = 10;

118 
	`´štf
("Loİ %dimes.\n", 
numLoİs
 );

119  
i
=0; i<
numLoİs
; i++ )

121 
	`´štf
("Loİ %d ouˆoà%d.\n", 
i
+1, 
numLoİs
 );

122 
”r
 = 
	`Te¡Onû
();

123 ifĞ
”r
 < 0 )  0;

125 
	}
}

127 
maš
(
¬gc
, **
¬gv
);

128 
	$maš
(
¬gc
, **
¬gv
)

130 
PaE¼Ü
 
”r
;

131 
i
, 
numLoİs
 = 10;

132 ifĞ
¬gc
 > 1 )

134 
numLoİs
 = 
	`©oi
(
¬gv
[1]);

136  
i
=0; i<
numLoİs
; i++ )

138 
	`´štf
("Loİ %d ouˆoà%d.\n", 
i
+1, 
numLoİs
 );

139 
”r
 = 
	`Te¡Onû
();

140 ifĞ
”r
 < 0 )  1;

142 
	`´štf
("Test complete.\n");

144 
	}
}

146 
PaE¼Ü
 
	$Te¡Onû
( )

148 
PÜtAudioSŒ—m
 *
¡»am
;

149 
PaE¼Ü
 
”r
;

150 
·Te¡D©a
 
d©a
;

151 
i
;

152 
tÙ®Samps
;

154  
i
=0; i<
TABLE_SIZE
; i++ )

156 
d©a
.
sše
[
i
] = (è(32767.0 * 
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. ));

158 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0;

159 
d©a
.
§mpsToGo
 = 
tÙ®Samps
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

160 
”r
 = 
	`Pa_In™Ÿlize
();

161 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

162 
”r
 = 
	`Pa_O³nSŒ—m
(

163 &
¡»am
,

164 
·NoDeviû
,

166 
·IÁ16
,

167 
NULL
,

168 
	`Pa_G‘DeçuÉOuutDeviûID
(),

170 
·IÁ16
,

171 
NULL
,

172 
SAMPLE_RATE
,

175 
·ClOff
,

176 
·‹¡1C®lback
,

177 &
d©a
 );

178 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

180 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

181 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

182 
	`´štf
("Waiting for soundo finish.\n");

183 
	`fæush
(
¡dout
);

184 
	`Pa_SË•
(1000);

185 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

186 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

187 
	`Pa_T”mš©e
();

188  
·NoE¼Ü
;

189 
”rÜ
:

190 
	`Pa_T”mš©e
();

191 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

192 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

193 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

194  
”r
;

195 
	}
}

	@pa_tests/patest_maxsines.c

38 
	~<¡dio.h
>

39 
	~<m©h.h
>

40 
	~"pÜudio.h
"

42 
	#MAX_SINES
 (500)

	)

43 
	#MAX_USAGE
 (0.8)

	)

44 
	#SAMPLE_RATE
 (44100)

	)

45 
	#FREQ_TO_PHASE_INC
(
äeq
è(äeq/()
SAMPLE_RATE
)

	)

47 
	#MIN_PHASE_INC
 
	`FREQ_TO_PHASE_INC
(200.0f)

	)

48 
	#MAX_PHASE_INC
 (
MIN_PHASE_INC
 * (1 << 5))

	)

50 
	#FRAMES_PER_BUFFER
 (512)

	)

51 #iâdeà
M_PI


52 
	#M_PI
 (3.14159265)

	)

54 
	#TWOPI
 (
M_PI
 * 2.0)

	)

56 
	#TABLE_SIZE
 (512)

	)

58 
	s·Te¡D©a


60 
	mnumSšes
;

61 
	msše
[
TABLE_SIZE
 + 1];

62 
	mpha£s
[
MAX_SINES
];

64 
	t·Te¡D©a
;

69 
LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 );

70 
	$LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 )

72 
fIndex
 = 
pha£
*
TABLE_SIZE
;

73 
šdex
 = (è
fIndex
;

74 
äaù
 = 
fIndex
 - 
šdex
;

75 
lo
 = 
d©a
->
sše
[
šdex
];

76 
hi
 = 
d©a
->
sše
[
šdex
+1];

77 
v®
 = 
lo
 + 
äaù
*(
hi
-lo);

78  
v®
;

79 
	}
}

85 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

86 
äamesP”Bufãr
,

87 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

89 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

90 *
out
 = (*)
ouutBufãr
;

91 
outSam¶e
;

92 
sÿËr
;

93 
numFÜSÿË
;

94 
i
;

95 
j
;

96 
fšished
 = 0;

97 (è
outTime
;

98 (è
šputBufãr
;

101 
numFÜSÿË
 = 
d©a
->
numSšes
;

102 ifĞ
numFÜSÿË
 < 8 )‚umForScale = 8;

103 
sÿËr
 = 1.0à/ 
numFÜSÿË
;

105  
i
=0; i<
äamesP”Bufãr
; i++ )

107 
ouut
 = 0.0;

108 
pha£Inc
 = 
MIN_PHASE_INC
;

109 
pha£
;

110  
j
=0; j<
d©a
->
numSšes
; j++ )

113 
pha£
 = 
d©a
->
pha£s
[
j
];

114 
pha£
 +ğ
pha£Inc
;

115 ifĞ
pha£
 >= 1.0 )…hase -= 1.0;

117 
ouut
 +ğ
	`LookupSše
(
d©a
, 
pha£
);

118 
d©a
->
pha£s
[
j
] = 
pha£
;

120 
pha£Inc
 *= 1.02f;

121 ifĞ
pha£Inc
 > 
MAX_PHASE_INC
 )…ha£Inøğ
MIN_PHASE_INC
;

124 
outSam¶e
 = (è(
ouut
 * 
sÿËr
);

125 *
out
++ = 
outSam¶e
;

126 *
out
++ = 
outSam¶e
;

128  
fšished
;

129 
	}
}

132 
maš
();

133 
	$maš
()

135 
i
;

136 
PÜtAudioSŒ—m
 *
¡»am
;

137 
PaE¼Ü
 
”r
;

138 
·Te¡D©a
 
d©a
 = {0};

139 
lßd
;

140 
	`´štf
("PÜtAudiØTe¡: ouuˆsšwave. SR = %d, BufSizğ%d\n", 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
);

143  
i
=0; i<
TABLE_SIZE
; i++ )

145 
d©a
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

147 
d©a
.
sše
[
TABLE_SIZE
] = data.sine[0];

149 
”r
 = 
	`Pa_In™Ÿlize
();

150 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

151 
”r
 = 
	`Pa_O³nSŒ—m
(

152 &
¡»am
,

153 
·NoDeviû
,

155 
·Flßt32
,

156 
NULL
,

157 
	`Pa_G‘DeçuÉOuutDeviûID
(),

159 
·Flßt32
,

160 
NULL
,

161 
SAMPLE_RATE
,

162 
FRAMES_PER_BUFFER
,

164 
·ClOff
,

165 
·‹¡C®lback
,

166 &
d©a
 );

167 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

168 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

169 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

174 
d©a
.
numSšes
++;

175 
	`Pa_SË•
( 200 );

177 
lßd
 = 
	`Pa_G‘CPULßd
Ğ
¡»am
 );

178 
	`´štf
("numSše ğ%d, CPU†ßd = %f\n", 
d©a
.
numSšes
, 
lßd
 );

179 
	`fæush
Ğ
¡dout
 );

181  (
lßd
 < 
MAX_USAGE
è&& (
d©a
.
numSšes
 < 
MAX_SINES
) );

183 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

184 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

185 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

186 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

187 
	`Pa_T”mš©e
();

188 
	`´štf
("Test finished.\n");

189  
”r
;

190 
”rÜ
:

191 
	`Pa_T”mš©e
();

192 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

193 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

194 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

195  
”r
;

196 
	}
}

	@pa_tests/patest_pink.c

45 
	~<¡dio.h
>

46 
	~<m©h.h
>

47 
	~"pÜudio.h
"

48 
	#PINK_MAX_RANDOM_ROWS
 (30)

	)

49 
	#PINK_RANDOM_BITS
 (24)

	)

50 
	#PINK_RANDOM_SHIFT
 ((()*8)-
PINK_RANDOM_BITS
)

	)

53 
	mpšk_Rows
[
PINK_MAX_RANDOM_ROWS
];

54 
	mpšk_RuÂšgSum
;

55 
	mpšk_Index
;

56 
	mpšk_IndexMask
;

57 
	mpšk_SÿÏr
;

59 
	tPškNoi£
;

61 
G’”©eRªdomNumb”
( );

62 
In™ŸlizePškNoi£
Ğ
PškNoi£
 *
pšk
, 
numRows
 );

63 
G’”©ePškNoi£
Ğ
PškNoi£
 *
pšk
 );

66 
	$G’”©eRªdomNumb”
( )

69 
¿ndS“d
 = 22222;

70 
¿ndS“d
 = (randSeed * 196314165) + 907633515;

71  
¿ndS“d
;

72 
	}
}

75 
	$In™ŸlizePškNoi£
Ğ
PškNoi£
 *
pšk
, 
numRows
 )

77 
i
;

78 
pmax
;

79 
pšk
->
pšk_Index
 = 0;

80 
pšk
->
pšk_IndexMask
 = (1<<
numRows
) - 1;

82 
pmax
 = (
numRows
 + 1è* (1<<(
PINK_RANDOM_BITS
-1));

83 
pšk
->
pšk_SÿÏr
 = 1.0à/ 
pmax
;

85  
i
=0; i<
numRows
; i++ ) 
pšk
->
pšk_Rows
[i] = 0;

86 
pšk
->
pšk_RuÂšgSum
 = 0;

87 
	}
}

88 
	#PINK_MEASURE


	)

89 #ifdeà
PINK_MEASURE


90 
	gpškMax
 = -999.0;

91 
	gpškMš
 = 999.0;

94 
	$G’”©ePškNoi£
Ğ
PškNoi£
 *
pšk
 )

96 
ÃwRªdom
;

97 
sum
;

98 
ouut
;

100 
pšk
->
pšk_Index
 = (pšk->pšk_Index + 1è&…šk->
pšk_IndexMask
;

102 ifĞ
pšk
->
pšk_Index
 != 0 )

106 
numZ”os
 = 0;

107 
n
 = 
pšk
->
pšk_Index
;

108  (
n
 & 1) == 0 )

110 
n
 =‚ >> 1;

111 
numZ”os
++;

117 
pšk
->
pšk_RuÂšgSum
 -ğpšk->
pšk_Rows
[
numZ”os
];

118 
ÃwRªdom
 = (()
	`G’”©eRªdomNumb”
()è>> 
PINK_RANDOM_SHIFT
;

119 
pšk
->
pšk_RuÂšgSum
 +ğ
ÃwRªdom
;

120 
pšk
->
pšk_Rows
[
numZ”os
] = 
ÃwRªdom
;

124 
ÃwRªdom
 = (()
	`G’”©eRªdomNumb”
()è>> 
PINK_RANDOM_SHIFT
;

125 
sum
 = 
pšk
->
pšk_RuÂšgSum
 + 
ÃwRªdom
;

127 
ouut
 = 
pšk
->
pšk_SÿÏr
 * 
sum
;

128 #ifdeà
PINK_MEASURE


130 ifĞ
ouut
 > 
pškMax
 )…inkMax = output;

131 ifĞ
ouut
 < 
pškMš
 )…inkMin = output;

133  
ouut
;

134 
	}
}

136 
	#PINK_TEST


	)

137 #ifdeà
PINK_TEST


141 
PškNoi£
 
	mËáPšk
;

142 
PškNoi£
 
	mrightPšk
;

143 
	m§mpsToGo
;

145 
	t·Te¡D©a
;

150 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

151 
äamesP”Bufãr
,

152 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

154 
fšished
;

155 
i
;

156 
numF¿mes
;

157 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

158 *
out
 = (*)
ouutBufãr
;

159 (è
šputBufãr
;

160 (è
outTime
;

163 ifĞ
d©a
->
§mpsToGo
 < 
äamesP”Bufãr
 )

165 
numF¿mes
 = 
d©a
->
§mpsToGo
;

166 
fšished
 = 1;

170 
numF¿mes
 = 
äamesP”Bufãr
;

171 
fšished
 = 0;

173  
i
=0; i<
numF¿mes
; i++ )

175 *
out
++ = 
	`G’”©ePškNoi£
Ğ&
d©a
->
ËáPšk
 );

176 *
out
++ = 
	`G’”©ePškNoi£
Ğ&
d©a
->
rightPšk
 );

178 
d©a
->
§mpsToGo
 -ğ
numF¿mes
;

179  
fšished
;

180 
	}
}

182 
maš
();

183 
	$maš
()

185 
PÜtAudioSŒ—m
 *
¡»am
;

186 
PaE¼Ü
 
”r
;

187 
·Te¡D©a
 
d©a
;

188 
tÙ®Samps
;

190 
	`In™ŸlizePškNoi£
Ğ&
d©a
.
ËáPšk
, 12 );

191 
	`In™ŸlizePškNoi£
Ğ&
d©a
.
rightPšk
, 16 );

194 
i
;

195 
pšk
;

196  
i
=0; i<20; i++ )

198 
pšk
 = 
	`G’”©ePškNoi£
Ğ&
d©a
.
ËáPšk
 );

199 
	`´štf
("Pšk = %f\n", 
pšk
 );

202 
d©a
.
§mpsToGo
 = 
tÙ®Samps
 = 8*44100;

203 
”r
 = 
	`Pa_In™Ÿlize
();

204 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

206 
”r
 = 
	`Pa_O³nSŒ—m
(

207 &
¡»am
,

208 
·NoDeviû
,

210 
·Flßt32
,

211 
NULL
,

212 
	`Pa_G‘DeçuÉOuutDeviûID
(),

214 
·Flßt32
,

215 
NULL
,

219 
·ClOff
,

220 
·‹¡C®lback
,

221 &
d©a
 );

222 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

224 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

225 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

226 
	`´štf
("Waiting for soundo finish.\n");

227  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

229 
	`Pa_SË•
(100);

231 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

232 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

233 #ifdeà
PINK_MEASURE


234 
	`´štf
("Pšk mš = %f, max = %f\n", 
pškMš
, 
pškMax
 );

236 
	`Pa_T”mš©e
();

238 
”rÜ
:

239 
	`Pa_T”mš©e
();

240 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

241 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

242 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

244 
	}
}

	@pa_tests/patest_record.c

38 
	~<¡dio.h
>

39 
	~<¡dlib.h
>

40 
	~"pÜudio.h
"

43 
	#SAMPLE_RATE
 (22050)

	)

44 
	#NUM_SECONDS
 (5)

	)

45 
	#NUM_CHANNELS
 (2)

	)

47 
	#DITHER_FLAG
 (0è

	)

48 
	#FRAMES_PER_BUFFER
 (1024)

	)

52 
	#PA_SAMPLE_TYPE
 
·Flßt32


	)

53 
	tSAMPLE
;

54 
	#SAMPLE_SILENCE
 (0.0f)

	)

56 
	#PA_SAMPLE_TYPE
 
·IÁ16


	)

57 
	tSAMPLE
;

58 
	#SAMPLE_SILENCE
 (0)

	)

60 
	#PA_SAMPLE_TYPE
 
·IÁ8


	)

61 
	tSAMPLE
;

62 
	#SAMPLE_SILENCE
 (0)

	)

64 
	#PA_SAMPLE_TYPE
 
·UIÁ8


	)

65 
	tSAMPLE
;

66 
	#SAMPLE_SILENCE
 (128)

	)

72 
	mäameIndex
;

73 
	mmaxF¿meIndex
;

74 
SAMPLE
 *
	m»cÜdedSam¶es
;

76 
	t·Te¡D©a
;

81 
	$»cÜdC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

82 
äamesP”Bufãr
,

83 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

85 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

86 
SAMPLE
 *
½Œ
 = (SAMPLE*)
šputBufãr
;

87 
SAMPLE
 *
w±r
 = &
d©a
->
»cÜdedSam¶es
[d©a->
äameIndex
 * 
NUM_CHANNELS
];

88 
äamesToC®c
;

89 
i
;

90 
fšished
;

91 
äamesLeá
 = 
d©a
->
maxF¿meIndex
 - d©a->
äameIndex
;

93 (è
ouutBufãr
;

94 (è
outTime
;

96 ifĞ
äamesLeá
 < 
äamesP”Bufãr
 )

98 
äamesToC®c
 = 
äamesLeá
;

99 
fšished
 = 1;

103 
äamesToC®c
 = 
äamesP”Bufãr
;

104 
fšished
 = 0;

106 ifĞ
šputBufãr
 =ğ
NULL
 )

108  
i
=0; i<
äamesToC®c
; i++ )

110 *
w±r
++ = 
SAMPLE_SILENCE
;

111 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = 
SAMPLE_SILENCE
;

116  
i
=0; i<
äamesToC®c
; i++ )

118 *
w±r
++ = *
½Œ
++;

119 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

122 
d©a
->
äameIndex
 +ğ
äamesToC®c
;

123  
fšished
;

124 
	}
}

130 
	$¶ayC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

131 
äamesP”Bufãr
,

132 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

134 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

135 
SAMPLE
 *
½Œ
 = &
d©a
->
»cÜdedSam¶es
[d©a->
äameIndex
 * 
NUM_CHANNELS
];

136 
SAMPLE
 *
w±r
 = (SAMPLE*)
ouutBufãr
;

137 
i
;

138 
fšished
;

139 
äamesLeá
 = 
d©a
->
maxF¿meIndex
 - d©a->
äameIndex
;

140 (è
šputBufãr
;

141 (è
outTime
;

143 ifĞ
äamesLeá
 < 
äamesP”Bufãr
 )

146  
i
=0; i<
äamesLeá
; i++ )

148 *
w±r
++ = *
½Œ
++;

149 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

151  ; 
i
<
äamesP”Bufãr
; i++ )

153 *
w±r
++ = 0;

154 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = 0;

156 
d©a
->
äameIndex
 +ğ
äamesLeá
;

157 
fšished
 = 1;

161  
i
=0; i<
äamesP”Bufãr
; i++ )

163 *
w±r
++ = *
½Œ
++;

164 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

166 
d©a
->
äameIndex
 +ğ
äamesP”Bufãr
;

167 
fšished
 = 0;

169  
fšished
;

170 
	}
}

173 
maš
();

174 
	$maš
()

176 
PÜtAudioSŒ—m
 *
¡»am
;

177 
PaE¼Ü
 
”r
;

178 
·Te¡D©a
 
d©a
;

179 
i
;

180 
tÙ®F¿mes
;

181 
numSam¶es
;

182 
numBy‹s
;

183 
SAMPLE
 
max
, 
av”age
, 
v®
;

184 
	`´štf
("·‹¡_»cÜd.c\n"); 
	`fæush
(
¡dout
);

186 
d©a
.
maxF¿meIndex
 = 
tÙ®F¿mes
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

187 
d©a
.
äameIndex
 = 0;

188 
numSam¶es
 = 
tÙ®F¿mes
 * 
NUM_CHANNELS
;

190 
numBy‹s
 = 
numSam¶es
 * (
SAMPLE
);

191 
d©a
.
»cÜdedSam¶es
 = (
SAMPLE
 *è
	`m®loc
Ğ
numBy‹s
 );

192 ifĞ
d©a
.
»cÜdedSam¶es
 =ğ
NULL
 )

194 
	`´štf
("Could‚ot‡llocate„ecord‡rray.\n");

195 
	`ex™
(1);

197  
i
=0; i<
numSam¶es
; i++ ) 
d©a
.
»cÜdedSam¶es
[i] = 0;

199 
”r
 = 
	`Pa_In™Ÿlize
();

200 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

203 
”r
 = 
	`Pa_O³nSŒ—m
(

204 &
¡»am
,

205 
	`Pa_G‘DeçuÉIÅutDeviûID
(),

206 
NUM_CHANNELS
,

207 
PA_SAMPLE_TYPE
,

208 
NULL
,

209 
·NoDeviû
,

211 
PA_SAMPLE_TYPE
,

212 
NULL
,

213 
SAMPLE_RATE
,

214 
FRAMES_PER_BUFFER
,

217 
»cÜdC®lback
,

218 &
d©a
 );

219 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

221 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

222 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

223 
	`´štf
("Now„ecÜdšg!!\n"); 
	`fæush
(
¡dout
);

225  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

227 
	`Pa_SË•
(1000);

228 
	`´štf
("šdex = %d\n", 
d©a
.
äameIndex
 ); 
	`fæush
(
¡dout
);

231 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

232 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

235 
max
 = 0;

236 
av”age
 = 0;

237  
i
=0; i<
numSam¶es
; i++ )

239 
v®
 = 
d©a
.
»cÜdedSam¶es
[
i
];

240 ifĞ
v®
 < 0 ) val = -val;

241 ifĞ
v®
 > 
max
 )

243 
max
 = 
v®
;

245 
av”age
 +ğ
v®
;

248 
av”age
 =‡v”ag/ 
numSam¶es
;

250 ifĞ
PA_SAMPLE_TYPE
 =ğ
·Flßt32
 )

252 
	`´štf
("§m¶max‡m¶™udğ%f\n", 
max
 );

253 
	`´štf
("§m¶av”agğ%f\n", 
av”age
 );

257 
	`´štf
("§m¶max‡m¶™udğ%d\n", 
max
 );

258 
	`´štf
("§m¶av”agğ%d\n", 
av”age
 );

264 
FILE
 *
fid
;

265 
fid
 = 
	`fİ’
("recorded.raw", "wb");

266 ifĞ
fid
 =ğ
NULL
 )

268 
	`´štf
("Could‚ot open file.");

272 
	`fwr™e
Ğ
d©a
.
»cÜdedSam¶es
, 
NUM_CHANNELS
 * (
SAMPLE
), 
tÙ®F¿mes
, 
fid
 );

273 
	`fşo£
Ğ
fid
 );

274 
	`´štf
("Wrote datao 'recorded.raw'\n");

280 
d©a
.
äameIndex
 = 0;

281 
	`´štf
("Begš…Ïyback.\n"); 
	`fæush
(
¡dout
);

282 
”r
 = 
	`Pa_O³nSŒ—m
(

283 &
¡»am
,

284 
·NoDeviû
,

286 
PA_SAMPLE_TYPE
,

287 
NULL
,

288 
	`Pa_G‘DeçuÉOuutDeviûID
(),

289 
NUM_CHANNELS
,

290 
PA_SAMPLE_TYPE
,

291 
NULL
,

292 
SAMPLE_RATE
,

293 
FRAMES_PER_BUFFER
,

295 
·ClOff
,

296 
¶ayC®lback
,

297 &
d©a
 );

298 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

300 ifĞ
¡»am
 )

302 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

303 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

304 
	`´štf
("Wa™šg fÜ…ÏybackØfšish.\n"); 
	`fæush
(
¡dout
);

306  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) ) 
	`Pa_SË•
(100);

308 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

309 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

310 
	`´štf
("DÚe.\n"); 
	`fæush
(
¡dout
);

312 
	`ä“
Ğ
d©a
.
»cÜdedSam¶es
 );

314 
	`Pa_T”mš©e
();

317 
”rÜ
:

318 
	`Pa_T”mš©e
();

319 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

320 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

321 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

323 
	}
}

	@pa_tests/patest_ringmix.c

3 
	~"¡dio.h
"

4 
	~"pÜudio.h
"

6 
	$myC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

7 
äamesP”Bufãr
, 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

9 *
out
 = (*è
ouutBufãr
;

10 *
š
 = (*è
šputBufãr
;

11 
ËáIÅut
, 
rightIÅut
;

12 
i
;

13 ifĞ
šputBufãr
 =ğ
NULL
 )  0;

15  
i
=0; i<
äamesP”Bufãr
; i++ )

17 
ËáIÅut
 = *
š
++;

18 
rightIÅut
 = *
š
++;

19 *
out
++ = 
ËáIÅut
 * 
rightIÅut
;

20 *
out
++ = 0.5à* (
ËáIÅut
 + 
rightIÅut
);

23 
	}
}

25 
	$maš
()

27 
PÜtAudioSŒ—m
 *
¡»am
;

28 
	`Pa_In™Ÿlize
();

29 
	`Pa_O³nDeçuÉSŒ—m
(

30 &
¡»am
,

32 
·Flßt32
, 44100.0,

34 
myC®lback
, 
NULL
 );

35 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

36 
	`Pa_SË•
( 10000 );

37 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

38 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

39 
	`Pa_T”mš©e
();

41 
	}
}

	@pa_tests/patest_saw.c

36 
	~<¡dio.h
>

37 
	~<m©h.h
>

38 
	~"pÜudio.h
"

39 
	#NUM_SECONDS
 (4)

	)

40 
	#SAMPLE_RATE
 (44100)

	)

43 
	mËá_pha£
;

44 
	mright_pha£
;

46 
	t·Te¡D©a
;

51 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

52 
äamesP”Bufãr
,

53 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

56 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

57 *
out
 = (*)
ouutBufãr
;

58 
i
;

59 (è
outTime
;

60 (è
šputBufãr
;

62  
i
=0; i<
äamesP”Bufãr
; i++ )

64 *
out
++ = 
d©a
->
Ëá_pha£
;

65 *
out
++ = 
d©a
->
right_pha£
;

67 
d©a
->
Ëá_pha£
 += 0.01f;

69 ifĞ
d©a
->
Ëá_pha£
 >= 1.0f ) data->left_phase -= 2.0f;

71 
d©a
->
right_pha£
 += 0.03f;

72 ifĞ
d©a
->
right_pha£
 >= 1.0f ) data->right_phase -= 2.0f;

75 
	}
}

77 
·Te¡D©a
 
	gd©a
;

78 
maš
();

79 
	$maš
()

81 
PÜtAudioSŒ—m
 *
¡»am
;

82 
PaE¼Ü
 
”r
;

83 
	`´štf
("PortAudio Test: output sawtooth wave.\n");

85 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0.0;

87 
”r
 = 
	`Pa_In™Ÿlize
();

88 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

90 
”r
 = 
	`Pa_O³nDeçuÉSŒ—m
(

91 &
¡»am
,

94 
·Flßt32
,

95 
SAMPLE_RATE
,

98 
·‹¡C®lback
,

99 &
d©a
 );

100 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

101 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

102 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

104 
	`Pa_SË•
(
NUM_SECONDS
*1000);

105 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

106 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

107 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

108 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

109 
	`Pa_T”mš©e
();

110 
	`´štf
("Test finished.\n");

111  
”r
;

112 
”rÜ
:

113 
	`Pa_T”mš©e
();

114 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

115 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

116 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

117  
”r
;

118 
	}
}

	@pa_tests/patest_sine.c

38 
	~<¡dio.h
>

39 
	~<m©h.h
>

40 
	~"pÜudio.h
"

42 
	#NUM_SECONDS
 (10)

	)

43 
	#SAMPLE_RATE
 (44100)

	)

44 
	#AMPLITUDE
 (0.9)

	)

45 
	#FRAMES_PER_BUFFER
 (64)

	)

46 
	#OUTPUT_DEVICE
 
	`Pa_G‘DeçuÉOuutDeviûID
()

	)

49 #iâdeà
M_PI


50 
	#M_PI
 (3.14159265)

	)

53 
	#TABLE_SIZE
 (200)

	)

56 
	msše
[
TABLE_SIZE
];

57 
	mËá_pha£
;

58 
	mright_pha£
;

60 
	t·Te¡D©a
;

66 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

67 
äamesP”Bufãr
,

68 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

70 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

71 *
out
 = (*)
ouutBufãr
;

72 
i
;

73 
fšished
 = 0;

74 (è
outTime
;

75 (è
šputBufãr
;

76  
i
=0; i<
äamesP”Bufãr
; i++ )

78 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

79 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

80 
d©a
->
Ëá_pha£
 += 1;

81 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

82 
d©a
->
right_pha£
 += 3;

83 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

85  
fšished
;

86 
	}
}

89 
maš
();

90 
	$maš
()

92 
PÜtAudioSŒ—m
 *
¡»am
;

93 
PaE¼Ü
 
”r
;

94 
·Te¡D©a
 
d©a
;

95 
i
;

96 
	`´štf
("PortAudio Test: output sine wave. SR = %d, BufSize = %d, devID = %d\n",

97 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
OUTPUT_DEVICE
);

99  
i
=0; i<
TABLE_SIZE
; i++ )

101 
d©a
.
sše
[
i
] = (è(
AMPLITUDE
 * 
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. ));

103 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0;

104 
”r
 = 
	`Pa_In™Ÿlize
();

105 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

106 
”r
 = 
	`Pa_O³nSŒ—m
(

107 &
¡»am
,

108 
·NoDeviû
,

110 
·Flßt32
,

111 
NULL
,

112 
OUTPUT_DEVICE
,

114 
·Flßt32
,

115 
NULL
,

116 
SAMPLE_RATE
,

117 
FRAMES_PER_BUFFER
,

119 
·ClOff
,

120 
·‹¡C®lback
,

121 &
d©a
 );

122 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

123 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

124 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

125 
	`´štf
("PÏy fÜ %d secÚds.\n", 
NUM_SECONDS
 ); 
	`fæush
(
¡dout
);

126 
	`Pa_SË•
Ğ
NUM_SECONDS
 * 1000 );

128 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

129 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

130 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

131 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

132 
	`Pa_T”mš©e
();

133 
	`´štf
("Test finished.\n");

134  
”r
;

135 
”rÜ
:

136 
	`Pa_T”mš©e
();

137 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

138 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

139 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

140  
”r
;

141 
	}
}

	@pa_tests/patest_sine8.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

40 
	#NUM_SECONDS
 (8)

	)

41 
	#SAMPLE_RATE
 (44100)

	)

42 
	#TEST_UNSIGNED
 (1)

	)

43 #ià
TEST_UNSIGNED


44 
	#TEST_FORMAT
 
·UIÁ8


	)

46 
	#TEST_FORMAT
 
·IÁ8


	)

48 #iâdeà
M_PI


49 
	#M_PI
 (3.14159265)

	)

51 
	#TABLE_SIZE
 (200)

	)

54 #ià
TEST_UNSIGNED


55 
	msše
[
TABLE_SIZE
];

57 
	msše
[
TABLE_SIZE
];

59 
	mËá_pha£
;

60 
	mright_pha£
;

61 
	mäamesToGo
;

63 
	t·Te¡D©a
;

68 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

69 
äamesP”Bufãr
,

70 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

72 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

73 *
out
 = (*)
ouutBufãr
;

74 
i
;

75 
äamesToC®c
;

76 
fšished
 = 0;

77 (è
outTime
;

78 (è
šputBufãr
;

80 ifĞ
d©a
->
äamesToGo
 < 
äamesP”Bufãr
 )

82 
äamesToC®c
 = 
d©a
->
äamesToGo
;

83 
d©a
->
äamesToGo
 = 0;

84 
fšished
 = 1;

88 
äamesToC®c
 = 
äamesP”Bufãr
;

89 
d©a
->
äamesToGo
 -ğ
äamesP”Bufãr
;

92  
i
=0; i<
äamesToC®c
; i++ )

94 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

95 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

96 
d©a
->
Ëá_pha£
 += 1;

97 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

98 
d©a
->
right_pha£
 += 3;

99 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

102  ; 
i
<()
äamesP”Bufãr
; i++ )

104 #ià
TEST_UNSIGNED


105 *
out
++ = () 0x80;

106 *
out
++ = () 0x80;

108 *
out
++ = 0;

109 *
out
++ = 0;

113  
fšished
;

114 
	}
}

116 
maš
();

117 
	$maš
()

119 
PÜtAudioSŒ—m
 *
¡»am
;

120 
PaE¼Ü
 
”r
;

121 
·Te¡D©a
 
d©a
;

122 
i
;

123 
tÙ®Samps
;

124 #ià
TEST_UNSIGNED


125 
	`´štf
("PortAudio Test: output UNsigned 8 bit sine wave.\n");

127 
	`´štf
("PortAudio Test: output signed 8 bit sine wave.\n");

130  
i
=0; i<
TABLE_SIZE
; i++ )

132 
d©a
.
sše
[
i
] = (è(127.0 * 
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. ));

133 #ià
TEST_UNSIGNED


134 
d©a
.
sše
[
i
] += () 0x80;

138 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0;

139 
d©a
.
äamesToGo
 = 
tÙ®Samps
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

140 
”r
 = 
	`Pa_In™Ÿlize
();

141 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

142 
”r
 = 
	`Pa_O³nSŒ—m
(

143 &
¡»am
,

144 
·NoDeviû
,

146 
TEST_FORMAT
,

147 
NULL
,

148 
	`Pa_G‘DeçuÉOuutDeviûID
(),

150 
TEST_FORMAT
,

151 
NULL
,

152 
SAMPLE_RATE
,

155 
·ClOff
,

156 
·‹¡C®lback
,

157 &
d©a
 );

158 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

159 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

160 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

162  
	`Pa_SŒ—mTime
Ğ
¡»am
 ) < (
tÙ®Samps
/2èè
	`Pa_SË•
(10);

164 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

165 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

166 
	`´štf
("Pause for 2 seconds.\n");

167 
	`Pa_SË•
( 2000 );

169 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

170 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

171 
	`´štf
("Waiting for soundo finish.\n");

172  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) ) 
	`Pa_SË•
(10);

173 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

174 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

175 
	`Pa_T”mš©e
();

176 
	`´štf
("Test finished.\n");

177  
”r
;

178 
”rÜ
:

179 
	`Pa_T”mš©e
();

180 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

181 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

182 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

183  
”r
;

184 
	}
}

	@pa_tests/patest_sine_time.c

40 
	~<¡dio.h
>

41 
	~<m©h.h
>

42 
	~"pÜudio.h
"

43 
	#NUM_SECONDS
 (8)

	)

44 
	#SAMPLE_RATE
 (44100)

	)

45 
	#FRAMES_PER_BUFFER
 (64)

	)

46 
	#NUM_BUFFERS
 (0)

	)

47 #iâdeà
M_PI


48 
	#M_PI
 (3.14159265)

	)

50 
	#TABLE_SIZE
 (200)

	)

53 
	msše
[
TABLE_SIZE
];

54 
	mËá_pha£
;

55 
	mright_pha£
;

56 
	mäamesToGo
;

57 vŞ©
PaTime¡amp
 
	moutTime
;

59 
	t·Te¡D©a
;

64 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

65 
äamesP”Bufãr
,

66 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

68 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

69 *
out
 = (*)
ouutBufãr
;

70 
i
;

71 
äamesToC®c
;

72 
fšished
 = 0;

73 (è
outTime
;

74 (è
šputBufãr
;

76 
d©a
->
outTime
 = outTime;

78 ifĞ
d©a
->
äamesToGo
 < 
äamesP”Bufãr
 )

80 
äamesToC®c
 = 
d©a
->
äamesToGo
;

81 
d©a
->
äamesToGo
 = 0;

82 
fšished
 = 1;

86 
äamesToC®c
 = 
äamesP”Bufãr
;

87 
d©a
->
äamesToGo
 -ğ
äamesP”Bufãr
;

90  
i
=0; i<
äamesToC®c
; i++ )

92 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

93 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

94 
d©a
->
Ëá_pha£
 += 1;

95 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

96 
d©a
->
right_pha£
 += 3;

97 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

100  ; 
i
<()
äamesP”Bufãr
; i++ )

102 *
out
++ = 0;

103 *
out
++ = 0;

105  
fšished
;

106 
	}
}

108 
R•ÜtSŒ—mTime
Ğ
PÜtAudioSŒ—m
 *
¡»am
, 
·Te¡D©a
 *
d©a
 );

109 
	$R•ÜtSŒ—mTime
Ğ
PÜtAudioSŒ—m
 *
¡»am
, 
·Te¡D©a
 *
d©a
 )

111 
PaTime¡amp
 
¡»amTime
, 
Ï‹ncy
, 
outTime
;

113 
¡»amTime
 = 
	`Pa_SŒ—mTime
Ğ
¡»am
 );

114 
outTime
 = 
d©a
->outTime;

115 ifĞ
outTime
 < 0.0 )

117 
	`´štf
("SŒ—mimğ%8.1f\n", 
¡»amTime
 );

121 
Ï‹ncy
 = 
outTime
 - 
¡»amTime
;

122 
	`´štf
("Streamime = %8.1f, outTime = %8.1f,†atency = %8.1f\n",

123 
¡»amTime
, 
outTime
, 
Ï‹ncy
 );

125 
	`fæush
(
¡dout
);

126 
	}
}

129 
maš
();

130 
	$maš
()

132 
PÜtAudioSŒ—m
 *
¡»am
;

133 
PaE¼Ü
 
”r
;

134 
·Te¡D©a
 
DATA
;

135 
i
;

136 
tÙ®Samps
;

137 
	`´štf
("PÜtAudiØTe¡: ouuˆsšwave. SR = %d, BufSizğ%d\n", 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
);

139  
i
=0; i<
TABLE_SIZE
; i++ )

141 
DATA
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

143 
DATA
.
Ëá_pha£
 = DATA.
right_pha£
 = 0;

144 
DATA
.
äamesToGo
 = 
tÙ®Samps
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

145 
”r
 = 
	`Pa_In™Ÿlize
();

146 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

147 
”r
 = 
	`Pa_O³nSŒ—m
(

148 &
¡»am
,

149 
·NoDeviû
,

151 
·Flßt32
,

152 
NULL
,

153 
	`Pa_G‘DeçuÉOuutDeviûID
(),

155 
·Flßt32
,

156 
NULL
,

157 
SAMPLE_RATE
,

158 
FRAMES_PER_BUFFER
,

159 
NUM_BUFFERS
,

160 
·ClOff
,

161 
·‹¡C®lback
,

162 &
DATA
 );

163 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

165 
DATA
.
outTime
 = -1.0;

166 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

167 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

170 
	`´štf
("PÏy fÜ %d secÚds.\n", 
NUM_SECONDS
/2 ); 
	`fæush
(
¡dout
);

173 
	`R•ÜtSŒ—mTime
Ğ
¡»am
, &
DATA
 );

174 
	`Pa_SË•
(100);

175 }  
	`Pa_SŒ—mTime
Ğ
¡»am
 ) < (
tÙ®Samps
/2) );

178 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

179 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

180 
	`´štf
("Pau£ fÜ 2 secÚds.\n"); 
	`fæush
(
¡dout
);

181 
	`Pa_SË•
( 2000 );

183 
DATA
.
outTime
 = -1.0;

184 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

185 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

187 
	`´štf
("PÏy uÁ sound i fšished.\n"); 
	`fæush
(
¡dout
);

190 
	`R•ÜtSŒ—mTime
Ğ
¡»am
, &
DATA
 );

191 
	`Pa_SË•
(100);

192 }  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) );

194 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

195 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

196 
	`Pa_T”mš©e
();

197 
	`´štf
("Test finished.\n");

198  
”r
;

199 
”rÜ
:

200 
	`Pa_T”mš©e
();

201 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

202 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

203 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

204  
”r
;

205 
	}
}

	@pa_tests/patest_stop.c

44 
	~<¡dio.h
>

45 
	~<m©h.h
>

46 
	~"pÜudio.h
"

47 
	#OUTPUT_DEVICE
 (
	`Pa_G‘DeçuÉOuutDeviûID
())

	)

48 
	#SLEEP_DUR
 (200)

	)

49 
	#SAMPLE_RATE
 (44100)

	)

50 
	#FRAMES_PER_BUFFER
 (256)

	)

51 
	#LATENCY_MSEC
 (3000)

	)

52 
	#NUM_BUFFERS
 ((
LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

53 
	#FRAMES_PER_NOTE
 (
SAMPLE_RATE
/2)

	)

54 
	#MAX_REPEATS
 (2)

	)

55 
	#FUNDAMENTAL
 (400.0à/ 
SAMPLE_RATE
)

	)

56 
	#NOTE_0
 (
FUNDAMENTAL
 * 1.0à/ 1.0f)

	)

57 
	#NOTE_1
 (
FUNDAMENTAL
 * 5.0à/ 4.0f)

	)

58 
	#NOTE_2
 (
FUNDAMENTAL
 * 4.0à/ 3.0f)

	)

59 
	#NOTE_3
 (
FUNDAMENTAL
 * 3.0à/ 2.0f)

	)

60 
	#NOTE_4
 (
FUNDAMENTAL
 * 2.0à/ 1.0f)

	)

61 
	#MODE_FINISH
 (0)

	)

62 
	#MODE_STOP
 (1)

	)

63 
	#MODE_ABORT
 (2)

	)

64 #iâdeà
M_PI


65 
	#M_PI
 (3.14159265)

	)

67 
	#TABLE_SIZE
 (400)

	)

70 
	mwavefÜm
[
TABLE_SIZE
 + 1];

71 
	mpha£_šüem’t
;

72 
	mpha£
;

73 *
	mtuÃ
;

74 
	mnÙesP”TuÃ
;

75 
	mäameCouÁ”
;

76 
	mnÙeCouÁ”
;

77 
	m»³©CouÁ”
;

78 
PaTime¡amp
 
	moutTime
;

79 
	m¡İMode
;

80 
	mdÚe
;

82 
	t·Te¡D©a
;

84 
Te¡StİMode
Ğ
·Te¡D©a
 *
d©a
 );

85 
LookupWavefÜm
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 );

90 
	$LookupWavefÜm
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 )

92 
fIndex
 = 
pha£
*
TABLE_SIZE
;

93 
šdex
 = (è
fIndex
;

94 
äaù
 = 
fIndex
 - 
šdex
;

95 
lo
 = 
d©a
->
wavefÜm
[
šdex
];

96 
hi
 = 
d©a
->
wavefÜm
[
šdex
+1];

97 
v®
 = 
lo
 + 
äaù
*(
hi
-lo);

98  
v®
;

99 
	}
}

104 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

105 
äamesP”Bufãr
,

106 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

108 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

109 *
out
 = (*)
ouutBufãr
;

110 
v®ue
;

111 
i
 = 0;

112 
fšished
 = 0;

113 (è
outTime
;

114 (è
šputBufãr
;

116 
d©a
->
outTime
 = outTime;

117 ifĞ!
d©a
->
dÚe
 )

119  
i
=0; i<
äamesP”Bufãr
; i++ )

122 ifĞ
d©a
->
äameCouÁ”
 >ğ
FRAMES_PER_NOTE
 )

124 
d©a
->
nÙeCouÁ”
 += 1;

125 
d©a
->
äameCouÁ”
 = 0;

127 ifĞ
d©a
->
nÙeCouÁ”
 >ğd©a->
nÙesP”TuÃ
 )

129 
d©a
->
nÙeCouÁ”
 = 0;

130 
d©a
->
»³©CouÁ”
 += 1;

132 ifĞ
d©a
->
»³©CouÁ”
 >ğ
MAX_REPEATS
 )

134 
d©a
->
dÚe
 = 1;

135 ifĞ
d©a
->
¡İMode
 =ğ
MODE_FINISH
 )

137 
fšished
 = 1;

142 
d©a
->
pha£_šüem’t
 = d©a->
tuÃ
[d©a->
nÙeCouÁ”
];

144 
v®ue
 = 
	`LookupWavefÜm
(
d©a
, d©a->
pha£
);

145 *
out
++ = 
v®ue
;

146 *
out
++ = 
v®ue
;

147 
d©a
->
pha£
 +ğd©a->
pha£_šüem’t
;

148 ifĞ
d©a
->
pha£
 >= 1.0f ) data->phase -= 1.0f;

150 
d©a
->
äameCouÁ”
 += 1;

154  ; 
i
<
äamesP”Bufãr
; i++ )

156 *
out
++ = 0;

157 *
out
++ = 0;

159  
fšished
;

160 
	}
}

162 
maš
();

163 
	$maš
()

165 
·Te¡D©a
 
DATA
;

166 
i
;

167 
sim¶eTuÃ
[] = { 
NOTE_0
, 
NOTE_1
, 
NOTE_2
, 
NOTE_3
, 
NOTE_4
, NOTE_3, NOTE_2, NOTE_1 };

168 
	`´štf
("PÜtAudiØTe¡:…Ïy sÚg‡nde¡ stİpšg.‡sk fÜ %d bufãrs\n", 
NUM_BUFFERS
 );

170  
i
=0; i<
TABLE_SIZE
; i++ )

172 
DATA
.
wavefÜm
[
i
] = () (

173 (0.2 * 
	`sš
Ğ(()
i
/()
TABLE_SIZE
è* 
M_PI
 * 2. )) +

174 (0.2 * 
	`sš
Ğ(()(3*
i
)/()
TABLE_SIZE
è* 
M_PI
 * 2. )) +

175 (0.1 * 
	`sš
Ğ(()(5*
i
)/()
TABLE_SIZE
è* 
M_PI
 * 2. ))

178 
DATA
.
wavefÜm
[
TABLE_SIZE
] = DATA.waveform[0];

179 
DATA
.
tuÃ
 = &
sim¶eTuÃ
[0];

180 
DATA
.
nÙesP”TuÃ
 = (
sim¶eTuÃ
) / ();

181 
	`´štf
("Test MODE_FINISH - callback„eturns 1.\n");

182 
	`´štf
("Should h—¸’tœ%d‚ÙtuÃ„•—‹dwiû.\n", 
DATA
.
nÙesP”TuÃ
);

183 
DATA
.
¡İMode
 = 
MODE_FINISH
;

184 ifĞ
	`Te¡StİMode
Ğ&
DATA
 ) !ğ
·NoE¼Ü
 )

186 
	`´štf
("Test of MODE_FINISH failed!\n");

187 
”rÜ
;

189 
	`´štf
("Test MODE_STOP - stop when song is done.\n");

190 
	`´štf
("Should h—¸’tœ%d‚ÙtuÃ„•—‹dwiû.\n", 
DATA
.
nÙesP”TuÃ
);

191 
DATA
.
¡İMode
 = 
MODE_STOP
;

192 ifĞ
	`Te¡StİMode
Ğ&
DATA
 ) !ğ
·NoE¼Ü
 )

194 
	`´štf
("Test of MODE_STOP failed!\n");

195 
”rÜ
;

198 
	`´štf
("Test MODE_ABORT -‡bort immediately.\n");

199 
	`´štf
("Should h—¸Ï¡„•‘™iÚ cuˆshÜˆby %d m£c.\n", 
LATENCY_MSEC
);

200 
DATA
.
¡İMode
 = 
MODE_ABORT
;

201 ifĞ
	`Te¡StİMode
Ğ&
DATA
 ) !ğ
·NoE¼Ü
 )

203 
	`´štf
("Test of MODE_ABORT failed!\n");

204 
”rÜ
;

207 
”rÜ
:

209 
	}
}

211 
	$Te¡StİMode
Ğ
·Te¡D©a
 *
d©a
 )

213 
PÜtAudioSŒ—m
 *
¡»am
;

214 
PaE¼Ü
 
”r
;

215 
d©a
->
dÚe
 = 0;

216 
d©a
->
pha£
 = 0.0;

217 
d©a
->
äameCouÁ”
 = 0;

218 
d©a
->
nÙeCouÁ”
 = 0;

219 
d©a
->
»³©CouÁ”
 = 0;

220 
d©a
->
pha£_šüem’t
 = d©a->
tuÃ
[d©a->
nÙeCouÁ”
];

221 
”r
 = 
	`Pa_In™Ÿlize
();

222 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

223 
”r
 = 
	`Pa_O³nSŒ—m
(

224 &
¡»am
,

225 
·NoDeviû
,

227 
·Flßt32
,

228 
NULL
,

229 
OUTPUT_DEVICE
,

231 
·Flßt32
,

232 
NULL
,

233 
SAMPLE_RATE
,

234 
FRAMES_PER_BUFFER
,

235 
NUM_BUFFERS
,

236 
·ClOff
,

237 
·‹¡C®lback
,

238 
d©a
 );

239 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

240 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

241 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

242 ifĞ
d©a
->
¡İMode
 =ğ
MODE_FINISH
 )

244  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

249 
	`Pa_SË•
Ğ
SLEEP_DUR
 );

254  
d©a
->
»³©CouÁ”
 < 
MAX_REPEATS
 )

259 
	`Pa_SË•
Ğ
SLEEP_DUR
 );

262 ifĞ
d©a
->
¡İMode
 =ğ
MODE_ABORT
 )

264 
	`´štf
("Call Pa_AbortStream()\n");

265 
”r
 = 
	`Pa_AbÜtSŒ—m
Ğ
¡»am
 );

269 
	`´štf
("Call Pa_StopStream()\n");

270 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

272 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

273 
	`´štf
("C®ÈPa_Clo£SŒ—m()\n"); 
	`fæush
(
¡dout
);

274 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

275 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

276 
	`Pa_T”mš©e
();

277 
	`´štf
("Test finished.\n");

278  
”r
;

279 
”rÜ
:

280 
	`Pa_T”mš©e
();

281 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

282 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

283 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

284  
”r
;

285 
	}
}

	@pa_tests/patest_sync.c

46 
	~<¡dio.h
>

47 
	~<m©h.h
>

48 
	~"pÜudio.h
"

49 
	#NUM_BEEPS
 (6)

	)

50 
	#SAMPLE_RATE
 (44100)

	)

51 
	#FRAMES_PER_BUFFER
 (256)

	)

52 
	#BEEP_DURATION
 (1000)

	)

53 
	#LATENCY_MSEC
 (2000)

	)

54 
	#SLEEP_MSEC
 (10)

	)

55 
	#TIMEOUT_MSEC
 ((3 * 
LATENCY_MSEC
è/ (2 * 
SLEEP_MSEC
))

	)

56 
	#NUM_BUFFERS
 ((
LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

57 
	#STATE_BKG_IDLE
 (0)

	)

58 
	#STATE_BKG_PENDING
 (1)

	)

59 
	#STATE_BKG_BEEPING
 (2)

	)

62 
	mËá_pha£
;

63 
	mright_pha£
;

64 
	m¡©e
;

65 
	m»que¡B“p
;

66 
PaTime¡amp
 
	mb“pTime
;

67 
	mb“pCouÁ
;

69 
	t·Te¡D©a
;

70 
G’”©eRªdomNumb”
( );

73 
	$G’”©eRªdomNumb”
( )

75 
¿ndS“d
 = 22222;

76 
¿ndS“d
 = (randSeed * 196314165) + 907633515;

77  
¿ndS“d
;

78 
	}
}

83 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

84 
äamesP”Bufãr
,

85 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

88 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

89 *
out
 = (*)
ouutBufãr
;

90 
i
;

91 (è
šputBufãr
;

93  
i
=0; i<
äamesP”Bufãr
; i++ )

95  
d©a
->
¡©e
 )

97 
STATE_BKG_IDLE
:

99 ifĞ
d©a
->
»que¡B“p
 )

101 
¿ndom
 = 
	`G’”©eRªdomNumb”
() >> 14;

102 
d©a
->
b“pTime
 = 
outTime
 + (
i
 + 
¿ndom
 + (
SAMPLE_RATE
/4));

103 
d©a
->
¡©e
 = 
STATE_BKG_PENDING
;

104 
d©a
->
»que¡B“p
 = 0;

105 
d©a
->
Ëá_pha£
 = d©a->
right_pha£
 = 0.0;

107 *
out
++ = 0.0;

108 *
out
++ = 0.0;

110 
STATE_BKG_PENDING
:

111 ifĞ(
outTime
 + 
i
è>ğ
d©a
->
b“pTime
 )

113 
d©a
->
¡©e
 = 
STATE_BKG_BEEPING
;

114 
d©a
->
b“pCouÁ
 = 
BEEP_DURATION
;

116 *
out
++ = 0.0;

117 *
out
++ = 0.0;

119 
STATE_BKG_BEEPING
:

120 ifĞ
d©a
->
b“pCouÁ
 <= 0 )

122 
d©a
->
¡©e
 = 
STATE_BKG_IDLE
;

123 *
out
++ = 0.0;

124 *
out
++ = 0.0;

129 *
out
++ = 
d©a
->
Ëá_pha£
;

130 *
out
++ = 
d©a
->
right_pha£
;

132 
d©a
->
Ëá_pha£
 += 0.01f;

134 ifĞ
d©a
->
Ëá_pha£
 >= 1.0f ) data->left_phase -= 2.0f;

136 
d©a
->
right_pha£
 += 0.03f;

137 ifĞ
d©a
->
right_pha£
 >= 1.0f ) data->right_phase -= 2.0f;

139 
d©a
->
b“pCouÁ
 -= 1;

142 
d©a
->
¡©e
 = 
STATE_BKG_IDLE
;

147 
	}
}

149 
maš
();

150 
	$maš
()

152 
PÜtAudioSŒ—m
 *
¡»am
;

153 
PaE¼Ü
 
”r
;

154 
·Te¡D©a
 
DATA
;

155 
i
, 
timeout
;

156 
PaTime¡amp
 
´eviousTime
;

157 
	`´štf
("PortAudio Test: you should see BEEP‡the sameime you hear it.\n");

158 
	`´štf
("Wait for‡ few seconds„andom delay between BEEPs.\n");

159 
	`´štf
("BEEP %dimes.\n", 
NUM_BEEPS
 );

161 
DATA
.
Ëá_pha£
 = DATA.
right_pha£
 = 0.0;

162 
DATA
.
¡©e
 = 
STATE_BKG_IDLE
;

163 
DATA
.
»que¡B“p
 = 0;

165 
”r
 = 
	`Pa_In™Ÿlize
();

166 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

168 
”r
 = 
	`Pa_O³nDeçuÉSŒ—m
(

169 &
¡»am
,

172 
·Flßt32
,

173 
SAMPLE_RATE
,

174 
FRAMES_PER_BUFFER
,

175 
NUM_BUFFERS
,

176 
·‹¡C®lback
,

177 &
DATA
 );

178 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

179 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

180 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

181 
´eviousTime
 = 
	`Pa_SŒ—mTime
Ğ
¡»am
 );

182  
i
=0; i<
NUM_BEEPS
; i++ )

185 
DATA
.
»que¡B“p
 = 1;

187 
timeout
 = 
TIMEOUT_MSEC
;

188  (
DATA
.
»que¡B“p
 =ğ1è&& (
timeout
-- > 0 ) ) 
	`Pa_SË•
(
SLEEP_MSEC
);

189 ifĞ
timeout
 <= 0 )

191 
	`årštf
Ğ
¡d”r
, "Timed out waiting for backgroundo‡cknowledge„equest.\n" );

192 
”rÜ
;

195 
timeout
 = 
TIMEOUT_MSEC
 + (10000/
SLEEP_MSEC
);

196  (
	`Pa_SŒ—mTime
Ğ
¡»am
 ) < 
DATA
.
b“pTime
è&& (
timeout
-- > 0 ) )

198 
	`Pa_SË•
(
SLEEP_MSEC
);

200 ifĞ
timeout
 <= 0 )

202 
	`årštf
Ğ
¡d”r
, "Timed out waiting forime. Now = %g, Beep for %g.\n",

203 
	`Pa_SŒ—mTime
Ğ
¡»am
 ), 
DATA
.
b“pTime
 );

204 
”rÜ
;

207 
	`´štf
("BEEP");

208 
	`fæush
(
¡dout
);

209 
	`´štf
("‡t %d, delta = %d\n",

210 (è
DATA
.
b“pTime
, (è(DATA.b“pTim- 
´eviousTime
) );

211 
	`fæush
(
¡dout
);

212 
´eviousTime
 = 
DATA
.
b“pTime
;

214 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

215 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

216 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

217 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

218 
	`Pa_T”mš©e
();

219 
	`´štf
("Test finished.\n");

220  
”r
;

221 
”rÜ
:

222 
	`Pa_T”mš©e
();

223 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

224 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

225 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

226  
”r
;

227 
	}
}

	@pa_tests/patest_wire.c

40 
	~<¡dio.h
>

41 
	~<m©h.h
>

42 
	~"pÜudio.h
"

44 
	#INPUT_DEVICE
 
	`Pa_G‘DeçuÉIÅutDeviûID
()

	)

45 
	#OUTPUT_DEVICE
 
	`Pa_G‘DeçuÉOuutDeviûID
()

	)

52 
	#SAMPLE_RATE
 (22050)

	)

53 
	#FRAMES_PER_BUFFER
 (64)

	)

56 
	#PA_SAMPLE_TYPE
 
·Flßt32


	)

57 
	tSAMPLE
;

59 
	#PA_SAMPLE_TYPE
 
·IÁ16


	)

60 
	tSAMPLE
;

62 
wœeC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

70 
	$wœeC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

71 
äamesP”Bufãr
,

72 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

74 
SAMPLE
 *
out
 = (SAMPLE*)
ouutBufãr
;

75 
SAMPLE
 *
š
 = (SAMPLE*)
šputBufãr
;

76 
i
;

77 (è
outTime
;

80 ifĞ
šputBufãr
 =ğ
NULL
 )

82  
i
=0; i<
äamesP”Bufãr
; i++ )

84 *
out
++ = 0;

85 *
out
++ = 0;

90  
i
=0; i<
äamesP”Bufãr
; i++ )

92 *
out
++ = *
š
++;

93 *
out
++ = *
š
++;

98 
	}
}

102 
maš
();

103 
	$maš
()

105 
PÜtAudioSŒ—m
 *
¡»am
;

106 
PaE¼Ü
 
”r
;

108 
”r
 = 
	`Pa_In™Ÿlize
();

109 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

111 
	`´štf
("PÜtAudiØTe¡: iÅuˆdeviû ID = %d\n", 
INPUT_DEVICE
 );

112 
	`´štf
("PÜtAudiØTe¡: ouuˆdeviû ID = %d\n", 
OUTPUT_DEVICE
 );

113 
”r
 = 
	`Pa_O³nSŒ—m
(

114 &
¡»am
,

115 
INPUT_DEVICE
,

117 
PA_SAMPLE_TYPE
,

118 
NULL
,

119 
OUTPUT_DEVICE
,

121 
PA_SAMPLE_TYPE
,

122 
NULL
,

123 
SAMPLE_RATE
,

124 
FRAMES_PER_BUFFER
,

126 
·ClOff
,

127 
wœeC®lback
,

128 
NULL
 );

129 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

131 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

132 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

134 
	`´štf
("Full duplex soundest in…rogress.\n");

135 
	`´štf
("H™ ENTERØex™e¡.\n"); 
	`fæush
(
¡dout
);

136 
	`g‘ch¬
();

138 
	`´štf
("Closing stream.\n");

139 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

140 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

141 
	`Pa_T”mš©e
();

143 
	`´štf
("FuÎ du¶ex sounde¡ com¶‘e.\n"); 
	`fæush
(
¡dout
);

145 
”rÜ
:

146 
	`Pa_T”mš©e
();

147 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

148 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

149 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

151 
	}
}

	@portaudio/pa_common/pa_convert.c

8 
	~<¡dio.h
>

10 
	~"pÜudio.h
"

11 
	~"·_ho¡.h
"

13 
	#CLIP
Ğ
v®
, 
mš
, 
max
 ) { v® = ((v®è< (mš)è? mš : (((v®è< (max)è? (maxè: (v®)); }

	)

16 
	$PaCÚv”t_Flßt32_IÁ16
(

17 *
sourûBufãr
, 
sourûSŒide
,

18 *
rg‘Bufãr
, 
rg‘SŒide
,

19 
numSam¶es
 )

21 
i
;

22  
i
=0; i<
numSam¶es
; i++ )

24 
§mp
 = (è(*
sourûBufãr
 * (32767.0f));

25 *
rg‘Bufãr
 = 
§mp
;

26 
sourûBufãr
 +ğ
sourûSŒide
;

27 
rg‘Bufãr
 +ğ
rg‘SŒide
;

29 
	}
}

32 
	$PaCÚv”t_Flßt32_IÁ16_Cl
(

33 *
sourûBufãr
, 
sourûSŒide
,

34 *
rg‘Bufãr
, 
rg‘SŒide
,

35 
numSam¶es
 )

37 
i
;

38  
i
=0; i<
numSam¶es
; i++ )

40 
§mp
 = (è(*
sourûBufãr
 * (32767.0f));

41 
	`CLIP
Ğ
§mp
, -0x8000, 0x7FFF );

42 *
rg‘Bufãr
 = (è
§mp
;

43 
sourûBufãr
 +ğ
sourûSŒide
;

44 
rg‘Bufãr
 +ğ
rg‘SŒide
;

46 
	}
}

49 
	$PaCÚv”t_Flßt32_IÁ16_ClD™h”
(

50 *
sourûBufãr
, 
sourûSŒide
,

51 *
rg‘Bufãr
, 
rg‘SŒide
,

52 
numSam¶es
 )

54 
i
;

55  
i
=0; i<
numSam¶es
; i++ )

58 
d™h”
 = 
	`PaCÚv”t_TrŸnguÏrD™h”
(è* 
PA_DITHER_SCALE
;

59 
d™h”ed
 = (*
sourûBufãr
 * (32766.0f)è+ 
d™h”
;

60 
§mp
 = (è
d™h”ed
;

61 
	`CLIP
Ğ
§mp
, -0x8000, 0x7FFF );

62 *
rg‘Bufãr
 = (è
§mp
;

63 
sourûBufãr
 +ğ
sourûSŒide
;

64 
rg‘Bufãr
 +ğ
rg‘SŒide
;

66 
	}
}

69 
	$PaCÚv”t_Flßt32_IÁ16_D™h”
(

70 *
sourûBufãr
, 
sourûSŒide
,

71 *
rg‘Bufãr
, 
rg‘SŒide
,

72 
numSam¶es
 )

74 
i
;

75  
i
=0; i<
numSam¶es
; i++ )

78 
d™h”
 = 
	`PaCÚv”t_TrŸnguÏrD™h”
(è* 
PA_DITHER_SCALE
;

79 
d™h”ed
 = (*
sourûBufãr
 * (32766.0f)è+ 
d™h”
;

80 *
rg‘Bufãr
 = (è
d™h”ed
;

81 
sourûBufãr
 +ğ
sourûSŒide
;

82 
rg‘Bufãr
 +ğ
rg‘SŒide
;

84 
	}
}

88 
	$PaCÚv”t_IÁ16_Flßt32
(

89 *
sourûBufãr
, 
sourûSŒide
,

90 *
rg‘Bufãr
, 
rg‘SŒide
,

91 
numSam¶es
 )

93 
i
;

94  
i
=0; i<
numSam¶es
; i++ )

96 
§mp
 = *
sourûBufãr
 * (1.0f / 32768.0f);

97 *
rg‘Bufãr
 = 
§mp
;

98 
sourûBufãr
 +ğ
sourûSŒide
;

99 
rg‘Bufãr
 +ğ
rg‘SŒide
;

101 
	}
}

104 
	$PaCÚv”t_Flßt32_IÁ8
(

105 *
sourûBufãr
, 
sourûSŒide
,

106 *
rg‘Bufãr
, 
rg‘SŒide
,

107 
numSam¶es
 )

109 
i
;

110  
i
=0; i<
numSam¶es
; i++ )

112 
§mp
 = (è(*
sourûBufãr
 * (127.0));

113 *
rg‘Bufãr
 = 
§mp
;

114 
sourûBufãr
 +ğ
sourûSŒide
;

115 
rg‘Bufãr
 +ğ
rg‘SŒide
;

117 
	}
}

121 
	$PaCÚv”t_Flßt32_IÁ8_Cl
(

122 *
sourûBufãr
, 
sourûSŒide
,

123 *
rg‘Bufãr
, 
rg‘SŒide
,

124 
numSam¶es
 )

126 
i
;

127  
i
=0; i<
numSam¶es
; i++ )

129 
§mp
 = (è(*
sourûBufãr
 * 127.0f);

130 
	`CLIP
Ğ
§mp
, -0x80, 0x7F );

131 *
rg‘Bufãr
 = (è
§mp
;

132 
sourûBufãr
 +ğ
sourûSŒide
;

133 
rg‘Bufãr
 +ğ
rg‘SŒide
;

135 
	}
}

138 
	$PaCÚv”t_Flßt32_IÁ8_ClD™h”
(

139 *
sourûBufãr
, 
sourûSŒide
,

140 *
rg‘Bufãr
, 
rg‘SŒide
,

141 
numSam¶es
 )

143 
i
;

144  
i
=0; i<
numSam¶es
; i++ )

147 
d™h”
 = 
	`PaCÚv”t_TrŸnguÏrD™h”
(è* 
PA_DITHER_SCALE
;

148 
d™h”ed
 = (*
sourûBufãr
 * (126.0f)è+ 
d™h”
;

149 
§mp
 = (è
d™h”ed
;

150 
	`CLIP
Ğ
§mp
, -0x80, 0x7F );

151 *
rg‘Bufãr
 = (è
§mp
;

152 
sourûBufãr
 +ğ
sourûSŒide
;

153 
rg‘Bufãr
 +ğ
rg‘SŒide
;

155 
	}
}

158 
	$PaCÚv”t_Flßt32_IÁ8_D™h”
(

159 *
sourûBufãr
, 
sourûSŒide
,

160 *
rg‘Bufãr
, 
rg‘SŒide
,

161 
numSam¶es
 )

163 
i
;

164  
i
=0; i<
numSam¶es
; i++ )

167 
d™h”
 = 
	`PaCÚv”t_TrŸnguÏrD™h”
(è* 
PA_DITHER_SCALE
;

168 
d™h”ed
 = (*
sourûBufãr
 * (126.0f)è+ 
d™h”
;

169 
§mp
 = (è
d™h”ed
;

170 *
rg‘Bufãr
 = (è
§mp
;

171 
sourûBufãr
 +ğ
sourûSŒide
;

172 
rg‘Bufãr
 +ğ
rg‘SŒide
;

174 
	}
}

177 
	$PaCÚv”t_IÁ8_Flßt32
(

178 *
sourûBufãr
, 
sourûSŒide
,

179 *
rg‘Bufãr
, 
rg‘SŒide
,

180 
numSam¶es
 )

182 
i
;

183  
i
=0; i<
numSam¶es
; i++ )

185 
§mp
 = *
sourûBufãr
 * (1.0f / 128.0f);

186 *
rg‘Bufãr
 = 
§mp
;

187 
sourûBufãr
 +ğ
sourûSŒide
;

188 
rg‘Bufãr
 +ğ
rg‘SŒide
;

190 
	}
}

193 
	$PaCÚv”t_Flßt32_UIÁ8
(

194 *
sourûBufãr
, 
sourûSŒide
,

195 *
rg‘Bufãr
, 
rg‘SŒide
,

196 
numSam¶es
 )

198 
i
;

199  
i
=0; i<
numSam¶es
; i++ )

201 
§mp
 = ()(128 + (*
sourûBufãr
 * (127.0)));

202 *
rg‘Bufãr
 = 
§mp
;

203 
sourûBufãr
 +ğ
sourûSŒide
;

204 
rg‘Bufãr
 +ğ
rg‘SŒide
;

206 
	}
}

209 
	$PaCÚv”t_UIÁ8_Flßt32
(

210 *
sourûBufãr
, 
sourûSŒide
,

211 *
rg‘Bufãr
, 
rg‘SŒide
,

212 
numSam¶es
 )

214 
i
;

215  
i
=0; i<
numSam¶es
; i++ )

217 
§mp
 = (*
sourûBufãr
 - 128) * (1.0f / 128.0f);

218 *
rg‘Bufãr
 = 
§mp
;

219 
sourûBufãr
 +ğ
sourûSŒide
;

220 
rg‘Bufãr
 +ğ
rg‘SŒide
;

222 
	}
}

225 
	$PaCÚv”t_Flßt32_IÁ32
(

226 *
sourûBufãr
, 
sourûSŒide
,

227 *
rg‘Bufãr
, 
rg‘SŒide
,

228 
numSam¶es
 )

230 
i
;

231  
i
=0; i<
numSam¶es
; i++ )

233 
§mp
 = (è(*
sourûBufãr
 * 0x7FFFFFFF);

234 *
rg‘Bufãr
 = 
§mp
;

235 
sourûBufãr
 +ğ
sourûSŒide
;

236 
rg‘Bufãr
 +ğ
rg‘SŒide
;

238 
	}
}

241 
	$PaCÚv”t_Flßt32_IÁ32_Cl
(

242 *
sourûBufãr
, 
sourûSŒide
,

243 *
rg‘Bufãr
, 
rg‘SŒide
,

244 
numSam¶es
 )

246 
i
;

247  
i
=0; i<
numSam¶es
; i++ )

249 
§mp
;

250 
fs
 = *
sourûBufãr
;

251 
	`CLIP
Ğ
fs
, -1.0, 0.999999 );

252 
§mp
 = (è(*
sourûBufãr
 * 0x7FFFFFFF);

253 *
rg‘Bufãr
 = 
§mp
;

254 
sourûBufãr
 +ğ
sourûSŒide
;

255 
rg‘Bufãr
 +ğ
rg‘SŒide
;

257 
	}
}

260 
	$PaCÚv”t_IÁ32_Flßt32
(

261 *
sourûBufãr
, 
sourûSŒide
,

262 *
rg‘Bufãr
, 
rg‘SŒide
,

263 
numSam¶es
 )

265 
i
;

266  
i
=0; i<
numSam¶es
; i++ )

268 
§mp
 = *
sourûBufãr
 * (1.0f / 0x7FFFFFFF);

269 *
rg‘Bufãr
 = 
§mp
;

270 
sourûBufãr
 +ğ
sourûSŒide
;

271 
rg‘Bufãr
 +ğ
rg‘SŒide
;

273 
	}
}

276 
PÜtAudioCÚv”‹r
 *
	$PaCÚv”t_S–eùProc
Ğ
PaSam¶eFÜm©
 
sourûFÜm©
,

277 
PaSam¶eFÜm©
 
rg‘FÜm©
, 
ifCl
, 
ifD™h”
 )

279 
PÜtAudioCÚv”‹r
 *
´oc
 = 
NULL
;

280  
sourûFÜm©
 )

282 
·UIÁ8
:

283  
rg‘FÜm©
 )

285 
·Flßt32
:

286 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_UIÁ8_Flßt32
;

292 
·IÁ8
:

293  
rg‘FÜm©
 )

295 
·Flßt32
:

296 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_IÁ8_Flßt32
;

302 
·IÁ16
:

303  
rg‘FÜm©
 )

305 
·Flßt32
:

306 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_IÁ16_Flßt32
;

313 
·IÁ32
:

314  
rg‘FÜm©
 )

316 
·Flßt32
:

317 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_IÁ32_Flßt32
;

324 
·Flßt32
:

325  
rg‘FÜm©
 )

327 
·UIÁ8
:

328 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_Flßt32_UIÁ8
;

330 
·IÁ8
:

331 ifĞ
ifCl
 && 
ifD™h”
 ) 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_Flßt32_IÁ8_ClD™h”
;

332 ifĞ
ifCl
 ) 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_Flßt32_IÁ8_Cl
;

333 ifĞ
ifD™h”
 ) 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_Flßt32_IÁ8_D™h”
;

334 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_Flßt32_IÁ8
;

336 
·IÁ16
:

337 ifĞ
ifCl
 && 
ifD™h”
 ) 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_Flßt32_IÁ16_ClD™h”
;

338 ifĞ
ifCl
 ) 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_Flßt32_IÁ16_Cl
;

339 ifĞ
ifD™h”
 ) 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_Flßt32_IÁ16_D™h”
;

340 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_Flßt32_IÁ16
;

342 
·IÁ32
:

344 ifĞ
ifCl
 ) 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_Flßt32_IÁ32_Cl
;

345 
´oc
 = (
PÜtAudioCÚv”‹r
 *è
PaCÚv”t_Flßt32_IÁ32
;

354  
´oc
;

356 
	}
}

359 
PaE¼Ü
 
	$PaCÚv”t_S‘upIÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
,

360 
PaSam¶eFÜm©
 
ÇtiveIÅutSam¶eFÜm©
 )

362 
·¡
->
·¡_N©iveIÅutSam¶eFÜm©
 = 
ÇtiveIÅutSam¶eFÜm©
;

363 
·¡
->
·¡_IÅutCÚv”siÚSourûSŒide
 = 1;

364 
·¡
->
·¡_IÅutCÚv”siÚT¬g‘SŒide
 = 1;

366 ifĞ
ÇtiveIÅutSam¶eFÜm©
 !ğ
·¡
->
·¡_IÅutSam¶eFÜm©
 )

368 
ifD™h”
 = (
·¡
->
·¡_FÏgs
 & 
·D™h”Off
) == 0;

369 
·¡
->
·¡_IÅutCÚv”siÚProc
 = 
	`PaCÚv”t_S–eùProc
Ğ
ÇtiveIÅutSam¶eFÜm©
,

370 
·¡
->
·¡_IÅutSam¶eFÜm©
, 0, 
ifD™h”
 );

371 ifĞ
·¡
->
·¡_IÅutCÚv”siÚProc
 =ğ
NULL
 )  
·Sam¶eFÜm©NÙSuµÜ‹d
;

375 
·¡
->
·¡_IÅutCÚv”siÚProc
 = 
NULL
;

378  
·NoE¼Ü
;

379 
	}
}

382 
PaE¼Ü
 
	$PaCÚv”t_S‘upOuut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
,

383 
PaSam¶eFÜm©
 
ÇtiveOuutSam¶eFÜm©
 )

386 
·¡
->
·¡_N©iveOuutSam¶eFÜm©
 = 
ÇtiveOuutSam¶eFÜm©
;

387 
·¡
->
·¡_OuutCÚv”siÚSourûSŒide
 = 1;

388 
·¡
->
·¡_OuutCÚv”siÚT¬g‘SŒide
 = 1;

390 ifĞ
ÇtiveOuutSam¶eFÜm©
 !ğ
·¡
->
·¡_OuutSam¶eFÜm©
 )

392 
ifD™h”
 = (
·¡
->
·¡_FÏgs
 & 
·D™h”Off
) == 0;

393 
ifCl
 = (
·¡
->
·¡_FÏgs
 & 
·ClOff
) == 0;

395 
·¡
->
·¡_OuutCÚv”siÚProc
 = 
	`PaCÚv”t_S–eùProc
Ğ·¡->
·¡_OuutSam¶eFÜm©
,

396 
ÇtiveOuutSam¶eFÜm©
, 
ifCl
, 
ifD™h”
 );

397 ifĞ
·¡
->
·¡_OuutCÚv”siÚProc
 =ğ
NULL
 )  
·Sam¶eFÜm©NÙSuµÜ‹d
;

401 
·¡
->
·¡_OuutCÚv”siÚProc
 = 
NULL
;

404  
·NoE¼Ü
;

405 
	}
}

414 
	$PaCÚv”t_Proûss
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
,

415 *
ÇtiveIÅutBufãr
,

416 *
ÇtiveOuutBufãr
 )

418 
u£rResuÉ
;

419 *
šputBufãr
 = 
NULL
;

420 *
ouutBufãr
 = 
NULL
;

423 ifĞ(
·¡
->
·¡_NumIÅutChªÃls
 > 0è&& (
ÇtiveIÅutBufãr
 !ğ
NULL
) )

425 ifĞ
·¡
->
·¡_IÅutSam¶eFÜm©
 =ğ·¡->
·¡_N©iveIÅutSam¶eFÜm©
 )

428 
šputBufãr
 = 
ÇtiveIÅutBufãr
;

432 
šputBufãr
 = 
·¡
->
·¡_IÅutBufãr
;

434 (*
·¡
->
·¡_IÅutCÚv”siÚProc
)(
ÇtiveIÅutBufãr
,…a¡->
·¡_IÅutCÚv”siÚSourûSŒide
,

435 
šputBufãr
, 
·¡
->
·¡_IÅutCÚv”siÚT¬g‘SŒide
,

436 
·¡
->
·¡_F¿mesP”U£rBufãr
 *…a¡->
·¡_NumIÅutChªÃls
 );

441 ifĞ(
·¡
->
·¡_NumOuutChªÃls
 > 0è&& (
ÇtiveOuutBufãr
 !ğ
NULL
) )

443 
ouutBufãr
 = (
·¡
->
·¡_OuutCÚv”siÚProc
 =ğ
NULL
) ?

444 
ÇtiveOuutBufãr
 : 
·¡
->
·¡_OuutBufãr
;

451 
u£rResuÉ
 = 
·¡
->
	`·¡_C®lback
(

452 
šputBufãr
,

453 
ouutBufãr
,

454 
·¡
->
·¡_F¿mesP”U£rBufãr
,

455 
·¡
->
·¡_F¿meCouÁ
,

456 
·¡
->
·¡_U£rD©a
 );

459 
·¡
->
·¡_F¿meCouÁ
 +ğ·¡->
·¡_F¿mesP”U£rBufãr
;

462 ifĞ(
·¡
->
·¡_OuutCÚv”siÚProc
 !ğ
NULL
 ) && (
ouutBufãr
 != NULL) )

464 (*
·¡
->
·¡_OuutCÚv”siÚProc
)Ğ
ouutBufãr
,…a¡->
·¡_OuutCÚv”siÚSourûSŒide
,

465 
ÇtiveOuutBufãr
, 
·¡
->
·¡_OuutCÚv”siÚT¬g‘SŒide
,

466 
·¡
->
·¡_F¿mesP”U£rBufãr
 *…a¡->
·¡_NumOuutChªÃls
 );

469  
u£rResuÉ
;

470 
	}
}

	@portaudio/pa_common/pa_host.h

1 #iâdeà
PA_HOST_H


2 
	#PA_HOST_H


	)

40 
	~"pÜudio.h
"

42 #ifdeà
__ılu¥lus


47 #iâdeà
SUPPORT_AUDIO_CAPTURE


48 
	#SUPPORT_AUDIO_CAPTURE
 (1)

	)

51 #iâdeà
št32


52 
	tšt32
;

54 #iâdeà
ušt32


55 
	tušt32
;

57 #iâdeà
št16


58 
	tšt16
;

60 #iâdeà
ušt16


61 
	tušt16
;

65 (
	gPÜtAudioCÚv”‹r
)(

66 *
	tšputBufãr
, 
	tšputSŒide
,

67 *
	touutBufãr
, 
	touutSŒide
,

68 
	tnumSam¶es
 );

70 
	#PA_MAGIC
 (0x18273645)

	)

76 
	sš‹º®PÜtAudioSŒ—m


78 
ušt32
 
	g·¡_Magic
;

81 
ušt32
 
	g·¡_F¿mesP”U£rBufãr
;

82 
ušt32
 
	g·¡_NumU£rBufãrs
;

83 
	g·¡_Sam¶eR©e
;

84 
	g·¡_NumIÅutChªÃls
;

85 
	g·¡_NumOuutChªÃls
;

86 
PaDeviûID
 
	g·¡_IÅutDeviûID
;

87 
PaDeviûID
 
	g·¡_OuutDeviûID
;

88 
PaSam¶eFÜm©
 
	g·¡_IÅutSam¶eFÜm©
;

89 
PaSam¶eFÜm©
 
	g·¡_OuutSam¶eFÜm©
;

90 
PÜtAudioC®lback
 *
	g·¡_C®lback
;

91 *
	g·¡_U£rD©a
;

92 
ušt32
 
	g·¡_FÏgs
;

95 *
	g·¡_DeviûD©a
;

96 
PaSam¶eFÜm©
 
	g·¡_N©iveOuutSam¶eFÜm©
;

97 
PaSam¶eFÜm©
 
	g·¡_N©iveIÅutSam¶eFÜm©
;

100 vŞ©
	g·¡_IsAùive
;

101 vŞ©
	g·¡_StİSoÚ
;

102 vŞ©
	g·¡_StİNow
;

104 *
	g·¡_IÅutBufãr
;

105 
ušt32
 
	g·¡_IÅutBufãrSize
;

106 *
	g·¡_OuutBufãr
;

107 
ušt32
 
	g·¡_OuutBufãrSize
;

109 
ušt32
 
	g·¡_NumC®lbacks
;

110 
PaTime¡amp
 
	g·¡_F¿meCouÁ
;

112 
	g·¡_Av”ageInsideCouÁ
;

113 
	g·¡_Av”ageTÙ®CouÁ
;

114 
	g·¡_U§ge
;

115 
	g·¡_IfLa¡Ex™V®id
;

118 
PÜtAudioCÚv”‹r
 *
	g·¡_IÅutCÚv”siÚProc
;

119 
	g·¡_IÅutCÚv”siÚSourûSŒide
;

120 
	g·¡_IÅutCÚv”siÚT¬g‘SŒide
;

121 
PÜtAudioCÚv”‹r
 *
	g·¡_OuutCÚv”siÚProc
;

122 
	g·¡_OuutCÚv”siÚSourûSŒide
;

123 
	g·¡_OuutCÚv”siÚT¬g‘SŒide
;

125 
	tš‹º®PÜtAudioSŒ—m
;

131 
PaE¼Ü
 
PaHo¡_In™
( );

132 
PaE¼Ü
 
PaHo¡_T”m
( );

134 
PaE¼Ü
 
PaHo¡_O³nSŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

135 
PaE¼Ü
 
PaHo¡_Clo£SŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

137 
PaE¼Ü
 
PaHo¡_S¹Ouut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

138 
PaE¼Ü
 
PaHo¡_StİOuut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 );

139 
PaE¼Ü
 
PaHo¡_S¹IÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

140 
PaE¼Ü
 
PaHo¡_StİIÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 );

141 
PaE¼Ü
 
PaHo¡_S¹Engše
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

142 
PaE¼Ü
 
PaHo¡_StİEngše
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 );

143 
PaE¼Ü
 
PaHo¡_SŒ—mAùive
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

145 *
PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ
numBy‹s
 );

146 
PaHo¡_F»eFa¡MemÜy
Ğ*
addr
, 
numBy‹s
 );

149 
PaE¼Ü
 
PaHo¡_V®id©eSam¶eR©e
Ğ
PaDeviûID
 
id
, 
»que¡edF¿meR©e
,

150 *
şo£¡F¿meR©ePŒ
 );

157 
PaHo¡_IsIn™Ÿlized
( );

159 
š‹º®PÜtAudioSŒ—m
* 
PaHo¡_G‘SŒ—mR•»£Á©iÚ
Ğ
PÜtAudioSŒ—m
 *
¡»am
 );

161 
PaHo¡_FšdClo£¡TabËEÁry
Ğ
®lowabËE¼Ü
, cÚ¡ *
¿‹TabË
,

162 
numR©es
, 
äameR©e
 );

164 
Pa_C®lCÚv”tIÁ16
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
,

165 *
ÇtiveIÅutBufãr
,

166 *
ÇtiveOuutBufãr
 );

172 
	#PA_DITHER_BITS
 (15)

	)

173 
	#PA_DITHER_SCALE
 (1.0à/ ((1<<
PA_DITHER_BITS
)-1))

	)

174 
PaCÚv”t_TrŸnguÏrD™h”
( );

176 
PaE¼Ü
 
PaCÚv”t_S‘upIÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
,

177 
PaSam¶eFÜm©
 
ÇtiveIÅutSam¶eFÜm©
 );

179 
PaE¼Ü
 
PaCÚv”t_S‘upOuut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
,

180 
PaSam¶eFÜm©
 
ÇtiveOuutSam¶eFÜm©
 );

182 
PaCÚv”t_Proûss
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
,

183 *
ÇtiveIÅutBufãr
,

184 *
ÇtiveOuutBufãr
 );

186 #ifdeà
__ılu¥lus


	@portaudio/pa_common/pa_lib.c

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~<¡ršg.h
>

42 
	~<m©h.h
>

45 #ifdeà
_WIN32


46 #iâdeà
__MWERKS__


47 
	~<memÜy.h
>

50 
	~<memÜy.h
>

53 
	~"pÜudio.h
"

54 
	~"·_ho¡.h
"

55 
	~"·_Œaû.h
"

60 
	#PA_VALIDATE_RATE
 (0è

	)

66 #iâdeà
FALSE


67 
	#FALSE
 (0)

	)

68 
	#TRUE
 (!
FALSE
)

	)

71 
	#PRINT
(
x
è{ 
´štf
 x; 
	`fæush
(
¡dout
); }

	)

72 
	#ERR_RPT
(
x
è
	`PRINT
(x)

	)

73 
	#DBUG
(
x
è

	)

74 
	#DBUGX
(
x
è

	)

76 
	ggIn™CouÁ
 = 0;

78 
PaE¼Ü
 
Pa_KlSŒ—m
Ğ
PÜtAudioSŒ—m
 *
¡»am
, 
abÜt
 );

81 
	$PaHo¡_FšdClo£¡TabËEÁry
Ğ
®lowabËE¼Ü
, cÚ¡ *
¿‹TabË
, 
numR©es
, 
äameR©e
 )

83 
”r
, 
mšE¼
 = 
®lowabËE¼Ü
;

84 
i
, 
be¡F™
 = -1;

86  
i
=0; i<
numR©es
; i++ )

88 
”r
 = 
	`çbs
Ğ
äameR©e
 - 
¿‹TabË
[
i
] );

89 ifĞ
”r
 < 
mšE¼
 )

91 
mšE¼
 = 
”r
;

92 
be¡F™
 = 
i
;

95  
be¡F™
;

96 
	}
}

101 
PaE¼Ü
 
	$PaHo¡_V®id©eSam¶eR©e
Ğ
PaDeviûID
 
id
, 
»que¡edF¿meR©e
,

102 *
şo£¡F¿meR©ePŒ
 )

104 
be¡R©eIndex
;

105 cÚ¡ 
PaDeviûInfo
 *
pdi
;

106 
pdi
 = 
	`Pa_G‘DeviûInfo
Ğ
id
 );

107 ifĞ
pdi
 =ğ
NULL
 )

109  
·Inv®idDeviûId
;

112 ifĞ
pdi
->
numSam¶eR©es
 == -1 )

115 ifĞ(
»que¡edF¿meR©e
 < 
pdi
->
§m¶eR©es
[0]) ||

116 (
»que¡edF¿meR©e
 > 
pdi
->
§m¶eR©es
[1]) )

118  
·Inv®idSam¶eR©e
;

121 *
şo£¡F¿meR©ePŒ
 = 
»que¡edF¿meR©e
;

125 
be¡R©eIndex
 = 
	`PaHo¡_FšdClo£¡TabËEÁry
Ğ1.0, 
pdi
->
§m¶eR©es
,…di->
numSam¶eR©es
, 
»que¡edF¿meR©e
 );

126 ifĞ
be¡R©eIndex
 < 0 )  
·Inv®idSam¶eR©e
;

127 *
şo£¡F¿meR©ePŒ
 = 
pdi
->
§m¶eR©es
[
be¡R©eIndex
];

129  
·NoE¼Ü
;

130 
	}
}

133 
PaE¼Ü
 
	$Pa_O³nSŒ—m
(

134 
PÜtAudioSŒ—m
** 
¡»amPŒPŒ
,

135 
PaDeviûID
 
šputDeviûID
,

136 
numIÅutChªÃls
,

137 
PaSam¶eFÜm©
 
šputSam¶eFÜm©
,

138 *
šputDriv”Info
,

139 
PaDeviûID
 
ouutDeviûID
,

140 
numOuutChªÃls
,

141 
PaSam¶eFÜm©
 
ouutSam¶eFÜm©
,

142 *
ouutDriv”Info
,

143 
§m¶eR©e
,

144 
äamesP”Bufãr
,

145 
numb”OfBufãrs
,

146 
¡»amFÏgs
,

147 
PÜtAudioC®lback
 *
ÿÎback
,

148 *
u£rD©a
 )

150 
š‹º®PÜtAudioSŒ—m
 *
·¡
 = 
NULL
;

151 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

152 
b™sP”IÅutSam¶e
;

153 
b™sP”OuutSam¶e
;

155 
	`DBUG
(("Pa_OpenStream( %p, %d, %d, %d, %p, /* input */ \n",

156 
¡»amPŒPŒ
, 
šputDeviûID
, 
numIÅutChªÃls
,

157 
šputSam¶eFÜm©
, 
šputDriv”Info
 ));

158 
	`DBUG
((" %d, %d, %d, %p, /* output */\n",

159 
ouutDeviûID
, 
numOuutChªÃls
,

160 
ouutSam¶eFÜm©
, 
ouutDriv”Info
 ));

161 
	`DBUG
((" %g, %d, %d, 0x%x, , %p )\n",

162 
§m¶eR©e
, 
äamesP”Bufãr
, 
numb”OfBufãrs
,

163 
¡»amFÏgs
, 
u£rD©a
 ));

166 ifĞ(
¡»amFÏgs
 & ~(
·ClOff
 | 
·D™h”Off
)è!ğ0 )  
·Inv®idFÏg
;

167 ifĞ
¡»amPŒPŒ
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

168 ifĞ
šputDriv”Info
 !ğ
NULL
 )  
·Ho¡E¼Ü
;

169 ifĞ
ouutDriv”Info
 !ğ
NULL
 )  
·Ho¡E¼Ü
;

170 ifĞ(
šputDeviûID
 < 0è&& ( 
ouutDeviûID
 < 0èè 
·Inv®idDeviûId
;

171 ifĞ(
ouutDeviûID
 >ğ
	`Pa_CouÁDeviûs
()è|| (
šputDeviûID
 >= Pa_CountDevices()) )

173  
·Inv®idDeviûId
;

175 ifĞ(
numIÅutChªÃls
 <ğ0è&& ( 
numOuutChªÃls
 <ğ0èè 
·Inv®idChªÃlCouÁ
;

177 #ià
SUPPORT_AUDIO_CAPTURE


178 ifĞ
šputDeviûID
 >= 0 )

180 
PaE¼Ü
 
size
 = 
	`Pa_G‘Sam¶eSize
Ğ
šputSam¶eFÜm©
 );

181 ifĞ
size
 < 0 )  size;

182 
b™sP”IÅutSam¶e
 = 8 * 
size
;

183 ifĞ(
numIÅutChªÃls
 <ğ0èè 
·Inv®idChªÃlCouÁ
;

186 ifĞ
šputDeviûID
 >= 0 )

188  
·Inv®idChªÃlCouÁ
;

193 ifĞ
numIÅutChªÃls
 > 0 )  
·Inv®idChªÃlCouÁ
;

194 
b™sP”IÅutSam¶e
 = 0;

197 ifĞ
ouutDeviûID
 >= 0 )

199 
PaE¼Ü
 
size
 = 
	`Pa_G‘Sam¶eSize
Ğ
ouutSam¶eFÜm©
 );

200 ifĞ
size
 < 0 )  size;

201 
b™sP”OuutSam¶e
 = 8 * 
size
;

202 ifĞ(
numOuutChªÃls
 <ğ0èè 
·Inv®idChªÃlCouÁ
;

206 ifĞ
numOuutChªÃls
 > 0 )  
·Inv®idChªÃlCouÁ
;

207 
b™sP”OuutSam¶e
 = 0;

210 ifĞ
ÿÎback
 =ğ
NULL
 )  
·NuÎC®lback
;

213 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
( (internalPortAudioStream) );

214 ifĞ
·¡
 =ğ
NULL
 )  
·Insuffic›ÁMemÜy
;

215 
	`mem£t
Ğ
·¡
, 0, (
š‹º®PÜtAudioSŒ—m
) );

216 
	`AddT¿ûMes§ge
("Pa_O³nSŒ—m:…a¡", (è
·¡
 );

218 
·¡
->
·¡_Magic
 = 
PA_MAGIC
;

219 
·¡
->
·¡_F¿mesP”U£rBufãr
 = 
äamesP”Bufãr
;

220 
·¡
->
·¡_NumU£rBufãrs
 = 
numb”OfBufãrs
;

221 
·¡
->
·¡_C®lback
 = 
ÿÎback
;

222 
·¡
->
·¡_U£rD©a
 = 
u£rD©a
;

223 
·¡
->
·¡_OuutSam¶eFÜm©
 = 
ouutSam¶eFÜm©
;

224 
·¡
->
·¡_IÅutSam¶eFÜm©
 = 
šputSam¶eFÜm©
;

225 
·¡
->
·¡_OuutDeviûID
 = 
ouutDeviûID
;

226 
·¡
->
·¡_IÅutDeviûID
 = 
šputDeviûID
;

227 
·¡
->
·¡_NumIÅutChªÃls
 = 
numIÅutChªÃls
;

228 
·¡
->
·¡_NumOuutChªÃls
 = 
numOuutChªÃls
;

229 
·¡
->
·¡_FÏgs
 = 
¡»amFÏgs
;

232 ifĞ(
§m¶eR©e
 < 1000.0) || (sampleRate > 200000.0) )

234 
»suÉ
 = 
·Inv®idSam¶eR©e
;

235 
ş—nup
;

239 ifĞ
numIÅutChªÃls
 > 0 )

242 #ià
PA_VALIDATE_RATE


243 
»suÉ
 = 
	`PaHo¡_V®id©eSam¶eR©e
Ğ
šputDeviûID
, 
§m¶eR©e
, &
·¡
->
·¡_Sam¶eR©e
 );

244 ifĞ
»suÉ
 < 0 )

246 
ş—nup
;

249 
·¡
->
·¡_Sam¶eR©e
 = 
§m¶eR©e
;

252 
·¡
->
·¡_IÅutBufãrSize
 = 
äamesP”Bufãr
 * 
numIÅutChªÃls
 * ((
b™sP”IÅutSam¶e
+7) / 8);

253 
·¡
->
·¡_IÅutBufãr
 = 
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
Õa¡->
·¡_IÅutBufãrSize
);

254 ifĞ
·¡
->
·¡_IÅutBufãr
 =ğ
NULL
 )

256 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

257 
ş—nup
;

262 
·¡
->
·¡_IÅutBufãr
 = 
NULL
;

266 ifĞ
numOuutChªÃls
 > 0 )

268 #ià
PA_VALIDATE_RATE


269 
»suÉ
 = 
	`PaHo¡_V®id©eSam¶eR©e
Ğ
ouutDeviûID
, 
§m¶eR©e
, &
·¡
->
·¡_Sam¶eR©e
 );

270 ifĞ
»suÉ
 < 0 )

272 
ş—nup
;

275 
·¡
->
·¡_Sam¶eR©e
 = 
§m¶eR©e
;

277 
·¡
->
·¡_OuutBufãrSize
 = 
äamesP”Bufãr
 * 
numOuutChªÃls
 * ((
b™sP”OuutSam¶e
+7) / 8);

278 
·¡
->
·¡_OuutBufãr
 = 
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
Õa¡->
·¡_OuutBufãrSize
);

279 ifĞ
·¡
->
·¡_OuutBufãr
 =ğ
NULL
 )

281 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

282 
ş—nup
;

287 
·¡
->
·¡_OuutBufãr
 = 
NULL
;

290 
»suÉ
 = 
	`PaHo¡_O³nSŒ—m
Ğ
·¡
 );

291 ifĞ
»suÉ
 < 0 ) 
ş—nup
;

293 *
¡»amPŒPŒ
 = (*è
·¡
;

295  
»suÉ
;

297 
ş—nup
:

298 ifĞ
·¡
 !ğ
NULL
 ) 
	`Pa_Clo£SŒ—m
(…ast );

299 *
¡»amPŒPŒ
 = 
NULL
;

300  
»suÉ
;

301 
	}
}

305 
PaE¼Ü
 
	$Pa_O³nDeçuÉSŒ—m
Ğ
PÜtAudioSŒ—m
** 
¡»am
,

306 
numIÅutChªÃls
,

307 
numOuutChªÃls
,

308 
PaSam¶eFÜm©
 
§m¶eFÜm©
,

309 
§m¶eR©e
,

310 
äamesP”Bufãr
,

311 
numb”OfBufãrs
,

312 
PÜtAudioC®lback
 *
ÿÎback
,

313 *
u£rD©a
 )

315  
	`Pa_O³nSŒ—m
(

316 
¡»am
,

317 ((
numIÅutChªÃls
 > 0è? 
	`Pa_G‘DeçuÉIÅutDeviûID
(è: 
·NoDeviû
),

318 
numIÅutChªÃls
, 
§m¶eFÜm©
, 
NULL
,

319 ((
numOuutChªÃls
 > 0è? 
	`Pa_G‘DeçuÉOuutDeviûID
(è: 
·NoDeviû
),

320 
numOuutChªÃls
, 
§m¶eFÜm©
, 
NULL
,

321 
§m¶eR©e
, 
äamesP”Bufãr
, 
numb”OfBufãrs
, 
·NoFÏg
, 
ÿÎback
, 
u£rD©a
 );

322 
	}
}

325 
PaE¼Ü
 
	$Pa_Clo£SŒ—m
Ğ
PÜtAudioSŒ—m
* 
¡»am
)

327 
PaE¼Ü
 
»suÉ
;

328 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

330 
	`DBUG
(("Pa_CloseStream()\n"));

331 ifĞ
¡»am
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

332 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
¡»am
;

334 
	`Pa_AbÜtSŒ—m
Ğ
·¡
 );

335 
»suÉ
 = 
	`PaHo¡_Clo£SŒ—m
Ğ
·¡
 );

337 ifĞ
·¡
->
·¡_IÅutBufãr
 ) 
	`PaHo¡_F»eFa¡MemÜy
Ğ·¡->·¡_IÅutBufãr,…a¡->
·¡_IÅutBufãrSize
 );

338 ifĞ
·¡
->
·¡_OuutBufãr
 ) 
	`PaHo¡_F»eFa¡MemÜy
Ğ·¡->·¡_OuutBufãr,…a¡->
·¡_OuutBufãrSize
 );

339 
	`PaHo¡_F»eFa¡MemÜy
Ğ
·¡
, (
š‹º®PÜtAudioSŒ—m
) );

341  
»suÉ
;

342 
	}
}

345 
PaE¼Ü
 
	$Pa_S¹SŒ—m
Ğ
PÜtAudioSŒ—m
 *
¡»am
 )

347 
PaE¼Ü
 
»suÉ
 = 
·Ho¡E¼Ü
;

348 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

350 ifĞ
¡»am
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

351 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
¡»am
;

353 
·¡
->
·¡_F¿meCouÁ
 = 0.0;

355 ifĞ
·¡
->
·¡_NumIÅutChªÃls
 > 0 )

357 
»suÉ
 = 
	`PaHo¡_S¹IÅut
Ğ
·¡
 );

358 
	`DBUG
(("Pa_S¹SŒ—m: PaHo¡_S¹IÅuˆ»tuºed = 0x%X.\n", 
»suÉ
));

359 ifĞ
»suÉ
 < 0 ) 
”rÜ
;

362 ifĞ
·¡
->
·¡_NumOuutChªÃls
 > 0 )

364 
»suÉ
 = 
	`PaHo¡_S¹Ouut
Ğ
·¡
 );

365 
	`DBUG
(("Pa_S¹SŒ—m: PaHo¡_S¹Ouuˆ»tuºed = 0x%X.\n", 
»suÉ
));

366 ifĞ
»suÉ
 < 0 ) 
”rÜ
;

369 
»suÉ
 = 
	`PaHo¡_S¹Engše
Ğ
·¡
 );

370 
	`DBUG
(("Pa_S¹SŒ—m: PaHo¡_S¹Engš»tuºed = 0x%X.\n", 
»suÉ
));

371 ifĞ
»suÉ
 < 0 ) 
”rÜ
;

373  
·NoE¼Ü
;

375 
”rÜ
:

376  
»suÉ
;

377 
	}
}

380 
PaE¼Ü
 
	$Pa_StİSŒ—m
Ğ
PÜtAudioSŒ—m
 *
¡»am
 )

382  
	`Pa_KlSŒ—m
Ğ
¡»am
, 0 );

383 
	}
}

386 
PaE¼Ü
 
	$Pa_AbÜtSŒ—m
Ğ
PÜtAudioSŒ—m
 *
¡»am
 )

388  
	`Pa_KlSŒ—m
Ğ
¡»am
, 1 );

389 
	}
}

392 
PaE¼Ü
 
	$Pa_KlSŒ—m
Ğ
PÜtAudioSŒ—m
 *
¡»am
, 
abÜt
 )

394 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

395 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

397 
	`DBUG
(("Pa_StopStream().\n"));

398 ifĞ
¡»am
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

399 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
¡»am
;

401 ifĞ(
·¡
->
·¡_NumIÅutChªÃls
 > 0è|| (·¡->
·¡_NumOuutChªÃls
 > 0) )

403 
»suÉ
 = 
	`PaHo¡_StİEngše
Ğ
·¡
, 
abÜt
 );

404 
	`DBUG
(("Pa_StİSŒ—m: PaHo¡_StİEngš»tuºed = 0x%X.\n", 
»suÉ
));

405 ifĞ
»suÉ
 < 0 ) 
”rÜ
;

408 ifĞ
·¡
->
·¡_NumIÅutChªÃls
 > 0 )

410 
»suÉ
 = 
	`PaHo¡_StİIÅut
Ğ
·¡
, 
abÜt
 );

411 
	`DBUG
(("Pa_StİSŒ—m: PaHo¡_StİIÅuˆ»tuºed = 0x%X.\n", 
»suÉ
));

412 ifĞ
»suÉ
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

415 ifĞ
·¡
->
·¡_NumOuutChªÃls
 > 0 )

417 
»suÉ
 = 
	`PaHo¡_StİOuut
Ğ
·¡
, 
abÜt
 );

418 
	`DBUG
(("Pa_StİSŒ—m: PaHo¡_StİOuuˆ»tuºed = 0x%X.\n", 
»suÉ
));

419 ifĞ
»suÉ
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

422 
”rÜ
:

423 
·¡
->
·¡_U§ge
 = 0;

424 
·¡
->
·¡_IfLa¡Ex™V®id
 = 0;

426  
»suÉ
;

427 
	}
}

430 
PaE¼Ü
 
	$Pa_SŒ—mAùive
Ğ
PÜtAudioSŒ—m
 *
¡»am
 )

432 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

433 ifĞ
¡»am
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

434 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
¡»am
;

435  
	`PaHo¡_SŒ—mAùive
Ğ
·¡
 );

436 
	}
}

439 cÚ¡ *
	$Pa_G‘E¼ÜText
Ğ
PaE¼Ü
 
”ºum
 )

441 cÚ¡ *
msg
;

443 
”ºum
)

445 
·NoE¼Ü
: 
msg
 = "Success"; ;

446 
·Ho¡E¼Ü
: 
msg
 = "Hostƒrror."; ;

447 
·Inv®idChªÃlCouÁ
: 
msg
 = "Invalid‚umber of channels."; ;

448 
·Inv®idSam¶eR©e
: 
msg
 = "Invalid sample„ate."; ;

449 
·Inv®idDeviûId
: 
msg
 = "Invalid device ID."; ;

450 
·Inv®idFÏg
: 
msg
 = "Invalid flag."; ;

451 
·Sam¶eFÜm©NÙSuµÜ‹d
: 
msg
 = "Sample format‚ot supported"; ;

452 
·BadIODeviûCombš©iÚ
: 
msg
 = "Illegal combination of I/O devices."; ;

453 
·Insuffic›ÁMemÜy
: 
msg
 = "Insufficient memory."; ;

454 
·BufãrTooBig
: 
msg
 = "Bufferoo big."; ;

455 
·BufãrTooSm®l
: 
msg
 = "Bufferoo small."; ;

456 
·NuÎC®lback
: 
msg
 = "No callback„outine specified."; ;

457 
·BadSŒ—mPŒ
: 
msg
 = "Invalid stream…ointer."; ;

458 
·TimedOut
 : 
msg
 = "Wait Timed Out."; ;

459 
·IÁ”ÇlE¼Ü
: 
msg
 = "Internal PortAudio Error."; ;

460 
·DeviûUÇvaabË
: 
msg
 = "Device Unavailable."; ;

461 : 
msg
 = "Illegalƒrror‚umber."; ;

463  
msg
;

464 
	}
}

473 
	$Pa_G‘CPULßd
Ğ
PÜtAudioSŒ—m
* 
¡»am
)

475 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

476 ifĞ
¡»am
 =ğ
NULL
 )  (è
·BadSŒ—mPŒ
;

477 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
¡»am
;

478  
·¡
->
·¡_U§ge
;

479 
	}
}

482 
š‹º®PÜtAudioSŒ—m
* 
	$PaHo¡_G‘SŒ—mR•»£Á©iÚ
Ğ
PÜtAudioSŒ—m
 *
¡»am
 )

484 
š‹º®PÜtAudioSŒ—m
* 
»suÉ
 = (š‹º®PÜtAudioSŒ—m*è
¡»am
;

486 ifĞ
»suÉ
 =ğ
NULL
 ||„esuÉ->
·¡_Magic
 !ğ
PA_MAGIC
 )

487  
NULL
;

489  
»suÉ
;

490 
	}
}

497 
	#PA_DITHER_BITS
 (15)

	)

498 
	#PA_DITHER_SCALE
 (1.0à/ ((1<<
PA_DITHER_BITS
)-1))

	)

499 
	$PaCÚv”t_TrŸnguÏrD™h”
( )

501 
´evious
 = 0;

502 
¿ndS“d1
 = 22222;

503 
¿ndS“d2
 = 5555555;

504 
cu¼’t
, 
highPass
;

506 
¿ndS“d1
 = (randSeed1 * 196314165) + 907633515;

507 
¿ndS“d2
 = (randSeed2 * 196314165) + 907633515;

512 
	#DITHER_SHIFT
 ((32 - 
PA_DITHER_BITS
è+ 1)

	)

513 
cu¼’t
 = ((()
¿ndS“d1
)>>
DITHER_SHIFT
è+ ((()
¿ndS“d2
)>>DITHER_SHIFT);

515 
highPass
 = 
cu¼’t
 - 
´evious
;

516 
´evious
 = 
cu¼’t
;

517  
highPass
;

518 
	}
}

527 
	$Pa_C®lCÚv”tIÁ16
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
,

528 *
ÇtiveIÅutBufãr
,

529 *
ÇtiveOuutBufãr
 )

531 
‹mp
;

532 
u£rResuÉ
;

533 
i
;

534 *
šputBufãr
 = 
NULL
;

535 *
ouutBufãr
 = 
NULL
;

537 #ià
SUPPORT_AUDIO_CAPTURE


539 ifĞ(
·¡
->
·¡_NumIÅutChªÃls
 > 0è&& (
ÇtiveIÅutBufãr
 !ğ
NULL
) )

542 
§m¶esP”Bufãr
 = 
·¡
->
·¡_F¿mesP”U£rBufãr
 *…a¡->
·¡_NumIÅutChªÃls
;

543 
·¡
->
·¡_IÅutSam¶eFÜm©
)

546 
·Flßt32
:

548 *
šBufPŒ
 = (*è
·¡
->
·¡_IÅutBufãr
;

549 
šputBufãr
 = 
·¡
->
·¡_IÅutBufãr
;

550  
i
=0; i<
§m¶esP”Bufãr
; i++ )

552 
šBufPŒ
[
i
] = 
ÇtiveIÅutBufãr
[i] * (1.0f / 32767.0f);

557 
·IÁ32
:

560 *
šBufPŒ
 = (*è
·¡
->
·¡_IÅutBufãr
;

561 
šputBufãr
 = 
·¡
->
·¡_IÅutBufãr
;

562  
i
=0; i<
§m¶esP”Bufãr
; i++ )

564 
šBufPŒ
[
i
] = 
ÇtiveIÅutBufãr
[i] << 16;

569 
·IÁ24
:

572 *
šBufPŒ
 = (*è
·¡
->
·¡_IÅutBufãr
;

573 
šputBufãr
 = 
·¡
->
·¡_IÅutBufãr
;

574  
i
=0; i<
§m¶esP”Bufãr
; i++ )

576 
šBufPŒ
[
i
] = 
ÇtiveIÅutBufãr
[i] << 8;

581 
·IÁ16
:

584 
šputBufãr
 = 
ÇtiveIÅutBufãr
;

588 
·IÁ8
:

591 *
šBufPŒ
 = (*è
·¡
->
·¡_IÅutBufãr
;

592 
šputBufãr
 = 
·¡
->
·¡_IÅutBufãr
;

593 ifĞ
·¡
->
·¡_FÏgs
 & 
·D™h”Off
 )

595  
i
=0; i<
§m¶esP”Bufãr
; i++ )

597 
šBufPŒ
[
i
] = ()(
ÇtiveIÅutBufãr
[i] >> 8);

602  
i
=0; i<
§m¶esP”Bufãr
; i++ )

604 
‹mp
 = 
ÇtiveIÅutBufãr
[
i
];

605 
‹mp
 +ğ
	`PaCÚv”t_TrŸnguÏrD™h”
() >> 8;

606 
‹mp
 = ((temp < -0x8000) ? -0x8000 : ((temp > 0x7FFF) ? 0x7FFF :emp));

607 
šBufPŒ
[
i
] = ()(
‹mp
 >> 8);

613 
·UIÁ8
:

616 *
šBufPŒ
 = (*è
·¡
->
·¡_IÅutBufãr
;

617 
šputBufãr
 = 
·¡
->
·¡_IÅutBufãr
;

618 ifĞ
·¡
->
·¡_FÏgs
 & 
·D™h”Off
 )

620  
i
=0; i<
§m¶esP”Bufãr
; i++ )

622 
šBufPŒ
[
i
] = ()((
ÇtiveIÅutBufãr
[i] >> 8) + 0x80);

628  
i
=0; i<
§m¶esP”Bufãr
; i++ )

630 
‹mp
 = 
ÇtiveIÅutBufãr
[
i
];

631 
‹mp
 +ğ
	`PaCÚv”t_TrŸnguÏrD™h”
() >> 8;

632 
‹mp
 = ((temp < -0x8000) ? -0x8000 : ((temp > 0x7FFF) ? 0x7FFF :emp));

633 
šBufPŒ
[
i
] = ()((
‹mp
>>8) + 0x80);

646 ifĞ(
·¡
->
·¡_NumOuutChªÃls
 > 0è&& (
ÇtiveOuutBufãr
 !ğ
NULL
) )

649 
ouutBufãr
 = (
·¡
->
·¡_OuutSam¶eFÜm©
 =ğ
·IÁ16
) ?

650 
ÇtiveOuutBufãr
 : 
·¡
->
·¡_OuutBufãr
;

657 
u£rResuÉ
 = 
·¡
->
	`·¡_C®lback
(

658 
šputBufãr
,

659 
ouutBufãr
,

660 
·¡
->
·¡_F¿mesP”U£rBufãr
,

661 
·¡
->
·¡_F¿meCouÁ
,

662 
·¡
->
·¡_U£rD©a
 );

664 
·¡
->
·¡_F¿meCouÁ
 +ğ(
PaTime¡amp
è·¡->
·¡_F¿mesP”U£rBufãr
;

667 ifĞ
ouutBufãr
 !ğ
NULL
 )

669 
§m¶esP”Bufãr
 = 
·¡
->
·¡_F¿mesP”U£rBufãr
 *…a¡->
·¡_NumOuutChªÃls
;

670 
·¡
->
·¡_OuutSam¶eFÜm©
)

672 
·Flßt32
:

674 *
outBufPŒ
 = (*è
·¡
->
·¡_OuutBufãr
;

675 ifĞ
·¡
->
·¡_FÏgs
 & 
·D™h”Off
 )

677 ifĞ
·¡
->
·¡_FÏgs
 & 
·ClOff
 )

679  
i
=0; i<
§m¶esP”Bufãr
; i++ )

681 *
ÇtiveOuutBufãr
++ = (è(
outBufPŒ
[
i
] * (32767.0f));

686  
i
=0; i<
§m¶esP”Bufãr
; i++ )

688 
‹mp
 = ()(
outBufPŒ
[
i
] * 32767.0f);

689 *
ÇtiveOuutBufãr
++ = ()((
‹mp
 < -0x8000) ? -0x8000 : ((temp > 0x7FFF) ? 0x7FFF :emp));

696  
i
=0; i<
§m¶esP”Bufãr
; i++ )

698 
d™h”
 = 
	`PaCÚv”t_TrŸnguÏrD™h”
()*
PA_DITHER_SCALE
;

699 
d™h”ed
 = (
outBufPŒ
[
i
] * (32767.0f)è+ 
d™h”
;

700 
‹mp
 = (è(
d™h”ed
);

701 *
ÇtiveOuutBufãr
++ = ()((
‹mp
 < -0x8000) ? -0x8000 : ((temp > 0x7FFF) ? 0x7FFF :emp));

707 
·IÁ32
:

709 *
outBufPŒ
 = (*è
·¡
->
·¡_OuutBufãr
;

710 ifĞ
·¡
->
·¡_FÏgs
 & 
·D™h”Off
 )

712  
i
=0; i<
§m¶esP”Bufãr
; i++ )

714 *
ÇtiveOuutBufãr
++ = (è(
outBufPŒ
[
i
] >> 16 );

719  
i
=0; i<
§m¶esP”Bufãr
; i++ )

722 
‹mp
 = (
outBufPŒ
[
i
] >> 1è+ 
	`PaCÚv”t_TrŸnguÏrD™h”
();

723 
‹mp
 =emp >> 15;

724 *
ÇtiveOuutBufãr
++ = ()((
‹mp
 < -0x8000) ? -0x8000 : ((temp > 0x7FFF) ? 0x7FFF :emp));

730 
·IÁ8
:

732 *
outBufPŒ
 = (*è
·¡
->
·¡_OuutBufãr
;

733  
i
=0; i<
§m¶esP”Bufãr
; i++ )

735 *
ÇtiveOuutBufãr
++ = (è((()
outBufPŒ
[
i
]) << 8);

740 
·UIÁ8
:

742 *
outBufPŒ
 = (*è
·¡
->
·¡_OuutBufãr
;

743  
i
=0; i<
§m¶esP”Bufãr
; i++ )

745 *
ÇtiveOuutBufãr
++ = (è((()(
outBufPŒ
[
i
] - 0x80)) << 8);

756  
u£rResuÉ
;

757 
	}
}

760 
PaE¼Ü
 
	$Pa_In™Ÿlize
( )

762 ifĞ
gIn™CouÁ
++ > 0 )  
·NoE¼Ü
;

763 
	`Re£tT¿ûMes§ges
();

764  
	`PaHo¡_In™
();

765 
	}
}

767 
PaE¼Ü
 
	$Pa_T”mš©e
( )

769 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

771 ifĞ
gIn™CouÁ
 =ğ0 )  
·NoE¼Ü
;

772 ifĞ--
gIn™CouÁ
 == 0 )

774 
»suÉ
 = 
	`PaHo¡_T”m
();

775 
	`DumpT¿ûMes§ges
();

777  
»suÉ
;

778 
	}
}

780 
	$PaHo¡_IsIn™Ÿlized
()

782  
gIn™CouÁ
;

783 
	}
}

786 
PaE¼Ü
 
	$Pa_G‘Sam¶eSize
Ğ
PaSam¶eFÜm©
 
fÜm©
 )

788 
size
;

789 
fÜm©
 )

792 
·UIÁ8
:

793 
·IÁ8
:

794 
size
 = 1;

797 
·IÁ16
:

798 
size
 = 2;

801 
·PackedIÁ24
:

802 
size
 = 3;

805 
·Flßt32
:

806 
·IÁ32
:

807 
·IÁ24
:

808 
size
 = 4;

812 
size
 = 
·Sam¶eFÜm©NÙSuµÜ‹d
;

815  (
PaE¼Ü
è
size
;

816 
	}
}

	@portaudio/pa_common/pa_trace.c

33 
	~<¡dio.h
>

34 
	~<¡dlib.h
>

35 
	~<¡ršg.h
>

36 
	~"·_Œaû.h
"

38 #ià
TRACE_REALTIME_EVENTS


40 *
	gŒaûTextA¼ay
[
MAX_TRACE_RECORDS
];

41 
	gŒaûIÁA¼ay
[
MAX_TRACE_RECORDS
];

42 
	gŒaûIndex
 = 0;

43 
	gŒaûBlock
 = 0;

46 
	$Re£tT¿ûMes§ges
()

48 
ŒaûIndex
 = 0;

49 
	}
}

52 
	$DumpT¿ûMes§ges
()

54 
i
;

55 
numDump
 = (
ŒaûIndex
 < 
MAX_TRACE_RECORDS
) ?raceIndex : MAX_TRACE_RECORDS;

57 
	`´štf
("DumpT¿ûMes§ges:¿ûIndex = %d\n", 
ŒaûIndex
 );

58  
i
=0; i<
numDump
; i++ )

60 
	`´štf
("%3d: %s = 0x%08X\n",

61 
i
, 
ŒaûTextA¼ay
[i], 
ŒaûIÁA¼ay
[i] );

63 
	`Re£tT¿ûMes§ges
();

64 
	`fæush
(
¡dout
);

65 
	}
}

68 
	$AddT¿ûMes§ge
Ğ*
msg
, 
d©a
 )

70 ifĞ(
ŒaûIndex
 =ğ
MAX_TRACE_RECORDS
è&& (
ŒaûBlock
 == 0) )

72 
ŒaûBlock
 = 1;

75 ifĞ
ŒaûIndex
 < 
MAX_TRACE_RECORDS
 )

77 
ŒaûTextA¼ay
[
ŒaûIndex
] = 
msg
;

78 
ŒaûIÁA¼ay
[
ŒaûIndex
] = 
d©a
;

79 
ŒaûIndex
++;

81 
	}
}

	@portaudio/pa_common/pa_trace.h

1 #iâdeà
PA_TRACE_H


2 
	#PA_TRACE_H


	)

36 
	#TRACE_REALTIME_EVENTS
 (0è

	)

37 
	#MAX_TRACE_RECORDS
 (2048)

	)

39 #ifdeà
__ılu¥lus


49 #ià
TRACE_REALTIME_EVENTS


51 
DumpT¿ûMes§ges
();

52 
Re£tT¿ûMes§ges
();

53 
AddT¿ûMes§ge
Ğ*
msg
, 
d©a
 );

57 
	#AddT¿ûMes§ge
(
msg
,
d©a
è

	)

58 
	#Re£tT¿ûMes§ges
(è

	)

59 
	#DumpT¿ûMes§ges
(è

	)

63 #ifdeà
__ılu¥lus


	@portaudio/pa_common/portaudio.h

1 #iâdeà
PORT_AUDIO_H


2 
	#PORT_AUDIO_H


	)

4 #ifdeà
__ılu¥lus


42 
	tPaE¼Ü
;

44 
·NoE¼Ü
 = 0,

46 
·Ho¡E¼Ü
 = -10000,

47 
·Inv®idChªÃlCouÁ
,

48 
·Inv®idSam¶eR©e
,

49 
·Inv®idDeviûId
,

50 
·Inv®idFÏg
,

51 
·Sam¶eFÜm©NÙSuµÜ‹d
,

52 
·BadIODeviûCombš©iÚ
,

53 
·Insuffic›ÁMemÜy
,

54 
·BufãrTooBig
,

55 
·BufãrTooSm®l
,

56 
·NuÎC®lback
,

57 
·BadSŒ—mPŒ
,

58 
·TimedOut
,

59 
·IÁ”ÇlE¼Ü
,

60 
·DeviûUÇvaabË


61 } 
	tPaE¼ÜNum
;

69 
PaE¼Ü
 
Pa_In™Ÿlize
( );

77 
PaE¼Ü
 
Pa_T”mš©e
( );

85 
Pa_G‘Ho¡E¼Ü
( );

93 cÚ¡ *
Pa_G‘E¼ÜText
Ğ
PaE¼Ü
 
”ºum
 );

112 
	tPaSam¶eFÜm©
;

113 
	#·Flßt32
 ((
PaSam¶eFÜm©
è(1<<0)è

	)

114 
	#·IÁ16
 ((
PaSam¶eFÜm©
è(1<<1)è

	)

115 
	#·IÁ32
 ((
PaSam¶eFÜm©
è(1<<2)è

	)

116 
	#·IÁ24
 ((
PaSam¶eFÜm©
è(1<<3))

	)

117 
	#·PackedIÁ24
 ((
PaSam¶eFÜm©
è(1<<4))

	)

118 
	#·IÁ8
 ((
PaSam¶eFÜm©
è(1<<5))

	)

119 
	#·UIÁ8
 ((
PaSam¶eFÜm©
è(1<<6))

	)

120 
	#·Cu¡omFÜm©
 ((
PaSam¶eFÜm©
è(1<<16))

	)

131 
	tPaDeviûID
;

132 
	#·NoDeviû
 -1

	)

134 
Pa_CouÁDeviûs
( );

138 
¡ruùV”siÚ
;

139 cÚ¡ *
Çme
;

140 
maxIÅutChªÃls
;

141 
maxOuutChªÃls
;

143 
numSam¶eR©es
;

145 cÚ¡ *
§m¶eR©es
;

146 
PaSam¶eFÜm©
 
ÇtiveSam¶eFÜm©s
;

148 
	tPaDeviûInfo
;

166 
PaDeviûID
 
Pa_G‘DeçuÉIÅutDeviûID
( );

167 
PaDeviûID
 
Pa_G‘DeçuÉOuutDeviûID
( );

182 cÚ¡ 
PaDeviûInfo
* 
Pa_G‘DeviûInfo
Ğ
PaDeviûID
 
deviû
 );

191 
	tPaTime¡amp
;

221 (
PÜtAudioC®lback
)(

222 *
	tšputBufãr
, *
	touutBufãr
,

223 
	täamesP”Bufãr
,

224 
	tPaTime¡amp
 
	toutTime
, *
	tu£rD©a
 );

235 
	#·NoFÏg
 (0)

	)

236 
	#·ClOff
 (1<<0è

	)

237 
	#·D™h”Off
 (1<<1è

	)

238 
	#·PÏtfÜmS³cificFÏgs
 (0x00010000)

	)

239 
	tPaSŒ—mFÏgs
;

247 
	tPÜtAudioSŒ—m
;

248 
	#PaSŒ—m
 
PÜtAudioSŒ—m


	)

325 
PaE¼Ü
 
Pa_O³nSŒ—m
Ğ
PÜtAudioSŒ—m
** 
¡»am
,

326 
PaDeviûID
 
šputDeviû
,

327 
numIÅutChªÃls
,

328 
PaSam¶eFÜm©
 
šputSam¶eFÜm©
,

329 *
šputDriv”Info
,

330 
PaDeviûID
 
ouutDeviû
,

331 
numOuutChªÃls
,

332 
PaSam¶eFÜm©
 
ouutSam¶eFÜm©
,

333 *
ouutDriv”Info
,

334 
§m¶eR©e
,

335 
äamesP”Bufãr
,

336 
numb”OfBufãrs
,

337 
PaSŒ—mFÏgs
 
¡»amFÏgs
,

338 
PÜtAudioC®lback
 *
ÿÎback
,

339 *
u£rD©a
 );

355 
PaE¼Ü
 
Pa_O³nDeçuÉSŒ—m
Ğ
PÜtAudioSŒ—m
** 
¡»am
,

356 
numIÅutChªÃls
,

357 
numOuutChªÃls
,

358 
PaSam¶eFÜm©
 
§m¶eFÜm©
,

359 
§m¶eR©e
,

360 
äamesP”Bufãr
,

361 
numb”OfBufãrs
,

362 
PÜtAudioC®lback
 *
ÿÎback
,

363 *
u£rD©a
 );

370 
PaE¼Ü
 
Pa_Clo£SŒ—m
Ğ
PÜtAudioSŒ—m
* );

380 
PaE¼Ü
 
Pa_S¹SŒ—m
Ğ
PÜtAudioSŒ—m
 *
¡»am
 );

382 
PaE¼Ü
 
Pa_StİSŒ—m
Ğ
PÜtAudioSŒ—m
 *
¡»am
 );

384 
PaE¼Ü
 
Pa_AbÜtSŒ—m
Ğ
PÜtAudioSŒ—m
 *
¡»am
 );

397 
PaE¼Ü
 
Pa_SŒ—mAùive
Ğ
PÜtAudioSŒ—m
 *
¡»am
 );

406 
PaTime¡amp
 
Pa_SŒ—mTime
Ğ
PÜtAudioSŒ—m
 *
¡»am
 );

419 
Pa_G‘CPULßd
Ğ
PÜtAudioSŒ—m
* 
¡»am
 );

436 
Pa_G‘MšNumBufãrs
Ğ
äamesP”Bufãr
, 
§m¶eR©e
 );

448 
Pa_SË•
Ğ
m£c
 );

457 
PaE¼Ü
 
Pa_G‘Sam¶eSize
Ğ
PaSam¶eFÜm©
 
fÜm©
 );

460 #ifdeà
__ılu¥lus


	@portaudio/pa_mac/pa_mac.c

80 
	~<¡dio.h
>

81 
	~<¡dlib.h
>

82 
	~<¡ršg.h
>

83 
	~<memÜy.h
>

84 
	~<m©h.h
>

87 
	~"OSUts.h
"

88 
	~<MacTy³s.h
>

89 
	~<M©h64.h
>

90 
	~<E¼Üs.h
>

91 
	~<Sound.h
>

92 
	~<SoundIÅut.h
>

93 
	~<SoundCompÚ’ts.h
>

94 
	~<Deviûs.h
>

95 
	~<D©eTimeUts.h
>

96 
	~<Tim”.h
>

97 
	~<Ge¡®t.h
>

99 
	~"pÜudio.h
"

100 
	~"·_ho¡.h
"

101 
	~"·_Œaû.h
"

103 #iâdeà
FALSE


104 
	#FALSE
 (0)

	)

105 
	#TRUE
 (!
FALSE
)

	)

116 
	#PA_MAX_USAGE_ALLOWED
 (0.92)

	)

119 
	#PRINT
(
x
è{ 
´štf
 x; 
	`fæush
(
¡dout
); }

	)

120 
	#ERR_RPT
(
x
è
	`PRINT
(x)

	)

121 
	#DBUG
(
x
è

	)

122 
	#DBUGX
(
x
è

	)

124 
	#MAC_PHYSICAL_FRAMES_PER_BUFFER
 (512è

	)

125 
	#MAC_VIRTUAL_FRAMES_PER_BUFFER
 (4096è

	)

126 
	#PA_MIN_NUM_HOST_BUFFERS
 (2)

	)

127 
	#PA_MAX_NUM_HOST_BUFFERS
 (16è

	)

128 
	#PA_MAX_DEVICE_INFO
 (32)

	)

131 
	#DoubËToUnsigÃdFixed
(
x
è((
UnsigÃdFixed
è((xè* 65536.0))

	)

132 
	#UnsigÃdFixedToDoubË
(
fx
è((()(fx)è* (1.0/(1<<16)))

	)

138 
	sMuÉiBufãr


140 *
	mbufãrs
[
PA_MAX_NUM_HOST_BUFFERS
];

141 
	mnumBufãrs
;

142 
	mÃxtWr™e
;

143 
	mÃxtR—d
;

145 
	tMuÉiBufãr
;

148 
	sPaHo¡SoundCÚŒŞ


150 
UIÁ64
 
	m·hsc_EÁryCouÁ
;

151 
	m·hsc_Inv”£MiüosP”Ho¡Bufãr
;

154 vŞ©
	m·hsc_IsRecÜdšg
;

155 vŞ©
	m·hsc_StİRecÜdšg
;

156 vŞ©
	m·hsc_IfInsideC®lback
;

158 
SPB
 
	m·hsc_IÅutP¬ams
;

159 
SICom¶‘iÚUPP
 
	m·hsc_IÅutCom¶‘iÚProc
;

160 
MuÉiBufãr
 
	m·hsc_IÅutMuÉiBufãr
;

161 
št32
 
	m·hsc_By‹sP”IÅutHo¡Bufãr
;

162 
št32
 
	m·hsc_IÅutRefNum
;

164 
CmpSoundH—d”
 
	m·hsc_SoundH—d”s
[
PA_MAX_NUM_HOST_BUFFERS
];

165 
št32
 
	m·hsc_By‹sP”OuutHo¡Bufãr
;

166 
SndChªÃlPŒ
 
	m·hsc_ChªÃl
;

167 
SndC®lBackUPP
 
	m·hsc_OuutCom¶‘iÚProc
;

168 
št32
 
	m·hsc_NumOutsQueued
;

169 
št32
 
	m·hsc_NumOutsPÏyed
;

170 
PaTime¡amp
 
	m·hsc_NumF¿mesDÚe
;

171 
UIÁ64
 
	m·hsc_Wh’F¿mesDÚeInüem’‹d
;

173 
št32
 
	m·hsc_NumHo¡Bufãrs
;

174 
št32
 
	m·hsc_F¿mesP”Ho¡Bufãr
;

175 
št32
 
	m·hsc_U£rBufãrsP”Ho¡Bufãr
;

176 
št32
 
	m·hsc_MšF¿mesP”Ho¡Bufãr
;

178 
	tPaHo¡SoundCÚŒŞ
;

181 
	sš‹º®PÜtAudioDeviû


183 
	m·d_DeviûRefNum
;

184 
	m·d_DeviûBufãrSize
;

185 
CompÚ’t
 
	m·d_Id’tif›r
;

186 
PaDeviûInfo
 
	m·d_Info
;

188 
	tš‹º®PÜtAudioDeviû
;

193 
	gsNumDeviûs
 = 0;

194 
š‹º®PÜtAudioDeviû
 
	gsDeviûs
[
PA_MAX_DEVICE_INFO
] = { 0 };

195 
št32
 
	gsPaHo¡E¼Ü
 = 0;

196 
	gsDeçuÉOuutDeviûID
;

197 
	gsDeçuÉIÅutDeviûID
;

202 
PaE¼Ü
 
PaMac_TimeSliû
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
št16
 *
macOuutBufPŒ
 );

203 
PaE¼Ü
 
PaMac_C®lU£rLoİ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
št16
 *
outPŒ
 );

204 
PaE¼Ü
 
PaMac_RecÜdNext
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

205 
PaMac_S¹LßdC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

206 
PaMac_G‘MšNumBufãrs
Ğ
mšF¿mesP”Ho¡Bufãr
, 
äamesP”Bufãr
, 
§m¶eR©e
 );

207 *
PaMac_G‘Sam¶eR©esFromHªdË
 ( 
numR©es
, 
HªdË
 
h
 );

208 
PaE¼Ü
 
PaMac_SÿnIÅutDeviûs
( );

209 
PaE¼Ü
 
PaMac_SÿnOuutDeviûs
( );

210 
PaE¼Ü
 
PaMac_Qu”yOuutDeviûInfo
Ğ
CompÚ’t
 
id’tif›r
, 
š‹º®PÜtAudioDeviû
 *
ad
 );

211 
PaE¼Ü
 
PaMac_Qu”yIÅutDeviûInfo
Ğ
SŒ255
 
deviûName
, 
š‹º®PÜtAudioDeviû
 *
ad
 );

212 
PaMac_In™SoundH—d”
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
CmpSoundH—d”
 *
¢dH—d”
 );

213 
PaMac_EndLßdC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

214 
PaMac_PÏyNext
 ( 
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
šdex
 );

215 
PaMac_FlNextOuutBufãr
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
šdex
 );

216 
·sÿl
 
PaMac_IÅutCom¶‘iÚProc
(
SPBPŒ
 
»cP¬ams
);

217 
·sÿl
 
PaMac_OuutCom¶‘iÚProc
 (
SndChªÃlPŒ
 
theChªÃl
, 
SndCommªd
 * 
theCmd
);

218 
PaE¼Ü
 
PaMac_BackgroundMªag”
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
šdex
 );

219 
PaHo¡_G‘TÙ®BufãrF¿mes
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

220 
Mac_IsVœtu®MemÜyOn
( );

221 
PToCSŒšg
(* 
šSŒšg
, * 
outSŒšg
);

222 
CToPSŒšg
(*
šSŒšg
, * 
outSŒšg
);

223 *
MuÉiBufãr_G‘NextWr™eBufãr
Ğ
MuÉiBufãr
 *
mbuf
 );

224 *
MuÉiBufãr_G‘NextR—dBufãr
Ğ
MuÉiBufãr
 *
mbuf
 );

225 
MuÉiBufãr_G‘NextR—dIndex
Ğ
MuÉiBufãr
 *
mbuf
 );

226 
MuÉiBufãr_G‘NextWr™eIndex
Ğ
MuÉiBufãr
 *
mbuf
 );

227 
MuÉiBufãr_IsWr™—bË
Ğ
MuÉiBufãr
 *
mbuf
 );

228 
MuÉiBufãr_IsR—dabË
Ğ
MuÉiBufãr
 *
mbuf
 );

229 
MuÉiBufãr_AdvªûR—dIndex
Ğ
MuÉiBufãr
 *
mbuf
 );

230 
MuÉiBufãr_AdvªûWr™eIndex
Ğ
MuÉiBufãr
 *
mbuf
 );

237 *
	$MuÉiBufãr_G‘NextWr™eBufãr
Ğ
MuÉiBufãr
 *
mbuf
 )

239  
mbuf
->
bufãrs
[mbuf->
ÃxtWr™e
 % mbuf->
numBufãrs
];

240 
	}
}

241 *
	$MuÉiBufãr_G‘NextR—dBufãr
Ğ
MuÉiBufãr
 *
mbuf
 )

243  
mbuf
->
bufãrs
[mbuf->
ÃxtR—d
 % mbuf->
numBufãrs
];

244 
	}
}

245 
	$MuÉiBufãr_G‘NextR—dIndex
Ğ
MuÉiBufãr
 *
mbuf
 )

247  
mbuf
->
ÃxtR—d
 % mbuf->
numBufãrs
;

248 
	}
}

249 
	$MuÉiBufãr_G‘NextWr™eIndex
Ğ
MuÉiBufãr
 *
mbuf
 )

251  
mbuf
->
ÃxtWr™e
 % mbuf->
numBufãrs
;

252 
	}
}

254 
	$MuÉiBufãr_IsWr™—bË
Ğ
MuÉiBufãr
 *
mbuf
 )

256 
bufsFuÎ
 = 
mbuf
->
ÃxtWr™e
 - mbuf->
ÃxtR—d
;

257 ifĞ
bufsFuÎ
 < 0 ) bufsFuÎ +ğ(2 * 
mbuf
->
numBufãrs
);

258  (
bufsFuÎ
 < 
mbuf
->
numBufãrs
);

259 
	}
}

260 
	$MuÉiBufãr_IsR—dabË
Ğ
MuÉiBufãr
 *
mbuf
 )

262 
bufsFuÎ
 = 
mbuf
->
ÃxtWr™e
 - mbuf->
ÃxtR—d
;

263 ifĞ
bufsFuÎ
 < 0 ) bufsFuÎ +ğ(2 * 
mbuf
->
numBufãrs
);

264  (
bufsFuÎ
 > 0);

265 
	}
}

266 
	$MuÉiBufãr_AdvªûR—dIndex
Ğ
MuÉiBufãr
 *
mbuf
 )

268 
‹mp
 = 
mbuf
->
ÃxtR—d
 + 1;

269 
mbuf
->
ÃxtR—d
 = (
‹mp
 >ğ(2 * mbuf->
numBufãrs
)) ? 0 :emp;

270 
	}
}

271 
	$MuÉiBufãr_AdvªûWr™eIndex
Ğ
MuÉiBufãr
 *
mbuf
 )

273 
‹mp
 = 
mbuf
->
ÃxtWr™e
 + 1;

274 
mbuf
->
ÃxtWr™e
 = (
‹mp
 >ğ(2 * mbuf->
numBufãrs
)) ? 0 :emp;

275 
	}
}

280 
	$PToCSŒšg
(* 
šSŒšg
, * 
outSŒšg
)

282 
i
;

283 
i
=0; i<
šSŒšg
[0]; i++)

284 
outSŒšg
[
i
] = 
šSŒšg
[i+1];

285 
outSŒšg
[
i
]=0;

286 
	}
}

291 
	$CToPSŒšg
(* 
šSŒšg
, * 
outSŒšg
)

293 
Ën
 = 
	`¡¾’
(
šSŒšg
);

294 
i
;

296 ià(
Ën
 > 255)

297 
Ën
 = 255;

300 
outSŒšg
[0] = ()
Ën
;

301 
i
=0; i<
Ën
; i++)

302 
outSŒšg
[
i
+1] = 
šSŒšg
[i];

303 
	}
}

306 
PaE¼Ü
 
	$PaHo¡_T”m
( )

308 
i
;

309 
PaDeviûInfo
 *
dev
;

310 *
¿‹s
;

312  
i
=0; i<
sNumDeviûs
; i++ )

314 
dev
 = &
sDeviûs
[
i
].
·d_Info
;

315 
¿‹s
 = (*è
dev
->
§m¶eR©es
;

316 ifĞ(
¿‹s
 !ğ
NULL
èè
	`ä“
(„ates );

317 
dev
->
§m¶eR©es
 = 
NULL
;

318 ifĞ
dev
->
Çme
 !ğ
NULL
 ) 
	`ä“
( (*) dev->name );

319 
dev
->
Çme
 = 
NULL
;

321 
sNumDeviûs
 = 0;

322  
·NoE¼Ü
;

323 
	}
}

329 
PaE¼Ü
 
	$PaHo¡_In™
( )

331 
PaE¼Ü
 
”r
;

332 
NumV”siÚV¬ŸÁ
 
v”siÚ
;

334 
v”siÚ
.
·¹s
 = 
	`SndSoundMªag”V”siÚ
();

335 
	`DBUG
(("SndSoundMªag”V”siÚ = 0x%x\n", 
v”siÚ
.
whŞe
));

338 
”r
 = (
PaE¼Ü
è
	`Pa_CouÁDeviûs
();

339 ifĞ
”r
 < 0 ) ƒrr;

340  
·NoE¼Ü
;

341 
	}
}

346 
PaE¼Ü
 
	$PaMac_SÿnOuutDeviûs
( )

348 
PaE¼Ü
 
”r
;

349 
CompÚ’t
 
id’tif›r
=0;

350 
CompÚ’tDesütiÚ
 
ü™”Ÿ
 = { 
kSoundOuutDeviûTy³
, 0, 0, 0, 0 };

351 
numCompÚ’ts
, 
i
;

354 
numCompÚ’ts
 = 
	`CouÁCompÚ’ts
 (&
ü™”Ÿ
);

355 
id’tif›r
 = 0;

356 
sDeçuÉOuutDeviûID
 = 
sNumDeviûs
;

357 
i
 = 0; i < 
numCompÚ’ts
; i++)

360 
id’tif›r
 = 
	`FšdNextCompÚ’t
Ğid’tif›r, &
ü™”Ÿ
);

361 
sDeviûs
[
sNumDeviûs
].
·d_Id’tif›r
 = 
id’tif›r
;

364 
”r
 = 
	`PaMac_Qu”yOuutDeviûInfo
Ğ
id’tif›r
, &
sDeviûs
[
sNumDeviûs
] );

365 ifĞ
”r
 < 0 ) ƒrr;

366 
sNumDeviûs
++;

370  
·NoE¼Ü
;

371 
	}
}

376 
PaE¼Ü
 
	$PaMac_SÿnIÅutDeviûs
( )

378 
SŒ255
 
deviûName
;

379 
couÁ
;

380 
HªdË
 
icÚHªdË
;

381 
PaE¼Ü
 
”r
;

382 
OSE¼
 
o£¼
;

383 
couÁ
 = 1;

384 
sDeçuÉIÅutDeviûID
 = 
sNumDeviûs
;

385 
Œue
)

388 
o£¼
 = 
	`SPBG‘IndexedDeviû
(
couÁ
++, 
deviûName
, &
icÚHªdË
);

389 
	`DBUG
(("PaMac_SÿnIÅutDeviûs: SPBG‘IndexedDeviû„‘uºed %d\n", 
o£¼
 ));

392 if(
o£¼
 !ğ
noE¼
) ;

394 if(
o£¼
 =ğ
siBadSoundInDeviû
)

396 
o£¼
 = 
noE¼
;

399 if(
o£¼
 !ğ
noE¼
)

401 
	`ERR_RPT
(("ERROR: SPBG‘IndexedDeviû(%d,,è»tuºed %d\n", 
couÁ
-1, 
o£¼
 ));

402 
sPaHo¡E¼Ü
 = 
o£¼
;

403  
·Ho¡E¼Ü
;

406 
	`Di¥o£HªdË
(
icÚHªdË
);

408 
”r
 = 
	`PaMac_Qu”yIÅutDeviûInfo
Ğ
deviûName
, &
sDeviûs
[
sNumDeviûs
] );

409 
	`DBUG
(("PaMac_SÿnIÅutDeviûs: PaMac_Qu”yIÅutDeviûInfØ»tuºed %d\n", 
”r
 ));

410 ifĞ
”r
 < 0 ) ƒrr;

411 ifĞ
”r
 =ğ1 ) 
sNumDeviûs
++;

414  
·NoE¼Ü
;

415 
	}
}

419 #´agm¨
İtiÚs
 
®ign
=
mac68k


422 
št16
 
	mnumR©es
;

423 
UnsigÃdFixed
 (**
¿‹s
)[];

425 
	tSR©eInfo
;

426 #´agm¨
İtiÚs
 
®ign
=
»£t


436 
PaE¼Ü
 
	$PaMac_Qu”yOuutDeviûInfo
Ğ
CompÚ’t
 
id’tif›r
, 
š‹º®PÜtAudioDeviû
 *
ad
 )

438 
Ën
;

439 
OSE¼
 
”r
;

440 
PaDeviûInfo
 *
dev
 = &
ad
->
·d_Info
;

441 
SR©eInfo
 
¤šfo
 = {0};

442 
numR©es
;

443 
CompÚ’tDesütiÚ
 
‹mpD
;

444 
HªdË
 
ÇmeH
=
n
, 
šfoH
ò, 
icÚH
=nil;

446 
	`mem£t
Ğ
ad
, 0, (
š‹º®PÜtAudioDeviû
) );

448 
dev
->
¡ruùV”siÚ
 = 1;

449 
dev
->
maxIÅutChªÃls
 = 0;

450 
dev
->
maxOuutChªÃls
 = 2;

451 
dev
->
ÇtiveSam¶eFÜm©s
 = 
·IÁ16
;

454 
”r
 = 
	`G‘SoundOuutInfo
(
id’tif›r
, 
siSam¶eR©eAvaabË
, (
PŒ
è&
¤šfo
);

455 if(
”r
 !ğ
noE¼
)

457 
	`ERR_RPT
(("E¼Ü iÀPaMac_Qu”yOuutDeviûInfo: G‘SoundOuutInfØsiSam¶eR©eAvaabË„‘uºed %d\n", 
”r
 ));

458 
”rÜ
;

460 
numR©es
 = 
¤šfo
.numRates;

461 
	`DBUG
(("PaMac_Qu”yOuutDeviûInfo: sršfo.numR©e ğ%d\n", 
¤šfo
.
numR©es
 ));

462 ifĞ
numR©es
 == 0 )

464 
dev
->
numSam¶eR©es
 = -1;

465 
numR©es
 = 2;

469 
dev
->
numSam¶eR©es
 = 
numR©es
;

471 
dev
->
§m¶eR©es
 = 
	`PaMac_G‘Sam¶eR©esFromHªdË
Ğ
numR©es
, (
HªdË
è
¤šfo
.
¿‹s
 );

472 if(
dev
->
§m¶eR©es
 =ğ
NULL
)

474 
	`DBUG
(("PaMac_QueryOutputDeviceInfo: PaMac_GetSampleRatesFromHandle‡lloc failed.\n"));

475  
·Insuffic›ÁMemÜy
;

479 
	`Di¥o£HªdË
((
HªdË
è
¤šfo
.
¿‹s
);

484 
	`DBUG
(("PaMac_QueryOutputDeviceInfo: get component‚ame.\n"));

485 
šfoH
 = 
n
;

486 
icÚH
 = 
n
;

487 
ÇmeH
 = 
	`NewHªdË
(0);

488 if(
ÇmeH
 =ğ
n
è 
·Insuffic›ÁMemÜy
;

489 
”r
 = 
	`G‘CompÚ’tInfo
(
id’tif›r
, &
‹mpD
, 
ÇmeH
, 
šfoH
, 
icÚH
);

490 ià(
”r
)

492 
	`ERR_RPT
(("E¼Ü iÀPaMac_Qu”yOuutDeviûInfo: G‘CompÚ’tInfØ»tuºed %d\n", 
”r
 ));

493 
”rÜ
;

496 
Ën
 = ((*)(*
ÇmeH
))[0] + 1;

497 
	`DBUG
(("PaMac_Qu”yOuutDeviûInfo:‚ew†’ = %d\n", 
Ën
 ));

499 
dev
->
Çme
 = (*è
	`m®loc
(
Ën
);

500 ifĞ
dev
->
Çme
 =ğ
NULL
 )

502 
	`Di¥o£HªdË
(
ÇmeH
);

503  
·Insuffic›ÁMemÜy
;

507 
	`PToCSŒšg
((*)(*
ÇmeH
), (*è
dev
->
Çme
);

508 
	`Di¥o£HªdË
(
ÇmeH
);

511 
	`DBUG
(("PaMac_Qu”yOuutDeviûInfo: dev->Çmğ%s\n", 
dev
->
Çme
 ));

512  
·NoE¼Ü
;

514 
”rÜ
:

515 
sPaHo¡E¼Ü
 = 
”r
;

516  
·Ho¡E¼Ü
;

518 
	}
}

528 
PaE¼Ü
 
	$PaMac_Qu”yIÅutDeviûInfo
Ğ
SŒ255
 
deviûName
, 
š‹º®PÜtAudioDeviû
 *
ad
 )

530 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

531 
Ën
;

532 
OSE¼
 
”r
;

533 
mRefNum
 = 0;

534 
‹mpL
;

535 
št16
 
‹mpS
;

536 
Fixed
 
‹mpF
;

537 
PaDeviûInfo
 *
dev
 = &
ad
->
·d_Info
;

538 
SR©eInfo
 
¤šfo
 = {0};

539 
numR©es
;

541 
	`mem£t
Ğ
ad
, 0, (
š‹º®PÜtAudioDeviû
) );

542 
dev
->
maxOuutChªÃls
 = 0;

545 
”r
 = 
	`SPBO³nDeviû
Ğ
deviûName
, 
siWr™eP”missiÚ
, &
mRefNum
);

546 ià(
”r
)

549 
”r
 = 
	`SPBO³nDeviû
Ğ
deviûName
, 
siR—dP”missiÚ
, &
mRefNum
);

550 ià(
”r
)

552 
	`ERR_RPT
(("E¼Ü iÀPaMac_Qu”yIÅutDeviûInfo: SPBO³nDeviû„‘uºed %d\n", 
”r
 ));

553 
sPaHo¡E¼Ü
 = 
”r
;

554  
·Ho¡E¼Ü
;

559 
	#PrštDeviûInfo
(
£ËùÜ
,
v¬
) \

560 
”r
 = 
	`SPBG‘DeviûInfo
(
mRefNum
, 
£ËùÜ
, (
PŒ
è&
v¬
); \

561 ià(
”r
) { \

562 
	`DBUG
(("query %s failed\n", #selector )); \

565 
	`DBUG
(("qu”y % ğ0x%x\n", #£ËùÜ, 
v¬
 )); \

566 }

	)

568 
	`PrštDeviûInfo
Ğ
siCÚtšuous
, 
‹mpS
 );

569 
	`PrštDeviûInfo
Ğ
siAsync
, 
‹mpS
 );

570 
	`PrštDeviûInfo
Ğ
siNumb”ChªÃls
, 
‹mpS
 );

571 
	`PrštDeviûInfo
Ğ
siSam¶eSize
, 
‹mpS
 );

572 
	`PrštDeviûInfo
Ğ
siSam¶eR©e
, 
‹mpF
 );

573 
	`PrštDeviûInfo
Ğ
siChªÃlAvaabË
, 
‹mpS
 );

574 
	`PrštDeviûInfo
Ğ
siAùiveChªÃls
, 
‹mpL
 );

575 
	`PrštDeviûInfo
Ğ
siDeviûBufãrInfo
, 
‹mpL
 );

577 
”r
 = 
	`SPBG‘DeviûInfo
(
mRefNum
, 
siAùiveChªÃls
, (
PŒ
è&
‹mpL
);

578 ià(
”r
 =ğ0è
	`DBUG
(("% ğ0x%x\n", "siAùiveChªÃls", 
‹mpL
 ));

580 
”r
 = 
	`SPBG‘DeviûInfo
(
mRefNum
, 
siAsync
, (
PŒ
è&
‹mpS
);

581 ià(
”r
)

583 
	`ERR_RPT
(("E¼Ü iÀPaMac_Qu”yIÅutDeviûInfo: SPBG‘DeviûInfØsiAsynø»tuºed %d\n", 
”r
 ));

584 
”rÜ
;

586 ifĞ
‹mpS
 =ğ0 ) 
u£Ëss
;

588 
”r
 = 
	`SPBG‘DeviûInfo
(
mRefNum
, 
siChªÃlAvaabË
, (
PŒ
è&
‹mpS
);

589 ià(
”r
)

591 
	`ERR_RPT
(("E¼Ü iÀPaMac_Qu”yIÅutDeviûInfo: SPBG‘DeviûInfØsiChªÃlAvaabË„‘uºed %d\n", 
”r
 ));

592 
”rÜ
;

594 
dev
->
maxIÅutChªÃls
 = 
‹mpS
;

597 
”r
 = 
	`SPBG‘DeviûInfo
(
mRefNum
, 
siSam¶eR©eAvaabË
, (
PŒ
è&
¤šfo
);

598 ià(
”r
)

600 
	`ERR_RPT
(("E¼Ü iÀPaMac_Qu”yIÅutDeviûInfo: SPBG‘DeviûInfØsiSam¶eR©eAvaabË„‘uºed %d\n", 
”r
 ));

601 
”rÜ
;

604 
numR©es
 = 
¤šfo
.numRates;

605 
	`DBUG
(("numR©e ğ0x%x\n", 
numR©es
 ));

606 ifĞ
numR©es
 == 0 )

608 
dev
->
numSam¶eR©es
 = -1;

609 
numR©es
 = 2;

613 
dev
->
numSam¶eR©es
 = 
numR©es
;

615 
dev
->
§m¶eR©es
 = 
	`PaMac_G‘Sam¶eR©esFromHªdË
Ğ
numR©es
, (
HªdË
è
¤šfo
.
¿‹s
 );

617 
	`Di¥o£HªdË
((
HªdË
è
¤šfo
.
¿‹s
);

620 
”r
 = 
	`SPBG‘DeviûInfo
(
mRefNum
, 
siDeviûBufãrInfo
, (
PŒ
è&
‹mpL
);

621 ià(
”r
)

623 
	`ERR_RPT
(("E¼Ü iÀPaMac_Qu”yIÅutDeviûInfo: SPBG‘DeviûInfØsiDeviûBufãrInfØ»tuºed %d\n", 
”r
 ));

624 
”rÜ
;

626 
ad
->
·d_DeviûBufãrSize
 = 
‹mpL
;

627 
	`DBUG
(("siDeviûBufãrInfØğ%d\n", 
‹mpL
 ));

630 
”r
 = 
	`SPBG‘DeviûInfo
(
mRefNum
, 
siSam¶eSize
, (
PŒ
è&
‹mpS
);

631 ià(
”r
)

633 
	`ERR_RPT
(("E¼Ü iÀPaMac_Qu”yIÅutDeviûInfo: SPBG‘DeviûInfØsiSam¶eSiz»tuºed %d\n", 
”r
 ));

634 
”rÜ
;

636  
‹mpS
 )

639 
dev
->
ÇtiveSam¶eFÜm©s
 = 
·IÁ32
;

643 
dev
->
ÇtiveSam¶eFÜm©s
 = 
·IÁ16
;

646 
	`DBUG
(("ÇtiveSam¶eFÜm© ğ%d\n", 
dev
->
ÇtiveSam¶eFÜm©s
 ));

649 
Ën
 = 
deviûName
[0] + 1;

650 
dev
->
Çme
 = (*è
	`m®loc
(
Ën
);

651 ifĞ
dev
->
Çme
 =ğ
NULL
 )

653 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

654 
ş—nup
;

656 
	`PToCSŒšg
(
deviûName
, (*è
dev
->
Çme
);

657 
	`DBUG
(("deviûNamğ%s\n", 
dev
->
Çme
 ));

658 
»suÉ
 = (
PaE¼Ü
) 1;

660 
ş—nup
:

661 ifĞ
mRefNum
 ) 
	`SPBClo£Deviû
(mRefNum);

662  
»suÉ
;

664 
”rÜ
:

665 ifĞ
mRefNum
 ) 
	`SPBClo£Deviû
(mRefNum);

666 
sPaHo¡E¼Ü
 = 
”r
;

667  
·Ho¡E¼Ü
;

669 
u£Ëss
:

670 ifĞ
mRefNum
 ) 
	`SPBClo£Deviû
(mRefNum);

671  (
PaE¼Ü
) 0;

672 
	}
}

677 * 
	$PaMac_G‘Sam¶eR©esFromHªdË
 ( 
numR©es
, 
HªdË
 
h
 )

679 
OSE¼
 
”r
 = 
noE¼
;

680 
SIÁ8
 
hS‹
;

681 
i
;

682 
UnsigÃdFixed
 *
fixedR©es
;

683 *
¿‹s
 = (*è
	`m®loc
Ğ
numR©es
 * () );

684 ifĞ
¿‹s
 =ğ
NULL
 )  NULL;

688 
hS‹
 = 
	`HG‘S‹
 (
h
);

689 ià(!(
”r
 = 
	`MemE¼Ü
 ()))

691 
	`HLock
 (
h
);

692 ià(!(
”r
 = 
	`MemE¼Ü
 ( )))

694 
fixedR©es
 = (
UIÁ32
 *è*
h
;

695  
i
=0; i<
numR©es
; i++ )

697 
¿‹s
[
i
] = 
	`UnsigÃdFixedToDoubË
(
fixedR©es
[i]);

700 
	`HS‘S‹
 (
h
,
hS‹
);

701 
”r
 = 
	`MemE¼Ü
 ( );

704 ifĞ
”r
 )

706 
	`ä“
Ğ
¿‹s
 );

707 
	`ERR_RPT
(("E¼Ü iÀPaMac_G‘Sam¶eR©esFromHªdË = %d\n", 
”r
 ));

709  
¿‹s
;

710 
	}
}

713 
	$Pa_CouÁDeviûs
()

715 
PaE¼Ü
 
”r
;

716 
	`DBUG
(("Pa_CountDevices()\n"));

718 ifĞ
sNumDeviûs
 <= 0 )

720 
”r
 = 
	`PaMac_SÿnOuutDeviûs
();

721 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

722 
”r
 = 
	`PaMac_SÿnIÅutDeviûs
();

723 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

725  
sNumDeviûs
;

727 
”rÜ
:

728 
	`PaHo¡_T”m
();

729 
	`DBUG
(("Pa_CouÁDeviûs:„‘uº %d\n", 
”r
 ));

730  
”r
;

732 
	}
}

735 cÚ¡ 
PaDeviûInfo
* 
	$Pa_G‘DeviûInfo
Ğ
PaDeviûID
 
id
 )

737 ifĞ(
id
 < 0è|| ( id >ğ
	`Pa_CouÁDeviûs
()èè 
NULL
;

738  &
sDeviûs
[
id
].
·d_Info
;

739 
	}
}

741 
PaDeviûID
 
	$Pa_G‘DeçuÉIÅutDeviûID
( )

743  
sDeçuÉIÅutDeviûID
;

744 
	}
}

747 
PaDeviûID
 
	$Pa_G‘DeçuÉOuutDeviûID
( )

749  
sDeçuÉOuutDeviûID
;

750 
	}
}

753 
	$PaMac_S¹LßdC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

755 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

756 
UnsigÃdWide
 
widePad
;

757 ifĞ
·hsc
 =ğ
NULL
 ) ;

759 
	`Miüo£cÚds
Ğ&
widePad
 );

760 
·hsc
->
·hsc_EÁryCouÁ
 = 
	`UnsigÃdWideToUIÁ64
Ğ
widePad
 );

761 
	}
}

768 
	$PaMac_EndLßdC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

770 
UnsigÃdWide
 
widePad
;

771 
UIÁ64
 
cu¼’tCouÁ
;

772 
u£csEÏp£d
;

773 
ÃwU§ge
;

774 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

775 ifĞ
·hsc
 =ğ
NULL
 ) ;

780 
	#LOWPASS_COEFFICIENT_0
 (0.95)

	)

781 
	#LOWPASS_COEFFICIENT_1
 (0.99999 - 
LOWPASS_COEFFICIENT_0
)

	)

782 
	`Miüo£cÚds
Ğ&
widePad
 );

783 
cu¼’tCouÁ
 = 
	`UnsigÃdWideToUIÁ64
Ğ
widePad
 );

785 
u£csEÏp£d
 = (è
	`U64SubŒaù
(
cu¼’tCouÁ
, 
·hsc
->
·hsc_EÁryCouÁ
);

788 
ÃwU§ge
 = 
u£csEÏp£d
 * 
·hsc
->
·hsc_Inv”£MiüosP”Ho¡Bufãr
;

790 
·¡
->
·¡_U§ge
 = (
LOWPASS_COEFFICIENT_0
 *…ast->past_Usage) +

791 (
LOWPASS_COEFFICIENT_1
 * 
ÃwU§ge
);

793 
	}
}

798 
PaE¼Ü
 
	$PaHo¡_S¹IÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

800 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

801 
·hsc
->
·hsc_IsRecÜdšg
 = 0;

802 
·hsc
->
·hsc_StİRecÜdšg
 = 0;

803 
·hsc
->
·hsc_IÅutMuÉiBufãr
.
ÃxtWr™e
 = 0;

804 
·hsc
->
·hsc_IÅutMuÉiBufãr
.
ÃxtR—d
 = 0;

805  
	`PaMac_RecÜdNext
Ğ
·¡
 );

806 
	}
}

813 
PaE¼Ü
 
	$PaHo¡_StİIÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

815 
št32
 
timeOutM£c
;

816 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

817 
OSE¼
 
”r
 = 0;

818 
mRefNum
;

819 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

820 ifĞ
·hsc
 =ğ
NULL
 )  
·NoE¼Ü
;

822 (è
abÜt
;

824 
mRefNum
 = 
·hsc
->
·hsc_IÅutRefNum
;

826 
	`DBUG
(("PaHo¡_StİIÅut: mRefNum = %d\n", 
mRefNum
 ));

827 ifĞ
mRefNum
 )

829 
	`DBUG
(("PaHo¡_StİIÅut:…ahsc_IsRecÜdšg = %d\n", 
·hsc
->
·hsc_IsRecÜdšg
 ));

830 ifĞ
·hsc
->
·hsc_IsRecÜdšg
 )

833 
·hsc
->
·hsc_StİRecÜdšg
 = 1;

834 
”r
 = 
	`SPBStİRecÜdšg
(
mRefNum
);

835 
	`DBUG
(("PaHo¡_StİIÅut:h’…ahsc_IsRecÜdšg = %d\n", 
·hsc
->
·hsc_IsRecÜdšg
 ));

838 
timeOutM£c
 = (
št32
è((1500.0 * 
·hsc
->
·hsc_F¿mesP”Ho¡Bufãr
è/ 
·¡
->
·¡_Sam¶eR©e
);

840  !
”r
 && 
·hsc
->
·hsc_IsRecÜdšg
 && (
timeOutM£c
 > 0))

842 
	`Pa_SË•
(20);

843 
timeOutM£c
 -= 20;

845 ifĞ
timeOutM£c
 <= 0 )

847 
	`ERR_RPT
(("PaHost_StopInput:imed out!\n"));

848  
·TimedOut
;

852 ifĞ
”r
 )

854 
sPaHo¡E¼Ü
 = 
”r
;

855 
»suÉ
 = 
·Ho¡E¼Ü
;

858 
	`DBUG
(("PaHo¡_StİIÅut: fšished.\n", 
mRefNum
 ));

859  
»suÉ
;

860 
	}
}

863 
	$PaMac_In™SoundH—d”
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
CmpSoundH—d”
 *
¢dH—d”
 )

865 
¢dH—d”
->
numChªÃls
 = 
·¡
->
·¡_NumOuutChªÃls
;

866 
¢dH—d”
->
§m¶eR©e
 = 
	`DoubËToUnsigÃdFixed
(
·¡
->
·¡_Sam¶eR©e
);

867 
¢dH—d”
->
loİS¹
 = 0;

868 
¢dH—d”
->
loİEnd
 = 0;

869 
¢dH—d”
->
’code
 = 
cmpSH
;

870 
¢dH—d”
->
ba£F»qu’cy
 = 
kMiddËC
;

871 
¢dH—d”
->
m¬k”Chunk
 = 
n
;

872 
¢dH—d”
->
futu»U£2
 = 
n
;

873 
¢dH—d”
->
¡©eV¬s
 = 
n
;

874 
¢dH—d”
->
ËáOv”Sam¶es
 = 
n
;

875 
¢dH—d”
->
com´essiÚID
 = 0;

876 
¢dH—d”
->
·ck‘Size
 = 0;

877 
¢dH—d”
->
¢thID
 = 0;

878 
¢dH—d”
->
§m¶eSize
 = 8 * (
št16
);

879 
¢dH—d”
->
§m¶eA»a
[0] = 0;

880 
¢dH—d”
->
fÜm©
 = 
kSoundNÙCom´es£d
;

881 
	}
}

883 
	$S‘F¿mesDÚe
Ğ
PaHo¡SoundCÚŒŞ
 *
·hsc
, 
PaTime¡amp
 
äamesDÚe
 )

885 
UnsigÃdWide
 
now
;

886 
	`Miüo£cÚds
Ğ&
now
 );

887 
·hsc
->
·hsc_NumF¿mesDÚe
 = 
äamesDÚe
;

888 
·hsc
->
·hsc_Wh’F¿mesDÚeInüem’‹d
 = 
	`UnsigÃdWideToUIÁ64
Ğ
now
 );

889 
	}
}

892 
PaE¼Ü
 
	$PaHo¡_S¹Ouut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

894 
SndCommªd
 
·u£Commªd
;

895 
SndCommªd
 
»sumeCommªd
;

896 
i
;

897 
OSE¼
 
”rÜ
;

898 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

899 ifĞ
·hsc
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

900 ifĞ
·hsc
->
·hsc_ChªÃl
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

902 
·¡
->
·¡_StİSoÚ
 = 0;

903 
·¡
->
·¡_IsAùive
 = 1;

904 
·hsc
->
·hsc_NumOutsQueued
 = 0;

905 
·hsc
->
·hsc_NumOutsPÏyed
 = 0;

907 
	`S‘F¿mesDÚe
Ğ
·hsc
, 0.0 );

910 
·u£Commªd
.
cmd
 = 
·u£Cmd
;

911 
·u£Commªd
.
·¿m1
 =…au£Commªd.
·¿m2
 = 0;

912 
”rÜ
 = 
	`SndDoCommªd
 (
·hsc
->
·hsc_ChªÃl
, &
·u£Commªd
, 
Œue
);

913 ià(
noE¼
 !ğ
”rÜ
è
ex™
;

916 
i
 = 0; i<
·hsc
->
·hsc_NumHo¡Bufãrs
; i++)

918 
	`PaMac_PÏyNext
Ğ
·¡
, 
i
 );

922 
»sumeCommªd
.
cmd
 = 
»sumeCmd
;

923 
»sumeCommªd
.
·¿m1
 =„esumeCommªd.
·¿m2
 = 0;

924 
”rÜ
 = 
	`SndDoImmedŸ‹
Ğ
·hsc
->
·hsc_ChªÃl
, &
»sumeCommªd
 );

925 ià(
noE¼
 !ğ
”rÜ
è
ex™
;

927  
·NoE¼Ü
;

928 
ex™
:

929 
·¡
->
·¡_IsAùive
 = 0;

930 
sPaHo¡E¼Ü
 = 
”rÜ
;

931 
	`ERR_RPT
(("E¼Ü iÀPaHo¡_S¹Ouut: SndDoCommªd„‘uºed %d\n", 
”rÜ
 ));

932  
·Ho¡E¼Ü
;

933 
	}
}

936 
	$PaHo¡_G‘TÙ®BufãrF¿mes
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

938 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

939  (è(
·hsc
->
·hsc_NumHo¡Bufãrs
 *…ahsc->
·hsc_F¿mesP”Ho¡Bufãr
);

940 
	}
}

947 
PaE¼Ü
 
	$PaHo¡_StİOuut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

949 
št32
 
timeOutM£c
;

950 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

951 ifĞ
·hsc
 =ğ
NULL
 )  
·NoE¼Ü
;

952 ifĞ
·hsc
->
·hsc_ChªÃl
 =ğ
NULL
 )  
·NoE¼Ü
;

954 
	`DBUG
(("PaHost_StopOutput()\n"));

955 ifĞ
·¡
->
·¡_IsAùive
 =ğ0 )  
·NoE¼Ü
;

958 ifĞ
abÜt
 ) 
·¡
->
·¡_StİNow
 = 1;

959 
·¡
->
·¡_StİSoÚ
 = 1;

961 
timeOutM£c
 = (
št32
è((1500.0 * 
	`PaHo¡_G‘TÙ®BufãrF¿mes
Ğ
·¡
 )è/…a¡->
·¡_Sam¶eR©e
);

963  
·¡
->
·¡_IsAùive
 && (
timeOutM£c
 > 0))

965 
	`Pa_SË•
(20);

966 
timeOutM£c
 -= 20;

968 ifĞ
timeOutM£c
 <= 0 )

970 
	`ERR_RPT
(("PaHost_StopOutput:imed out!\n"));

971  
·TimedOut
;

973  
·NoE¼Ü
;

974 
	}
}

977 
PaE¼Ü
 
	$PaHo¡_S¹Engše
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

979 (è
·¡
;

980  
·NoE¼Ü
;

981 
	}
}

984 
PaE¼Ü
 
	$PaHo¡_StİEngše
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

986 (è
·¡
;

987 (è
abÜt
;

988  
·NoE¼Ü
;

989 
	}
}

991 
PaE¼Ü
 
	$PaHo¡_SŒ—mAùive
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

993 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

994  (
PaE¼Ü
èĞ
·¡
->
·¡_IsAùive
 + 
·hsc
->
·hsc_IsRecÜdšg
 );

995 
	}
}

996 
	$Mac_IsVœtu®MemÜyOn
( )

998 
©Œ
;

999 
OSE¼
 
»suÉ
 = 
	`Ge¡®t
Ğ
ge¡®tVMA‰r
, &
©Œ
 );

1000 
	`DBUG
(("ge¡®tVMA‰¸: 0x%x\n", 
©Œ
 ));

1001  ((
©Œ
 >> 
ge¡®tVMHasPagšgCÚŒŞ
 ) & 1);

1002 
	}
}

1008 
	$PaHo¡_C®cNumHo¡Bufãrs
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1010 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

1011 
št32
 
mšNumBufãrs
;

1012 
št32
 
mšF¿mesP”Ho¡Bufãr
;

1013 
št32
 
mšTÙ®F¿mes
;

1014 
št32
 
u£rBufãrsP”Ho¡Bufãr
;

1015 
št32
 
äamesP”Ho¡Bufãr
;

1016 
št32
 
numHo¡Bufãrs
;

1018 
mšF¿mesP”Ho¡Bufãr
 = 
·hsc
->
·hsc_MšF¿mesP”Ho¡Bufãr
;

1019 
mšF¿mesP”Ho¡Bufãr
 = (minFramesPerHostBuffer + 7) & ~7;

1020 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs: mšF¿mesP”Ho¡Bufã¸ğ%d\n", 
mšF¿mesP”Ho¡Bufãr
 ));

1027 
mšNumBufãrs
 = 
	`PaMac_G‘MšNumBufãrs
Ğ
mšF¿mesP”Ho¡Bufãr
, 
·¡
->
·¡_F¿mesP”U£rBufãr
,…a¡->
·¡_Sam¶eR©e
 );

1029 
·¡
->
·¡_NumU£rBufãrs
 = ( 
mšNumBufãrs
 >…ast->past_NumUserBuffers ) ? minNumBuffers :…ast->past_NumUserBuffers;

1030 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs: mš…a¡_NumU£rBufãr ğ%d\n", 
·¡
->
·¡_NumU£rBufãrs
 ));

1031 
mšTÙ®F¿mes
 = 
·¡
->
·¡_NumU£rBufãrs
 *…a¡->
·¡_F¿mesP”U£rBufãr
;

1034 ifĞ(
št32
è
·¡
->
·¡_F¿mesP”U£rBufãr
 < 
mšF¿mesP”Ho¡Bufãr
 )

1036 
u£rBufãrsP”Ho¡Bufãr
 =

1037 (
mšF¿mesP”Ho¡Bufãr
 + 
·¡
->
·¡_F¿mesP”U£rBufãr
 - 1) /

1038 
·¡
->
·¡_F¿mesP”U£rBufãr
;

1042 
u£rBufãrsP”Ho¡Bufãr
 = 1;

1044 
äamesP”Ho¡Bufãr
 = 
·¡
->
·¡_F¿mesP”U£rBufãr
 * 
u£rBufãrsP”Ho¡Bufãr
;

1047 
numHo¡Bufãrs
 = (
mšTÙ®F¿mes
 + 
äamesP”Ho¡Bufãr
 - 1) / framesPerHostBuffer;

1049 ifĞ
numHo¡Bufãrs
 < 
PA_MIN_NUM_HOST_BUFFERS
)

1051 
numHo¡Bufãrs
 = 
PA_MIN_NUM_HOST_BUFFERS
;

1056 
numHo¡Bufãrs
 > 
PA_MAX_NUM_HOST_BUFFERS
)

1058 
u£rBufãrsP”Ho¡Bufãr
 += 1;

1059 
äamesP”Ho¡Bufãr
 = 
·¡
->
·¡_F¿mesP”U£rBufãr
 * 
u£rBufãrsP”Ho¡Bufãr
;

1060 
numHo¡Bufãrs
 = (
mšTÙ®F¿mes
 + 
äamesP”Ho¡Bufãr
 - 1) / framesPerHostBuffer;

1064 
·hsc
->
·hsc_U£rBufãrsP”Ho¡Bufãr
 = 
u£rBufãrsP”Ho¡Bufãr
;

1065 
·hsc
->
·hsc_F¿mesP”Ho¡Bufãr
 = 
äamesP”Ho¡Bufãr
;

1066 
·hsc
->
·hsc_NumHo¡Bufãrs
 = 
numHo¡Bufãrs
;

1067 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs:…ahsc_U£rBufãrsP”Ho¡Bufã¸ğ%d\n", 
·hsc
->
·hsc_U£rBufãrsP”Ho¡Bufãr
 ));

1068 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs:…ahsc_NumHo¡Bufãr ğ%d\n", 
·hsc
->
·hsc_NumHo¡Bufãrs
 ));

1069 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs:…ahsc_F¿mesP”Ho¡Bufã¸ğ%d\n", 
·hsc
->
·hsc_F¿mesP”Ho¡Bufãr
 ));

1070 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs:…a¡_NumU£rBufãr ğ%d\n", 
·¡
->
·¡_NumU£rBufãrs
 ));

1071 
	}
}

1074 
PaE¼Ü
 
	$PaHo¡_O³nSŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1076 
OSE¼
 
”r
;

1077 
PaE¼Ü
 
»suÉ
 = 
·Ho¡E¼Ü
;

1078 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1079 
i
;

1081 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
((PaHostSoundControl));

1082 ifĞ
·hsc
 =ğ
NULL
 )

1084  
·Insuffic›ÁMemÜy
;

1086 
·¡
->
·¡_DeviûD©a
 = (*è
·hsc
;

1089 ifĞ(
·¡
->
·¡_NumIÅutChªÃls
 > 0è&& 
	`Mac_IsVœtu®MemÜyOn
() )

1091 
·hsc
->
·hsc_MšF¿mesP”Ho¡Bufãr
 = 
MAC_VIRTUAL_FRAMES_PER_BUFFER
;

1095 
·hsc
->
·hsc_MšF¿mesP”Ho¡Bufãr
 = 
MAC_PHYSICAL_FRAMES_PER_BUFFER
;

1098 
	`PaHo¡_C®cNumHo¡Bufãrs
Ğ
·¡
 );

1101 
·hsc
->
·hsc_Inv”£MiüosP”Ho¡Bufãr
 = 
·¡
->
·¡_Sam¶eR©e
 / (1000000.0 *…ahsc->
·hsc_F¿mesP”Ho¡Bufãr
);

1104 ifĞ
·¡
->
·¡_NumOuutChªÃls
 > 0 )

1107 
·hsc
->
·hsc_ChªÃl
 = 0L;

1108 
”r
 = 
	`SndNewChªÃl
(&
·hsc
->
·hsc_ChªÃl
, 
§m¶edSyÁh
, 0, 
n
);

1109 if(
”r
 != 0)

1111 
	`ERR_RPT
(("E¼Ü iÀPaHo¡_O³nSŒ—m: SndNewChªÃÈ»tuºed 0x%x\n", 
”r
 ));

1112 
”rÜ
;

1117 #ià
TARGET_API_MAC_CARBON


1118 
·hsc
->
·hsc_OuutCom¶‘iÚProc
 = 
	`NewSndC®lBackUPP
(
PaMac_OuutCom¶‘iÚProc
);

1120 
·hsc
->
·hsc_OuutCom¶‘iÚProc
 = 
	`NewSndC®lBackProc
(
PaMac_OuutCom¶‘iÚProc
);

1123 
·hsc
->
·hsc_ChªÃl
->
ÿÎBack
 =…ahsc->
·hsc_OuutCom¶‘iÚProc
;

1125 
·hsc
->
·hsc_By‹sP”OuutHo¡Bufãr
 =…ahsc->
·hsc_F¿mesP”Ho¡Bufãr
 * 
·¡
->
·¡_NumOuutChªÃls
 * (
št16
);

1126 
i
 = 0; i<
·hsc
->
·hsc_NumHo¡Bufãrs
; i++)

1128 *
buf
 = (*)
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
(
·hsc
->
·hsc_By‹sP”OuutHo¡Bufãr
);

1129 ià(
buf
 =ğ
NULL
)

1131 
	`ERR_RPT
(("E¼Ü iÀPaHo¡_O³nSŒ—m: could‚Ù‡Îoÿ‹ ouuˆbufãr. Sizğ\n", 
·hsc
->
·hsc_By‹sP”OuutHo¡Bufãr
 ));

1132 
mem”rÜ
;

1135 
	`PaMac_In™SoundH—d”
Ğ
·¡
, &
·hsc
->
·hsc_SoundH—d”s
[
i
] );

1136 
·hsc
->
·hsc_SoundH—d”s
[
i
].
§m¶ePŒ
 = 
buf
;

1137 
·hsc
->
·hsc_SoundH—d”s
[
i
].
numF¿mes
 = (è·hsc->
·hsc_F¿mesP”Ho¡Bufãr
;

1141 #ifdeà
SUPPORT_AUDIO_CAPTURE


1144 ifĞ
·¡
->
·¡_NumIÅutChªÃls
 > 0 )

1146 
št16
 
‹mpS
;

1147 
‹mpL
;

1148 
Fixed
 
‹mpF
;

1149 
mRefNum
;

1150 
SŒ255
 
ÇmePSŒšg
;

1151 #ià
TARGET_API_MAC_CARBON


1152 
·hsc
->
·hsc_IÅutCom¶‘iÚProc
 = 
	`NewSICom¶‘iÚUPP
((
SICom¶‘iÚProcPŒ
)
PaMac_IÅutCom¶‘iÚProc
);

1154 
·hsc
->
·hsc_IÅutCom¶‘iÚProc
 = 
	`NewSICom¶‘iÚProc
((
ProcPŒ
)
PaMac_IÅutCom¶‘iÚProc
);

1156 
·hsc
->
·hsc_By‹sP”IÅutHo¡Bufãr
 =…ahsc->
·hsc_F¿mesP”Ho¡Bufãr
 * 
·¡
->
·¡_NumIÅutChªÃls
 * (
št16
);

1157 
i
 = 0; i<
·hsc
->
·hsc_NumHo¡Bufãrs
; i++)

1159 *
buf
 = (*è
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
(
·hsc
->
·hsc_By‹sP”IÅutHo¡Bufãr
);

1160 iàĞ
buf
 =ğ
NULL
 )

1162 
	`ERR_RPT
(("PaHo¡_O³nSŒ—m: could‚Ù‡Îoÿ‹ iÅuˆ bufãr. Sizğ\n", 
·hsc
->
·hsc_By‹sP”IÅutHo¡Bufãr
 ));

1163 
mem”rÜ
;

1165 
·hsc
->
·hsc_IÅutMuÉiBufãr
.
bufãrs
[
i
] = 
buf
;

1167 
·hsc
->
·hsc_IÅutMuÉiBufãr
.
numBufãrs
 =…ahsc->
·hsc_NumHo¡Bufãrs
;

1170 
	`CToPSŒšg
((*)
sDeviûs
[
·¡
->
·¡_IÅutDeviûID
].
·d_Info
.
Çme
, 
ÇmePSŒšg
);

1171 
”r
 = 
	`SPBO³nDeviû
(
ÇmePSŒšg
, 
siWr™eP”missiÚ
, &
mRefNum
);

1173 ià(
”r
è
”rÜ
;

1174 
·hsc
->
·hsc_IÅutRefNum
 = 
mRefNum
;

1175 
	`DBUG
(("PaHo¡_O³nSŒ—m: mRefNum = %d\n", 
mRefNum
 ));

1178 
‹mpS
 = 1;

1179 
”r
 = 
	`SPBS‘DeviûInfo
(
mRefNum
, 
siCÚtšuous
, (
PŒ
è&
‹mpS
);

1180 ià(
”r
)

1182 
	`ERR_RPT
(("E¼Ü iÀPaHo¡_O³nSŒ—m: SPBS‘DeviûInfØsiCÚtšuou »tuºed %d\n", 
”r
 ));

1183 
”rÜ
;

1186 
‹mpL
 = 0x03;

1187 
”r
 = 
	`SPBS‘DeviûInfo
(
mRefNum
, 
siAùiveChªÃls
, (
PŒ
è&
‹mpL
);

1188 ià(
”r
)

1190 
	`DBUG
(("PaHo¡_O³nSŒ—m: s‘tšg siAùiveChªÃl »tuºed 0x%x. E¼Ü ignÜed.\n", 
”r
 ));

1194 
‹mpS
 = 
·¡
->
·¡_NumIÅutChªÃls
;

1195 
”r
 = 
	`SPBS‘DeviûInfo
(
mRefNum
, 
siNumb”ChªÃls
, (
PŒ
è&
‹mpS
);

1196 ià(
”r
)

1198 
	`ERR_RPT
(("E¼Ü iÀPaHo¡_O³nSŒ—m: SPBS‘DeviûInfØsiNumb”ChªÃl »tuºed %d\n", 
”r
 ));

1199 
”rÜ
;

1202 
‹mpF
 = (()
·¡
->
·¡_Sam¶eR©e
) << 16;

1203 
”r
 = 
	`SPBS‘DeviûInfo
(
mRefNum
, 
siSam¶eR©e
, (
PŒ
è&
‹mpF
);

1204 ià(
”r
)

1206 
	`ERR_RPT
(("E¼Ü iÀPaHo¡_O³nSŒ—m: SPBS‘DeviûInfØsiSam¶eR©»tuºed %d\n", 
”r
 ));

1207 
”rÜ
;

1211 
·hsc
->
·hsc_IÅutP¬ams
.
šRefNum
 = 
mRefNum
;

1212 
·hsc
->
·hsc_IÅutP¬ams
.
mli£cÚds
 = 0;

1213 
·hsc
->
·hsc_IÅutP¬ams
.
com¶‘iÚRoutše
 =…ahsc->
·hsc_IÅutCom¶‘iÚProc
;

1214 
·hsc
->
·hsc_IÅutP¬ams
.
š‹¼u±Routše
 = 0;

1215 
·hsc
->
·hsc_IÅutP¬ams
.
u£rLÚg
 = (è
·¡
;

1216 
·hsc
->
·hsc_IÅutP¬ams
.
unu£d1
 = 0;

1219 
	`DBUG
(("PaHost_OpenStream: complete.\n"));

1220  
·NoE¼Ü
;

1222 
”rÜ
:

1223 
	`PaHo¡_Clo£SŒ—m
Ğ
·¡
 );

1224 
	`ERR_RPT
(("PaHo¡_O³nSŒ—m: sPaHo¡E¼Ü = 0x%x.\n", 
”r
 ));

1225 
sPaHo¡E¼Ü
 = 
”r
;

1226  
·Ho¡E¼Ü
;

1228 
mem”rÜ
:

1229 
	`PaHo¡_Clo£SŒ—m
Ğ
·¡
 );

1230  
·Insuffic›ÁMemÜy
;

1231 
	}
}

1238 
PaE¼Ü
 
	$PaHo¡_Clo£SŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1240 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1241 
OSE¼
 
”r
 = 0;

1242 
i
;

1243 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1245 
	`DBUG
(("PaHo¡_Clo£SŒ—mĞ0x%x )\n", 
·¡
 ));

1247 ifĞ
·¡
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

1249 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

1250 ifĞ
·hsc
 =ğ
NULL
 )  
·NoE¼Ü
;

1252 ifĞ
·¡
->
·¡_NumOuutChªÃls
 > 0 )

1255 ifĞ
·hsc
->
·hsc_ChªÃl
 !ğ
NULL
 ) 
	`SndDi¥o£ChªÃl
Õahsc->·hsc_ChªÃl, 
TRUE
);

1257 
i
 = 0; i<
·hsc
->
·hsc_NumHo¡Bufãrs
; i++)

1259 
PŒ
 
p
 = (PŒè
·hsc
->
·hsc_SoundH—d”s
[
i
].
§m¶ePŒ
;

1260 ifĞ
p
 !ğ
NULL
 ) 
	`PaHo¡_F»eFa¡MemÜy
Ğp, 
·hsc
->
·hsc_By‹sP”OuutHo¡Bufãr
 );

1265 ifĞ
·¡
->
·¡_NumIÅutChªÃls
 > 0 )

1267 ifĞ
·hsc
->
·hsc_IÅutRefNum
 )

1269 
”r
 = 
	`SPBClo£Deviû
(
·hsc
->
·hsc_IÅutRefNum
);

1270 
·hsc
->
·hsc_IÅutRefNum
 = 0;

1271 ifĞ
”r
 )

1273 
sPaHo¡E¼Ü
 = 
”r
;

1274 
»suÉ
 = 
·Ho¡E¼Ü
;

1278 
i
 = 0; i<
·hsc
->
·hsc_IÅutMuÉiBufãr
.
numBufãrs
; i++)

1280 
PŒ
 
p
 = (PŒè
·hsc
->
·hsc_IÅutMuÉiBufãr
.
bufãrs
[
i
];

1281 ifĞ
p
 !ğ
NULL
 ) 
	`PaHo¡_F»eFa¡MemÜy
Ğp, 
·hsc
->
·hsc_By‹sP”IÅutHo¡Bufãr
 );

1286 
·¡
->
·¡_DeviûD©a
 = 
NULL
;

1287 
	`PaHo¡_F»eFa¡MemÜy
Ğ
·hsc
, (
PaHo¡SoundCÚŒŞ
) );

1289 
	`DBUG
(("PaHo¡_Clo£SŒ—m: com¶‘e.\n", 
·¡
 ));

1290  
»suÉ
;

1291 
	}
}

1293 
	$Pa_G‘MšNumBufãrs
Ğ
äamesP”U£rBufãr
, 
§m¶eR©e
 )

1298  
	`PaMac_G‘MšNumBufãrs
Ğ
MAC_VIRTUAL_FRAMES_PER_BUFFER
, 
äamesP”U£rBufãr
, 
§m¶eR©e
 );

1299 
	}
}

1301 
	$PaMac_G‘MšNumBufãrs
Ğ
mšF¿mesP”Ho¡Bufãr
, 
äamesP”U£rBufãr
, 
§m¶eR©e
 )

1303 
mšU£rP”Ho¡
 = ( 
mšF¿mesP”Ho¡Bufãr
 + 
äamesP”U£rBufãr
 - 1) / framesPerUserBuffer;

1304 
numBufs
 = 
PA_MIN_NUM_HOST_BUFFERS
 * 
mšU£rP”Ho¡
;

1305 ifĞ
numBufs
 < 
PA_MIN_NUM_HOST_BUFFERS
 )‚umBufs = PA_MIN_NUM_HOST_BUFFERS;

1306 (è
§m¶eR©e
;

1307  
numBufs
;

1308 
	}
}

1311 
	$Pa_SË•
Ğ
št32
 
m£c
 )

1313 
Ev’tRecÜd
 
ev’t
;

1314 
št32
 
¦“pTime
, 
’dTime
;

1316 
¦“pTime
 = ((
m£c
 * 60) + 999) / 1000;

1317 ifĞ
¦“pTime
 < 1 ) sleepTime = 1;

1318 
’dTime
 = 
	`TickCouÁ
(è+ 
¦“pTime
;

1321 
	`DBUGX
(("SË• fÜ %dicks.\n", 
¦“pTime
 ));

1325 
	`Wa™NextEv’t
Ğ0, &
ev’t
, 
¦“pTime
, 
NULL
 );

1326 
¦“pTime
 = 
’dTime
 - 
	`TickCouÁ
();

1328  
¦“pTime
 > 0 );

1329 
	}
}

1331 
št32
 
	$Pa_G‘Ho¡E¼Ü
( )

1333 
št32
 
”r
 = 
sPaHo¡E¼Ü
;

1334 
sPaHo¡E¼Ü
 = 0;

1335  
”r
;

1336 
	}
}

1344 *
	$PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ
numBy‹s
 )

1346 *
addr
 = 
	`NewPŒCË¬
Ğ
numBy‹s
 );

1347 ifĞ(
addr
 =ğ
NULL
è|| (
	`MemE¼Ü
 () != 0) )  NULL;

1349 #ià(
TARGET_API_MAC_CARBON
 == 0)

1350 ifĞ
	`HŞdMemÜy
Ğ
addr
, 
numBy‹s
 ) !ğ
noE¼
 )

1352 
	`Di¥o£PŒ
Ğ(
PŒ
è
addr
 );

1353  
NULL
;

1356  
addr
;

1357 
	}
}

1363 
	$PaHo¡_F»eFa¡MemÜy
Ğ*
addr
, 
numBy‹s
 )

1365 ifĞ
addr
 =ğ
NULL
 ) ;

1366 #ià
TARGET_API_MAC_CARBON


1367 (è
numBy‹s
;

1369 
	`UnhŞdMemÜy
Ğ
addr
, 
numBy‹s
 );

1371 
	`Di¥o£PŒ
Ğ(
PŒ
è
addr
 );

1372 
	}
}

1375 
PaTime¡amp
 
	$Pa_SŒ—mTime
Ğ
PÜtAudioSŒ—m
 *
¡»am
 )

1377 
PaTime¡amp
 
äamesDÚe1
;

1378 
PaTime¡amp
 
äamesDÚe2
;

1379 
UIÁ64
 
wh’Inüem’‹d
;

1380 
UnsigÃdWide
 
now
;

1381 
UIÁ64
 
now64
;

1382 
miüosEÏp£d
;

1383 
äamesEÏp£d
;

1385 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1386 
š‹º®PÜtAudioSŒ—m
 *
·¡
 = (š‹º®PÜtAudioSŒ—m *è
¡»am
;

1387 ifĞ
·¡
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

1388 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

1396 
äamesDÚe1
 = 
·hsc
->
·hsc_NumF¿mesDÚe
;

1397 
wh’Inüem’‹d
 = 
·hsc
->
·hsc_Wh’F¿mesDÚeInüem’‹d
;

1398 
äamesDÚe2
 = 
·hsc
->
·hsc_NumF¿mesDÚe
;

1399 }  
äamesDÚe1
 !ğ
äamesDÚe2
 );

1402 
	`Miüo£cÚds
Ğ&
now
 );

1403 
now64
 = 
	`UnsigÃdWideToUIÁ64
Ğ
now
 );

1404 
miüosEÏp£d
 = 
	`U64SubŒaù
Ğ
now64
, 
wh’Inüem’‹d
 );

1405 
äamesEÏp£d
 = 
miüosEÏp£d
 * 
·¡
->
·¡_Sam¶eR©e
 * 0.000001;

1407  
äamesDÚe1
 + 
äamesEÏp£d
;

1408 
	}
}

1413 
	ggRecÜdCouÁ”
 = 0;

1414 
	ggPÏyCouÁ”
 = 0;

1415 
·sÿl
 
	$PaMac_IÅutCom¶‘iÚProc
(
SPBPŒ
 
»cP¬ams
)

1417 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1418 
fšished
 = 1;

1419 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

1420 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1422 
gRecÜdCouÁ”
 += 1;

1425 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
»cP¬ams
->
u£rLÚg
;

1426 ifĞ
·¡
 =ğ
NULL
 ) ;

1428 ifĞ
·¡
->
·¡_Magic
 !ğ
PA_MAGIC
 )

1430 
	`AddT¿ûMes§ge
("PaMac_IÅutCom¶‘iÚProc: bad MAGIC,…a¡", (è
·¡
 );

1431 
	`AddT¿ûMes§ge
("PaMac_IÅutCom¶‘iÚProc: bad MAGIC, magic", (è
·¡
->
·¡_Magic
 );

1432 
”rÜ
;

1434 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

1435 
·¡
->
·¡_NumC®lbacks
 += 1;

1438 ifĞ(
»cP¬ams
->
”rÜ
 =ğ
abÜtE¼
è|| 
·hsc
->
·hsc_StİRecÜdšg
 ) error;

1443 if(
·¡
->
·¡_NumOuutChªÃls
 == 0)

1445 
	`S‘F¿mesDÚe
Ğ
·hsc
,

1446 
·hsc
->
·hsc_NumF¿mesDÚe
 +…ahsc->
·hsc_F¿mesP”Ho¡Bufãr
 );

1447 
»suÉ
 = 
	`PaMac_C®lU£rLoİ
Ğ
·¡
, 
NULL
 );

1451 ifĞ(
»suÉ
 =ğ
·NoE¼Ü
è&& (
·hsc
->
·hsc_StİRecÜdšg
 == 0) )

1453 
»suÉ
 = 
	`PaMac_RecÜdNext
Ğ
·¡
 );

1454 ifĞ
»suÉ
 !ğ
·NoE¼Ü
 ) 
·hsc
->
·hsc_IsRecÜdšg
 = 0;

1456 
”rÜ
;

1460 
”rÜ
:

1461 
·hsc
->
·hsc_IsRecÜdšg
 = 0;

1462 
·hsc
->
·hsc_StİRecÜdšg
 = 0;

1464 
	}
}

1471 
PaE¼Ü
 
	$PaMac_C®lU£rLoİ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
št16
 *
outPŒ
 )

1473 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1474 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

1475 
št16
 *
šPŒ
 = 
NULL
;

1476 
i
;

1480 if(
·¡
->
·¡_NumIÅutChªÃls
 > 0)

1482 ifĞ
	`MuÉiBufãr_IsR—dabË
Ğ&
·hsc
->
·hsc_IÅutMuÉiBufãr
 ) )

1484 
šPŒ
 = (
št16
 *è
	`MuÉiBufãr_G‘NextR—dBufãr
Ğ&
·hsc
->
·hsc_IÅutMuÉiBufãr
 );

1485 
	`MuÉiBufãr_AdvªûR—dIndex
Ğ&
·hsc
->
·hsc_IÅutMuÉiBufãr
 );

1490 ifĞ(
šPŒ
 !ğ
NULL
è|| (
outPŒ
 != NULL) )

1492 
	`PaMac_S¹LßdC®cuÏtiÚ
Ğ
·¡
 );

1494 #ifdeà
PA_MAX_USAGE_ALLOWED


1496 ifĞ
·¡
->
·¡_U§ge
 > 
PA_MAX_USAGE_ALLOWED
 )

1498 
·¡
->
·¡_F¿meCouÁ
 +ğ(
PaTime¡amp
è
·hsc
->
·hsc_F¿mesP”Ho¡Bufãr
;

1504  
i
=0; i<
·hsc
->
·hsc_U£rBufãrsP”Ho¡Bufãr
; i++ )

1506 
»suÉ
 = (
PaE¼Ü
è
	`Pa_C®lCÚv”tIÁ16
Ğ
·¡
, 
šPŒ
, 
outPŒ
 );

1507 ifĞ
»suÉ
 != 0)

1510 
·hsc
->
·hsc_StİRecÜdšg
 =…ahsc->
·hsc_IsRecÜdšg
;

1514 if(
šPŒ
 !ğ
NULL
èšPŒ +ğ
·¡
->
·¡_F¿mesP”U£rBufãr
 *…a¡->
·¡_NumIÅutChªÃls
;

1515 if(
outPŒ
 !ğ
NULL
èoutPŒ +ğ
·¡
->
·¡_F¿mesP”U£rBufãr
 *…a¡->
·¡_NumOuutChªÃls
;

1519 
	`PaMac_EndLßdC®cuÏtiÚ
Ğ
·¡
 );

1521  
»suÉ
;

1522 
	}
}

1527 
PaE¼Ü
 
	$PaMac_RecÜdNext
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1529 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1530 
OSE¼
 
”r
;

1531 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

1533 
·hsc
->
·hsc_IÅutP¬ams
.
bufãrPŒ
 = 
	`MuÉiBufãr_G‘NextWr™eBufãr
Ğ&·hsc->
·hsc_IÅutMuÉiBufãr
 );

1536 ifĞ
	`MuÉiBufãr_IsWr™—bË
Ğ&
·hsc
->
·hsc_IÅutMuÉiBufãr
 ) )

1538 
	`MuÉiBufãr_AdvªûWr™eIndex
Ğ&
·hsc
->
·hsc_IÅutMuÉiBufãr
 );

1541 
	`AddT¿ûMes§ge
("PaMac_RecÜdNext: bufãrPŒ", (è
·hsc
->
·hsc_IÅutP¬ams
.
bufãrPŒ
 );

1542 
	`AddT¿ûMes§ge
("PaMac_RecÜdNext:‚extWr™e", 
·hsc
->
·hsc_IÅutMuÉiBufãr
.
ÃxtWr™e
 );

1545 
·hsc
->
·hsc_IÅutP¬ams
.
bufãrL’gth
 =…ahsc->
·hsc_By‹sP”IÅutHo¡Bufãr
;

1546 
·hsc
->
·hsc_IÅutP¬ams
.
couÁ
 =…ahsc->
·hsc_By‹sP”IÅutHo¡Bufãr
;

1547 
”r
 = 
	`SPBRecÜd
(&
·hsc
->
·hsc_IÅutP¬ams
, 
Œue
);

1548 ifĞ
”r
 )

1550 
	`AddT¿ûMes§ge
("PaMac_RecÜdNext: SPBRecÜdƒ¼Ü ", 
”r
 );

1551 
sPaHo¡E¼Ü
 = 
”r
;

1552 
»suÉ
 = 
·Ho¡E¼Ü
;

1556 
·hsc
->
·hsc_IsRecÜdšg
 = 1;

1558  
»suÉ
;

1559 
	}
}

1565 
	$PaMac_FlNextOuutBufãr
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
šdex
 )

1567 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1568 
»suÉ
 = 0;

1569 
fšished
 = 1;

1570 *
outPŒ
;

1572 
gPÏyCouÁ”
 += 1;

1574 
·¡
->
·¡_NumC®lbacks
 += 1;

1575 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

1576 ifĞ
·hsc
 =ğ
NULL
 )  -1;

1578 ifĞ
·hsc
->
·hsc_IfInsideC®lback
 )  0;

1579 
·hsc
->
·hsc_IfInsideC®lback
 = 1;

1581 
outPŒ
 = 
·hsc
->
·hsc_SoundH—d”s
[
šdex
].
§m¶ePŒ
;

1583 
»suÉ
 = 
	`PaMac_C®lU£rLoİ
Ğ
·¡
, (
št16
 *è
outPŒ
 );

1585 
·hsc
->
·hsc_IfInsideC®lback
 = 0;

1586  
»suÉ
;

1587 
	}
}

1592 
·sÿl
 
	$PaMac_OuutCom¶‘iÚProc
 (
SndChªÃlPŒ
 
theChªÃl
, 
SndCommªd
 * 
theC®lBackCmd
)

1594 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

1595 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1596 (è
theChªÃl
;

1597 (è
theC®lBackCmd
;

1600 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
theC®lBackCmd
->
·¿m2
;

1601 ifĞ
·¡
 =ğ
NULL
 ) ;

1603 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

1604 
·hsc
->
·hsc_NumOutsPÏyed
 += 1;

1606 
	`S‘F¿mesDÚe
Ğ
·hsc
,

1607 
·hsc
->
·hsc_NumF¿mesDÚe
 +…ahsc->
·hsc_F¿mesP”Ho¡Bufãr
 );

1609 
	`PaMac_BackgroundMªag”
Ğ
·¡
, 
theC®lBackCmd
->
·¿m1
 );

1610 
	}
}

1613 
PaE¼Ü
 
	$PaMac_BackgroundMªag”
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
šdex
 )

1615 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1616 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

1618 ifĞ
·¡
->
·¡_StİNow
 )

1620 
SndCommªd
 
commªd
;

1622 
commªd
.
cmd
 = 
æushCmd
;

1623 
commªd
.
·¿m1
 = commªd.
·¿m2
 = 0;

1624 
	`SndDoImmedŸ‹
Ğ
·hsc
->
·hsc_ChªÃl
, &
commªd
 );

1626 
commªd
.
cmd
 = 
qu›tCmd
;

1627 
	`SndDoImmedŸ‹
Ğ
·hsc
->
·hsc_ChªÃl
, &
commªd
 );

1628 
·¡
->
·¡_IsAùive
 = 0;

1633 ifĞ
·¡
->
·¡_StİSoÚ
 )

1635 ifĞ(
·hsc
->
·hsc_NumOutsQueued
 -…ahsc->
·hsc_NumOutsPÏyed
) <= 0 )

1637 
·¡
->
·¡_IsAùive
 = 0;

1642 
	`PaMac_PÏyNext
Ğ
·¡
, 
šdex
 );

1644  
»suÉ
;

1645 
	}
}

1650 
	$PaMac_PÏyNext
 ( 
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
šdex
 )

1652 
OSE¼
 
”rÜ
;

1653 
»suÉ
;

1654 
SndCommªd
 
¶ayCmd
;

1655 
SndCommªd
 
ÿÎbackCmd
;

1656 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

1659 iàĞ
·¡
->
·¡_StİSoÚ
 ) 
dÚe
;

1662 
»suÉ
 = 
	`PaMac_FlNextOuutBufãr
 ( 
·¡
, 
šdex
 );

1663 ifĞ
»suÉ
 > 0 ) 
·¡
->
·¡_StİSoÚ
 = 1;

1664 ifĞ
»suÉ
 < 0 ) 
dÚe
;

1667 
¶ayCmd
.
cmd
 = 
bufãrCmd
;

1668 
¶ayCmd
.
·¿m1
 = 0;

1669 
¶ayCmd
.
·¿m2
 = (è&
·hsc
->
·hsc_SoundH—d”s
[ 
šdex
 ];

1670 
”rÜ
 = 
	`SndDoCommªd
 (
·hsc
->
·hsc_ChªÃl
, &
¶ayCmd
, 
Œue
 );

1671 ifĞ
”rÜ
 !ğ
noE¼
 ) 
gÙE¼Ü
;

1674 
ÿÎbackCmd
.
cmd
 = 
ÿÎBackCmd
;

1675 
ÿÎbackCmd
.
·¿m1
 = 
šdex
;

1676 
ÿÎbackCmd
.
·¿m2
 = ()
·¡
;

1677 
”rÜ
 = 
	`SndDoCommªd
 (
·hsc
->
·hsc_ChªÃl
, &
ÿÎbackCmd
, 
Œue
 );

1678 ifĞ
”rÜ
 !ğ
noE¼
 ) 
gÙE¼Ü
;

1679 
·hsc
->
·hsc_NumOutsQueued
 += 1;

1683 
gÙE¼Ü
:

1684 
sPaHo¡E¼Ü
 = 
”rÜ
;

1685 
dÚe
:

1687 
	}
}

	@portaudio/pa_mac/patest_devinfo.c

1 #šşud
	~<¡dio.h
> #šşud<¡dlib.h> #šşud<¡ršg.h> #šşud<memÜy.h> #šşud<m©h.h> #šşud"OSUts.h" #šşud<MacTy³s.h> #šşud<M©h64.h> #šşud<E¼Üs.h> #šşud<Sound.h> #šşud<SoundIÅut.h> #šşud<Deviûs.h> #šşud<D©eTimeUts.h> #šşud<Tim”.h> #šşud<Ge¡®t.h> #defšUSE_POINTER (1è #defšPRINT(xè{…rštàx; fæush(¡dout); } #defšERR_RPT(xèPRINT(xè#defšDBUG(xèPRINT(xèTe¡S‘tšgDeviûInfoĞcÚ¡ *deviûNam); mašĞ); mašĞè{ nÚamğ0; »suÉ = Te¡S‘tšgDeviûInfoĞ(cÚ¡ *è&nÚam); PRINT(("Te¡ com¶‘e.„esuÉ = %d\n",„esuÉ ));  0; } Te¡S‘tšgDeviûInfoĞcÚ¡ *deviûNamè{ OSE¼ƒ¼; mRefNum = 0; ‹mpL; ‹mpS; FixedempF;ƒ¼ = SPBO³nDeviûĞdeviûName, siWr™eP”missiÚ, &mRefNum); iàÓ¼è{ PRINT(("Cound‚Ù o³Àdeviû!\n"));  -1; } #defšPrštDeviûInfo(£ËùÜ,v¬è\ƒ¼ = SPBG‘DeviûInfo(mRefNum, s–eùÜ, (PŒè&v¬); \ iàÓ¼è{ \ PRINT(("qu”y % çed\n", #£ËùÜ )); \ }\ { \ PRINT(("qu”y % ğ0x%x\n", #£ËùÜ, v¬ )); \ } PrštDeviûInfoĞsiCÚtšuous,empS ); PrštDeviûInfoĞsiAsync,empS ); PrštDeviûInfoĞsiNumb”ChªÃls,empS ); PrštDeviûInfoĞsiSam¶eSize,empS ); PrštDeviûInfoĞsiSam¶eR©e,empF ); PrštDeviûInfoĞsiChªÃlAvaabË,empS ); PrštDeviûInfoĞsiAùiveChªÃls,empL ); PrštDeviûInfoĞsiDeviûBufãrInfo,empL ); #iàUSE_POINTER PRINT(("A‰em±Ø£ˆsiCÚtšuou tØ1 usšg…oš‹¸m‘hod.\n"));empS = 1;ƒ¼ = SPBS‘DeviûInfo(mRefNum, siCÚtšuous, (PŒè&‹mpS); iàÓ¼èPRINT(("£‰šg siCÚtšuou usšg…oš‹¸çed\n")); PrštDeviûInfoĞsiCÚtšuous,empS ); PRINT(("A‰em±Ø£ˆsiCÚtšuou tØ0 usšg…oš‹¸m‘hod.\n"));empS = 1;ƒ¼ = SPBS‘DeviûInfo(mRefNum, siCÚtšuous, (PŒè&‹mpS); iàÓ¼èPRINT(("£‰šg siCÚtšuou usšg…oš‹¸çed\n")); PrštDeviûInfoĞsiCÚtšuous,empS ); #–£ (("A‰em±Ø£ˆsiCÚtšuou tØ1 usšg dœeù m‘hod.\n"));ğSPBS‘DeviûInfo(mRefNum, siCÚtšuous, (PŒè1);Ó¼èPRINT(("£‰šg siCÚtšuou usšg dœeù faed\n"));ĞsiCÚtšuous,empS );(("A‰em±Ø£ˆsiCÚtšuou tØ0 usšg dœeù m‘hod.\n"));ğSPBS‘DeviûInfo(mRefNum, siCÚtšuous, (PŒè0);Ó¼èPRINT(("£‰šg siCÚtšuou usšg dœeù faed\n"));ĞsiCÚtšuous,empS );#’dif/* Sam¶¿‹ ----------- */#iàUSE_POINTER(("A‰em±Ø£ˆsiSam¶eR©tØ44100 usšg…oš‹¸m‘hod.\n"));ğ((unsigÃd†Úg)44100è<< 16;ğSPBS‘DeviûInfo(mRefNum, siSam¶eR©e, (PŒè&‹mpF);Ó¼èPRINT(("£‰šg siSam¶eR©usšg…oš‹¸çed\n"));ğ0;ĞsiSam¶eR©e,empF );(("A‰em±Ø£ˆsiSam¶eR©tØ22050 usšg…oš‹¸m‘hod.\n"));ğ((unsigÃd†Úg)22050è<< 16;ğSPBS‘DeviûInfo(mRefNum, siSam¶eR©e, (PŒè&‹mpF);Ó¼èPRINT(("£‰šg siSam¶eR©usšg…oš‹¸çed\n"));ğ0;ĞsiSam¶eR©e,empF );#–£(("A‰em±Ø£ˆsiSam¶eR©tØ44100 usšg dœeù m‘hod.\n"));ğSPBS‘DeviûInfo(mRefNum, siSam¶eR©e, (PŒè(((unsigÃd†Úg)44100è<< 16));Ó¼èPRINT(("£‰šg siSam¶eR©usšg dœeù faed\n"));ĞsiSam¶eR©e,empF );(("A‰em±Ø£ˆsiSam¶eR©tØ22050 usšg dœeù m‘hod.\n"));ğSPBS‘DeviûInfo(mRefNum, siSam¶eR©e, (PŒè (((unsigÃd†Úg)44100è<< 16));Ó¼èPRINT(("£‰šg siSam¶eR©usšg dœeù faed\n"));ĞsiSam¶eR©e,empF );#’dif/* AÎ dÚsØşo£ u°deviû. */ĞmRefNum ) SPBClo£Deviû(mRefNum);0;:ĞmRefNum ) SPBClo£Deviû(mRefNum);-1;}

	@portaudio/pa_mac_core/pa_mac_core.c

98 
	~<CÜeS”viûs/CÜeS”viûs.h
>

99 
	~<CÜeAudio/CÜeAudio.h
>

100 
	~<sys/time.h
>

101 
	~<sys/»sourû.h
>

102 
	~<sys/ty³s.h
>

103 
	~<uni¡d.h
>

104 
	~<uni¡d.h
>

105 
	~<AudioUn™/AudioUn™.h
>

106 
	~<AudioToŞbox/DeçuÉAudioOuut.h
>

107 
	~<AudioToŞbox/AudioCÚv”‹r.h
>

109 
	~"pÜudio.h
"

110 
	~"·_ho¡.h
"

111 
	~"·_Œaû.h
"

112 
	~"ršgbufãr.h
"

115 
	#SET_DEVICE_BUFFER_SIZE
 (1)

	)

118 
	#PA_TRACE_RUN
 (0)

	)

119 
	#PA_TRACE_START_STOP
 (0)

	)

121 
	#PA_MIN_LATENCY_MSEC
 (20è

	)

122 
	#MIN_TIMEOUT_MSEC
 (3000)

	)

124 
	#PRINT
(
x
è{ 
´štf
 x; 
	`fæush
(
¡dout
); }

	)

125 
	#PRINT_ERR
Ğ
msg
, 
”r
 ) 
	`PRINT
(Ğmsg ":ƒ¼Ü = 0x%0lX = '%s'\n", (”r), 
	`E¼ÜToSŒšg
Ó¼)è)

	)

126 
	#DBUG
(
x
è
	`PRINT
(x)

	)

127 
	#DBUGBACK
(
x
è

	)

128 
	#DBUGX
(
x
)

	)

131 
	#IS_INPUT
 (
Œue
)

	)

132 
	#IS_OUTPUT
 (
çl£
)

	)

134 
	ePaDeviûMode


136 
	mPA_MODE_OUTPUT_ONLY
,

137 
	mPA_MODE_INPUT_ONLY
,

138 
	mPA_MODE_IO_ONE_DEVICE
,

139 
	mPA_MODE_IO_TWO_DEVICES


140 } 
	tPaDeviûMode
;

142 
	#PA_USING_OUTPUT
 (
·hsc
->
mode
 !ğ
PA_MODE_INPUT_ONLY
)

	)

143 
	#PA_USING_INPUT
 (
·hsc
->
mode
 !ğ
PA_MODE_OUTPUT_ONLY
)

	)

148 
	sPaHo¡InOut_s


150 
AudioDeviûID
 
	maudioDeviûID
;

151 
	mby‹sP”U£rN©iveBufãr
;

152 
AudioCÚv”‹rRef
 
	mcÚv”‹r
;

153 *
	mcÚv”‹rBufãr
;

154 
	mnumChªÃls
;

155 } 
	tPaHo¡InOut
;

161 
	sPaHo¡SoundCÚŒŞ


163 
PaHo¡InOut
 
	mšput
;

164 
PaHo¡InOut
 
	mouut
;

165 
AudioDeviûID
 
	m´im¬yDeviûID
;

166 
PaDeviûMode
 
	mmode
;

167 
RšgBufãr
 
	mršgBufãr
;

168 *
	mršgBufãrD©a
;

169 
BoŞ—n
 
	mfÜm©Li¡’”C®Ëd
;

171 
ru§ge
 
	m’ŒyRu§ge
;

172 
	mšv”£MiüosP”Ho¡Bufãr
;

173 } 
	tPaHo¡SoundCÚŒŞ
;

180 
	sPaHo¡DeviûInfo


182 
PaDeviûInfo
 
	m·Info
;

183 
AudioDeviûID
 
	maudioDeviûID
;

185 
	tPaHo¡DeviûInfo
;

189 
	gsNumPaDeviûs
 = 0;

190 
	gsNumIÅutDeviûs
 = 0;

191 
	gsNumOuutDeviûs
 = 0;

192 
	gsNumCÜeDeviûs
 = 0;

193 
AudioDeviûID
 *
	gsCÜeDeviûIDs
;

194 
PaHo¡DeviûInfo
 *
	gsDeviûInfos
 = 
NULL
;

195 
	gsDeçuÉIÅutDeviûID
 = 
·NoDeviû
;

196 
	gsDeçuÉOuutDeviûID
 = 
·NoDeviû
;

197 
	gsSavedHo¡E¼Ü
 = 0;

199 cÚ¡ 
	gsuµÜ‹dSam¶eR©eRªge
[] = { 8000.0, 96000.0 };

200 cÚ¡ 
	gsM­³rSuffixIÅut
[] = " - Input";

201 cÚ¡ 
	gsM­³rSuffixOuut
[] = " - Output";

206 *
	$FourCh¬Code2SŒ
(
code
)

208 
¡r
[5];

209 
¡r
[0] = ()((
code
 & 0xFF000000) >> 24);

210 
¡r
[1] = ()((
code
 & 0xFF0000) >> 16);

211 
¡r
[2] = ()((
code
 & 0xFF00) >> 8);

212 
¡r
[3] = ()((
code
 & 0xFF));

213 
¡r
[4] = 0;

215  
¡r
;

216 
	}
}

219 
	#LOWEST_INPUT_DEVID
 (0)

	)

220 
	#HIGHEST_INPUT_DEVID
 (
sNumIÅutDeviûs
 - 1)

	)

221 
	#LOWEST_OUTPUT_DEVID
 (
sNumIÅutDeviûs
)

	)

222 
	#HIGHEST_OUTPUT_DEVID
 (
sNumPaDeviûs
 - 1)

	)

228 
PaE¼Ü
 
PaOSX_Qu”yDeviûs
( );

229 
PaOSX_SÿnDeviûs
Ğ
BoŞ—n
 
isIÅut
 );

230 
PaOSX_Qu”yDeviûInfo
Ğ
PaHo¡DeviûInfo
 *
ho¡DeviûInfo
, 
cÜeDeviûIndex
, 
BoŞ—n
 
isIÅut
 );

231 
PaDeviûID
 
PaOSX_Qu”yDeçuÉIÅutDeviû
( );

232 
PaDeviûID
 
PaOSX_Qu”yDeçuÉOuutDeviû
( );

233 
PaOSX_C®cHo¡BufãrSize
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

235 
OSStus
 
PAOSX_DeviûPrİ”tyLi¡’”
 (
AudioDeviûID
 
šDeviû
,

236 
UIÁ32
 
šChªÃl
,

237 
BoŞ—n
 
isIÅut
,

238 
AudioDeviûPrİ”tyID
 
šPrİ”tyID
,

239 * 
šCl›ÁD©a
);

245 
OSStus
 
	g¡©usText
[2] = { 0, 0 };

246 cÚ¡ *
	$E¼ÜToSŒšg
Ğ
OSStus
 
”r
 )

248 cÚ¡ *
¡r
;

250 
”r
)

252 
kAudioH¬dw¬eUn¥ecif›dE¼Ü
:

253 
¡r
 = "kAudioHardwareUnspecifiedError";

255 
kAudioH¬dw¬eNÙRuÂšgE¼Ü
:

256 
¡r
 = "kAudioHardwareNotRunningError";

258 
kAudioH¬dw¬eUnknownPrİ”tyE¼Ü
:

259 
¡r
 = "kAudioHardwareUnknownPropertyError";

261 
kAudioDeviûUnsuµÜ‹dFÜm©E¼Ü
:

262 
¡r
 = "kAudioDeviceUnsupportedFormatError";

264 
kAudioH¬dw¬eBadPrİ”tySizeE¼Ü
:

265 
¡r
 = "kAudioHardwareBadPropertySizeError";

267 
kAudioH¬dw¬eIÎeg®O³¿tiÚE¼Ü
:

268 
¡r
 = "kAudioHardwareIllegalOperationError";

271 
¡©usText
[0] = 
”r
;

272 
¡r
 = (cÚ¡ *)
¡©usText
;

276  
¡r
;

277 
	}
}

280 
	$RoundUpToNextPow”Of2
Ğ
n
 )

282 
numB™s
 = 0;

283 ifĞ((
n
-1) &‚) == 0) ‚;

284  
n
 > 0 )

286 
n
=‚>>1;

287 
numB™s
++;

289  (1<<
numB™s
);

290 
	}
}

293 
	$Pa_S¹U§geC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

295 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

296 ifĞ
·hsc
 =ğ
NULL
 ) ;

298 
	`g‘ru§ge
Ğ
RUSAGE_SELF
, &
·hsc
->
’ŒyRu§ge
 );

299 
	}
}

301 
	$SubŒaùTime_AmšusB
Ğ
timev®
 *
timeA
, timev® *
timeB
 )

303 
£cs
 = 
timeA
->
tv_£c
 - 
timeB
->tv_sec;

304 
u£cs
 = 
£cs
 * 1000000;

305 
u£cs
 +ğ(
timeA
->
tv_u£c
 - 
timeB
->tv_usec);

306  
u£cs
;

307 
	}
}

313 
	$Pa_EndU§geC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

315 
ru§ge
 
cu¼’tRu§ge
;

316 
u£csEÏp£d
;

317 
ÃwU§ge
;

319 
	#LOWPASS_COEFFICIENT_0
 (0.95)

	)

320 
	#LOWPASS_COEFFICIENT_1
 (0.99999 - 
LOWPASS_COEFFICIENT_0
)

	)

322 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

323 ifĞ
·hsc
 =ğ
NULL
 ) ;

325 ifĞ
	`g‘ru§ge
Ğ
RUSAGE_SELF
, &
cu¼’tRu§ge
 ) == 0 )

327 
u£csEÏp£d
 = 
	`SubŒaùTime_AmšusB
Ğ&
cu¼’tRu§ge
.
ru_utime
, &
·hsc
->
’ŒyRu§ge
.ru_utime );

330 
ÃwU§ge
 = 
u£csEÏp£d
 * 
·hsc
->
šv”£MiüosP”Ho¡Bufãr
;

332 
·¡
->
·¡_U§ge
 = (
LOWPASS_COEFFICIENT_0
 *…ast->past_Usage) +

333 (
LOWPASS_COEFFICIENT_1
 * 
ÃwU§ge
);

335 
	}
}

339 
PaDeviûID
 
	$PaOSX_Qu”yDeçuÉIÅutDeviû
( )

341 
OSStus
 
”r
 = 
noE¼
;

342 
UIÁ32
 
couÁ
;

343 
i
;

344 
AudioDeviûID
 
‹mpDeviûID
 = 
kAudioDeviûUnknown
;

345 
PaDeviûID
 
deçuÉDeviûID
 = 
·NoDeviû
;

349 
couÁ
 = (
‹mpDeviûID
);

350 
”r
 = 
	`AudioH¬dw¬eG‘Prİ”ty
Ğ
kAudioH¬dw¬ePrİ”tyDeçuÉIÅutDeviû
, &
couÁ
, (*è&
‹mpDeviûID
);

351 ià(
”r
 !ğ
noE¼
è
”rÜ
;

354 
deçuÉDeviûID
 = 
·NoDeviû
;

355  
i
=
LOWEST_INPUT_DEVID
; i<=
HIGHEST_INPUT_DEVID
; i++ )

357 
	`DBUG
(("PaOSX_Qu”yDeçuÉIÅutDeviû: i = %d,‡DevId = %ld\n", 
i
, 
sDeviûInfos
[i].
audioDeviûID
 ));

358 ifĞ
sDeviûInfos
[
i
].
audioDeviûID
 =ğ
‹mpDeviûID
 )

360 
deçuÉDeviûID
 = 
i
;

364 
”rÜ
:

365  
deçuÉDeviûID
;

366 
	}
}

369 
PaDeviûID
 
	$PaOSX_Qu”yDeçuÉOuutDeviû
( )

371 
OSStus
 
”r
 = 
noE¼
;

372 
UIÁ32
 
couÁ
;

373 
i
;

374 
AudioDeviûID
 
‹mpDeviûID
 = 
kAudioDeviûUnknown
;

375 
PaDeviûID
 
deçuÉDeviûID
 = 
·NoDeviû
;

379 
couÁ
 = (
‹mpDeviûID
);

380 
”r
 = 
	`AudioH¬dw¬eG‘Prİ”ty
Ğ
kAudioH¬dw¬ePrİ”tyDeçuÉOuutDeviû
, &
couÁ
, (*è&
‹mpDeviûID
);

381 ià(
”r
 !ğ
noE¼
è
”rÜ
;

384 
deçuÉDeviûID
 = 
·NoDeviû
;

385  
i
=
LOWEST_OUTPUT_DEVID
; i<=
HIGHEST_OUTPUT_DEVID
; i++ )

387 
	`DBUG
(("PaOSX_Qu”yDeçuÉOuutDeviû: i = %d,‡DevId = %ld\n", 
i
, 
sDeviûInfos
[i].
audioDeviûID
 ));

388 ifĞ
sDeviûInfos
[
i
].
audioDeviûID
 =ğ
‹mpDeviûID
 )

390 
deçuÉDeviûID
 = 
i
;

394 
”rÜ
:

395  
deçuÉDeviûID
;

396 
	}
}

399 
PaE¼Ü
 
	$PaOSX_Qu”yDeviûs
( )

401 
OSStus
 
”r
 = 
noE¼
;

402 
UIÁ32
 
outSize
;

403 
BoŞ—n
 
outWr™abË
;

404 
numBy‹s
;

407 
outSize
 = (
outWr™abË
);

408 
”r
 = 
	`AudioH¬dw¬eG‘Prİ”tyInfo
(
kAudioH¬dw¬ePrİ”tyDeviûs
, &
outSize
, &
outWr™abË
);

409 ià(
”r
 !ğ
noE¼
)

411 
	`PRINT_ERR
("Couldn'ˆg‘ infØabouˆli¡ oàaudiØdeviûs", 
”r
);

412 
sSavedHo¡E¼Ü
 = 
”r
;

413  
·Ho¡E¼Ü
;

417 
sNumCÜeDeviûs
 = 
outSize
 / (
AudioDeviûID
);

420 ià(
sNumCÜeDeviûs
 < 1)

422 
	`PRINT
(("No Devices Available"));

423  
·Ho¡E¼Ü
;

427 
sCÜeDeviûIDs
 = (
AudioDeviûID
 *)
	`m®loc
(
outSize
);

430 
”r
 = 
	`AudioH¬dw¬eG‘Prİ”ty
(
kAudioH¬dw¬ePrİ”tyDeviûs
, &
outSize
, (*)
sCÜeDeviûIDs
);

431 ià(
”r
 !ğ
noE¼
)

433 
	`PRINT_ERR
("Couldn'ˆg‘†i¡ oàaudiØdeviû IDs", 
”r
);

434 
sSavedHo¡E¼Ü
 = 
”r
;

435  
·Ho¡E¼Ü
;

440 
numBy‹s
 = 
sNumCÜeDeviûs
 * 2 * (
PaHo¡DeviûInfo
);

441 
sDeviûInfos
 = (
PaHo¡DeviûInfo
 *è
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ
numBy‹s
 );

442 ifĞ
sDeviûInfos
 =ğ
NULL
 )  
·Insuffic›ÁMemÜy
;

446 
	`DBUG
(("PaOSX_QueryDevices: scan for input ======================\n"));

447 
	`PaOSX_SÿnDeviûs
Ğ
IS_INPUT
 );

448 
sNumIÅutDeviûs
 = 
sNumPaDeviûs
;

450 
	`DBUG
(("PaOSX_QueryDevices: scan for output ======================\n"));

451 
	`PaOSX_SÿnDeviûs
Ğ
IS_OUTPUT
 );

452 
sNumOuutDeviûs
 = 
sNumPaDeviûs
 - 
sNumIÅutDeviûs
;

455 
sDeçuÉIÅutDeviûID
 = 
	`PaOSX_Qu”yDeçuÉIÅutDeviû
();

456 
sDeçuÉOuutDeviûID
 = 
	`PaOSX_Qu”yDeçuÉOuutDeviû
();

458  
·NoE¼Ü
;

459 
	}
}

466 
Flßt64
 
	$PaOSX_G‘DeviûSam¶eR©e
Ğ
AudioDeviûID
 
deviûID
, 
BoŞ—n
 
isIÅut
 )

468 
OSStus
 
”r
 = 
noE¼
;

469 
AudioSŒ—mBasicDesütiÚ
 
fÜm©Desc
;

470 
UIÁ32
 
d©aSize
;

471 
d©aSize
 = (
fÜm©Desc
);

472 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
deviûID
, 0, 
isIÅut
,

473 
kAudioDeviûPrİ”tySŒ—mFÜm©
, &
d©aSize
, &
fÜm©Desc
);

474 ifĞ
”r
 !ğ
noE¼
 )  0.0;

475  
fÜm©Desc
.
mSam¶eR©e
;

476 
	}
}

480 *
	$PaOSX_DeviûNameFromID
(
AudioDeviûID
 
deviûID
, 
BoŞ—n
 
isIÅut
 )

482 
OSStus
 
”r
 = 
noE¼
;

483 
UIÁ32
 
outSize
;

484 
BoŞ—n
 
outWr™abË
;

485 *
deviûName
 = 
n
;

488 
”r
 = 
	`AudioDeviûG‘Prİ”tyInfo
(
deviûID
, 0, 
isIÅut
, 
kAudioDeviûPrİ”tyDeviûName
, &
outSize
, &
outWr™abË
);

489 ià(
”r
 =ğ
noE¼
)

491 
deviûName
 = (*)
	`m®loc
Ğ
outSize
 + 1);

492 ifĞ
deviûName
 )

494 
”r
 = 
	`AudioDeviûG‘Prİ”ty
(
deviûID
, 0, 
isIÅut
, 
kAudioDeviûPrİ”tyDeviûName
, &
outSize
, 
deviûName
);

495 ià(
”r
 !ğ
noE¼
)

496 
	`PRINT_ERR
("Couldn'ˆg‘‡udiØdeviû‚ame", 
”r
);

500  
deviûName
;

501 
	}
}

508 
	$PaOSX_SÿnDeviûs
Ğ
BoŞ—n
 
isIÅut
 )

510 
cÜeDeviûIndex
;

511 
»suÉ
;

512 
PaHo¡DeviûInfo
 *
ho¡DeviûInfo
;

513 
numAdded
 = 0;

515  
cÜeDeviûIndex
=0; cÜeDeviûIndex<
sNumCÜeDeviûs
; coreDeviceIndex++ )

518 
ho¡DeviûInfo
 = &
sDeviûInfos
[
sNumPaDeviûs
];

519 
»suÉ
 = 
	`PaOSX_Qu”yDeviûInfo
Ğ
ho¡DeviûInfo
, 
cÜeDeviûIndex
, 
isIÅut
 );

520 
	`DBUG
(("PaOSX_SÿnDeviûs:…aDevId = %d, cÜeDevId = %d\n", 
sNumPaDeviûs
, 
cÜeDeviûIndex
 ));

521 ifĞ
»suÉ
 > 0 )

523 
sNumPaDeviûs
 += 1;

524 
numAdded
 += 1;

526 ifĞ
»suÉ
 < 0 ) „esult;

528  
numAdded
;

529 
	}
}

539 
	$PaOSX_Qu”yDeviûInfo
Ğ
PaHo¡DeviûInfo
 *
ho¡DeviûInfo
, 
cÜeDeviûIndex
, 
BoŞ—n
 
isIÅut
 )

541 
AudioSŒ—mBasicDesütiÚ
 *
®lSŒ—mFÜm©s
;

542 
AudioSŒ—mBasicDesütiÚ
 
fÜm©Desc
;

543 
OSStus
 
”r
;

544 
UIÁ32
 
outSize
;

545 
BoŞ—n
 
outWr™abË
;

546 
AudioDeviûID
 
devID
;

547 
numSŒ—mFÜm©s
;

548 
maxChªÃls
;

549 
i
;

550 
PaDeviûInfo
 *
deviûInfo
 = &
ho¡DeviûInfo
->
·Info
;

552 
deviûInfo
->
¡ruùV”siÚ
 = 1;

553 
deviûInfo
->
maxIÅutChªÃls
 = 0;

554 
deviûInfo
->
maxOuutChªÃls
 = 0;

556 
deviûInfo
->
§m¶eR©es
 = 
suµÜ‹dSam¶eR©eRªge
;

557 
deviûInfo
->
numSam¶eR©es
 = -1;

559 
devID
 = 
sCÜeDeviûIDs
[ 
cÜeDeviûIndex
 ];

560 
ho¡DeviûInfo
->
audioDeviûID
 = 
devID
;

561 
	`DBUG
(("PaOSX_Qu”yDeviûInfo:‚amğ%s\n", 
	`PaOSX_DeviûNameFromID
Ğ
devID
, 
isIÅut
 )));

562 
	`DBUG
(("PaOSX_QueryDeviceInfo: coreDeviceIndex = %d, devID = %d, isInput = %d\n",

563 
cÜeDeviûIndex
, 
devID
, 
isIÅut
 ));

566 
outSize
 = (
fÜm©Desc
);

567 
”r
 = 
	`AudioDeviûG‘Prİ”ty
(
devID
, 0, 
isIÅut
, 
kAudioDeviûPrİ”tySŒ—mFÜm©
, &
outSize
, &
fÜm©Desc
);

569 ifĞ(
”r
 !ğ
noE¼
è|| (
fÜm©Desc
.
mChªÃlsP”F¿me
 =ğ0èè
”rÜ
;

571 
	`DBUG
(("PaOSX_Qu”yDeviûInfo: mFÜm©ID = %4s\n", &
fÜm©Desc
.
mFÜm©ID
));

572 
	`DBUG
(("PaOSX_Qu”yDeviûInfo: mFÜm©FÏg ğ0x%x\n", 
fÜm©Desc
.
mFÜm©FÏgs
));

573 
	`DBUG
(("PaOSX_Qu”yDeviûInfo: kLš—rPCMFÜm©FÏgIsFlßˆğ0x%x\n", 
kLš—rPCMFÜm©FÏgIsFlßt
));

577 
deviûInfo
->
ÇtiveSam¶eFÜm©s
 = 
·Flßt32
;

582 
outSize
 = 0;

583 
”r
 = 
	`AudioDeviûG‘Prİ”tyInfo
Ğ
devID
, 0, 
isIÅut
,

584 
kAudioDeviûPrİ”tySŒ—mFÜm©s
,

585 &
outSize
, &
outWr™abË
 );

587 
®lSŒ—mFÜm©s
 = (
AudioSŒ—mBasicDesütiÚ
 *)
	`m®loc
(
outSize
);

588 
numSŒ—mFÜm©s
 = 
outSize
 / (
AudioSŒ—mBasicDesütiÚ
);

589 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
devID
, 0, 
isIÅut
,

590 
kAudioDeviûPrİ”tySŒ—mFÜm©s
,

591 &
outSize
, 
®lSŒ—mFÜm©s
);

593 
	`DBUG
(("%d suµÜ‹d fÜm©s!\n", 
numSŒ—mFÜm©s
));

594 
maxChªÃls
 = 0;

595 
i
=0; i<
numSŒ—mFÜm©s
; i++) {

596 
	`DBUG
(("Format %d: formatID=%4s flags=0x%x channels=%d„ate=%.0f\n",

597 
i
,

598 &
®lSŒ—mFÜm©s
[
i
].
mFÜm©ID
,

599 
®lSŒ—mFÜm©s
[
i
].
mFÜm©FÏgs
,

600 
®lSŒ—mFÜm©s
[
i
].
mChªÃlsP”F¿me
,

601 
®lSŒ—mFÜm©s
[
i
].
mSam¶eR©e
));

603 ià(
®lSŒ—mFÜm©s
[
i
].
mChªÃlsP”F¿me
 > 
maxChªÃls
)

604 
maxChªÃls
 = 
®lSŒ—mFÜm©s
[
i
].
mChªÃlsP”F¿me
;

607 
	`ä“
(
®lSŒ—mFÜm©s
);

611 
	`mem£t
Ğ&
fÜm©Desc
, 0, (formatDesc));

612 
fÜm©Desc
.
mChªÃlsP”F¿me
 = 256;

613 
fÜm©Desc
.
mFÜm©ID
 = 
kAudioFÜm©Lš—rPCM
;

614 
fÜm©Desc
.
mFÜm©FÏgs
 =

615 
kAudioFÜm©FÏgIsFlßt
 |

616 
kAudioFÜm©FÏgIsBigEndŸn
 |

617 
kAudioFÜm©FÏgIsPacked
;

618 
outSize
 = (
fÜm©Desc
);

619 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
devID
, 0,

620 
isIÅut
, 
kAudioDeviûPrİ”tySŒ—mFÜm©M©ch
, &
outSize
, &
fÜm©Desc
);

621 ifĞ
”r
 !ğ
noE¼
 )

623 
	`PRINT_ERR
("PaOSX_Qu”yDeviûInfo: Could‚Ù g‘ deviû fÜm© m©ch", 
”r
);

624 
sSavedHo¡E¼Ü
 = 
”r
;

625  
·Ho¡E¼Ü
;

629 ifĞ
isIÅut
 )

631 
deviûInfo
->
maxIÅutChªÃls
 = 
maxChªÃls
;

635 
deviûInfo
->
maxOuutChªÃls
 = 
maxChªÃls
;

639 
deviûInfo
->
Çme
 = 
	`PaOSX_DeviûNameFromID
Ğ
devID
, 
isIÅut
 );

642 
	`DBUG
(("\n"));

644 
”rÜ
:

646 
	}
}

649 
PaE¼Ü
 
	$PaOSX_MaybeQu”yDeviûs
( )

651 ifĞ
sNumPaDeviûs
 == 0 )

653  
	`PaOSX_Qu”yDeviûs
();

656 
	}
}

658 
	gz”oPad
[256] = { 0 };

665 
OSStus
 
	$PaOSX_IÅutCÚv”‹rC®lbackProc
 (
AudioCÚv”‹rRef
 
šAudioCÚv”‹r
,

666 
UIÁ32
* 
outD©aSize
,

667 ** 
outD©a
,

668 * 
šU£rD©a
)

670 
š‹º®PÜtAudioSŒ—m
 *
·¡
 = (š‹º®PÜtAudioSŒ—m *è
šU£rD©a
;

671 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

672 *
d©aPŒ1
;

673 
size1
;

674 *
d©aPŒ2
;

675 
size2
;

678 
	`RšgBufãr_G‘R—dRegiÚs
Ğ&
·hsc
->
ršgBufãr
, *
outD©aSize
,

679 &
d©aPŒ1
, &
size1
, &
d©aPŒ2
, &
size2
 );

681 ifĞ
size1
 > 0 )

683 *
outD©a
 = 
d©aPŒ1
;

684 *
outD©aSize
 = 
size1
;

685 
	`RšgBufãr_AdvªûR—dIndex
Ğ&
·hsc
->
ršgBufãr
, 
size1
 );

686 
	`DBUGX
(("PaOSX_IÅutCÚv”‹rC®lbackProc:„—d %ld by‹ äom FIFO.\n", 
size1
 ));

690 
	`DBUGBACK
(("PaOSX_InputConverterCallbackProc: got‚o data!\n"));

691 *
outD©a
 = 
z”oPad
;

692 *
outD©aSize
 = (
z”oPad
);

694  
noE¼
;

695 
	}
}

701 
OSStus
 
	$PaOSX_LßdAndProûss
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
,

702 *
šputBufãr
, *
ouutBufãr
 )

704 
OSStus
 
”r
 = 
noE¼
;

705 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

707 ifĞ
·¡
->
·¡_StİSoÚ
 )

709 ifĞ
ouutBufãr
 )

712 
	`AddT¿ûMes§ge
("PaOSX_LßdAndProûss: z”Ø»¡ oàwavbufã¸", 
i
 );

713 
	`mem£t
Ğ
ouutBufãr
, 0, 
·hsc
->
ouut
.
by‹sP”U£rN©iveBufãr
 );

719 ifĞ
PA_USING_INPUT
 )

721 
UIÁ32
 
size
 = 
·hsc
->
šput
.
by‹sP”U£rN©iveBufãr
;

722 
”r
 = 
	`AudioCÚv”‹rFlBufãr
(

723 
·hsc
->
šput
.
cÚv”‹r
,

724 
PaOSX_IÅutCÚv”‹rC®lbackProc
,

725 
·¡
,

726 &
size
,

727 
·hsc
->
šput
.
cÚv”‹rBufãr
);

728 ifĞ
”r
 !ğ
noE¼
 ) ƒrr;

729 
šputBufãr
 = 
·hsc
->
šput
.
cÚv”‹rBufãr
;

734 ifĞ
	`PaCÚv”t_Proûss
Ğ
·¡
, 
šputBufãr
, 
ouutBufãr
 ))

736 
·¡
->
·¡_StİSoÚ
 = 1;

739  
”r
;

740 
	}
}

745 
OSStus
 
	$PaOSX_OuutCÚv”‹rC®lbackProc
 (
AudioCÚv”‹rRef
 
šAudioCÚv”‹r
,

746 
UIÁ32
* 
outD©aSize
,

747 ** 
outD©a
,

748 * 
šU£rD©a
)

750 
š‹º®PÜtAudioSŒ—m
 *
·¡
 = (š‹º®PÜtAudioSŒ—m *è
šU£rD©a
;

751 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

753 *
outD©a
 = 
·hsc
->
ouut
.
cÚv”‹rBufãr
;

754 *
outD©aSize
 = 
·hsc
->
ouut
.
by‹sP”U£rN©iveBufãr
;

756  
	`PaOSX_LßdAndProûss
 ( 
·¡
, 
·hsc
->
šput
.
cÚv”‹rBufãr
,…ahsc->
ouut
.converterBuffer );

757 
	}
}

764 
OSStus
 
	$PaOSX_HªdËIÅutOuut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
,

765 cÚ¡ 
AudioBufãrLi¡
* 
šIÅutD©a
,

766 
AudioBufãrLi¡
* 
outOuutD©a
 )

768 
OSStus
 
”r
 = 
noE¼
;

769 *
šputN©iveBufãrfPŒ
 = 
NULL
;

770 *
ouutN©iveBufãrfPŒ
 = 
NULL
;

771 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

774 ifĞ
outOuutD©a
->
mNumb”Bufãrs
 > 0 )

776 
ouutN©iveBufãrfPŒ
 = (*)
outOuutD©a
->
mBufãrs
[0].
mD©a
;

779 ifĞ
šIÅutD©a
->
mNumb”Bufãrs
 > 0 )

781 
šputN©iveBufãrfPŒ
 = (*)
šIÅutD©a
->
mBufãrs
[0].
mD©a
;

784 ifĞ(
·hsc
->
mode
 =ğ
PA_MODE_INPUT_ONLY
è|| (·hsc->mod=ğ
PA_MODE_IO_ONE_DEVICE
) )

786 
wr™eRoom
 = 
	`RšgBufãr_G‘Wr™eAvaabË
Ğ&
·hsc
->
ršgBufãr
 );

787 
numBy‹s
 = 
šIÅutD©a
->
mBufãrs
[0].
mD©aBy‹Size
;

788 ifĞ
numBy‹s
 <ğ
wr™eRoom
 )

790 
	`RšgBufãr_Wr™e
Ğ&
·hsc
->
ršgBufãr
, 
šputN©iveBufãrfPŒ
, 
numBy‹s
 );

791 
	`DBUGBACK
(("PaOSX_HªdËIÅutOuut: wrÙ%ld by‹ tØFIFO.\n", 
šIÅutD©a
->
mBufãrs
[0].
mD©aBy‹Size
));

796 ifĞ
·hsc
->
mode
 =ğ
PA_MODE_INPUT_ONLY
 )

799 
h®fSize
 = 
·hsc
->
ršgBufãr
.
bufãrSize
 / 2;

800  (
	`RšgBufãr_G‘R—dAvaabË
Ğ&
·hsc
->
ršgBufãr
 ) >ğ
h®fSize
) &&

801 (
·¡
->
·¡_StİSoÚ
 == 0) )

803 
”r
 = 
	`PaOSX_LßdAndProûss
 ( 
·¡
, 
NULL
, NULL );

804 ifĞ
”r
 !ğ
noE¼
 ) 
”rÜ
;

809 
UIÁ32
 
size
 = 
outOuutD©a
->
mBufãrs
[0].
mD©aBy‹Size
;

810 
”r
 = 
	`AudioCÚv”‹rFlBufãr
(

811 
·hsc
->
ouut
.
cÚv”‹r
,

812 
PaOSX_OuutCÚv”‹rC®lbackProc
,

813 
·¡
,

814 &
size
,

815 
ouutN©iveBufãrfPŒ
);

816 ifĞ
”r
 !ğ
noE¼
 )

818 
	`PRINT_ERR
("PaOSX_HªdËIÅutOuut: AudioCÚv”‹rFlBufã¸çed", 
”r
);

819 
”rÜ
;

823 
”rÜ
:

824  
”r
;

825 
	}
}

833 
OSStus
 
	$PaOSX_CÜeAudioIÅutC®lback
 (
AudioDeviûID
 
šDeviû
, cÚ¡ 
AudioTimeSmp
* 
šNow
,

834 cÚ¡ 
AudioBufãrLi¡
* 
šIÅutD©a
, cÚ¡ 
AudioTimeSmp
* 
šIÅutTime
,

835 
AudioBufãrLi¡
* 
outOuutD©a
, cÚ¡ 
AudioTimeSmp
* 
šOuutTime
,

836 * 
cÚ‹xtPŒ
)

838 
š‹º®PÜtAudioSŒ—m
 *
·¡
 = (š‹º®PÜtAudioSŒ—m *è
cÚ‹xtPŒ
;

839 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

840 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

843 ifĞ
·hsc
->
ršgBufãrD©a
 !ğ
NULL
 )

845 
wr™eRoom
 = 
	`RšgBufãr_G‘Wr™eAvaabË
Ğ&
·hsc
->
ršgBufãr
 );

846 
numBy‹s
 = 
šIÅutD©a
->
mBufãrs
[0].
mD©aBy‹Size
;

847 ifĞ
numBy‹s
 <ğ
wr™eRoom
 )

849 
	`RšgBufãr_Wr™e
Ğ&
·hsc
->
ršgBufãr
, 
šIÅutD©a
->
mBufãrs
[0].
mD©a
, inIÅutD©a->mBufãrs[0].
mD©aBy‹Size
 );

853 
	`DBUGBACK
(("PaOSX_CoreAudioInputCallback: FIFOoo fullo write!\n"));

857  
noE¼
;

858 
	}
}

867 
OSStus
 
	$PaOSX_CÜeAudioIOC®lback
 (
AudioDeviûID
 
šDeviû
, cÚ¡ 
AudioTimeSmp
* 
šNow
,

868 cÚ¡ 
AudioBufãrLi¡
* 
šIÅutD©a
, cÚ¡ 
AudioTimeSmp
* 
šIÅutTime
,

869 
AudioBufãrLi¡
* 
outOuutD©a
, cÚ¡ 
AudioTimeSmp
* 
šOuutTime
,

870 * 
cÚ‹xtPŒ
)

872 
OSStus
 
”r
 = 
noE¼
;

873 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

874 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

875 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
cÚ‹xtPŒ
;

876 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

879 ifĞ
·¡
->
·¡_StİNow
 )

881 
·¡
->
·¡_IsAùive
 = 0;

886 ifĞ
·¡
->
·¡_StİSoÚ
 )

889 
·¡
->
·¡_IsAùive
 = 0;

909 
	`Pa_S¹U§geC®cuÏtiÚ
Ğ
·¡
 );

910 
·¡
->
·¡_NumC®lbacks
 += 1;

913 
”r
 = 
	`PaOSX_HªdËIÅutOuut
Ğ
·¡
, 
šIÅutD©a
, 
outOuutD©a
 );

915 
	`Pa_EndU§geC®cuÏtiÚ
Ğ
·¡
 );

918 ifĞ
”r
 !ğ0 ) 
	`DBUG
(("PaOSX_CoreAudioIOCallback:„eturns %ld.\n",ƒrr ));

920  
”r
;

921 
	}
}

925 
	$PaOSX_IsB‘‹rFÜm©
(
AudioSŒ—mBasicDesütiÚ
 *
ÃwFÜm©
,

926 
AudioSŒ—mBasicDesütiÚ
 *
ŞdFÜm©
,

927 
desœedR©e
, 
desœedChªÃls
)

931 ià(
ÃwFÜm©
->
mFÜm©ID
 !ğ
kAudioFÜm©Lš—rPCM
)

935 ià(
ŞdFÜm©
->
mFÜm©ID
 !ğ
kAudioFÜm©Lš—rPCM
 &&

936 
ÃwFÜm©
->
mFÜm©ID
 =ğ
kAudioFÜm©Lš—rPCM
)

942 ià(
ŞdFÜm©
->
mChªÃlsP”F¿me
 < 
desœedChªÃls
 &&

943 
ÃwFÜm©
->
mChªÃlsP”F¿me
 >ğ
desœedChªÃls
)

946 ià(
ÃwFÜm©
->
mChªÃlsP”F¿me
 < 
desœedChªÃls
 &&

947 
ŞdFÜm©
->
mChªÃlsP”F¿me
 >ğ
desœedChªÃls
)

951 ià(
ŞdFÜm©
->
mB™sP”ChªÃl
 == 8 &&

952 
ÃwFÜm©
->
mB™sP”ChªÃl
 >= 16)

955 ià(
ÃwFÜm©
->
mB™sP”ChªÃl
 == 8 &&

956 
ŞdFÜm©
->
mB™sP”ChªÃl
 >= 16)

961 ià(
ÃwFÜm©
->
mSam¶eR©e
 == 0 &&

962 
ŞdFÜm©
->
mSam¶eR©e
 != 0)

965 ià(
ÃwFÜm©
->
mSam¶eR©e
 != 0 &&

966 
ŞdFÜm©
->
mSam¶eR©e
 == 0)

969 ià(
ŞdFÜm©
->
mSam¶eR©e
 != 0 &&

970 
ÃwFÜm©
->
mSam¶eR©e
 != 0) {

976 ià(
desœedR©e
 < 
ÃwFÜm©
->
mSam¶eR©e
 &&

977 
desœedR©e
 < 
ŞdFÜm©
->
mSam¶eR©e
)

979 ià(
	`çbs
(
ÃwFÜm©
->
mSam¶eR©e
 - 
desœedR©e
) < 1.0 &&

980 
	`çbs
(
ŞdFÜm©
->
mSam¶eR©e
 - 
desœedR©e
) >= 1.0)

985 ià(
	`çbs
(
ÃwFÜm©
->
mSam¶eR©e
 - 
desœedR©e
) <

986 
	`çbs
(
ŞdFÜm©
->
mSam¶eR©e
 - 
desœedR©e
))

993 ià(
ÃwFÜm©
->
mB™sP”ChªÃl
 >

994 
ŞdFÜm©
->
mB™sP”ChªÃl
)

998 
	}
}

1000 
	$PaOSX_Debug_Pršt_FÜm©
(
šdex
, 
AudioSŒ—mBasicDesütiÚ
 *
fÜm©
)

1002 
	`DBUG
(("Format %2d: %s %2d-bit %d-channel %6.0f Hz\n",

1003 
šdex
,

1004 
fÜm©
->
mFÜm©ID
 =ğ
kAudioFÜm©Lš—rPCM
? "linear PCM" : "non-PCM ",

1005 
fÜm©
->
mB™sP”ChªÃl
,

1006 
fÜm©
->
mChªÃlsP”F¿me
,

1007 
fÜm©
->
mSam¶eR©e
));

1008 
	}
}

1011 
	gPaOSX_L—ve_Deviû_AlÚe_Mode
 = 0;

1023 
PaE¼Ü
 
	$PaOSX_S‘FÜm©
Ğ
AudioDeviûID
 
devID
, 
BoŞ—n
 
isIÅut
,

1024 
desœedR©e
, 
desœedNumChªÃls
 )

1026 
AudioSŒ—mID
 *
¡»ams
 = 
NULL
;

1027 
AudioSŒ—mBasicDesütiÚ
 *
fÜm©s
 = 
NULL
;

1028 
PaE¼Ü
 
»suÉ
 = 0;

1029 
OSStus
 
”r
;

1030 
BoŞ—n
 
outWr™abË
;

1031 
UIÁ32
 
d©aSize
;

1032 
desœedNumChªÃlsP”SŒ—m
;

1033 
numSŒ—ms
;

1034 
¡»amIndex
;

1035 
pid_t
 
hog_pid
;

1036 
pid_t
 
this_pid
 = 
	`g‘pid
();

1037 
did_£t_hog_mode
 = 0;

1043 ià(
PaOSX_L—ve_Deviû_AlÚe_Mode
) {

1044 
	`DBUG
(("Opening device‡s-is.\n"));

1050 
”r
 = 
	`AudioDeviûG‘Prİ”tyInfo
Ğ
devID
, 0, 
isIÅut
,

1051 
kAudioDeviûPrİ”tySŒ—ms
, &
d©aSize
, 
NULL
 );

1052 iàĞ
”r
 !ğ
noE¼
 )

1054 
	`PRINT_ERR
("PaOSX_S‘FÜm©: Could‚Ù g‘‚umb” oà¡»ams.", 
”r
);

1055 
sSavedHo¡E¼Ü
 = 
”r
;

1056 
»suÉ
 = 
·Ho¡E¼Ü
;

1057 
fšish
;

1060 
¡»ams
 = (
AudioSŒ—mID
 *)
	`m®loc
(
d©aSize
);

1061 iàĞ!
¡»ams
 )

1063 
	`PRINT_ERR
("PaOSX_S‘FÜm©: Could‚Ù‡Îoÿ‹ %d by‹ fÜ sŒ—ms.", 
d©aSize
);

1064 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

1065 
fšish
;

1068 
numSŒ—ms
 = 
d©aSize
 / (
AudioSŒ—mID
);

1069 
	`DBUG
(("PaOSX_S‘FÜm©:‚umSŒ—ms=%d.\n", 
numSŒ—ms
 ));

1071 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
devID
, 0, 
isIÅut
,

1072 
kAudioDeviûPrİ”tySŒ—ms
, &
d©aSize
, 
¡»ams
 );

1073 iàĞ
”r
 !ğ
noE¼
 )

1075 
	`PRINT_ERR
("PaOSX_S‘FÜm©: Could‚Ù g‘ sŒ—ms.", 
”r
);

1076 
sSavedHo¡E¼Ü
 = 
”r
;

1077 
»suÉ
 = 
·Ho¡E¼Ü
;

1078 
fšish
;

1081 
desœedNumChªÃlsP”SŒ—m
 = 
desœedNumChªÃls
 / 
numSŒ—ms
;

1082 ià(
desœedNumChªÃlsP”SŒ—m
 < 1)

1083 
desœedNumChªÃlsP”SŒ—m
 = 1;

1085 
	`DBUG
(("PaOSX_S‘FÜm©: desœedNumChªÃlsP”SŒ—m=%d.\n", 
desœedNumChªÃlsP”SŒ—m
));

1092 
¡»amIndex
=0; sŒ—mIndex<
numSŒ—ms
; streamIndex++)

1094 
AudioSŒ—mBasicDesütiÚ
 *
be¡FÜm©
;

1095 
AudioSŒ—mBasicDesütiÚ
 
cu¼’tFÜm©
;

1096 
numFÜm©s
;

1097 
fÜm©Index
;

1098 
be¡FÜm©Index
;

1099 
ch
 = 0;

1101 
	`DBUG
(("SŒ—m %d\n", 
¡»amIndex
));

1105 
d©aSize
 = (
cu¼’tFÜm©
);

1106 
”r
 = 
	`AudioSŒ—mG‘Prİ”ty
Ğ
¡»ams
[
¡»amIndex
], 
ch
,

1107 
kAudioSŒ—mPrİ”tyPhysiÿlFÜm©
, &
d©aSize
,

1108 &
cu¼’tFÜm©
);

1109 iàĞ
”r
 !ğ
noE¼
 )

1111 
	`PRINT_ERR
("PaOSX_S‘FÜm©: Could‚Ù g‘ cu¼’ˆphysiÿÈfÜm© oà¡»am %d.", 
¡»amIndex
);

1112 
sSavedHo¡E¼Ü
 = 
”r
;

1113 
»suÉ
 = 
·Ho¡E¼Ü
;

1114 
fšish
;

1117 
	`PaOSX_Debug_Pršt_FÜm©
(-1, &
cu¼’tFÜm©
);

1121 
”r
 = 
	`AudioSŒ—mG‘Prİ”tyInfo
Ğ
¡»ams
[
¡»amIndex
], 
ch
,

1122 
kAudioSŒ—mPrİ”tyPhysiÿlFÜm©s
, &
d©aSize
, 
NULL
 );

1123 iàĞ
”r
 !ğ
noE¼
 )

1125 
	`ä“
(
¡»ams
);

1126 
	`PRINT_ERR
("PaOSX_S‘FÜm©: Could‚Ù g‘‚umb” oàphysiÿÈfÜm© fÜ sŒ—m %d.", 
¡»amIndex
);

1127 
sSavedHo¡E¼Ü
 = 
”r
;

1128 
»suÉ
 = 
·Ho¡E¼Ü
;

1129 
fšish
;

1132 
fÜm©s
 = (
AudioSŒ—mBasicDesütiÚ
 *)
	`m®loc
(
d©aSize
);

1133 iàĞ!
fÜm©s
 )

1135 
	`PRINT_ERR
("PaOSX_S‘FÜm©: Could‚Ù‡Îoÿ‹ %d by‹ fÜ sŒ—m fÜm©s.", 
d©aSize
);

1136 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

1137 
fšish
;

1140 
”r
 = 
	`AudioSŒ—mG‘Prİ”ty
Ğ
¡»ams
[
¡»amIndex
], 
ch
,

1141 
kAudioSŒ—mPrİ”tyPhysiÿlFÜm©s
, &
d©aSize
, 
fÜm©s
 );

1142 iàĞ
”r
 !ğ
noE¼
 )

1144 
	`PRINT_ERR
("PaOSX_S‘FÜm©: Could‚Ù g‘‡Î…hysiÿÈfÜm© fÜ sŒ—m %d.", 
¡»amIndex
);

1145 
sSavedHo¡E¼Ü
 = 
”r
;

1146 
»suÉ
 = 
·Ho¡E¼Ü
;

1147 
fšish
;

1150 
numFÜm©s
 = 
d©aSize
 / (
AudioSŒ—mBasicDesütiÚ
);

1161 
be¡FÜm©Index
 = -1;

1162 
be¡FÜm©
 = &
cu¼’tFÜm©
;

1164 
fÜm©Index
=0; fÜm©Index<
numFÜm©s
; formatIndex++)

1166 
	`PaOSX_Debug_Pršt_FÜm©
(
fÜm©Index
, &
fÜm©s
[formatIndex]);

1168 ià(
	`PaOSX_IsB‘‹rFÜm©
(&
fÜm©s
[
fÜm©Index
], 
be¡FÜm©
,

1169 
desœedR©e
, 
desœedNumChªÃlsP”SŒ—m
))

1171 
	`DBUG
(("FÜm© %d i ¡riùly b‘‹¸thª fÜm© %d\n", 
fÜm©Index
, 
be¡FÜm©Index
));

1172 
be¡FÜm©Index
 = 
fÜm©Index
;

1173 
be¡FÜm©
 = &
fÜm©s
[
fÜm©Index
];

1177 ià(
be¡FÜm©Index
 != -1)

1183 ià(!
did_£t_hog_mode
)

1186 
d©aSize
 = (
hog_pid
);

1187 
”r
 = 
	`AudioDeviûG‘Prİ”ty
(
devID
, 0, 
isIÅut
,

1188 
kAudioDeviûPrİ”tyHogMode
, &
d©aSize
, &
hog_pid
);

1190 ià(!
”r
 && 
hog_pid
 !ğ
this_pid
)

1192 
	`DBUG
(("Cu¼’ˆ¡©u oàhog mode:…id=%dhis_pid=%d\n", ()
hog_pid
, ()
this_pid
));

1194 
hog_pid
 = 
this_pid
;

1195 
”r
 = 
	`AudioDeviûS‘Prİ”ty
Ğ
devID
, 0, 0, 
isIÅut
,

1196 
kAudioDeviûPrİ”tyHogMode
, (
hog_pid
), &hog_pid);

1197 ià(!
”r
)

1199 
	`DBUG
(("Successfully set hog mode.\n"));

1200 
did_£t_hog_mode
 = 1;

1209 ià(
be¡FÜm©
->
mSam¶eR©e
 == 0)

1210 
be¡FÜm©
->
mSam¶eR©e
 = 
desœedR©e
;

1212 
d©aSize
 = (
AudioSŒ—mBasicDesütiÚ
);

1213 
”r
 = 
	`AudioSŒ—mS‘Prİ”ty
Ğ
¡»ams
[
¡»amIndex
], 
NULL
, 
ch
,

1214 
kAudioSŒ—mPrİ”tyPhysiÿlFÜm©
, 
d©aSize
,

1215 
be¡FÜm©
 );

1217 ià(
”r
 !ğ
noE¼
)

1219 
	`DBUG
(("SucûssfuÎy s‘ fÜm© oà¡»am %d.\n", 
¡»amIndex
));

1220 
»suÉ
 = 1;

1224 
	`DBUG
(("UÇbËØ£ˆfÜm© oà¡»am %d.\n", 
¡»amIndex
));

1229 
”r
 = 
	`AudioSŒ—mS‘Prİ”ty
Ğ
devID
, 
NULL
, 
ch
,

1230 
kAudioSŒ—mPrİ”tyPhysiÿlFÜm©
, 
d©aSize
,

1231 
be¡FÜm©
 );

1233 ià(
”r
 !ğ
noE¼
)

1235 
	`DBUG
(("SucûssfuÎy s‘ fÜm© oàdeviû.\n", 
¡»amIndex
));

1236 
»suÉ
 = 1;

1240 
	`DBUG
(("UÇbËØ£ˆfÜm© oàdeviû.\n", 
¡»amIndex
));

1246 
	`DBUG
(("No‚eedo set stream format,ƒxisting format is goodƒnough.\n"));

1253 ià(
»suÉ
 == 1)

1255 
UIÁ32
 
suµÜtsMixšg
 = 1;

1256 
”r
 = 
	`AudioDeviûS‘Prİ”ty
Ğ
devID
, 0, 0, 
isIÅut
,

1257 
kAudioDeviûPrİ”tySuµÜtsMixšg
, (
UIÁ32
), &
suµÜtsMixšg
);

1259 ià(
”r
) {

1260 
	`DBUG
(("Unableourn on mixing\n"));

1263 
	`DBUG
(("Turned on mixing!\n"));

1267 
fšish
:

1269 ià(
¡»ams
)

1270 
	`ä“
(
¡»ams
);

1271 ià(
fÜm©s
)

1272 
	`ä“
(
fÜm©s
);

1274 ià(
did_£t_hog_mode
)

1276 
hog_pid
 = -1;

1277 
”r
 = 
	`AudioDeviûS‘Prİ”ty
Ğ
devID
, 0, 0, 
isIÅut
, 
kAudioDeviûPrİ”tyHogMode
,

1278 (
hog_pid
), &hog_pid );

1280 ià(
”r
 !ğ
noE¼
) {

1281 
	`DBUG
(("Error„eleasing hog mode.\n"));

1284 
	`DBUG
(("Hog mode„eleased successfully.\n"));

1288  
»suÉ
;

1289 
	}
}

1295 
	$PaOSX_FixVŞumeSÿÏrs
Ğ
AudioDeviûID
 
devID
, 
BoŞ—n
 
isIÅut
,

1296 
numChªÃls
, 
th»shŞd
, 
ÃwLev–
 )

1298 
OSStus
 
”r
 = 
noE¼
;

1299 
UIÁ32
 
d©aSize
;

1300 
iChªÃl
;

1304  
iChªÃl
 = 0; iChªÃl<=
numChªÃls
; iChannel++ )

1306 
Flßt32
 
fd©a32
;

1307 
d©aSize
 = Ğ
fd©a32
 );

1308 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
devID
, 
iChªÃl
, 
isIÅut
,

1309 
kAudioDeviûPrİ”tyVŞumeSÿÏr
, &
d©aSize
, &
fd©a32
 );

1311 
	`´štf
("devID=%d\n", 
devID
);

1313 
	`´štf
("Channel=%d input=%d volume=%f\n",

1314 
iChªÃl
, ()
isIÅut
, 
fd©a32
);

1316 ifĞ
”r
 =ğ
noE¼
 )

1318 
	`DBUG
(("kAudioDeviûPrİ”tyVŞumeSÿÏ¸fÜ chªÃÈ%d = %f\n", 
iChªÃl
, 
fd©a32
));

1319 ifĞ
fd©a32
 <ğ(
Flßt32
è
th»shŞd
 )

1321 
d©aSize
 = Ğ
fd©a32
 );

1322 
fd©a32
 = (
Flßt32
è
ÃwLev–
;

1324 
	`´štf
("Channel=%d input=%d‚ew volume=%f\n",

1325 
iChªÃl
, ()
isIÅut
, 
fd©a32
);

1327 
”r
 = 
	`AudioDeviûS‘Prİ”ty
Ğ
devID
, 0, 
iChªÃl
, 
isIÅut
,

1328 
kAudioDeviûPrİ”tyVŞumeSÿÏr
, 
d©aSize
, &
fd©a32
 );

1329 ifĞ
”r
 !ğ
noE¼
 )

1331 
	`PRINT
(("Warning:‡udio volume is very†ow‡nd could‚ot beurned up.\n"));

1335 
	`PRINT
(("Volume for‡udio channel %d was <= %4.2f so seto %4.2f by PortAudio!\n",

1336 
iChªÃl
, 
th»shŞd
, 
ÃwLev–
 ));

1342  
iChªÃl
 = 0; iChªÃl<=
numChªÃls
; iChannel++ )

1344 
UIÁ32
 
uid©a32
;

1345 
d©aSize
 = Ğ
uid©a32
 );

1346 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
devID
, 
iChªÃl
, 
isIÅut
,

1347 
kAudioDeviûPrİ”tyMu‹
, &
d©aSize
, &
uid©a32
 );

1348 ifĞ
”r
 =ğ
noE¼
 )

1350 
	`DBUG
(("uid©a32 fÜ chªÃÈ%d = %ld\n", 
iChªÃl
, 
uid©a32
));

1351 ifĞ
uid©a32
 == 1 )

1353 
d©aSize
 = Ğ
uid©a32
 );

1354 
uid©a32
 = 0;

1355 
”r
 = 
	`AudioDeviûS‘Prİ”ty
Ğ
devID
, 0, 
iChªÃl
, 
isIÅut
,

1356 
kAudioDeviûPrİ”tyMu‹
, 
d©aSize
, &
uid©a32
 );

1357 ifĞ
”r
 !ğ
noE¼
 )

1359 
	`PRINT
(("Warning:‡udio is muted‡nd could‚ot be unmuted!\n"));

1363 
	`PRINT
(("AudiØchªÃÈ%d wa unmu‹d by PÜtAudio!\n", 
iChªÃl
 ));

1369 
	}
}

1372 
	$PaOSX_DumpDeviûInfo
Ğ
AudioDeviûID
 
devID
, 
BoŞ—n
 
isIÅut
 )

1374 
OSStus
 
”r
 = 
noE¼
;

1375 
UIÁ32
 
d©aSize
;

1376 
UIÁ32
 
uid©a32
;

1377 
Flßt32
 
fd©a32
;

1378 
AudioV®ueRªge
 
audioRªge
;

1380 
d©aSize
 = Ğ
uid©a32
 );

1381 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
devID
, 0, 
isIÅut
,

1382 
kAudioDeviûPrİ”tyL©’cy
, &
d©aSize
, &
uid©a32
 );

1383 ifĞ
”r
 !ğ
noE¼
 )

1385 
	`PRINT_ERR
("E¼Ü„—dšg kAudioDeviûPrİ”tyL©’cy", 
”r
);

1388 
	`PRINT
(("kAudioDeviûPrİ”tyL©’cy = %d\n", ()
uid©a32
 ));

1390 
d©aSize
 = Ğ
fd©a32
 );

1391 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
devID
, 1, 
isIÅut
,

1392 
kAudioDeviûPrİ”tyVŞumeSÿÏr
, &
d©aSize
, &
fd©a32
 );

1393 ifĞ
”r
 !ğ
noE¼
 )

1395 
	`PRINT_ERR
("E¼Ü„—dšg kAudioDeviûPrİ”tyVŞumeSÿÏr", 
”r
);

1398 
	`PRINT
(("kAudioDeviûPrİ”tyVŞumeSÿÏ¸ğ%f\n", 
fd©a32
 ));

1400 
d©aSize
 = Ğ
uid©a32
 );

1401 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
devID
, 0, 
isIÅut
,

1402 
kAudioDeviûPrİ”tyBufãrSize
, &
d©aSize
, &
uid©a32
 );

1403 ifĞ
”r
 !ğ
noE¼
 )

1405 
	`PRINT_ERR
("E¼Ü„—dšg bufã¸size", 
”r
);

1408 
	`PRINT
(("kAudioDeviûPrİ”tyBufãrSizğ%d by‹s\n", ()
uid©a32
 ));

1410 
d©aSize
 = Ğ
audioRªge
 );

1411 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
devID
, 0, 
isIÅut
,

1412 
kAudioDeviûPrİ”tyBufãrSizeRªge
, &
d©aSize
, &
audioRªge
 );

1413 ifĞ
”r
 !ğ
noE¼
 )

1415 
	`PRINT_ERR
("E¼Ü„—dšg bufã¸siz¿nge", 
”r
);

1418 
	`PRINT
(("kAudioDeviûPrİ”tyBufãrSizeRªgğ%gØ%g by‹s\n", 
audioRªge
.
mMšimum
,‡udioRªge.
mMaximum
 ));

1420 
d©aSize
 = Ğ
uid©a32
 );

1421 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
devID
, 0, 
isIÅut
,

1422 
kAudioDeviûPrİ”tyBufãrF¿meSize
, &
d©aSize
, &
uid©a32
 );

1423 ifĞ
”r
 !ğ
noE¼
 )

1425 
	`PRINT_ERR
("E¼Ü„—dšg bufã¸size", 
”r
);

1428 
	`PRINT
(("kAudioDeviûPrİ”tyBufãrF¿meSizğ%d f¿mes\n", ()
uid©a32
 ));

1430 
d©aSize
 = Ğ
audioRªge
 );

1431 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
devID
, 0, 
isIÅut
,

1432 
kAudioDeviûPrİ”tyBufãrF¿meSizeRªge
, &
d©aSize
, &
audioRªge
 );

1433 ifĞ
”r
 !ğ
noE¼
 )

1435 
	`PRINT_ERR
("E¼Ü„—dšg bufã¸siz¿nge", 
”r
);

1438 
	`PRINT
(("kAudioDeviûPrİ”tyBufãrF¿meSizeRªgğ%gØ%g f¿mes\n", 
audioRªge
.
mMšimum
,‡udioRªge.
mMaximum
 ));

1441 
	}
}

1445 
OSStus
 
	$PAOSX_DeviûPrİ”tyLi¡’”
 (
AudioDeviûID
 
šDeviû
,

1446 
UIÁ32
 
šChªÃl
,

1447 
BoŞ—n
 
isIÅut
,

1448 
AudioDeviûPrİ”tyID
 
šPrİ”tyID
,

1449 * 
šCl›ÁD©a
)

1451 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1452 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

1453 
UIÁ32
 
d©aSize
;

1454 
OSStus
 
”r
 = 
noE¼
;

1455 
AudioSŒ—mBasicDesütiÚ
 
u£rSŒ—mFÜm©
, 
h¬dw¬eSŒ—mFÜm©
;

1456 
BoŞ—n
 
upd©eInv”£Miüos
;

1457 
BoŞ—n
 
upd©eCÚv”‹r
;

1459 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
šCl›ÁD©a
;

1460 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

1462 
	`DBUG
(("PAOSX_DeviûPrİ”tyLi¡’”: c®Ëd w™h…rİ”tyID = 0x%0X\n", (è
šPrİ”tyID
 ));

1464 
upd©eInv”£Miüos
 = (
šDeviû
 =ğ
·hsc
->
´im¬yDeviûID
) &&

1465 ((
šPrİ”tyID
 =ğ
kAudioDeviûPrİ”tySŒ—mFÜm©
) ||

1466 (
šPrİ”tyID
 =ğ
kAudioDeviûPrİ”tyBufãrF¿meSize
));

1468 
upd©eCÚv”‹r
 = (
šPrİ”tyID
 =ğ
kAudioDeviûPrİ”tySŒ—mFÜm©
);

1471 ifĞ
upd©eCÚv”‹r
 || 
upd©eInv”£Miüos
 )

1475 
d©aSize
 = (
h¬dw¬eSŒ—mFÜm©
);

1476 
”r
 = 
	`AudioDeviûG‘Prİ”ty
(
šDeviû
, 0, 
isIÅut
,

1477 
kAudioDeviûPrİ”tySŒ—mFÜm©
, &
d©aSize
, &
h¬dw¬eSŒ—mFÜm©
);

1478 ifĞ
”r
 !ğ
noE¼
 )

1480 
	`PRINT_ERR
("PAOSX_DeviûPrİ”tyLi¡’”: Could‚Ù g‘ deviû fÜm©", 
”r
);

1481 
sSavedHo¡E¼Ü
 = 
”r
;

1482 
”rÜ
;

1486 ifĞ
upd©eCÚv”‹r
 )

1488 
	`DBUG
(("PAOSX_DeviûPrİ”tyLi¡’”: HW„©ğ%f\n", 
h¬dw¬eSŒ—mFÜm©
.
mSam¶eR©e
 ));

1489 
	`DBUG
(("PAOSX_DeviûPrİ”tyLi¡’”: u£¸¿‹ = %f\n", 
·¡
->
·¡_Sam¶eR©e
 ));

1492 
	`mem£t
(&
u£rSŒ—mFÜm©
, 0, (
AudioSŒ—mBasicDesütiÚ
));

1494 
u£rSŒ—mFÜm©
.
mFÜm©ID
 = 
kAudioFÜm©Lš—rPCM
;

1495 
u£rSŒ—mFÜm©
.
mFÜm©FÏgs
 =

1496 
kAudioFÜm©FÏgIsFlßt
 |

1497 
kAudioFÜm©FÏgIsBigEndŸn
 |

1498 
kAudioFÜm©FÏgIsPacked
;

1499 
u£rSŒ—mFÜm©
.
mB™sP”ChªÃl
 = 32;

1500 
u£rSŒ—mFÜm©
.
mSam¶eR©e
 = 
·¡
->
·¡_Sam¶eR©e
;

1501 
u£rSŒ—mFÜm©
.
mChªÃlsP”F¿me
 = (
isIÅut
è? 
·¡
->
·¡_NumIÅutChªÃls
 :…a¡->
·¡_NumOuutChªÃls
;

1503 
u£rSŒ—mFÜm©
.
mBy‹sP”F¿me
 = u£rSŒ—mFÜm©.
mChªÃlsP”F¿me
 * ();

1504 
u£rSŒ—mFÜm©
.
mF¿mesP”Pack‘
 = 1;

1505 
u£rSŒ—mFÜm©
.
mBy‹sP”Pack‘
 = u£rSŒ—mFÜm©.
mBy‹sP”F¿me
 * u£rSŒ—mFÜm©.
mF¿mesP”Pack‘
;

1507 ifĞ
isIÅut
 )

1509 ifĞ
·hsc
->
šput
.
cÚv”‹r
 !ğ
NULL
 )

1511 
	`v”ify_nÛ¼
(
	`AudioCÚv”‹rDi¥o£
 (
·hsc
->
šput
.
cÚv”‹r
));

1515 
”r
 = 
	`AudioCÚv”‹rNew
 (

1516 &
h¬dw¬eSŒ—mFÜm©
,

1517 &
u£rSŒ—mFÜm©
,

1518 &
·hsc
->
šput
.
cÚv”‹r
 );

1519 ifĞ
”r
 !ğ
noE¼
 )

1521 
	`PRINT_ERR
("Could‚Ù c»©špuˆfÜm© cÚv”‹r", 
”r
);

1522 
sSavedHo¡E¼Ü
 = 
”r
;

1523 
”rÜ
;

1528 ifĞ
·hsc
->
ouut
.
cÚv”‹r
 !ğ
NULL
 )

1530 
	`v”ify_nÛ¼
(
	`AudioCÚv”‹rDi¥o£
 (
·hsc
->
ouut
.
cÚv”‹r
));

1534 
”r
 = 
	`AudioCÚv”‹rNew
 (

1535 &
u£rSŒ—mFÜm©
,

1536 &
h¬dw¬eSŒ—mFÜm©
,

1537 &
·hsc
->
ouut
.
cÚv”‹r
 );

1538 ifĞ
”r
 !ğ
noE¼
 )

1540 
	`PRINT_ERR
("Could‚Ù c»©ouuˆfÜm© cÚv”‹r", 
”r
);

1541 
sSavedHo¡E¼Ü
 = 
”r
;

1542 
”rÜ
;

1547 ifĞ
upd©eInv”£Miüos
 )

1550 
UIÁ32
 
ioBufãrSize
;

1551 
d©aSize
 = (
ioBufãrSize
);

1552 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
šDeviû
, 0, 
isIÅut
,

1553 
kAudioDeviûPrİ”tyBufãrF¿meSize
, &
d©aSize
,

1554 &
ioBufãrSize
);

1555 ifĞ
”r
 =ğ
noE¼
 )

1557 
·hsc
->
šv”£MiüosP”Ho¡Bufãr
 = 
h¬dw¬eSŒ—mFÜm©
.
mSam¶eR©e
 /

1558 (1000000.0 * 
ioBufãrSize
);

1562 
”rÜ
:

1563 
·hsc
->
fÜm©Li¡’”C®Ëd
 = 
Œue
;

1564  
”r
;

1565 
	}
}

1570 
PaE¼Ü
 
	$PaOSX_C»©eIÅutRšgBufãr
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1572 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

1573 
OSStus
 
”r
 = 
noE¼
;

1574 
UIÁ32
 
d©aSize
;

1575 
§m¶eR©eR©io
;

1576 
numBy‹s
;

1577 
UIÁ32
 
äamesP”Ho¡Bufãr
;

1578 
UIÁ32
 
by‹sFÜDeviû
;

1579 
UIÁ32
 
by‹sFÜU£r
;

1580 
AudioSŒ—mBasicDesütiÚ
 
fÜm©Desc
;

1582 
d©aSize
 = (
fÜm©Desc
);

1583 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
·hsc
->
šput
.
audioDeviûID
, 0, 
IS_INPUT
,

1584 
kAudioDeviûPrİ”tySŒ—mFÜm©
, &
d©aSize
, &
fÜm©Desc
);

1585 ifĞ
”r
 !ğ
noE¼
 )

1587 
	`PRINT_ERR
("PaOSX_C»©eIÅutRšgBufãr: Could‚Ù g‘ I/O bufã¸size.\n", 
”r
);

1588 
sSavedHo¡E¼Ü
 = 
”r
;

1589  
·Ho¡E¼Ü
;

1593 
§m¶eR©eR©io
 = 
fÜm©Desc
.
mSam¶eR©e
 / 
·¡
->
·¡_Sam¶eR©e
;

1596 
d©aSize
 = (
äamesP”Ho¡Bufãr
);

1597 
”r
 = 
	`AudioDeviûG‘Prİ”ty
Ğ
·hsc
->
šput
.
audioDeviûID
, 0, 
IS_INPUT
,

1598 
kAudioDeviûPrİ”tyBufãrF¿meSize
, &
d©aSize
,

1599 &
äamesP”Ho¡Bufãr
);

1600 ifĞ
”r
 !ğ
noE¼
 )

1602 
	`PRINT_ERR
("PaOSX_C»©eIÅutRšgBufãr: Could‚Ù g‘ I/O bufã¸size.\n", 
”r
);

1603 
sSavedHo¡E¼Ü
 = 
”r
;

1604  
·Ho¡E¼Ü
;

1607 
by‹sFÜDeviû
 = 
äamesP”Ho¡Bufãr
 * 
fÜm©Desc
.
mChªÃlsP”F¿me
 * (
Flßt32
) * 2;

1609 
by‹sFÜU£r
 = 
·¡
->
·¡_F¿mesP”U£rBufãr
 *…a¡->
·¡_NumIÅutChªÃls
 *

1610 (
Flßt32
è* 3 * 
§m¶eR©eR©io
;

1614 
numBy‹s
 = (
by‹sFÜDeviû
 > 
by‹sFÜU£r
) ? bytesForDevice : bytesForUser;

1616 
numBy‹s
 = 
	`RoundUpToNextPow”Of2
(‚umBytes );

1618 
	`DBUG
(("PaOSX_C»©eIÅutRšgBufãr: FIFO‚umBy‹ ğ%ld\n", 
numBy‹s
));

1619 
·hsc
->
ršgBufãrD©a
 = 
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ
numBy‹s
 );

1620 ifĞ
·hsc
->
ršgBufãrD©a
 =ğ
NULL
 )

1622  
·Insuffic›ÁMemÜy
;

1624 
	`RšgBufãr_In™
Ğ&
·hsc
->
ršgBufãr
, 
numBy‹s
,…ahsc->
ršgBufãrD©a
 );

1626 
	`RšgBufãr_AdvªûWr™eIndex
Ğ&
·hsc
->
ršgBufãr
, 
numBy‹s
 );

1628  
·NoE¼Ü
;

1629 
	}
}

1636 
OSStus
 
	$PaOSX_S‘DeviûBufãrSize
Ğ
AudioDeviûID
 
devID
, 
BoŞ—n
 
isIÅut
, 
äamesP”U£rBufãr
, 
Flßt64
 
§m¶eR©eR©io
 )

1638 
UIÁ32
 
d©aSize
;

1639 
UIÁ32
 
ioBufãrSize
;

1640 
sÿËr
;

1642 
sÿËr
 = (è
§m¶eR©eR©io
;

1643 ifĞ
§m¶eR©eR©io
 > (
Flßt64
è
sÿËr
 ) scaler += 1;

1644 
	`DBUG
(("PaOSX_S‘DeviûBufãrSize: bufã¸sizsÿË¸ğ%d\n", 
sÿËr
 ));

1645 
ioBufãrSize
 = 
äamesP”U£rBufãr
 * 
sÿËr
;

1648 ifĞ
ioBufãrSize
 < 128 ) ioBufferSize = 128;

1650 
d©aSize
 = (
ioBufãrSize
);

1651  
	`AudioDeviûS‘Prİ”ty
Ğ
devID
, 0, 0, 
isIÅut
,

1652 
kAudioDeviûPrİ”tyBufãrF¿meSize
, 
d©aSize
,

1653 &
ioBufãrSize
);

1654 
	}
}

1658 
PaE¼Ü
 
	$PaOSX_O³nCommÚDeviû
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
,

1659 
PaHo¡InOut
 *
šOut
, 
BoŞ—n
 
isIÅut
 )

1661 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

1662 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1663 
OSStus
 
”r
 = 
noE¼
;

1664 
Flßt64
 
deviûR©e
;

1671 
·hsc
->
fÜm©Li¡’”C®Ëd
 = 
çl£
;

1674 
	`DBUG
(("PaOSX_OpenCommonDevice: call AudioDeviceAddPropertyListener()\n" ));

1675 
”r
 = 
	`AudioDeviûAddPrİ”tyLi¡’”
Ğ
šOut
->
audioDeviûID
, 0, 
isIÅut
,

1676 
kAudioDeviûPrİ”tySŒ—mFÜm©
,

1677 (
AudioDeviûPrİ”tyLi¡’”Proc
è
PAOSX_DeviûPrİ”tyLi¡’”
, 
·¡
 );

1678 ià(
”r
 !ğ
noE¼
)

1685 
»suÉ
 = 
	`PaOSX_S‘FÜm©
Ğ
šOut
->
audioDeviûID
, 
isIÅut
, 
·¡
->
·¡_Sam¶eR©e
, inOut->
numChªÃls
 );

1688 ifĞ
»suÉ
 == 1 )

1690 cÚ¡ 
¦“pDurM£c
 = 10;

1691 
¥šCouÁ
 = 
MIN_TIMEOUT_MSEC
 / 
¦“pDurM£c
;

1692  !
·hsc
->
fÜm©Li¡’”C®Ëd
 && (
¥šCouÁ
 > 0) )

1694 
	`DBUG
(("SË•šg: %d\n", 
¥šCouÁ
));

1695 
	`Pa_SË•
Ğ
¦“pDurM£c
 );

1696 
¥šCouÁ
--;

1698 ifĞ!
·hsc
->
fÜm©Li¡’”C®Ëd
 )

1700 
	`PRINT
(("PaOSX_OpenCommonDevice:imed out waiting for device formato settle.\n"));

1702 
»suÉ
 = 0;

1707 ifĞ
šOut
->
cÚv”‹r
 =ğ
NULL
 )

1709 
”r
 = 
	`PAOSX_DeviûPrİ”tyLi¡’”
 (
šOut
->
audioDeviûID
,

1710 0, 
isIÅut
, 
kAudioDeviûPrİ”tySŒ—mFÜm©
, 
·¡
);

1711 ià(
”r
 !ğ
kAudioH¬dw¬eNoE¼Ü
)

1713 
	`PRINT_ERR
("PaOSX_O³nCommÚDeviû: PAOSX_DeviûPrİ”tyLi¡’” faed.\n", 
”r
);

1714 
sSavedHo¡E¼Ü
 = 
”r
;

1715  
·Ho¡E¼Ü
;

1719 #ià
SET_DEVICE_BUFFER_SIZE


1722 
Flßt64
 
¿tio
;

1723 
deviûR©e
 = 
	`PaOSX_G‘DeviûSam¶eR©e
Ğ
šOut
->
audioDeviûID
, 
isIÅut
 );

1724 ifĞ
deviûR©e
 <ğ0.0 ) deviûR©ğ
·¡
->
·¡_Sam¶eR©e
;

1725 
¿tio
 = 
deviûR©e
 / 
·¡
->
·¡_Sam¶eR©e
 ;

1726 
”r
 = 
	`PaOSX_S‘DeviûBufãrSize
Ğ
šOut
->
audioDeviûID
, 
isIÅut
,

1727 
·¡
->
·¡_F¿mesP”U£rBufãr
, 
¿tio
 );

1728 ifĞ
”r
 !ğ
noE¼
 )

1730 
	`DBUG
(("PaOSX_OpenCommonDevice: Could‚ot set I/O buffer size.\n"));

1736 
šOut
->
cÚv”‹rBufãr
 = 
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
ĞšOut->
by‹sP”U£rN©iveBufãr
 );

1737 ifĞ
šOut
->
cÚv”‹rBufãr
 =ğ
NULL
 )

1739  
·Insuffic›ÁMemÜy
;

1742  
»suÉ
;

1743 
	}
}

1746 
PaE¼Ü
 
	$PaOSX_O³nIÅutDeviû
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1748 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

1749 cÚ¡ 
PaHo¡DeviûInfo
 *
ho¡DeviûInfo
;

1750 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1752 
	`DBUG
(("PaOSX_OpenInputDevice: -------------\n"));

1754 ifĞ(
·¡
->
·¡_IÅutDeviûID
 < 
LOWEST_INPUT_DEVID
) ||

1755 (
·¡
->
·¡_IÅutDeviûID
 > 
HIGHEST_INPUT_DEVID
) )

1757  
·Inv®idDeviûId
;

1759 
ho¡DeviûInfo
 = &
sDeviûInfos
[
·¡
->
·¡_IÅutDeviûID
];

1761 ifĞ
·¡
->
·¡_NumIÅutChªÃls
 > 
ho¡DeviûInfo
->
·Info
.
maxIÅutChªÃls
 )

1763 
	`DBUG
(("Too many channels!„equested: %d max: %d\n",

1764 
·¡
->
·¡_NumIÅutChªÃls
,

1765 
ho¡DeviûInfo
->
·Info
.
maxIÅutChªÃls
));

1766  
·Inv®idChªÃlCouÁ
;

1768 
·hsc
->
šput
.
numChªÃls
 = 
·¡
->
·¡_NumIÅutChªÃls
;

1771 
»suÉ
 = 
	`PaCÚv”t_S‘upIÅut
Ğ
·¡
, 
·Flßt32
 );

1773 
»suÉ
 = 
	`PaOSX_O³nCommÚDeviû
Ğ
·¡
, &
·hsc
->
šput
, 
IS_INPUT
 );

1774 ifĞ
»suÉ
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

1777 
»suÉ
 = 
	`PaOSX_C»©eIÅutRšgBufãr
Ğ
·¡
 );

1778 ifĞ
»suÉ
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

1780 
”rÜ
:

1781  
»suÉ
;

1782 
	}
}

1785 
PaE¼Ü
 
	$PaOSX_O³nOuutDeviû
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1787 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1788 cÚ¡ 
PaHo¡DeviûInfo
 *
ho¡DeviûInfo
;

1789 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1791 
	`DBUG
(("PaOSX_OpenOutputDevice: -------------\n"));

1792 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

1795 
	`DBUG
(("PaOSX_O³nOuutDeviû: deviûID = 0x%x\n", 
·¡
->
·¡_OuutDeviûID
));

1796 ifĞ(
·¡
->
·¡_OuutDeviûID
 < 
LOWEST_OUTPUT_DEVID
) ||

1797 (
·¡
->
·¡_OuutDeviûID
 > 
HIGHEST_OUTPUT_DEVID
) )

1799  
·Inv®idDeviûId
;

1801 
ho¡DeviûInfo
 = &
sDeviûInfos
[
·¡
->
·¡_OuutDeviûID
];

1804 ifĞ
·¡
->
·¡_NumOuutChªÃls
 > 
ho¡DeviûInfo
->
·Info
.
maxOuutChªÃls
 )

1806 
	`DBUG
(("Too many channels!„equested: %d max: %d\n",

1807 
·¡
->
·¡_NumOuutChªÃls
,

1808 
ho¡DeviûInfo
->
·Info
.
maxOuutChªÃls
));

1809  
·Inv®idChªÃlCouÁ
;

1811 
·hsc
->
ouut
.
numChªÃls
 = 
·¡
->
·¡_NumOuutChªÃls
;

1814 
»suÉ
 = 
	`PaCÚv”t_S‘upOuut
Ğ
·¡
, 
·Flßt32
 );

1815 ifĞ
»suÉ
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

1817 
»suÉ
 = 
	`PaOSX_O³nCommÚDeviû
Ğ
·¡
, &
·hsc
->
ouut
, 
IS_OUTPUT
 );

1818 ifĞ
»suÉ
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

1820 
”rÜ
:

1821  
»suÉ
;

1822 
	}
}

1833 
	$PaOSX_C®cHo¡BufãrSize
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1835 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = ( PaHo¡SoundCÚŒŞ *)
·¡
->
·¡_DeviûD©a
;

1840 
·¡
->
·¡_NumU£rBufãrs
 = 
	`Pa_G‘MšNumBufãrs
Ğ·¡->
·¡_F¿mesP”U£rBufãr
,…a¡->
·¡_Sam¶eR©e
 );

1843 
·hsc
->
šput
.
by‹sP”U£rN©iveBufãr
 = 
·¡
->
·¡_F¿mesP”U£rBufãr
 *

1844 
	`Pa_G‘Sam¶eSize
(
·Flßt32
è* 
·¡
->
·¡_NumIÅutChªÃls
;

1845 
·hsc
->
ouut
.
by‹sP”U£rN©iveBufãr
 = 
·¡
->
·¡_F¿mesP”U£rBufãr
 *

1846 
	`Pa_G‘Sam¶eSize
(
·Flßt32
è* 
·¡
->
·¡_NumOuutChªÃls
;

1848 
	`DBUG
(("PaOSX_C®cNumHo¡Bufãrs:…a¡_NumU£rBufãr ğ%ld\n", 
·¡
->
·¡_NumU£rBufãrs
 ));

1849 
	`DBUG
(("PaOSX_C®cNumHo¡Bufãrs: iÅut.by‹sP”U£rN©iveBufã¸ğ%d\n", 
·hsc
->
šput
.
by‹sP”U£rN©iveBufãr
 ));

1850 
	`DBUG
(("PaOSX_C®cNumHo¡Bufãrs: ouut.by‹sP”U£rN©iveBufã¸ğ%d\n", 
·hsc
->
ouut
.
by‹sP”U£rN©iveBufãr
 ));

1851 
	}
}

1856 
PaE¼Ü
 
	$PaHo¡_O³nSŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1858 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1859 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1860 
BoŞ—n
 
u£IÅut
;

1861 
BoŞ—n
 
u£Ouut
;

1863 
	`as£¹
Ğ
·¡
->
·¡_Magic
 =ğ
PA_MAGIC
 );

1866 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
	`m®loc
((PaHostSoundControl));

1867 ifĞ
·hsc
 =ğ
NULL
 )

1869 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

1870 
”rÜ
;

1872 
	`mem£t
Ğ
·hsc
, 0, (
PaHo¡SoundCÚŒŞ
) );

1873 
·¡
->
·¡_DeviûD©a
 = (*è
·hsc
;

1874 
·hsc
->
´im¬yDeviûID
 = 
kAudioDeviûUnknown
;

1875 
·hsc
->
šput
.
audioDeviûID
 = 
kAudioDeviûUnknown
;

1876 
·hsc
->
ouut
.
audioDeviûID
 = 
kAudioDeviûUnknown
;

1878 
	`PaOSX_C®cHo¡BufãrSize
Ğ
·¡
 );

1880 
u£Ouut
 = (
·¡
->
·¡_OuutDeviûID
 !ğ
·NoDeviû
è&& (·¡->
·¡_NumOuutChªÃls
 > 0);

1881 
u£IÅut
 = (
·¡
->
·¡_IÅutDeviûID
 !ğ
·NoDeviû
è&& (·¡->
·¡_NumIÅutChªÃls
 > 0);

1884 ifĞ
u£Ouut
 )

1886 
·hsc
->
ouut
.
audioDeviûID
 = 
sDeviûInfos
[
·¡
->
·¡_OuutDeviûID
].audioDeviceID;

1887 
·hsc
->
´im¬yDeviûID
 =…ahsc->
ouut
.
audioDeviûID
;

1888 ifĞ
u£IÅut
 )

1890 
·hsc
->
šput
.
audioDeviûID
 = 
sDeviûInfos
[
·¡
->
·¡_IÅutDeviûID
].audioDeviceID;

1891 
·hsc
->
mode
 = (…ahsc->
šput
.
audioDeviûID
 !ğ·hsc->
´im¬yDeviûID
 ) ?

1892 
PA_MODE_IO_TWO_DEVICES
 : 
PA_MODE_IO_ONE_DEVICE
;

1896 
·hsc
->
mode
 = 
PA_MODE_OUTPUT_ONLY
;

1902 
·hsc
->
šput
.
audioDeviûID
 = 
sDeviûInfos
[
·¡
->
·¡_IÅutDeviûID
].audioDeviceID;

1903 
·hsc
->
´im¬yDeviûID
 =…ahsc->
šput
.
audioDeviûID
;

1904 
·hsc
->
mode
 = 
PA_MODE_INPUT_ONLY
;

1907 
	`DBUG
(("ouutDeviûID = %ld\n", 
·hsc
->
ouut
.
audioDeviûID
 ));

1908 
	`DBUG
(("šputDeviûID = %ld\n", 
·hsc
->
šput
.
audioDeviûID
 ));

1909 
	`DBUG
(("´im¬yDeviûID = %ld\n", 
·hsc
->
´im¬yDeviûID
 ));

1912 ifĞ
u£Ouut
 )

1914 
»suÉ
 = 
	`PaOSX_O³nOuutDeviû
Ğ
·¡
 );

1915 ifĞ
»suÉ
 < 0 ) 
”rÜ
;

1919 ifĞ
u£IÅut
 )

1921 
»suÉ
 = 
	`PaOSX_O³nIÅutDeviû
Ğ
·¡
 );

1922 ifĞ
»suÉ
 < 0 ) 
”rÜ
;

1925  
»suÉ
;

1927 
”rÜ
:

1928 
	`PaHo¡_Clo£SŒ—m
Ğ
·¡
 );

1929  
»suÉ
;

1930 
	}
}

1933 
PaE¼Ü
 
	$PaHo¡_S¹Ouut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1936 
	}
}

1939 
PaE¼Ü
 
	$PaHo¡_S¹IÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1942 
	}
}

1945 
PaE¼Ü
 
	$PaHo¡_S¹Engše
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1947 
OSStus
 
”r
 = 
noE¼
;

1948 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1949 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

1951 
·¡
->
·¡_StİSoÚ
 = 0;

1952 
·¡
->
·¡_StİNow
 = 0;

1953 
·¡
->
·¡_IsAùive
 = 1;

1955 
·¡
->
·¡_F¿meCouÁ
 = 0;

1958 ifĞ
·hsc
->
mode
 =ğ
PA_MODE_IO_TWO_DEVICES
 )

1961 
”r
 = 
	`AudioDeviûAddIOProc
(
·hsc
->
šput
.
audioDeviûID
, (
AudioDeviûIOProc
)
PaOSX_CÜeAudioIÅutC®lback
, 
·¡
);

1962 ià(
”r
 !ğ
noE¼
)

1964 
	`PRINT_ERR
("PaHo¡_S¹Engše: AudioDeviûAddIOProø£cÚd¬y faed", 
”r
 );

1965 
”rÜ
;

1969 
”r
 = 
	`AudioDeviûS¹
(
·hsc
->
šput
.
audioDeviûID
, (
AudioDeviûIOProc
)
PaOSX_CÜeAudioIÅutC®lback
);

1970 ià(
”r
 !ğ
noE¼
)

1972 
	`PRINT_ERR
("PaHo¡_S¹Engše: AudioDeviûS¹ secÚd¬y faed", 
”r
 );

1973 
	`PRINT
(("The…rogram may succeed if you„un it‡gain!\n"));

1974 
”rÜ
;

1979 
”r
 = 
	`AudioDeviûAddIOProc
(
·hsc
->
´im¬yDeviûID
, (
AudioDeviûIOProc
)
PaOSX_CÜeAudioIOC®lback
, 
·¡
);

1980 ià(
”r
 !ğ
noE¼
)

1982 
	`PRINT_ERR
("PaHo¡_S¹Engše: AudioDeviûAddIOProø´im¬y faed", 
”r
 );

1983 
”rÜ
;

1987 
”r
 = 
	`AudioDeviûS¹
(
·hsc
->
´im¬yDeviûID
, (
AudioDeviûIOProc
)
PaOSX_CÜeAudioIOC®lback
);

1988 ià(
”r
 !ğ
noE¼
)

1990 
	`PRINT_ERR
("PaHo¡_S¹Engše: AudioDeviûS¹…rim¬y faed", 
”r
 );

1991 
	`PRINT
(("The…rogram may succeed if you„un it‡gain!\n"));

1992 
”rÜ
;

1995  
»suÉ
;

1997 
”rÜ
:

1998 
sSavedHo¡E¼Ü
 = 
”r
;

1999  
·Ho¡E¼Ü
;

2000 
	}
}

2003 
PaE¼Ü
 
	$PaHo¡_StİEngše
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

2005 
OSStus
 
”r
 = 
noE¼
;

2006 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

2007 ifĞ
·hsc
 =ğ
NULL
 )  
·NoE¼Ü
;

2008 (è
abÜt
;

2011 
·¡
->
·¡_StİSoÚ
 = 1;

2013 ifĞ
abÜt
 ) 
·¡
->
·¡_StİNow
 = 1;

2014 
·¡
->
·¡_IsAùive
 = 0;

2016 #ià
PA_TRACE_START_STOP


2017 
	`AddT¿ûMes§ge
Ğ"PaHo¡_StİOuut:…ahsc_HWaveOuˆ", (è
·hsc
->
·hsc_HWaveOut
 );

2021 
”r
 = 
	`AudioDeviûStİ
(
·hsc
->
´im¬yDeviûID
, (
AudioDeviûIOProc
)
PaOSX_CÜeAudioIOC®lback
);

2022 ià(
”r
 !ğ
noE¼
)

2024 
”rÜ
;

2027 
”r
 = 
	`AudioDeviûRemoveIOProc
(
·hsc
->
´im¬yDeviûID
, (
AudioDeviûIOProc
)
PaOSX_CÜeAudioIOC®lback
);

2028 ià(
”r
 !ğ
noE¼
è
”rÜ
;

2031 ifĞ
·hsc
->
mode
 =ğ
PA_MODE_IO_TWO_DEVICES
 )

2033 
”r
 = 
	`AudioDeviûStİ
(
·hsc
->
šput
.
audioDeviûID
, (
AudioDeviûIOProc
)
PaOSX_CÜeAudioIÅutC®lback
);

2034 ià(
”r
 !ğ
noE¼
è
”rÜ
;

2035 
”r
 = 
	`AudioDeviûRemoveIOProc
(
·hsc
->
šput
.
audioDeviûID
, (
AudioDeviûIOProc
)
PaOSX_CÜeAudioIÅutC®lback
);

2036 ià(
”r
 !ğ
noE¼
è
”rÜ
;

2039  
·NoE¼Ü
;

2041 
”rÜ
:

2042 
sSavedHo¡E¼Ü
 = 
”r
;

2043  
·Ho¡E¼Ü
;

2044 
	}
}

2047 
PaE¼Ü
 
	$PaHo¡_StİIÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

2049  
·NoE¼Ü
;

2050 
	}
}

2053 
PaE¼Ü
 
	$PaHo¡_StİOuut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

2055  
·NoE¼Ü
;

2056 
	}
}

2059 
PaE¼Ü
 
	$PaHo¡_Clo£SŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

2061 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

2063 ifĞ
·¡
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

2064 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

2065 ifĞ
·hsc
 =ğ
NULL
 )  
·NoE¼Ü
;

2069 #ià
PA_TRACE_START_STOP


2070 
	`AddT¿ûMes§ge
Ğ"PaHo¡_Clo£SŒ—m:…ahsc_HWaveOuˆ", (è
·hsc
->
·hsc_HWaveOut
 );

2073 ifĞ
PA_USING_INPUT
 )

2075 
	`AudioDeviûRemovePrİ”tyLi¡’”
Ğ
·hsc
->
šput
.
audioDeviûID
, 0, 
IS_INPUT
,

2076 
kAudioDeviûPrİ”tySŒ—mFÜm©
,

2077 (
AudioDeviûPrİ”tyLi¡’”Proc
è
PAOSX_DeviûPrİ”tyLi¡’”
 );

2080 ifĞ
PA_USING_OUTPUT
 )

2082 
	`AudioDeviûRemovePrİ”tyLi¡’”
Ğ
·hsc
->
ouut
.
audioDeviûID
, 0, 
IS_OUTPUT
,

2083 
kAudioDeviûPrİ”tySŒ—mFÜm©
,

2084 (
AudioDeviûPrİ”tyLi¡’”Proc
è
PAOSX_DeviûPrİ”tyLi¡’”
 );

2087 ifĞ
·hsc
->
ouut
.
cÚv”‹rBufãr
 !ğ
NULL
 )

2089 
	`PaHo¡_F»eFa¡MemÜy
Ğ
·hsc
->
ouut
.
cÚv”‹rBufãr
,…ahsc->ouut.
by‹sP”U£rN©iveBufãr
 );

2091 ifĞ
·hsc
->
šput
.
cÚv”‹rBufãr
 !ğ
NULL
 )

2093 
	`PaHo¡_F»eFa¡MemÜy
Ğ
·hsc
->
šput
.
cÚv”‹rBufãr
,…ahsc->šput.
by‹sP”U£rN©iveBufãr
 );

2095 ifĞ
·hsc
->
ršgBufãrD©a
 !ğ
NULL
 )

2097 
	`PaHo¡_F»eFa¡MemÜy
Ğ
·hsc
->
ršgBufãrD©a
,…ahsc->
ršgBufãr
.
bufãrSize
 );

2099 ifĞ
·hsc
->
ouut
.
cÚv”‹r
 !ğ
NULL
 )

2101 
	`v”ify_nÛ¼
(
	`AudioCÚv”‹rDi¥o£
 (
·hsc
->
ouut
.
cÚv”‹r
));

2103 ifĞ
·hsc
->
šput
.
cÚv”‹r
 !ğ
NULL
 )

2105 
	`v”ify_nÛ¼
(
	`AudioCÚv”‹rDi¥o£
 (
·hsc
->
šput
.
cÚv”‹r
));

2108 
	`ä“
Ğ
·hsc
 );

2109 
·¡
->
·¡_DeviûD©a
 = 
NULL
;

2111  
·NoE¼Ü
;

2112 
	}
}

2117 
PaE¼Ü
 
	$PaHo¡_In™
( )

2119  
	`PaOSX_MaybeQu”yDeviûs
();

2120 
	}
}

2125 
PaE¼Ü
 
	$PaHo¡_T”m
( )

2127 
i
;

2129 ifĞ
sDeviûInfos
 !ğ
NULL
 )

2131  
i
=0; i<
sNumPaDeviûs
; i++ )

2133 ifĞ
sDeviûInfos
[
i
].
·Info
.
Çme
 !ğ
NULL
 )

2135 
	`ä“
Ğ(*)
sDeviûInfos
[
i
].
·Info
.
Çme
 );

2138 
	`ä“
Ğ
sDeviûInfos
 );

2139 
sDeviûInfos
 = 
NULL
;

2142 
sNumPaDeviûs
 = 0;

2143  
·NoE¼Ü
;

2144 
	}
}

2152 *
	$PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ
numBy‹s
 )

2154 *
addr
 = 
	`m®loc
Ğ
numBy‹s
 );

2155 ifĞ
addr
 !ğ
NULL
 ) 
	`mem£t
Ğaddr, 0, 
numBy‹s
 );

2156  
addr
;

2157 
	}
}

2163 
	$PaHo¡_F»eFa¡MemÜy
Ğ*
addr
, 
numBy‹s
 )

2165 ifĞ
addr
 !ğ
NULL
 ) 
	`ä“
(‡ddr );

2166 
	}
}

2170 
PaE¼Ü
 
	$PaHo¡_SŒ—mAùive
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

2172 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

2173 ifĞ
·¡
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

2174 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

2175 ifĞ
·hsc
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

2176  (
PaE¼Ü
è
·¡
->
·¡_IsAùive
;

2177 
	}
}

2186 
PaDeviûID
 
	$Pa_G‘DeçuÉIÅutDeviûID
( )

2188 
PaE¼Ü
 
»suÉ
 = 
	`PaOSX_MaybeQu”yDeviûs
();

2189 ifĞ
»suÉ
 < 0 ) „esult;

2190  
sDeçuÉIÅutDeviûID
;

2191 
	}
}

2193 
PaDeviûID
 
	$Pa_G‘DeçuÉOuutDeviûID
( )

2195 
PaE¼Ü
 
»suÉ
 = 
	`PaOSX_MaybeQu”yDeviûs
();

2196 ifĞ
»suÉ
 < 0 ) „esult;

2197  
sDeçuÉOuutDeviûID
;

2198 
	}
}

2206 
	$Pa_G‘MšNumBufãrs
Ğ
äamesP”Bufãr
, 
äamesP”SecÚd
 )

2208 
mšBufãrs
;

2209 
d’omš©Ü
;

2210 
mšL©’cyM£c
 = 
PA_MIN_LATENCY_MSEC
;

2211 
d’omš©Ü
 = 1000.0 * 
äamesP”Bufãr
;

2212 
mšBufãrs
 = (è(((
mšL©’cyM£c
 * 
äamesP”SecÚd
è+ 
d’omš©Ü
 - 1) / denominator );

2213 ifĞ
mšBufãrs
 < 1 ) minBuffers = 1;

2214  
mšBufãrs
;

2215 
	}
}

2218 
	$Pa_SË•
Ğ
m£c
 )

2220 
	`u¦“p
Ğ
m£c
 * 1000 );

2221 
	}
}

2224 
PaTime¡amp
 
	$Pa_SŒ—mTime
Ğ
PÜtAudioSŒ—m
 *
¡»am
 )

2226 
AudioTimeSmp
 
timeSmp
;

2227 
PaTime¡amp
 
¡»amTime
;

2228 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

2229 
š‹º®PÜtAudioSŒ—m
 *
·¡
 = (š‹º®PÜtAudioSŒ—m *è
¡»am
;

2230 ifĞ
·¡
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

2231 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

2239  
·¡
->
·¡_F¿meCouÁ
;

2241  
¡»amTime
;

2242 
	}
}

2245 
	$Pa_G‘Ho¡E¼Ü
()

2247  
sSavedHo¡E¼Ü
;

2248 
	}
}

2251 
	$Pa_CouÁDeviûs
()

2253 ifĞ
sNumPaDeviûs
 <ğ0 ) 
	`Pa_In™Ÿlize
();

2254  
sNumPaDeviûs
;

2255 
	}
}

2262 cÚ¡ 
PaDeviûInfo
* 
	$Pa_G‘DeviûInfo
Ğ
PaDeviûID
 
id
 )

2264 ifĞ
id
 < 0 || id >ğ
sNumPaDeviûs
 )

2265  
NULL
;

2267  &
sDeviûInfos
[
id
].
·Info
;

2268 
	}
}

	@portaudio/pa_tests/debug_dual.c

38 
	~<¡dio.h
>

39 
	~<m©h.h
>

40 
	~"pÜudio.h
"

41 
	#DEV_ID_1
 (13)

	)

42 
	#DEV_ID_2
 (15)

	)

43 
	#NUM_SECONDS
 (8)

	)

44 
	#SLEEP_DUR
 (800)

	)

45 
	#SAMPLE_RATE
 (44100)

	)

46 
	#FRAMES_PER_BUFFER
 (256)

	)

48 
	#MIN_LATENCY_MSEC
 (200)

	)

49 
	#NUM_BUFFERS
 ((
MIN_LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

51 
	#NUM_BUFFERS
 (0)

	)

53 
	#MIN_FREQ
 (100.0f)

	)

54 
	#MAX_FREQ
 (4000.0f)

	)

55 
	#FREQ_SCALAR
 (1.00002f)

	)

56 
	#C®cPha£Inüem’t
(
äeq
è(äeq/
SAMPLE_RATE
)

	)

57 #iâdeà
M_PI


58 
	#M_PI
 (3.14159265)

	)

60 
	#TABLE_SIZE
 (400)

	)

63 
	msše
[
TABLE_SIZE
 + 1];

64 
	mpha£_šüem’t
;

65 
	mËá_pha£
;

66 
	mright_pha£
;

68 
	t·Te¡D©a
;

72 
LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 );

73 
	$LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 )

75 
fIndex
 = 
pha£
*
TABLE_SIZE
;

76 
šdex
 = (è
fIndex
;

77 
äaù
 = 
fIndex
 - 
šdex
;

78 
lo
 = 
d©a
->
sše
[
šdex
];

79 
hi
 = 
d©a
->
sše
[
šdex
+1];

80 
v®
 = 
lo
 + 
äaù
*(
hi
-lo);

81  
v®
;

82 
	}
}

87 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

88 
äamesP”Bufãr
,

89 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

91 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

92 *
out
 = (*)
ouutBufãr
;

93 
i
;

94 
fšished
 = 0;

95 (è
outTime
;

96 (è
šputBufãr
;

99  
i
=0; i<
äamesP”Bufãr
; i++ )

101 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
Ëá_pha£
);

102 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
right_pha£
);

103 
d©a
->
Ëá_pha£
 +ğd©a->
pha£_šüem’t
;

104 ifĞ
d©a
->
Ëá_pha£
 >= 1.0f ) data->left_phase -= 1.0f;

105 
d©a
->
right_pha£
 +ğ(d©a->
pha£_šüem’t
 * 1.5f);

106 ifĞ
d©a
->
right_pha£
 >= 1.0f ) data->right_phase -= 1.0f;

108 
d©a
->
pha£_šüem’t
 *ğ
FREQ_SCALAR
;

109 ifĞ
d©a
->
pha£_šüem’t
 > 
	`C®cPha£Inüem’t
(
MAX_FREQ
èèd©a->pha£_šüem’ˆğC®cPha£Inüem’t(
MIN_FREQ
);

112 
	}
}

114 
PaE¼Ü
 
Te¡S¹
Ğ
PÜtAudioSŒ—m
 **
¡»amPŒ
, 
PaDeviûID
 
devID
,

115 
·Te¡D©a
 *
d©a
 );

117 
maš
();

118 
	$maš
()

120 
PÜtAudioSŒ—m
 *
¡»am1
, *
¡»am2
;

121 
PaE¼Ü
 
”r
;

122 
·Te¡D©a
 
DATA1
, 
DATA2
;

123 
	`´štf
("PÜtAudiØTe¡: DUAL sšsw“p.‡sk fÜ %d bufãrs\n", 
NUM_BUFFERS
 );

124 
”r
 = 
	`Pa_In™Ÿlize
();

125 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

126 
”r
 = 
	`Te¡S¹
Ğ&
¡»am1
, 
DEV_ID_1
, &
DATA1
 );

127 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

128 
”r
 = 
	`Te¡S¹
Ğ&
¡»am2
, 
DEV_ID_2
, &
DATA2
 );

129 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

130 
	`´štf
("Hit ENTER\n");

131 
	`g‘ch¬
();

132 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am1
 );

133 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

134 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am2
 );

135 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

136 
	`Pa_T”mš©e
();

137 
	`´štf
("Test finished.\n");

138  
”r
;

139 
”rÜ
:

140 
	`Pa_T”mš©e
();

141 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

142 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

143 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

144  
”r
;

145 
	}
}

146 
PaE¼Ü
 
	$Te¡S¹
Ğ
PÜtAudioSŒ—m
 **
¡»amPŒ
, 
PaDeviûID
 
devID
, 
·Te¡D©a
 *
d©a
 )

148 
PÜtAudioSŒ—m
 *
¡»am
;

149 
PaE¼Ü
 
”r
;

150 
i
;

152  
i
=0; i<
TABLE_SIZE
; i++ )

154 
d©a
->
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

156 
d©a
->
sše
[
TABLE_SIZE
] = data->sine[0];

157 
d©a
->
Ëá_pha£
 = d©a->
right_pha£
 = 0.0;

158 
d©a
->
pha£_šüem’t
 = 
	`C®cPha£Inüem’t
(
MIN_FREQ
);

159 
	`´štf
("PÜtAudiØTe¡: ouuˆdeviû = %d\n", 
devID
 );

160 
”r
 = 
	`Pa_O³nSŒ—m
(

161 &
¡»am
,

162 
·NoDeviû
,

164 
·Flßt32
,

165 
NULL
,

166 
devID
,

168 
·Flßt32
,

169 
NULL
,

170 
SAMPLE_RATE
,

171 
FRAMES_PER_BUFFER
,

172 
NUM_BUFFERS
,

173 
·ClOff
|
·D™h”Off
,

174 
·‹¡C®lback
,

175 
d©a
 );

176 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

177 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

178 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

179 *
¡»amPŒ
 = 
¡»am
;

181 
”rÜ
:

182  
”r
;

183 
	}
}

	@portaudio/pa_tests/debug_multi_in.c

38 
	~<¡dio.h
>

39 
	~<m©h.h
>

40 
	~<¡ršg.h
>

41 
	~"pÜudio.h
"

43 
	#OUTPUT_DEVICE
 (
	`Pa_G‘DeçuÉOuutDeviûID
())

	)

45 
	#SAMPLE_RATE
 (22050)

	)

46 
	#FRAMES_PER_BUFFER
 (256)

	)

47 
	#MIN_LATENCY_MSEC
 (400)

	)

48 
	#NUM_BUFFERS
 ((
MIN_LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

49 #iâdeà
M_PI


50 
	#M_PI
 (3.14159265)

	)

54 
	mliveChªÃl
;

55 
	mnumChªÃls
;

57 
	t·Te¡D©a
;

62 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

66 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

67 *
out
 = (*)
ouutBufãr
;

68 *
š
 = (*)
šputBufãr
;

69 
i
;

70 
fšished
 = 0;

71 (è
outTime
;

72 (è
šputBufãr
;

74 ifĞ
š
 =ğ
NULL
 )  0;

75  
i
=0; i<()
äamesP”Bufãr
; i++ )

78 *
out
++ = 
š
[
d©a
->
liveChªÃl
];

79 *
out
++ = 
š
[
d©a
->
liveChªÃl
];

80 
š
 +ğ
d©a
->
numChªÃls
;

83 
	}
}

85 
	$PaFšdDeviûByName
ĞcÚ¡ *
Çme
 )

87 
i
;

88 
numDeviûs
;

89 cÚ¡ 
PaDeviûInfo
 *
pdi
;

90 
Ën
 = 
	`¡¾’
Ğ
Çme
 );

91 
PaDeviûID
 
»suÉ
 = 
·NoDeviû
;

92 
numDeviûs
 = 
	`Pa_CouÁDeviûs
();

93  
i
=0; i<
numDeviûs
; i++ )

95 
pdi
 = 
	`Pa_G‘DeviûInfo
Ğ
i
 );

96 ifĞ
	`¡ºcmp
Ğ
Çme
, 
pdi
->Çme, 
Ën
 ) == 0 )

98 
»suÉ
 = 
i
;

102  
»suÉ
;

103 
	}
}

105 
maš
();

106 
	$maš
()

108 
PÜtAudioSŒ—m
 *
¡»am
;

109 
PaE¼Ü
 
”r
;

110 
·Te¡D©a
 
d©a
;

111 
i
;

112 
PaDeviûID
 
šputDeviû
;

113 cÚ¡ 
PaDeviûInfo
 *
pdi
;

114 
	`´štf
("PÜtAudiØTe¡: iÅuˆsigÇÈäomƒach chªÃl. %d bufãrs\n", 
NUM_BUFFERS
 );

115 
d©a
.
liveChªÃl
 = 0;

116 
”r
 = 
	`Pa_In™Ÿlize
();

117 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

118 #ifdeà
INPUT_DEVICE_NAME


119 
	`´štf
("TryØu£ deviû: %s\n", 
INPUT_DEVICE_NAME
 );

120 
šputDeviû
 = 
	`PaFšdDeviûByName
(
INPUT_DEVICE_NAME
);

121 ifĞ
šputDeviû
 =ğ
·NoDeviû
 )

123 
	`´štf
("Could‚Ù fšd %s. Usšg deçuÉ in¡—d.\n", 
INPUT_DEVICE_NAME
 );

124 
šputDeviû
 = 
	`Pa_G‘DeçuÉIÅutDeviûID
();

127 
	`´štf
("Using default input device.\n");

128 
šputDeviû
 = 
	`Pa_G‘DeçuÉIÅutDeviûID
();

130 
pdi
 = 
	`Pa_G‘DeviûInfo
Ğ
šputDeviû
 );

131 ifĞ
pdi
 =ğ
NULL
 )

133 
	`´štf
("Could‚ot get device info!\n");

134 
”rÜ
;

136 
d©a
.
numChªÃls
 = 
pdi
->
maxIÅutChªÃls
;

137 
	`´štf
("IÅuˆDeviû‚ami %s\n", 
pdi
->
Çme
 );

138 
	`´štf
("IÅuˆDeviû ha %d chªÃls.\n", 
pdi
->
maxIÅutChªÃls
);

139 
”r
 = 
	`Pa_O³nSŒ—m
(

140 &
¡»am
,

141 
šputDeviû
,

142 
pdi
->
maxIÅutChªÃls
,

143 
·Flßt32
,

144 
NULL
,

145 
OUTPUT_DEVICE
,

147 
·Flßt32
,

148 
NULL
,

149 
SAMPLE_RATE
,

150 
FRAMES_PER_BUFFER
,

151 
NUM_BUFFERS
,

152 
·ClOff
,

153 
·‹¡C®lback
,

154 &
d©a
 );

155 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

156 
d©a
.
liveChªÃl
 = 0;

157 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

158 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

159  
i
=0; i<
d©a
.
numChªÃls
; i++ )

161 
d©a
.
liveChªÃl
 = 
i
;

162 
	`´štf
("ChªÃÈ%d bešg s’ˆtØouut. H™ ENTER fÜ‚exˆchªÃl.", 
i
 );

163 
	`fæush
(
¡dout
);

164 
	`g‘ch¬
();

166 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

167 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

169 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

170 
	`Pa_T”mš©e
();

171 
	`´štf
("Test finished.\n");

172  
”r
;

173 
”rÜ
:

174 
	`Pa_T”mš©e
();

175 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

176 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

177 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

178  
”r
;

179 
	}
}

	@portaudio/pa_tests/debug_multi_out.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

41 
	#OUTPUT_DEVICE
 (
	`Pa_G‘DeçuÉOuutDeviûID
())

	)

42 
	#SAMPLE_RATE
 (44100)

	)

43 
	#FRAMES_PER_BUFFER
 (256)

	)

44 
	#FREQ_INCR
 (300.0 / 
SAMPLE_RATE
)

	)

45 
	#MAX_CHANNELS
 (64)

	)

47 #iâdeà
M_PI


48 
	#M_PI
 (3.14159265)

	)

53 
	mnumChªÃls
;

54 
	mpha£s
[
MAX_CHANNELS
];

56 
	t·Te¡D©a
;

62 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

66 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

67 *
out
 = (*)
ouutBufãr
;

68 
äameIndex
, 
chªÃlIndex
;

69 
fšished
 = 0;

70 (è
outTime
;

71 (è
šputBufãr
;

73  
äameIndex
=0; f¿meIndex<()
äamesP”Bufãr
; frameIndex++ )

75  
chªÃlIndex
=0; chªÃlIndex<
d©a
->
numChªÃls
; channelIndex++ )

78 *
out
++ = (è
	`sš
(
d©a
->
pha£s
[
chªÃlIndex
]);

81 
d©a
->
pha£s
[
chªÃlIndex
] +ğ
FREQ_INCR
 * (4 + channelIndex);

82 ifĞ
d©a
->
pha£s
[
chªÃlIndex
] >ğ(2.0 * 
M_PI
) ) data->phases[channelIndex] -= (2.0 * M_PI);

87 
	}
}

89 
maš
();

90 
	$maš
()

92 
PÜtAudioSŒ—m
 *
¡»am
;

93 
PaE¼Ü
 
”r
;

94 cÚ¡ 
PaDeviûInfo
 *
pdi
;

95 
·Te¡D©a
 
d©a
 = {0};

96 
	`´štf
("PortAudio Test: output sine wave onƒach channel.\n" );

98 
”r
 = 
	`Pa_In™Ÿlize
();

99 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

101 
pdi
 = 
	`Pa_G‘DeviûInfo
Ğ
OUTPUT_DEVICE
 );

102 
d©a
.
numChªÃls
 = 
pdi
->
maxOuutChªÃls
;

103 ifĞ
d©a
.
numChªÃls
 > 
MAX_CHANNELS
 ) data.numChannels = MAX_CHANNELS;

104 
	`´štf
("Numb” oàChªÃl ğ%d\n", 
d©a
.
numChªÃls
 );

106 
”r
 = 
	`Pa_O³nSŒ—m
(

107 &
¡»am
,

108 
·NoDeviû
,

110 
·Flßt32
,

111 
NULL
,

112 
OUTPUT_DEVICE
,

113 
d©a
.
numChªÃls
,

114 
·Flßt32
,

115 
NULL
,

116 
SAMPLE_RATE
,

117 
FRAMES_PER_BUFFER
,

119 
·ClOff
,

120 
·‹¡C®lback
,

121 &
d©a
 );

122 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

124 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

125 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

127 
	`´štf
("Hit ENTERo stop sound.\n");

128 
	`fæush
(
¡dout
);

129 
	`g‘ch¬
();

131 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

132 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

134 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

135 
	`Pa_T”mš©e
();

136 
	`´štf
("Test finished.\n");

137  
”r
;

138 
”rÜ
:

139 
	`Pa_T”mš©e
();

140 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

141 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

142 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

143  
”r
;

144 
	}
}

	@portaudio/pa_tests/debug_record.c

38 
	~<¡dio.h
>

39 
	~<¡dlib.h
>

40 
	~"pÜudio.h
"

42 
	#SAMPLE_RATE
 (22050)

	)

43 
	#NUM_SECONDS
 (6)

	)

44 
	#NUM_CHANNELS
 (2)

	)

45 
	#FRAMES_PER_BUFFER
 (64)

	)

47 
	#DITHER_FLAG
 (0)

	)

51 
	#PA_SAMPLE_TYPE
 
·Flßt32


	)

52 
	tSAMPLE
;

53 
	#SAMPLE_SILENCE
 (0.0f)

	)

56 
	#PA_SAMPLE_TYPE
 
·IÁ32


	)

57 
	tSAMPLE
;

58 
	#SAMPLE_SILENCE
 (0)

	)

61 
	#PA_SAMPLE_TYPE
 
·IÁ16


	)

62 
	tSAMPLE
;

63 
	#SAMPLE_SILENCE
 (0)

	)

66 
	#PA_SAMPLE_TYPE
 
·IÁ8


	)

67 
	tSAMPLE
;

68 
	#SAMPLE_SILENCE
 (0)

	)

71 
	#PA_SAMPLE_TYPE
 
·UIÁ8


	)

72 
	tSAMPLE
;

73 
	#SAMPLE_SILENCE
 (128)

	)

79 
	mäameIndex
;

80 
	mmaxF¿meIndex
;

81 
SAMPLE
 *
	m»cÜdedSam¶es
;

83 
	t·Te¡D©a
;

88 
	$»cÜdC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

89 
äamesP”Bufãr
,

90 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

92 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

93 
SAMPLE
 *
½Œ
 = (SAMPLE*)
šputBufãr
;

94 
SAMPLE
 *
w±r
 = &
d©a
->
»cÜdedSam¶es
[d©a->
äameIndex
 * 
NUM_CHANNELS
];

95 
äamesToC®c
;

96 
i
;

97 
fšished
;

98 
äamesLeá
 = 
d©a
->
maxF¿meIndex
 - d©a->
äameIndex
;

100 (è
ouutBufãr
;

101 (è
outTime
;

103 ifĞ
äamesLeá
 < 
äamesP”Bufãr
 )

105 
äamesToC®c
 = 
äamesLeá
;

106 
fšished
 = 1;

110 
äamesToC®c
 = 
äamesP”Bufãr
;

111 
fšished
 = 0;

113 ifĞ
šputBufãr
 =ğ
NULL
 )

115  
i
=0; i<
äamesToC®c
; i++ )

117 *
w±r
++ = 
SAMPLE_SILENCE
;

118 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = 
SAMPLE_SILENCE
;

123  
i
=0; i<
äamesToC®c
; i++ )

125 *
w±r
++ = *
½Œ
++;

126 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

129 
d©a
->
äameIndex
 +ğ
äamesToC®c
;

130  
fšished
;

131 
	}
}

137 
	$¶ayC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

138 
äamesP”Bufãr
,

139 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

141 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

142 
SAMPLE
 *
½Œ
 = &
d©a
->
»cÜdedSam¶es
[d©a->
äameIndex
 * 
NUM_CHANNELS
];

143 
SAMPLE
 *
w±r
 = (SAMPLE*)
ouutBufãr
;

144 
i
;

145 
fšished
;

146 
äamesLeá
 = 
d©a
->
maxF¿meIndex
 - d©a->
äameIndex
;

147 (è
šputBufãr
;

148 (è
outTime
;

150 ifĞ
äamesLeá
 < 
äamesP”Bufãr
 )

153  
i
=0; i<
äamesLeá
; i++ )

155 *
w±r
++ = *
½Œ
++;

156 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

158  ; 
i
<
äamesP”Bufãr
; i++ )

160 *
w±r
++ = 0;

161 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = 0;

163 
d©a
->
äameIndex
 +ğ
äamesLeá
;

164 
fšished
 = 1;

168  
i
=0; i<
äamesP”Bufãr
; i++ )

170 *
w±r
++ = *
½Œ
++;

171 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

173 
d©a
->
äameIndex
 +ğ
äamesP”Bufãr
;

174 
fšished
 = 0;

176  
fšished
;

177 
	}
}

180 
maš
();

181 
	$maš
()

183 
PÜtAudioSŒ—m
 *
¡»am
;

184 
PaE¼Ü
 
”r
;

185 
·Te¡D©a
 
d©a
;

186 
i
;

187 
tÙ®F¿mes
;

188 
numSam¶es
;

189 
numBy‹s
;

190 
SAMPLE
 
max
, 
av”age
, 
v®
;

192 
	`´štf
("debug_record.c, sampleRate = %d,‚umChannels = %d\n",

193 
SAMPLE_RATE
, 
NUM_CHANNELS
 );

194 
	`fæush
(
¡dout
);

196 
d©a
.
maxF¿meIndex
 = 
tÙ®F¿mes
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

197 
d©a
.
äameIndex
 = 0;

198 
numSam¶es
 = 
tÙ®F¿mes
 * 
NUM_CHANNELS
;

200 
numBy‹s
 = 
numSam¶es
 * (
SAMPLE
);

201 
d©a
.
»cÜdedSam¶es
 = (
SAMPLE
 *è
	`m®loc
Ğ
numBy‹s
 );

202 ifĞ
d©a
.
»cÜdedSam¶es
 =ğ
NULL
 )

204 
	`´štf
("Could‚ot‡llocate„ecord‡rray.\n");

205 
	`ex™
(1);

207  
i
=0; i<
numSam¶es
; i++ ) 
d©a
.
»cÜdedSam¶es
[i] = 0;

209 
”r
 = 
	`Pa_In™Ÿlize
();

210 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

213 
”r
 = 
	`Pa_O³nSŒ—m
(

214 &
¡»am
,

215 
	`Pa_G‘DeçuÉIÅutDeviûID
(),

216 
NUM_CHANNELS
,

217 
PA_SAMPLE_TYPE
,

218 
NULL
,

219 
·NoDeviû
,

221 
PA_SAMPLE_TYPE
,

222 
NULL
,

223 
SAMPLE_RATE
,

224 
FRAMES_PER_BUFFER
,

227 
»cÜdC®lback
,

228 &
d©a
 );

229 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

231 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

232 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

233 
	`´štf
("S¹„ecÜdšg!!\n"); 
	`fæush
(
¡dout
);

235  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

237 
	`Pa_SË•
(1000);

238 
	`´štf
("šdex = %d\n", 
d©a
.
äameIndex
 ); 
	`fæush
(
¡dout
);

240 
	`´štf
("Stİ„ecÜdšg!!\n"); 
	`fæush
(
¡dout
);

241 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

242 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

245 
max
 = 0;

246 
av”age
 = 0;

247  
i
=0; i<
numSam¶es
; i++ )

249 
v®
 = 
d©a
.
»cÜdedSam¶es
[
i
];

250 ifĞ
v®
 < 0 ) val = -val;

251 ifĞ
v®
 > 
max
 )

253 
max
 = 
v®
;

255 
av”age
 +ğ
v®
;

258 
av”age
 =‡v”ag/ 
numSam¶es
;

260 ifĞ
PA_SAMPLE_TYPE
 =ğ
·Flßt32
 )

262 
	`´štf
("§m¶max‡m¶™udğ%f\n", (è
max
 );

263 
	`´štf
("§m¶av”agğ%f\n", (è
av”age
 );

267 
	`´štf
("§m¶max‡m¶™udğ%d\n", (è
max
 );

268 
	`´štf
("§m¶av”agğ%d\n", (è
av”age
 );

274 
FILE
 *
fid
;

275 
fid
 = 
	`fİ’
("recorded.raw", "wb");

276 ifĞ
fid
 =ğ
NULL
 )

278 
	`´štf
("Could‚ot open file.");

282 
	`fwr™e
Ğ
d©a
.
»cÜdedSam¶es
, 
NUM_CHANNELS
 * (
SAMPLE
), 
tÙ®F¿mes
, 
fid
 );

283 
	`fşo£
Ğ
fid
 );

284 
	`´štf
("Wrote datao 'recorded.raw'\n");

290 
d©a
.
äameIndex
 = 0;

291 
	`´štf
("Begš…Ïyback.\n"); 
	`fæush
(
¡dout
);

292 
”r
 = 
	`Pa_O³nSŒ—m
(

293 &
¡»am
,

294 
·NoDeviû
,

296 
PA_SAMPLE_TYPE
,

297 
NULL
,

298 
	`Pa_G‘DeçuÉOuutDeviûID
(),

299 
NUM_CHANNELS
,

300 
PA_SAMPLE_TYPE
,

301 
NULL
,

302 
SAMPLE_RATE
,

303 
FRAMES_PER_BUFFER
,

305 
·ClOff
,

306 
¶ayC®lback
,

307 &
d©a
 );

308 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

310 ifĞ
¡»am
 )

312 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

313 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

314 
	`´štf
("S¹…Ïyback!!\n"); 
	`fæush
(
¡dout
);

316  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

318 
	`Pa_SË•
(1000);

319 
	`´štf
("šdex = %d\n", 
d©a
.
äameIndex
 ); 
	`fæush
(
¡dout
);

322 
	`´štf
("Stİ…Ïyback!!\n"); 
	`fæush
(
¡dout
);

323 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

324 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

325 
	`´štf
("DÚe.\n"); 
	`fæush
(
¡dout
);

327 
	`ä“
Ğ
d©a
.
»cÜdedSam¶es
 );

329 
	`Pa_T”mš©e
();

332 
”rÜ
:

333 
	`Pa_T”mš©e
();

334 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

335 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

336 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

338 
	}
}

	@portaudio/pa_tests/debug_sine.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

40 
	#OUTPUT_DEVICE
 (
	`Pa_G‘DeçuÉOuutDeviûID
())

	)

42 
	#NUM_SECONDS
 (8)

	)

43 
	#SLEEP_DUR
 (800)

	)

44 
	#SAMPLE_RATE
 (44100)

	)

45 
	#FRAMES_PER_BUFFER
 (4096)

	)

47 
	#MSEC_PER_BUFFER
 (1000 * 
FRAMES_PER_BUFFER
 / 
SAMPLE_RATE
)

	)

50 
	#MIN_LATENCY_MSEC
 (200)

	)

51 
	#NUM_BUFFERS
 ((
MIN_LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

53 
	#NUM_BUFFERS
 (0)

	)

56 
	#MIN_FREQ
 (100.0f)

	)

57 
	#MAX_FREQ
 (4000.0f)

	)

58 
	#FREQ_SCALAR
 (1.00002f)

	)

59 
	#C®cPha£Inüem’t
(
äeq
è(äeq/
SAMPLE_RATE
)

	)

60 #iâdeà
M_PI


61 
	#M_PI
 (3.14159265)

	)

63 
	#TABLE_SIZE
 (400)

	)

66 
	msše
[
TABLE_SIZE
 + 1];

67 
	mpha£_šüem’t
;

68 
	mËá_pha£
;

69 
	mright_pha£
;

70 
	mäamesToGo
;

72 
	t·Te¡D©a
;

76 
LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 );

77 
	$LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 )

79 
fIndex
 = 
pha£
*
TABLE_SIZE
;

80 
šdex
 = (è
fIndex
;

81 
äaù
 = 
fIndex
 - 
šdex
;

82 
lo
 = 
d©a
->
sše
[
šdex
];

83 
hi
 = 
d©a
->
sše
[
šdex
+1];

84 
v®
 = 
lo
 + 
äaù
*(
hi
-lo);

85  
v®
;

86 
	}
}

91 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

92 
äamesP”Bufãr
,

93 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

95 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

96 *
out
 = (*)
ouutBufãr
;

97 
äamesToC®c
;

98 
i
;

99 
fšished
 = 0;

100 (è
outTime
;

101 (è
šputBufãr
;

103 ifĞ
d©a
->
äamesToGo
 < 
äamesP”Bufãr
 )

105 
äamesToC®c
 = 
d©a
->
äamesToGo
;

106 
d©a
->
äamesToGo
 = 0;

107 
fšished
 = 1;

111 
äamesToC®c
 = 
äamesP”Bufãr
;

112 
d©a
->
äamesToGo
 -ğ
äamesP”Bufãr
;

115  
i
=0; i<
äamesToC®c
; i++ )

117 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
Ëá_pha£
);

118 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
right_pha£
);

119 
d©a
->
Ëá_pha£
 +ğd©a->
pha£_šüem’t
;

120 ifĞ
d©a
->
Ëá_pha£
 >= 1.0f ) data->left_phase -= 1.0f;

121 
d©a
->
right_pha£
 +ğ(d©a->
pha£_šüem’t
 * 1.5f);

122 ifĞ
d©a
->
right_pha£
 >= 1.0f ) data->right_phase -= 1.0f;

124 
d©a
->
pha£_šüem’t
 *ğ
FREQ_SCALAR
;

125 ifĞ
d©a
->
pha£_šüem’t
 > 
	`C®cPha£Inüem’t
(
MAX_FREQ
èèd©a->pha£_šüem’ˆğC®cPha£Inüem’t(
MIN_FREQ
);

128  ; 
i
<()
äamesP”Bufãr
; i++ )

130 *
out
++ = 0;

131 *
out
++ = 0;

136  
fšished
;

137 
	}
}

139 
maš
();

140 
	$maš
()

142 
PÜtAudioSŒ—m
 *
¡»am
;

143 
PaE¼Ü
 
”r
;

144 
·Te¡D©a
 
d©a
;

145 
i
;

146 
tÙ®Samps
;

147 
	`´štf
("PÜtAudiØTe¡: ouuˆsšsw“p.‡sk fÜ %d bufãrs\n", 
NUM_BUFFERS
 );

148 
	`´štf
("MSEC_PER_BUFFER = %d\n", 
MSEC_PER_BUFFER
 );

151  
i
=0; i<
TABLE_SIZE
; i++ )

153 
d©a
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

155 
d©a
.
sše
[
TABLE_SIZE
] = data.sine[0];

156 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0.0;

157 
d©a
.
pha£_šüem’t
 = 
	`C®cPha£Inüem’t
(
MIN_FREQ
);

158 
d©a
.
äamesToGo
 = 
tÙ®Samps
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

159 
	`´štf
("tÙ®Samp ğ%d\n", 
tÙ®Samps
 );

160 
”r
 = 
	`Pa_In™Ÿlize
();

161 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

162 
	`´štf
("PÜtAudiØTe¡: ouuˆdeviû = %d\n", 
OUTPUT_DEVICE
 );

163 
”r
 = 
	`Pa_O³nSŒ—m
(

164 &
¡»am
,

165 
·NoDeviû
,

167 
·Flßt32
,

168 
NULL
,

169 
OUTPUT_DEVICE
,

171 
·Flßt32
,

172 
NULL
,

173 
SAMPLE_RATE
,

174 
FRAMES_PER_BUFFER
,

175 
NUM_BUFFERS
,

176 
·ClOff
|
·D™h”Off
,

177 
·‹¡C®lback
,

178 &
d©a
 );

179 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

180 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

181 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

182 
	`´štf
("Is callback being called?\n");

183  
i
=0; i<((
NUM_SECONDS
+1)*1000); i+=
SLEEP_DUR
 )

185 
	`´štf
("d©a.äamesToGØğ%d\n", 
d©a
.
äamesToGo
 ); 
	`fæush
(
¡dout
);

186 
	`Pa_SË•
Ğ
SLEEP_DUR
 );

189 
	`´štf
("Call Pa_StopStream()\n");

190 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

191 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

192 
	`Pa_T”mš©e
();

193 
	`´štf
("Test finished.\n");

194  
”r
;

195 
”rÜ
:

196 
	`Pa_T”mš©e
();

197 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

198 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

199 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

200  
”r
;

201 
	}
}

	@portaudio/pa_tests/debug_test1.c

10 
	~<¡dio.h
>

11 
	~<m©h.h
>

12 
	~"pÜudio.h
"

13 #iâdeà
M_PI


14 
	#M_PI
 (3.14159265)

	)

18 
	msše
[100];

19 
	mpha£
;

20 
	m§mpsToGo
;

22 
	t·‹¡1d©a
;

23 
	$·‹¡1C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

24 
bufãrF¿mes
,

25 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

27 
·‹¡1d©a
 *
d©a
 = (·‹¡1d©a*)
u£rD©a
;

28 *
š
 = (*)
šputBufãr
;

29 *
out
 = (*)
ouutBufãr
;

30 
äamesToC®c
 = 
bufãrF¿mes
;

31 
i
;

32 
fšished
 = 0;

33 if(
šputBufãr
 =ğ
NULL
)  0;

34 ifĞ
d©a
->
§mpsToGo
 < 
bufãrF¿mes
 )

36 
fšished
 = 1;

38  
i
=0; i<
bufãrF¿mes
; i++ )

40 *
out
++ = *
š
++;

41 *
out
++ = *
š
++;

42 ifĞ
d©a
->
pha£
 >= 100 )

43 
d©a
->
pha£
 = 0;

45 
d©a
->
§mpsToGo
 -ğ
bufãrF¿mes
;

47  ; 
i
<
bufãrF¿mes
; i++ )

49 *
out
++ = 0;

50 *
out
++ = 0;

52  
fšished
;

53 
	}
}

54 
maš
(
¬gc
, * 
¬gv
[]);

55 
	$maš
(
¬gc
, * 
¬gv
[])

57 
PaSŒ—m
 *
¡»am
;

58 
PaE¼Ü
 
”r
;

59 
·‹¡1d©a
 
d©a
;

60 
i
;

61 
šputDeviû
 = 
	`Pa_G‘DeçuÉIÅutDeviûID
();

62 
ouutDeviû
 = 
	`Pa_G‘DeçuÉOuutDeviûID
();

64  
i
=0; i<100; i++ )

65 
d©a
.
sše
[
i
] = 
	`sš
Ğ(()i/100.è* 
M_PI
 * 2. );

66 
d©a
.
pha£
 = 0;

67 
d©a
.
§mpsToGo
 = 44100 * 4;

69 
	`Pa_In™Ÿlize
();

70 
”r
 = 
	`Pa_O³nSŒ—m
(

71 &
¡»am
,

72 
šputDeviû
,

74 
·Flßt32
,

75 
NULL
,

76 
ouutDeviû
,

78 
·Flßt32
,

79 
NULL
,

85 
·ClOff
,

86 
·‹¡1C®lback
,

87 &
d©a
 );

88 ifĞ
”r
 =ğ
·NoE¼Ü
 )

90 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

95 
	`´štf
( "Waiting for streamo complete...\n" );

97  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

98 
	`Pa_SË•
(1000);

100 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

104 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while openinghe…ortaudio stream\n" );

105 ifĞ
”r
 =ğ
·Ho¡E¼Ü
 )

106 
	`årštf
Ğ
¡d”r
, "Ho¡ƒ¼Ü‚umb”: %d\n", 
	`Pa_G‘Ho¡E¼Ü
() );

108 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

110 
	`Pa_T”mš©e
();

111 
	`´štf
( "bye\n" );

114 
	}
}

	@portaudio/pa_tests/pa_devs.c

36 
	~<¡dio.h
>

37 
	~<m©h.h
>

38 
	~"pÜudio.h
"

41 
maš
();

42 
	$maš
()

44 
i
,
j
;

45 
numDeviûs
;

46 cÚ¡ 
PaDeviûInfo
 *
pdi
;

47 
PaE¼Ü
 
”r
;

48 
	`Pa_In™Ÿlize
();

49 
numDeviûs
 = 
	`Pa_CouÁDeviûs
();

50 ifĞ
numDeviûs
 < 0 )

52 
	`´štf
("ERROR: Pa_CouÁDeviû »tuºed 0x%x\n", 
numDeviûs
 );

53 
”r
 = 
numDeviûs
;

54 
”rÜ
;

56 
	`´štf
("Numb” oàdeviû ğ%d\n", 
numDeviûs
 );

57  
i
=0; i<
numDeviûs
; i++ )

59 
pdi
 = 
	`Pa_G‘DeviûInfo
Ğ
i
 );

60 
	`´štf
("---------------------------------------------- #%d", 
i
 );

61 ifĞ
i
 =ğ
	`Pa_G‘DeçuÉIÅutDeviûID
(èè
	`´štf
(" DefaultInput");

62 ifĞ
i
 =ğ
	`Pa_G‘DeçuÉOuutDeviûID
(èè
	`´štf
(" DefaultOutput");

63 
	`´štf
("\nNam = %s\n", 
pdi
->
Çme
 );

64 
	`´štf
("Max IÅut  = %d", 
pdi
->
maxIÅutChªÃls
 );

65 
	`´štf
(", Max Ouut ğ%d\n", 
pdi
->
maxOuutChªÃls
 );

66 ifĞ
pdi
->
numSam¶eR©es
 == -1 )

68 
	`´štf
("Sam¶R©Rªgğ%àtØ%f\n", 
pdi
->
§m¶eR©es
[0],…di->sampleRates[1] );

72 
	`´štf
("Sample Rates =");

73  
j
=0; j<
pdi
->
numSam¶eR©es
; j++ )

75 
	`´štf
(" %8.2f,", 
pdi
->
§m¶eR©es
[
j
] );

77 
	`´štf
("\n");

79 
	`´štf
("Native Sample Formats = ");

80 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·IÁ8
 ) 
	`´štf
("paInt8, ");

81 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·UIÁ8
 ) 
	`´štf
("paUInt8, ");

82 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·IÁ16
 ) 
	`´štf
("paInt16, ");

83 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·IÁ32
 ) 
	`´štf
("paInt32, ");

84 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·Flßt32
 ) 
	`´štf
("paFloat32, ");

85 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·IÁ24
 ) 
	`´štf
("paInt24, ");

86 ifĞ
pdi
->
ÇtiveSam¶eFÜm©s
 & 
·PackedIÁ24
 ) 
	`´štf
("paPackedInt24, ");

87 
	`´štf
("\n");

89 
	`Pa_T”mš©e
();

91 
	`´štf
("----------------------------------------------\n");

93 
”rÜ
:

94 
	`Pa_T”mš©e
();

95 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

96 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

97 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

98  
”r
;

99 
	}
}

	@portaudio/pa_tests/pa_fuzz.c

36 
	~<¡dio.h
>

37 
	~<m©h.h
>

38 
	~"pÜudio.h
"

44 
	#SAMPLE_RATE
 (44100)

	)

45 
	#PA_SAMPLE_TYPE
 
·Flßt32


	)

46 
	#FRAMES_PER_BUFFER
 (64)

	)

48 
	tSAMPLE
;

50 
CubicAm¶if›r
Ğ
šput
 );

51 
fuzzC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

52 
äamesP”Bufãr
,

53 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

56 
	$CubicAm¶if›r
Ğ
šput
 )

58 
ouut
, 
‹mp
;

59 ifĞ
šput
 < 0.0 )

61 
‹mp
 = 
šput
 + 1.0f;

62 
ouut
 = (
‹mp
 *emp *emp) - 1.0f;

66 
‹mp
 = 
šput
 - 1.0f;

67 
ouut
 = (
‹mp
 *emp *emp) + 1.0f;

70  
ouut
;

71 
	}
}

72 
	#FUZZ
(
x
è
	`CubicAm¶if›r
(CubicAm¶if›r(CubicAm¶if›r(CubicAm¶if›r(x))))

	)

74 
	ggNumNoIÅuts
 = 0;

79 
	$fuzzC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

80 
äamesP”Bufãr
,

81 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

83 
SAMPLE
 *
out
 = (SAMPLE*)
ouutBufãr
;

84 
SAMPLE
 *
š
 = (SAMPLE*)
šputBufãr
;

85 
i
;

86 (è
outTime
;

87 (è
u£rD©a
;

89 ifĞ
šputBufãr
 =ğ
NULL
 )

91  
i
=0; i<
äamesP”Bufãr
; i++ )

93 *
out
++ = 0;

94 *
out
++ = 0;

96 
gNumNoIÅuts
 += 1;

100  
i
=0; i<
äamesP”Bufãr
; i++ )

102 *
out
++ = 
	`FUZZ
(*
š
++);

103 *
out
++ = *
š
++;

107 
	}
}

110 
maš
();

111 
	$maš
()

113 
PÜtAudioSŒ—m
 *
¡»am
;

114 
PaE¼Ü
 
”r
;

116 
”r
 = 
	`Pa_In™Ÿlize
();

117 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

119 
”r
 = 
	`Pa_O³nSŒ—m
(

120 &
¡»am
,

121 
	`Pa_G‘DeçuÉIÅutDeviûID
(),

123 
PA_SAMPLE_TYPE
,

124 
NULL
,

125 
	`Pa_G‘DeçuÉOuutDeviûID
(),

127 
PA_SAMPLE_TYPE
,

128 
NULL
,

129 
SAMPLE_RATE
,

130 
FRAMES_PER_BUFFER
,

133 
fuzzC®lback
,

134 
NULL
 );

135 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

137 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

138 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

140 
	`´štf
("Hit ENTERo stop…rogram.\n");

141 
	`fæush
(
¡dout
);

142 
	`g‘ch¬
();

143 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

144 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

146 
	`´štf
("Fšished. gNumNoIÅut ğ%d\n", 
gNumNoIÅuts
 );

147 
	`Pa_T”mš©e
();

150 
”rÜ
:

151 
	`Pa_T”mš©e
();

152 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

153 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

154 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

156 
	}
}

	@portaudio/pa_tests/pa_minlat.c

37 
	~<¡dio.h
>

38 
	~<¡dlib.h
>

39 
	~<m©h.h
>

40 
	~"pÜudio.h
"

42 #iâdeà
M_PI


43 
	#M_PI
 (3.14159265)

	)

45 
	#TWOPI
 (
M_PI
 * 2.0)

	)

47 
	#DEFAULT_BUFFER_SIZE
 (64)

	)

51 
	mËá_pha£
;

52 
	mright_pha£
;

54 
	t·Te¡D©a
;

57 
	$·mšÏtC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

58 
äamesP”Bufãr
,

59 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

61 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

62 *
out
 = (*)
ouutBufãr
;

63 
i
;

64 
Ëá_pha£Inc
 = 0.02;

65 
right_pha£Inc
 = 0.06;

67 
Ëá_pha£
 = 
d©a
->left_phase;

68 
right_pha£
 = 
d©a
->right_phase;

70  
i
=0; i<
äamesP”Bufãr
; i++ )

72 
Ëá_pha£
 +ğ
Ëá_pha£Inc
;

73 ifĞ
Ëá_pha£
 > 
TWOPI
 )†eft_phase -= TWOPI;

74 *
out
++ = (è
	`sš
Ğ
Ëá_pha£
 );

76 
right_pha£
 +ğ
right_pha£Inc
;

77 ifĞ
right_pha£
 > 
TWOPI
 )„ight_phase -= TWOPI;

78 *
out
++ = (è
	`sš
Ğ
right_pha£
 );

81 
d©a
->
Ëá_pha£
 =†eft_phase;

82 
d©a
->
right_pha£
 =„ight_phase;

84 
	}
}

85 
maš
Ğ
¬gc
, **
¬gv
 );

86 
	$maš
Ğ
¬gc
, **
¬gv
 )

88 
PÜtAudioSŒ—m
 *
¡»am
;

89 
PaE¼Ü
 
”r
;

90 
·Te¡D©a
 
d©a
;

91 
go
;

92 
numBufãrs
 = 0;

93 
mšBufãrs
 = 0;

94 
äamesP”Bufãr
;

95 
§m¶eR©e
 = 44100.0;

96 
¡r
[256];

97 
	`´štf
("paminlat - Determine minimum†atency for your computer.\n");

98 
	`´štf
(" usage:…aminlat {framesPerBuffer}\n");

99 
	`´štf
(" forƒxample:…aminlat 256\n");

100 
	`´štf
("Adjust your stereo until you hear‡ smoothone inƒach speaker.\n");

101 
	`´štf
("Thenryo findhe smallest‚umber of buffershat still sounds smooth.\n");

102 
	`´štf
("Notehathe sound will stop momentarily when you changehe‚umber of buffers.\n");

104 
äamesP”Bufãr
 = ( 
¬gc
 > 1 ) ? 
	`©Ş
Ğ
¬gv
[1] ) : 
DEFAULT_BUFFER_SIZE
;

105 
	`´štf
("F¿me ³¸bufã¸ğ%d\n", 
äamesP”Bufãr
 );

107 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0.0;

108 
”r
 = 
	`Pa_In™Ÿlize
();

109 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

111 
numBufãrs
 = 
mšBufãrs
 = 
	`Pa_G‘MšNumBufãrs
Ğ
äamesP”Bufãr
, 
§m¶eR©e
 );

112 
	`´štf
("NumBufãr £ˆtØ%d ba£d oÀ¨ÿÎØPa_G‘MšNumBufãrs()\n", 
numBufãrs
 );

114 
go
 = 1;

115  
go
 )

118 
	`´štf
("Latency = framesPerBuffer *‚umBuffers = %d * %d = %d frames = %d msecs.\n",

119 
äamesP”Bufãr
, 
numBufãrs
, framesPerBuffer*numBuffers,

120 ()((1000 * 
äamesP”Bufãr
 * 
numBufãrs
è/ 
§m¶eR©e
) );

121 
”r
 = 
	`Pa_O³nSŒ—m
(

122 &
¡»am
,

123 
·NoDeviû
,

125 
·Flßt32
,

126 
NULL
,

127 
	`Pa_G‘DeçuÉOuutDeviûID
(),

129 
·Flßt32
,

130 
NULL
,

131 
§m¶eR©e
,

132 
äamesP”Bufãr
,

133 
numBufãrs
,

134 
·ClOff
,

135 
·mšÏtC®lback
,

136 &
d©a
 );

137 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

138 ifĞ
¡»am
 =ğ
NULL
 ) 
”rÜ
;

140 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

141 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

143 
	`´štf
("\nMove windows‡roundo see ifhe sound glitches.\n");

144 
	`´štf
("NumBufãr cu¼’y %d,ƒÁ”‚ew‚umb”, o¸'q'Øqu™: ", 
numBufãrs
 );

145 
	`g‘s
Ğ
¡r
 );

146 ifĞ
¡r
[0] =ğ'q' ) 
go
 = 0;

149 
numBufãrs
 = 
	`©Ş
Ğ
¡r
 );

150 ifĞ
numBufãrs
 < 
mšBufãrs
 )

152 
	`´štf
Ğ"numBufãr b–ow mšimum oà%d! S‘Ømšimum!!!\n", 
mšBufãrs
 );

153 
numBufãrs
 = 
mšBufãrs
;

157 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

158 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

159 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

160 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

162 
	`´štf
("A good setting for†atency would be somewhat higherhan\n");

163 
	`´štf
("the minimum†atencyhat worked.\n");

164 
	`´štf
("PortAudio: Test finished.\n");

165 
	`Pa_T”mš©e
();

167 
”rÜ
:

168 
	`Pa_T”mš©e
();

169 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

170 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

171 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

172 
	}
}

	@portaudio/pa_tests/paqa_devs.c

38 
	~<¡dio.h
>

39 
	~<m©h.h
>

40 
	~"pÜudio.h
"

41 
	~"·_Œaû.h
"

43 
	#MODE_INPUT
 (0)

	)

44 
	#MODE_OUTPUT
 (1)

	)

45 
	sPaQaD©a


47 
	mäamesLeá
;

48 
	mnumChªÃls
;

49 
	mby‹sP”Sam¶e
;

50 
	mmode
;

51 
	m§wPha£
;

52 
PaSam¶eFÜm©
 
	mfÜm©
;

53 } 
	tPaQaD©a
;

56 
Te¡Deviûs
Ğ
mode
 );

57 
Te¡FÜm©s
Ğ
mode
, 
PaDeviûID
 
deviûID
, 
§m¶eR©e
,

58 
numChªÃls
 );

59 
Te¡Advªû
Ğ
mode
, 
PaDeviûID
 
deviûID
, 
§m¶eR©e
,

60 
numChªÃls
, 
PaSam¶eFÜm©
 
fÜm©
 );

61 
QaC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

62 
äamesP”Bufãr
,

63 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

66 
	ggNumPas£d
 = 0;

67 
	ggNumFaed
 = 0;

72 
	#EXPECT
(
_exp
) \

75 ià((
_exp
)) {\

77 
gNumPas£d
++; \

80 
	`´štf
("ERROR - 0x%x - % fÜ %s\n", 
»suÉ
, \

81 ((
»suÉ
 =ğ0è? "-" : 
	`Pa_G‘E¼ÜText
(result)), \

83 
gNumFaed
++; \

84 
”rÜ
; \

86 } 0)

	)

92 
	$QaC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

93 
äamesP”Bufãr
,

94 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

96 
i
;

97 
pha£
;

98 
PaQaD©a
 *
d©a
 = (PaQaD©¨*è
u£rD©a
;

99 (è
šputBufãr
;

100 (è
outTime
;

103 ifĞ
d©a
->
mode
 =ğ
MODE_OUTPUT
 )

105 
pha£
 = 
d©a
->
§wPha£
;

106  
d©a
->
fÜm©
 )

108 
·Flßt32
:

110 *
out
 = (*è
ouutBufãr
;

111  
i
=0; i<
äamesP”Bufãr
; i++ )

113 
pha£
 += 0x123;

114 *
out
++ = (è(
pha£
 * (1.0 / 32768.0));

115 ifĞ
d©a
->
numChªÃls
 == 2 )

117 *
out
++ = (è(
pha£
 * (1.0 / 32768.0));

123 
·IÁ32
:

125 *
out
 = (*è
ouutBufãr
;

126  
i
=0; i<
äamesP”Bufãr
; i++ )

128 
pha£
 += 0x123;

129 *
out
++ = ((è
pha£
 ) << 16;

130 ifĞ
d©a
->
numChªÃls
 == 2 )

132 *
out
++ = ((è
pha£
 ) << 16;

137 
·IÁ16
:

139 *
out
 = (*è
ouutBufãr
;

140  
i
=0; i<
äamesP”Bufãr
; i++ )

142 
pha£
 += 0x123;

143 *
out
++ = 
pha£
;

144 ifĞ
d©a
->
numChªÃls
 == 2 )

146 *
out
++ = 
pha£
;

154 *
out
 = (*è
ouutBufãr
;

155 
numBy‹s
 = 
äamesP”Bufãr
 * 
d©a
->
numChªÃls
 * d©a->
by‹sP”Sam¶e
;

156  
i
=0; i<
numBy‹s
; i++ )

158 *
out
++ = 0;

163 
d©a
->
§wPha£
 = 
pha£
;

166 ifĞ
d©a
->
äamesLeá
 > 
äamesP”Bufãr
 )

168 
	`AddT¿ûMes§ge
("QaC®lback:„uÂšg. f¿mesLeá", 
d©a
->
äamesLeá
 );

169 
d©a
->
äamesLeá
 -ğ
äamesP”Bufãr
;

174 
	`AddT¿ûMes§ge
("QaC®lback: DONE! f¿mesLeá", 
d©a
->
äamesLeá
 );

175 
d©a
->
äamesLeá
 = 0;

178 
	}
}

180 
maš
();

181 
	$maš
()

183 
PaE¼Ü
 
»suÉ
;

184 
	`EXPECT
Ğ((
»suÉ
=
	`Pa_In™Ÿlize
()) == 0) );

185 
	`´štf
("Test OUTPUT ---------------\n");

186 
	`Te¡Deviûs
Ğ
MODE_OUTPUT
 );

187 
	`´štf
("Test INPUT ---------------\n");

188 
	`Te¡Deviûs
Ğ
MODE_INPUT
 );

189 
”rÜ
:

190 
	`Pa_T”mš©e
();

191 
	`´štf
("QA R•Üt: %d…as£d, %d faed.\n", 
gNumPas£d
, 
gNumFaed
 );

192 
	}
}

195 
	$Te¡Deviûs
Ğ
mode
 )

197 
id
,
jc
,
kr
;

198 
maxChªÃls
;

199 cÚ¡ 
PaDeviûInfo
 *
pdi
;

200 
numDeviûs
 = 
	`Pa_CouÁDeviûs
();

202  
id
=0; id<
numDeviûs
; id++ )

204 
pdi
 = 
	`Pa_G‘DeviûInfo
Ğ
id
 );

206 
maxChªÃls
 = ( 
mode
 =ğ
MODE_INPUT
 ) ? 
pdi
->
maxIÅutChªÃls
 :…di->
maxOuutChªÃls
;

207  
jc
=1; jc<=
maxChªÃls
; jc++ )

209 
	`´štf
("Nam = %s\n", 
pdi
->
Çme
 );

211 ifĞ
pdi
->
numSam¶eR©es
 == -1 )

213 
low
, 
high
;

214 
low
 = 
pdi
->
§m¶eR©es
[0];

215 
high
 = 
pdi
->
§m¶eR©es
[1];

216 ifĞ
low
 < 8000.0 )†ow = 8000.0;

217 
	`Te¡FÜm©s
Ğ
mode
, 
id
, 
low
, 
jc
 );

218 
	#TESTSR
(
¤
è{if(((¤)>=
low
è&& ((¤)<=
high
)è
	`Te¡FÜm©s
Ğ
mode
, 
id
, (¤), 
jc
 ); }

	)

220 
	`TESTSR
(11025.0);

221 
	`TESTSR
(22050.0);

222 
	`TESTSR
(34567.0);

223 
	`TESTSR
(44100.0);

224 
	`Te¡FÜm©s
Ğ
mode
, 
id
, 
high
, 
jc
 );

228  
kr
=0; kr<
pdi
->
numSam¶eR©es
; kr++ )

230 
	`Te¡FÜm©s
Ğ
mode
, 
id
, 
pdi
->
§m¶eR©es
[
kr
], 
jc
 );

235 
	}
}

237 
	$Te¡FÜm©s
Ğ
mode
, 
PaDeviûID
 
deviûID
, 
§m¶eR©e
,

238 
numChªÃls
 )

240 
	`Te¡Advªû
Ğ
mode
, 
deviûID
, 
§m¶eR©e
, 
numChªÃls
, 
·Flßt32
 );

241 
	`Te¡Advªû
Ğ
mode
, 
deviûID
, 
§m¶eR©e
, 
numChªÃls
, 
·IÁ16
 );

242 
	`Te¡Advªû
Ğ
mode
, 
deviûID
, 
§m¶eR©e
, 
numChªÃls
, 
·IÁ32
 );

243 
	}
}

245 
	$Te¡Advªû
Ğ
mode
, 
PaDeviûID
 
deviûID
, 
§m¶eR©e
,

246 
numChªÃls
, 
PaSam¶eFÜm©
 
fÜm©
 )

248 
PÜtAudioSŒ—m
 *
¡»am
 = 
NULL
;

249 
PaE¼Ü
 
»suÉ
;

250 
PaQaD©a
 
myD©a
;

251 
	#FRAMES_PER_BUFFER
 (64)

	)

252 
	`´štf
("------ TestAdvance: %s, device = %d,„ate = %g,‚umChannels = %d, format = %d -------\n",

253 Ğ
mode
 =ğ
MODE_INPUT
 ) ? "INPUT" : "OUTPUT",

254 
deviûID
, 
§m¶eR©e
, 
numChªÃls
, 
fÜm©
);

255 
	`fæush
(
¡dout
);

257 
myD©a
.
äamesLeá
 = (è(
§m¶eR©e
 * 100);

258 
myD©a
.
numChªÃls
 =‚umChannels;

259 
myD©a
.
mode
 = mode;

260 
myD©a
.
fÜm©
 = format;

261  
fÜm©
 )

263 
·Flßt32
:

264 
·IÁ32
:

265 
·IÁ24
:

266 
myD©a
.
by‹sP”Sam¶e
 = 4;

268 
·PackedIÁ24
:

269 
myD©a
.
by‹sP”Sam¶e
 = 3;

272 
myD©a
.
by‹sP”Sam¶e
 = 2;

275 
	`EXPECT
Ğ((
»suÉ
 = 
	`Pa_O³nSŒ—m
(

276 &
¡»am
,

277 Ğ
mode
 =ğ
MODE_INPUT
 ) ? 
deviûID
 : 
·NoDeviû
,

278 Ğ
mode
 =ğ
MODE_INPUT
 ) ? 
numChªÃls
 : 0,

279 
fÜm©
,

280 
NULL
,

281 Ğ
mode
 =ğ
MODE_OUTPUT
 ) ? 
deviûID
 : 
·NoDeviû
,

282 Ğ
mode
 =ğ
MODE_OUTPUT
 ) ? 
numChªÃls
 : 0,

283 
fÜm©
,

284 
NULL
,

285 
§m¶eR©e
,

286 
FRAMES_PER_BUFFER
,

288 
·ClOff
,

289 
QaC®lback
,

290 &
myD©a
 )

292 ifĞ
¡»am
 )

294 
PaTime¡amp
 
ŞdSmp
, 
ÃwSmp
;

295 
ŞdF¿mes
;

296 
mšD–ay
 = ( 
mode
 =ğ
MODE_INPUT
 ) ? 1000 : 400;

297 
mšNumBufãrs
 = 
	`Pa_G‘MšNumBufãrs
Ğ
FRAMES_PER_BUFFER
, 
§m¶eR©e
 );

298 
m£c
 = (è((
mšNumBufãrs
 * 3 * 1000.0 * 
FRAMES_PER_BUFFER
è/ 
§m¶eR©e
);

299 ifĞ
m£c
 < 
mšD–ay
 ) msec = minDelay;

300 
	`´štf
("m£øğ%d\n", 
m£c
);

301 
	`EXPECT
Ğ((
»suÉ
=
	`Pa_S¹SŒ—m
Ğ
¡»am
 )) == 0) );

303 
»suÉ
 = 
·NoE¼Ü
;

304 
ŞdSmp
 = 
	`Pa_SŒ—mTime
(
¡»am
);

305 
	`fæush
(
¡dout
);

306 
	`Pa_SË•
(
m£c
);

307 
ÃwSmp
 = 
	`Pa_SŒ—mTime
(
¡»am
);

308 
	`´štf
("ŞdSm°ğ%g,ÃwSm°ğ%g\n", 
ŞdSmp
, 
ÃwSmp
 );

309 
	`EXPECT
Ğ(
ŞdSmp
 < 
ÃwSmp
) );

311 
ŞdF¿mes
 = 
myD©a
.
äamesLeá
;

312 
	`Pa_SË•
(
m£c
);

313 
	`´štf
("ŞdF¿me ğ%d, myD©a.äamesLeá = %d\n", 
ŞdF¿mes
, 
myD©a
.
äamesLeá
 );

314 
	`EXPECT
Ğ(
ŞdF¿mes
 > 
myD©a
.
äamesLeá
) );

315 
	`EXPECT
Ğ((
»suÉ
=
	`Pa_Clo£SŒ—m
Ğ
¡»am
 )) == 0) );

316 
¡»am
 = 
NULL
;

318 
”rÜ
:

319 ifĞ
¡»am
 !ğ
NULL
 ) 
	`Pa_Clo£SŒ—m
( stream );

320 
	`fæush
(
¡dout
);

321  
»suÉ
;

322 
	}
}

	@portaudio/pa_tests/paqa_errs.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

41 
	#MODE_INPUT
 (0)

	)

42 
	#MODE_OUTPUT
 (1)

	)

43 
	#FRAMES_PER_BUFFER
 (64)

	)

44 
	#SAMPLE_RATE
 (44100.0)

	)

45 
	#NUM_BUFFERS
 (0)

	)

46 
	sPaQaD©a


48 
	mäamesLeá
;

49 
	mnumChªÃls
;

50 
	mby‹sP”Sam¶e
;

51 
	mmode
;

53 
	tPaQaD©a
;

55 
Te¡Deviûs
Ğ
mode
 );

56 
Te¡FÜm©s
Ğ
mode
, 
PaDeviûID
 
deviûID
, 
§m¶eR©e
,

57 
numChªÃls
 );

58 
Te¡BadO³ns
( );

59 
Te¡BadAùiÚs
( );

60 
QaC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

61 
äamesP”Bufãr
,

62 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

64 
	ggNumPas£d
 = 0;

65 
	ggNumFaed
 = 0;

69 
	#EXPECT
Ğ
msg
, 
_exp
) \

72 ià((
_exp
)) {\

73 
gNumPas£d
++; \

76 
	`´štf
("\nERROR %s\À - 0x%x - % fÜ %s\n", (
msg
), 
»suÉ
, 
	`Pa_G‘E¼ÜText
(result), #_exp ); \

77 
gNumFaed
++; \

78 
”rÜ
; \

80 } 0)

	)

81 
	#HOPEFOR
Ğ
msg
, 
_exp
) \

84 ià((
_exp
)) {\

85 
gNumPas£d
++; \

88 
	`´štf
("\nERROR %s\À - 0x%x - % fÜ %s\n", (
msg
), 
»suÉ
, 
	`Pa_G‘E¼ÜText
(result), #_exp ); \

89 
gNumFaed
++; \

91 } 0)

	)

97 
	$QaC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

98 
äamesP”Bufãr
,

99 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

101 
i
;

102 *
out
 = (*è
ouutBufãr
;

103 
PaQaD©a
 *
d©a
 = (PaQaD©¨*è
u£rD©a
;

104 (è
šputBufãr
;

105 (è
outTime
;

108 ifĞ
d©a
->
mode
 =ğ
MODE_OUTPUT
 )

110 
numBy‹s
 = 
äamesP”Bufãr
 * 
d©a
->
numChªÃls
 * d©a->
by‹sP”Sam¶e
;

111  
i
=0; i<
numBy‹s
; i++ )

113 *
out
++ = 0;

117 ifĞ
d©a
->
äamesLeá
 > 
äamesP”Bufãr
 )

119 
d©a
->
äamesLeá
 -ğ
äamesP”Bufãr
;

124 
d©a
->
äamesLeá
 = 0;

127 
	}
}

129 
maš
();

130 
	$maš
()

132 
PaE¼Ü
 
»suÉ
;

133 
	`EXPECT
Ğ"š™", ((
»suÉ
=
	`Pa_In™Ÿlize
()) == 0) );

134 
	`Te¡BadAùiÚs
();

135 
	`Te¡BadO³ns
();

136 
”rÜ
:

137 
	`Pa_T”mš©e
();

138 
	`´štf
("QA R•Üt: %d…as£d, %d faed.\n", 
gNumPas£d
, 
gNumFaed
 );

140 
	}
}

142 
	$Te¡BadO³ns
( )

144 
PÜtAudioSŒ—m
 *
¡»am
 = 
NULL
;

145 
PaE¼Ü
 
»suÉ
;

146 
PaQaD©a
 
myD©a
;

148 
myD©a
.
äamesLeá
 = (è(
SAMPLE_RATE
 * 100);

149 
myD©a
.
numChªÃls
 = 1;

150 
myD©a
.
mode
 = 
MODE_OUTPUT
;

151 
	`HOPEFOR
( "No devices specified.",(

152 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

153 &
¡»am
,

154 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

155 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

156 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

157 
·ClOff
,

158 
QaC®lback
,

159 &
myD©a
 )

160 è=ğ
·Inv®idDeviûId
) );

161 
	`HOPEFOR
( "Out of„ange input device specified.",(

162 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

163 &
¡»am
,

164 
	`Pa_CouÁDeviûs
(), 0, 
·Flßt32
, 
NULL
,

165 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

166 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

167 
·ClOff
,

168 
QaC®lback
,

169 &
myD©a
 )

170 è=ğ
·Inv®idDeviûId
) );

172 
	`HOPEFOR
( "Out of„ange output device specified.",(

173 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

174 &
¡»am
,

175 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

176 
	`Pa_CouÁDeviûs
(), 0, 
·Flßt32
, 
NULL
,

177 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

178 
·ClOff
,

179 
QaC®lback
,

180 &
myD©a
 )

181 è=ğ
·Inv®idDeviûId
) );

182 
	`HOPEFOR
( "Zero input channels.",(

183 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

184 &
¡»am
,

185 
	`Pa_G‘DeçuÉIÅutDeviûID
(), 0, 
·Flßt32
, 
NULL
,

186 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

187 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

188 
·ClOff
,

189 
QaC®lback
,

190 &
myD©a
 )

191 è=ğ
·Inv®idChªÃlCouÁ
) );

192 
	`HOPEFOR
( "Zero output channels.",(

193 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

194 &
¡»am
,

195 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

196 
	`Pa_G‘DeçuÉOuutDeviûID
(), 0, 
·Flßt32
, 
NULL
,

197 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

198 
·ClOff
,

199 
QaC®lback
,

200 &
myD©a
 )

201 è=ğ
·Inv®idChªÃlCouÁ
) );

202 
	`HOPEFOR
( "Nonzero input channels but‚o device.",(

203 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

204 &
¡»am
,

205 
	`Pa_G‘DeçuÉIÅutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

206 
·NoDeviû
, 2, 
·Flßt32
, 
NULL
,

207 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

208 
·ClOff
,

209 
QaC®lback
,

210 &
myD©a
 )

211 è=ğ
·Inv®idChªÃlCouÁ
) );

213 
	`HOPEFOR
( "Nonzero output channels but‚o device.",(

214 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

215 &
¡»am
,

216 
·NoDeviû
, 2, 
·Flßt32
, 
NULL
,

217 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

218 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

219 
·ClOff
,

220 
QaC®lback
,

221 &
myD©a
 )

222 è=ğ
·Inv®idChªÃlCouÁ
) );

223 
	`HOPEFOR
( "NULL stream…ointer.",(

224 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

225 
NULL
,

226 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

227 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

228 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

229 
·ClOff
,

230 
QaC®lback
,

231 &
myD©a
 )

232 è=ğ
·BadSŒ—mPŒ
) );

233 
	`HOPEFOR
( "Low sample„ate.",(

234 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

235 &
¡»am
,

236 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

237 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

238 1.0, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

239 
·ClOff
,

240 
QaC®lback
,

241 &
myD©a
 )

242 è=ğ
·Inv®idSam¶eR©e
) );

243 
	`HOPEFOR
( "High sample„ate.",(

244 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

245 &
¡»am
,

246 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

247 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

248 10000000.0, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

249 
·ClOff
,

250 
QaC®lback
,

251 &
myD©a
 )

252 è=ğ
·Inv®idSam¶eR©e
) );

253 
	`HOPEFOR
( "NULL callback.",(

254 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

255 &
¡»am
,

256 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

257 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

258 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

259 
·ClOff
,

260 
NULL
,

261 &
myD©a
 )

262 è=ğ
·NuÎC®lback
) );

263 
	`HOPEFOR
( "Bad flag.",(

264 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

265 &
¡»am
,

266 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

267 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

268 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

270 
QaC®lback
,

271 &
myD©a
 )

272 è=ğ
·Inv®idFÏg
) );

275 
	`HOPEFOR
( "Use input device‡s output device.",(

276 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

277 &
¡»am
,

278 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

279 
	`Pa_G‘DeçuÉIÅutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

280 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

281 
·ClOff
,

282 
QaC®lback
,

283 &
myD©a
 )

284 è=ğ
·Inv®idDeviûId
) );

286 
	`HOPEFOR
( "Use output device‡s input device.",(

287 (
»suÉ
 = 
	`Pa_O³nSŒ—m
(

288 &
¡»am
,

289 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

290 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

291 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

292 
·ClOff
,

293 
QaC®lback
,

294 &
myD©a
 )

295 è=ğ
·Inv®idDeviûId
) );

298 ifĞ
¡»am
 !ğ
NULL
 ) 
	`Pa_Clo£SŒ—m
( stream );

299  
»suÉ
;

300 
	}
}

302 
	$Te¡BadAùiÚs
( )

304 
PÜtAudioSŒ—m
 *
¡»am
 = 
NULL
;

305 
PaE¼Ü
 
»suÉ
;

306 
PaQaD©a
 
myD©a
;

308 
myD©a
.
äamesLeá
 = (è(
SAMPLE_RATE
 * 100);

309 
myD©a
.
numChªÃls
 = 1;

310 
myD©a
.
mode
 = 
MODE_OUTPUT
;

312 
	`EXPECT
Ğ"Te¡BadAùiÚs", ((
»suÉ
 = 
	`Pa_O³nSŒ—m
(

313 &
¡»am
,

314 
·NoDeviû
, 0, 
·Flßt32
, 
NULL
,

315 
	`Pa_G‘DeçuÉOuutDeviûID
(), 2, 
·Flßt32
, 
NULL
,

316 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
NUM_BUFFERS
,

317 
·ClOff
,

318 
QaC®lback
,

319 &
myD©a
 )

321 
	`HOPEFOR
Ğ"¡¬t", ((
»suÉ
 = 
	`Pa_S¹SŒ—m
Ğ
NULL
 )è=ğ
·BadSŒ—mPŒ
) );

322 
	`HOPEFOR
Ğ"¡İ", ((
»suÉ
 = 
	`Pa_StİSŒ—m
Ğ
NULL
 )è=ğ
·BadSŒ—mPŒ
) );

323 
	`HOPEFOR
Ğ"aùive?", ((
»suÉ
 = 
	`Pa_SŒ—mAùive
Ğ
NULL
 )è=ğ
·BadSŒ—mPŒ
) );

324 
	`HOPEFOR
Ğ"şo£", ((
»suÉ
 = 
	`Pa_Clo£SŒ—m
Ğ
NULL
 )è=ğ
·BadSŒ—mPŒ
) );

325 
	`HOPEFOR
Ğ"time?", ((
»suÉ
 = (
PaE¼Ü
)
	`Pa_SŒ—mTime
Ğ
NULL
 )) != 0) );

326 
	`HOPEFOR
Ğ"CPULßd?", ((
»suÉ
 = (
PaE¼Ü
)
	`Pa_G‘CPULßd
Ğ
NULL
 )) != 0) );

327 
”rÜ
:

328 ifĞ
¡»am
 !ğ
NULL
 ) 
	`Pa_Clo£SŒ—m
( stream );

329  
»suÉ
;

330 
	}
}

	@portaudio/pa_tests/patest1.c

10 
	~<¡dio.h
>

11 
	~<m©h.h
>

12 
	~"pÜudio.h
"

13 #iâdeà
M_PI


14 
	#M_PI
 (3.14159265)

	)

18 
	msše
[100];

19 
	mpha£
;

20 
	m§mpsToGo
;

22 
	t·‹¡1d©a
;

23 
	$·‹¡1C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

24 
bufãrF¿mes
,

25 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

27 
·‹¡1d©a
 *
d©a
 = (·‹¡1d©a*)
u£rD©a
;

28 *
š
 = (*)
šputBufãr
;

29 *
out
 = (*)
ouutBufãr
;

30 
äamesToC®c
 = 
bufãrF¿mes
;

31 
i
;

32 
fšished
 = 0;

34 if(
šputBufãr
 =ğ
NULL
)  0;

35 ifĞ
d©a
->
§mpsToGo
 < 
bufãrF¿mes
 )

37 
äamesToC®c
 = 
d©a
->
§mpsToGo
;

38 
fšished
 = 1;

40  
i
=0; i<
äamesToC®c
; i++ )

42 *
out
++ = *
š
++ * 
d©a
->
sše
[d©a->
pha£
];

43 *
out
++ = *
š
++ * 
d©a
->
sše
[d©a->
pha£
++];

44 ifĞ
d©a
->
pha£
 >= 100 )

45 
d©a
->
pha£
 = 0;

47 
d©a
->
§mpsToGo
 -ğ
äamesToC®c
;

49  ; 
i
<
bufãrF¿mes
; i++ )

51 *
out
++ = 0;

52 *
out
++ = 0;

54  
fšished
;

55 
	}
}

56 
maš
(
¬gc
, * 
¬gv
[]);

57 
	$maš
(
¬gc
, * 
¬gv
[])

59 
PaSŒ—m
 *
¡»am
;

60 
PaE¼Ü
 
”r
;

61 
·‹¡1d©a
 
d©a
;

62 
i
;

63 
šputDeviû
 = 
	`Pa_G‘DeçuÉIÅutDeviûID
();

64 
ouutDeviû
 = 
	`Pa_G‘DeçuÉOuutDeviûID
();

66  
i
=0; i<100; i++ )

67 
d©a
.
sše
[
i
] = 
	`sš
Ğ(()i/100.è* 
M_PI
 * 2. );

68 
d©a
.
pha£
 = 0;

69 
d©a
.
§mpsToGo
 = 44100 * 20;

71 
	`Pa_In™Ÿlize
();

72 
”r
 = 
	`Pa_O³nSŒ—m
(

73 &
¡»am
,

74 
šputDeviû
,

76 
·Flßt32
,

77 
NULL
,

78 
ouutDeviû
,

80 
·Flßt32
,

81 
NULL
,

85 
·ClOff
,

86 
·‹¡1C®lback
,

87 &
d©a
 );

88 ifĞ
”r
 =ğ
·NoE¼Ü
 )

90 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

91 
	`´štf
( "Press‡ny keyoƒnd.\n" );

92 
	`g‘c
Ğ
¡dš
 );

93 
	`Pa_AbÜtSŒ—m
Ğ
¡»am
 );

95 
	`´štf
( "Waiting for streamo complete...\n" );

97  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

98 
	`Pa_SË•
(1000);

100 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

104 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while openinghe…ortaudio stream\n" );

105 ifĞ
”r
 =ğ
·Ho¡E¼Ü
 )

106 
	`årštf
Ğ
¡d”r
, "Ho¡ƒ¼Ü‚umb”: %d\n", 
	`Pa_G‘Ho¡E¼Ü
() );

108 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

110 
	`Pa_T”mš©e
();

111 
	`´štf
( "bye\n" );

114 
	}
}

	@portaudio/pa_tests/patest_clip.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

40 
	#NUM_SECONDS
 (4)

	)

41 
	#SAMPLE_RATE
 (44100)

	)

42 #iâdeà
M_PI


43 
	#M_PI
 (3.14159265)

	)

45 
	#TABLE_SIZE
 (200)

	)

46 
	s·Te¡D©a


48 
	msše
[
TABLE_SIZE
];

49 
	mam¶™ude
;

50 
	mËá_pha£
;

51 
	mright_pha£
;

53 
	t·Te¡D©a
;

54 
PaE¼Ü
 
PÏySše
Ğ
·Te¡D©a
 *
d©a
, 
æags
, 
am¶™ude
 );

59 
	$sšeC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

60 
äamesP”Bufãr
,

61 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

63 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

64 *
out
 = (*)
ouutBufãr
;

65 
am¶™ude
 = 
d©a
->amplitude;

66 
i
;

67 (è
šputBufãr
;

68 (è
outTime
;

70  
i
=0; i<
äamesP”Bufãr
; i++ )

72 *
out
++ = 
am¶™ude
 * 
d©a
->
sše
[d©a->
Ëá_pha£
];

73 *
out
++ = 
am¶™ude
 * 
d©a
->
sše
[d©a->
right_pha£
];

74 
d©a
->
Ëá_pha£
 += 1;

75 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

76 
d©a
->
right_pha£
 += 3;

77 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

80 
	}
}

82 
maš
();

83 
	$maš
()

85 
PaE¼Ü
 
”r
;

86 
·Te¡D©a
 
DATA
;

87 
i
;

88 
	`´štf
("PortAudio Test: output sine wave with‡nd without clipping.\n");

90  
i
=0; i<
TABLE_SIZE
; i++ )

92 
DATA
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

94 
	`´štf
("\nH®àam¶™ude. Should sound†iksšwave.\n"); 
	`fæush
(
¡dout
);

95 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·ClOff
 | 
·D™h”Off
, 0.5f );

96 ifĞ
”r
 < 0 ) 
”rÜ
;

97 
	`´štf
("\nFuÎ‡m¶™ude. Should sound†iksšwave.\n"); 
	`fæush
(
¡dout
);

98 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·ClOff
 | 
·D™h”Off
, 0.999f );

99 ifĞ
”r
 < 0 ) 
”rÜ
;

100 
	`´štf
("\nOver„ange with clipping‡nd ditheringurned OFF. Should sound very‚asty.\n");

101 
	`fæush
(
¡dout
);

102 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·ClOff
 | 
·D™h”Off
, 1.1f );

103 ifĞ
”r
 < 0 ) 
”rÜ
;

104 
	`´štf
("\nOver„ange with clipping‡nd ditheringurned ON. Should sound smootherhan…revious.\n");

105 
	`fæush
(
¡dout
);

106 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·NoFÏg
, 1.1f );

107 ifĞ
”r
 < 0 ) 
”rÜ
;

108 
	`´štf
("\nOver„ange with…aClipOff but dithering ON.\n"

110 
	`fæush
(
¡dout
);

111 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·ClOff
, 1.1f );

112 ifĞ
”r
 < 0 ) 
”rÜ
;

114 
”rÜ
:

115 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

116 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

117 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

119 
	}
}

121 
PaE¼Ü
 
	$PÏySše
Ğ
·Te¡D©a
 *
d©a
, 
æags
, 
am¶™ude
 )

123 
PÜtAudioSŒ—m
 *
¡»am
;

124 
PaE¼Ü
 
”r
;

125 
d©a
->
Ëá_pha£
 = d©a->
right_pha£
 = 0;

126 
d©a
->
am¶™ude
 =‡mplitude;

127 
”r
 = 
	`Pa_In™Ÿlize
();

128 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

129 
”r
 = 
	`Pa_O³nSŒ—m
(

130 &
¡»am
,

131 
·NoDeviû
,

133 
·Flßt32
,

134 
NULL
,

135 
	`Pa_G‘DeçuÉOuutDeviûID
(),

137 
·Flßt32
,

138 
NULL
,

139 
SAMPLE_RATE
,

142 
æags
,

143 
sšeC®lback
,

144 
d©a
 );

145 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

146 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

147 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

148 
	`Pa_SË•
Ğ
NUM_SECONDS
 * 1000 );

149 
	`´štf
("CPULßd = %8.6f\n", 
	`Pa_G‘CPULßd
Ğ
¡»am
 ) );

150 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

151 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

152 
	`Pa_T”mš©e
();

153  
·NoE¼Ü
;

154 
”rÜ
:

155  
”r
;

156 
	}
}

	@portaudio/pa_tests/patest_dither.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

40 
	#NUM_SECONDS
 (4)

	)

41 
	#SAMPLE_RATE
 (44100)

	)

42 #iâdeà
M_PI


43 
	#M_PI
 (3.14159265)

	)

45 
	#TABLE_SIZE
 (200)

	)

46 
	s·Te¡D©a


48 
	msše
[
TABLE_SIZE
];

49 
	mam¶™ude
;

50 
	mËá_pha£
;

51 
	mright_pha£
;

53 
	t·Te¡D©a
;

54 
PaE¼Ü
 
PÏySše
Ğ
·Te¡D©a
 *
d©a
, 
PaSŒ—mFÏgs
 
æags
, 
am¶™ude
 );

55 
sšeC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

56 
äamesP”Bufãr
,

57 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

62 
	$sšeC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

66 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

67 *
out
 = (*)
ouutBufãr
;

68 
am¶™ude
 = 
d©a
->amplitude;

69 
i
;

70 (è
outTime
;

71 (è
šputBufãr
;

72  
i
=0; i<
äamesP”Bufãr
; i++ )

74 *
out
++ = 
am¶™ude
 * 
d©a
->
sše
[d©a->
Ëá_pha£
];

75 *
out
++ = 
am¶™ude
 * 
d©a
->
sše
[d©a->
right_pha£
];

76 
d©a
->
Ëá_pha£
 += 1;

77 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

78 
d©a
->
right_pha£
 += 3;

79 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

82 
	}
}

84 
maš
();

85 
	$maš
()

87 
PaE¼Ü
 
”r
;

88 
·Te¡D©a
 
DATA
;

89 
i
;

90 
am¶™ude
 = 32.0 / (1<<15);

91 
	`´štf
("PortAudio Test: output EXTREMELY QUIET sine wave with‡nd without dithering.\n");

93  
i
=0; i<
TABLE_SIZE
; i++ )

95 
DATA
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

97 
	`´štf
("\nNØŒ—tm’t..\n"); 
	`fæush
(
¡dout
);

98 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·ClOff
 | 
·D™h”Off
, 
am¶™ude
 );

99 ifĞ
”r
 < 0 ) 
”rÜ
;

100 
	`´štf
("\nClip.\n");

101 
	`fæush
(
¡dout
);

102 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·D™h”Off
, 
am¶™ude
 );

103 ifĞ
”r
 < 0 ) 
”rÜ
;

104 
	`´štf
("\nClip‡nd Dither.\n");

105 
	`fæush
(
¡dout
);

106 
”r
 = 
	`PÏySše
Ğ&
DATA
, 
·NoFÏg
, 
am¶™ude
 );

107 ifĞ
”r
 < 0 ) 
”rÜ
;

109 
”rÜ
:

110 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

111 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

112 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

114 
	}
}

116 
PaE¼Ü
 
	$PÏySše
Ğ
·Te¡D©a
 *
d©a
, 
PaSŒ—mFÏgs
 
æags
, 
am¶™ude
 )

118 
PÜtAudioSŒ—m
 *
¡»am
;

119 
PaE¼Ü
 
”r
;

120 
d©a
->
Ëá_pha£
 = d©a->
right_pha£
 = 0;

121 
d©a
->
am¶™ude
 =‡mplitude;

122 
”r
 = 
	`Pa_In™Ÿlize
();

123 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

124 
”r
 = 
	`Pa_O³nSŒ—m
(

125 &
¡»am
,

126 
·NoDeviû
,

128 
·Flßt32
,

129 
NULL
,

130 
	`Pa_G‘DeçuÉOuutDeviûID
(),

132 
·Flßt32
,

133 
NULL
,

134 
SAMPLE_RATE
,

137 
æags
,

138 
sšeC®lback
,

139 (*)
d©a
 );

140 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

142 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

143 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

144 
	`Pa_SË•
Ğ
NUM_SECONDS
 * 1000 );

145 
	`´štf
("CPULßd = %8.6f\n", 
	`Pa_G‘CPULßd
Ğ
¡»am
 ) );

146 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

147 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

148 
	`Pa_T”mš©e
();

149  
·NoE¼Ü
;

150 
”rÜ
:

151  
”r
;

152 
	}
}

	@portaudio/pa_tests/patest_latency.c

36 
	~<¡dio.h
>

37 
	~<m©h.h
>

38 
	~"pÜudio.h
"

40 
	#OUTPUT_DEVICE
 (
	`Pa_G‘DeçuÉOuutDeviûID
())

	)

41 
	#SAMPLE_RATE
 (44100)

	)

42 
	#FRAMES_PER_BUFFER
 (64)

	)

45 
	#MIN_LATENCY_MSEC
 (2000)

	)

46 
	#NUM_BUFFERS
 ((
MIN_LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

48 
	#NUM_BUFFERS
 (0)

	)

51 
	#MIN_FREQ
 (100.0f)

	)

52 
	#C®cPha£Inüem’t
(
äeq
è((äeq)/
SAMPLE_RATE
)

	)

53 #iâdeà
M_PI


54 
	#M_PI
 (3.14159265)

	)

56 
	#TABLE_SIZE
 (400)

	)

59 
	msše
[
TABLE_SIZE
 + 1];

60 
	mpha£_šüem’t
;

61 
	mËá_pha£
;

62 
	mright_pha£
;

64 
	t·Te¡D©a
;

65 
LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 );

69 
	$LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 )

71 
fIndex
 = 
pha£
*
TABLE_SIZE
;

72 
šdex
 = (è
fIndex
;

73 
äaù
 = 
fIndex
 - 
šdex
;

74 
lo
 = 
d©a
->
sše
[
šdex
];

75 
hi
 = 
d©a
->
sše
[
šdex
+1];

76 
v®
 = 
lo
 + 
äaù
*(
hi
-lo);

77  
v®
;

78 
	}
}

83 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

84 
äamesP”Bufãr
,

85 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

87 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

88 *
out
 = (*)
ouutBufãr
;

89 
i
;

90 
fšished
 = 0;

91 (è
outTime
;

92 (è
šputBufãr
;

94  
i
=0; i<
äamesP”Bufãr
; i++ )

96 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
Ëá_pha£
);

97 *
out
++ = 
	`LookupSše
(
d©a
, d©a->
right_pha£
);

98 
d©a
->
Ëá_pha£
 +ğd©a->
pha£_šüem’t
;

99 ifĞ
d©a
->
Ëá_pha£
 >= 1.0f ) data->left_phase -= 1.0f;

100 
d©a
->
right_pha£
 +ğ(d©a->
pha£_šüem’t
 * 1.5f);

101 ifĞ
d©a
->
right_pha£
 >= 1.0f ) data->right_phase -= 1.0f;

104 
	}
}

106 
maš
();

107 
	$maš
()

109 
PÜtAudioSŒ—m
 *
¡»am
;

110 
PaE¼Ü
 
”r
;

111 
·Te¡D©a
 
d©a
;

112 
i
;

113 
dÚe
 = 0;

114 
	`´štf
("PÜtAudiØTe¡:ƒÁ”†‘‹¸th’ h™ ENTER.‚umBufãr ğ%d\n", 
NUM_BUFFERS
 );

116  
i
=0; i<
TABLE_SIZE
; i++ )

118 
d©a
.
sše
[
i
] = 0.90à* (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

120 
d©a
.
sše
[
TABLE_SIZE
] = data.sine[0];

121 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0.0;

122 
d©a
.
pha£_šüem’t
 = 
	`C®cPha£Inüem’t
(
MIN_FREQ
);

124 
”r
 = 
	`Pa_In™Ÿlize
();

125 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

126 
	`´štf
("PÜtAudiØTe¡: ouuˆdeviû = %d\n", 
OUTPUT_DEVICE
 );

127 
”r
 = 
	`Pa_O³nSŒ—m
(

128 &
¡»am
,

129 
·NoDeviû
,

131 
·Flßt32
,

132 
NULL
,

133 
OUTPUT_DEVICE
,

135 
·Flßt32
,

136 
NULL
,

137 
SAMPLE_RATE
,

138 
FRAMES_PER_BUFFER
,

139 
NUM_BUFFERS
,

140 
·ClOff
|
·D™h”Off
,

141 
·‹¡C®lback
,

142 &
d©a
 );

143 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

144 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

145 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

146 
	`´štf
("Play ASCII keyboard. Hit 'q'o stop. (Use RETURN key on Mac)\n");

147 
	`fæush
(
¡dout
);

148  !
dÚe
 )

150 
äeq
;

151 
šdex
;

152 
c
;

155 
c
 = 
	`g‘ch¬
();

157  
c
 < ' ');

159 ifĞ
c
 =ğ'q' ) 
dÚe
 = 1;

160 
šdex
 = 
c
 % 26;

161 
äeq
 = 
MIN_FREQ
 + (
šdex
 * 40.0);

162 
d©a
.
pha£_šüem’t
 = 
	`C®cPha£Inüem’t
(
äeq
);

164 
	`´štf
("Call Pa_StopStream()\n");

165 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

166 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

167 
	`Pa_T”mš©e
();

168 
	`´štf
("Test finished.\n");

169  
”r
;

170 
”rÜ
:

171 
	`Pa_T”mš©e
();

172 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

173 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

174 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

175  
”r
;

176 
	}
}

	@portaudio/pa_tests/patest_leftright.c

39 
	~<¡dio.h
>

40 
	~<m©h.h
>

41 
	~"pÜudio.h
"

42 
	#NUM_SECONDS
 (8)

	)

43 
	#SAMPLE_RATE
 (44100)

	)

44 
	#FRAMES_PER_BUFFER
 (512)

	)

45 #iâdeà
M_PI


46 
	#M_PI
 (3.14159265)

	)

48 
	#TABLE_SIZE
 (200)

	)

51 
	msše
[
TABLE_SIZE
];

52 
	mËá_pha£
;

53 
	mright_pha£
;

54 
	mtoggË
;

55 
	mcouÁDown
;

57 
	t·Te¡D©a
;

62 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

66 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

67 *
out
 = (*)
ouutBufãr
;

68 
i
;

69 
fšished
 = 0;

70 (è
outTime
;

71 (è
šputBufãr
;

73  
i
=0; i<
äamesP”Bufãr
; i++ )

75 ifĞ
d©a
->
toggË
 )

77 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

78 *
out
++ = 0;

82 *
out
++ = 0;

83 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

86 
d©a
->
Ëá_pha£
 += 1;

87 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

88 
d©a
->
right_pha£
 += 3;

89 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

92 ifĞ
d©a
->
couÁDown
 < 0 )

94 
d©a
->
couÁDown
 = 
SAMPLE_RATE
;

95 
d©a
->
toggË
 = !data->toggle;

97 
d©a
->
couÁDown
 -ğ
äamesP”Bufãr
;

99  
fšished
;

100 
	}
}

103 
maš
();

104 
	$maš
()

106 
PÜtAudioSŒ—m
 *
¡»am
;

107 
PaE¼Ü
 
”r
;

108 
·Te¡D©a
 
d©a
;

109 
i
;

110 
timeout
;

112 
	`´štf
("Play differentone sine waveshat‡lternate between†eft‡nd„ight channel.\n");

113 
	`´štf
("The†owone should be onhe†eft channel.\n");

116  
i
=0; i<
TABLE_SIZE
; i++ )

118 
d©a
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

120 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = d©a.
toggË
 = 0;

121 
d©a
.
couÁDown
 = 
SAMPLE_RATE
;

123 
”r
 = 
	`Pa_In™Ÿlize
();

124 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

126 
”r
 = 
	`Pa_O³nSŒ—m
(

127 &
¡»am
,

128 
·NoDeviû
,

130 
·Flßt32
,

131 
NULL
,

132 
	`Pa_G‘DeçuÉOuutDeviûID
(),

134 
·Flßt32
,

135 
NULL
,

136 
SAMPLE_RATE
,

137 
FRAMES_PER_BUFFER
,

139 
·ClOff
,

140 
·‹¡C®lback
,

141 &
d©a
 );

142 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

144 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

145 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

147 
	`´štf
("Play for several seconds.\n");

148 
timeout
 = 
NUM_SECONDS
 * 4;

149  
timeout
 > 0 )

151 
	`Pa_SË•
( 300 );

152 
timeout
 -= 1;

155 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

156 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

157 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

158 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

159 
	`Pa_T”mš©e
();

160 
	`´štf
("Test finished.\n");

161  
”r
;

162 
”rÜ
:

163 
	`Pa_T”mš©e
();

164 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

165 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

166 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

167  
”r
;

168 
	}
}

	@portaudio/pa_tests/patest_longsine.c

36 
	~<¡dio.h
>

37 
	~<m©h.h
>

38 
	~"pÜudio.h
"

40 
	#SAMPLE_RATE
 (44100)

	)

42 #iâdeà
M_PI


43 
	#M_PI
 (3.14159265)

	)

46 
	#TABLE_SIZE
 (200)

	)

49 
	msše
[
TABLE_SIZE
];

50 
	mËá_pha£
;

51 
	mright_pha£
;

53 
	t·Te¡D©a
;

59 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

60 
äamesP”Bufãr
,

61 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

63 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

64 *
out
 = (*)
ouutBufãr
;

65 
i
;

66 (è
outTime
;

67 (è
šputBufãr
;

68  
i
=0; i<
äamesP”Bufãr
; i++ )

70 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

71 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

72 
d©a
->
Ëá_pha£
 += 1;

73 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

74 
d©a
->
right_pha£
 += 3;

75 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

78 
	}
}

81 
maš
();

82 
	$maš
()

84 
PÜtAudioSŒ—m
 *
¡»am
;

85 
PaE¼Ü
 
”r
;

86 
·Te¡D©a
 
d©a
;

87 
i
;

88 
	`´štf
("PortAudio Test: output sine wave.\n");

91  
i
=0; i<
TABLE_SIZE
; i++ )

93 
d©a
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

95 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0;

97 
”r
 = 
	`Pa_In™Ÿlize
();

98 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

100 
”r
 = 
	`Pa_O³nSŒ—m
(

101 &
¡»am
,

102 
·NoDeviû
,

104 
·Flßt32
,

105 
NULL
,

106 
	`Pa_G‘DeçuÉOuutDeviûID
(),

108 
·Flßt32
,

109 
NULL
,

110 
SAMPLE_RATE
,

113 
·ClOff
,

114 
·‹¡C®lback
,

115 &
d©a
 );

116 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

118 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

119 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

121 
	`´štf
("Hit ENTERo stop…rogram.\n");

122 
	`g‘ch¬
();

124 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

125 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

126 
	`Pa_T”mš©e
();

128 
	`´štf
("Test finished.\n");

129  
”r
;

131 
”rÜ
:

132 
	`Pa_T”mš©e
();

133 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

134 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

135 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

136  
”r
;

137 
	}
}

	@portaudio/pa_tests/patest_many.c

36 
	~<¡dio.h
>

37 
	~<¡dlib.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

40 
	#NUM_SECONDS
 (1)

	)

41 
	#SAMPLE_RATE
 (44100)

	)

42 #iâdeà
M_PI


43 
	#M_PI
 (3.14159265)

	)

45 
	#TABLE_SIZE
 (200)

	)

48 
	msše
[
TABLE_SIZE
];

49 
	mËá_pha£
;

50 
	mright_pha£
;

51 
	m§mpsToGo
;

53 
	t·Te¡D©a
;

54 
PaE¼Ü
 
Te¡Onû
( );

55 
·‹¡1C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

56 
äamesP”Bufãr
,

57 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

62 
	$·‹¡1C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

66 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

67 *
out
 = (*)
ouutBufãr
;

68 
i
;

69 
fšished
 = 0;

70 (è
šputBufãr
;

71 (è
outTime
;

73 ifĞ
d©a
->
§mpsToGo
 < 
äamesP”Bufãr
 )

77  
i
=0; i<
d©a
->
§mpsToGo
; i++ )

79 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

80 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

81 
d©a
->
Ëá_pha£
 += 1;

82 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

83 
d©a
->
right_pha£
 += 3;

84 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

87  ; 
i
<
äamesP”Bufãr
; i++ )

89 *
out
++ = 0;

90 *
out
++ = 0;

93 
fšished
 = 1;

97  
i
=0; i<
äamesP”Bufãr
; i++ )

99 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

100 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

101 
d©a
->
Ëá_pha£
 += 1;

102 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

103 
d©a
->
right_pha£
 += 3;

104 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

106 
d©a
->
§mpsToGo
 -ğ
äamesP”Bufãr
;

108  
fšished
;

109 
	}
}

111 #ifdeà
MACINTOSH


112 
maš
();

113 
	$maš
()

115 
i
;

116 
PaE¼Ü
 
”r
;

117 
numLoİs
 = 10;

118 
	`´štf
("Loİ %dimes.\n", 
numLoİs
 );

119  
i
=0; i<
numLoİs
; i++ )

121 
	`´štf
("Loİ %d ouˆoà%d.\n", 
i
+1, 
numLoİs
 );

122 
”r
 = 
	`Te¡Onû
();

123 ifĞ
”r
 < 0 )  0;

125 
	}
}

127 
maš
(
¬gc
, **
¬gv
);

128 
	$maš
(
¬gc
, **
¬gv
)

130 
PaE¼Ü
 
”r
;

131 
i
, 
numLoİs
 = 10;

132 ifĞ
¬gc
 > 1 )

134 
numLoİs
 = 
	`©oi
(
¬gv
[1]);

136  
i
=0; i<
numLoİs
; i++ )

138 
	`´štf
("Loİ %d ouˆoà%d.\n", 
i
+1, 
numLoİs
 );

139 
”r
 = 
	`Te¡Onû
();

140 ifĞ
”r
 < 0 )  1;

142 
	`´štf
("Test complete.\n");

144 
	}
}

146 
PaE¼Ü
 
	$Te¡Onû
( )

148 
PÜtAudioSŒ—m
 *
¡»am
;

149 
PaE¼Ü
 
”r
;

150 
·Te¡D©a
 
d©a
;

151 
i
;

152 
tÙ®Samps
;

154  
i
=0; i<
TABLE_SIZE
; i++ )

156 
d©a
.
sše
[
i
] = (è(32767.0 * 
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. ));

158 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0;

159 
d©a
.
§mpsToGo
 = 
tÙ®Samps
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

160 
”r
 = 
	`Pa_In™Ÿlize
();

161 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

162 
”r
 = 
	`Pa_O³nSŒ—m
(

163 &
¡»am
,

164 
·NoDeviû
,

166 
·IÁ16
,

167 
NULL
,

168 
	`Pa_G‘DeçuÉOuutDeviûID
(),

170 
·IÁ16
,

171 
NULL
,

172 
SAMPLE_RATE
,

175 
·ClOff
,

176 
·‹¡1C®lback
,

177 &
d©a
 );

178 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

180 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

181 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

182 
	`´štf
("Waiting for soundo finish.\n");

183 
	`fæush
(
¡dout
);

184 
	`Pa_SË•
(1000);

185 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

186 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

187 
	`Pa_T”mš©e
();

188  
·NoE¼Ü
;

189 
”rÜ
:

190 
	`Pa_T”mš©e
();

191 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

192 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

193 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

194  
”r
;

195 
	}
}

	@portaudio/pa_tests/patest_maxsines.c

38 
	~<¡dio.h
>

39 
	~<m©h.h
>

40 
	~"pÜudio.h
"

42 
	#MAX_SINES
 (500)

	)

43 
	#MAX_USAGE
 (0.8)

	)

44 
	#SAMPLE_RATE
 (44100)

	)

45 
	#FREQ_TO_PHASE_INC
(
äeq
è(äeq/()
SAMPLE_RATE
)

	)

47 
	#MIN_PHASE_INC
 
	`FREQ_TO_PHASE_INC
(200.0f)

	)

48 
	#MAX_PHASE_INC
 (
MIN_PHASE_INC
 * (1 << 5))

	)

50 
	#FRAMES_PER_BUFFER
 (512)

	)

51 #iâdeà
M_PI


52 
	#M_PI
 (3.14159265)

	)

54 
	#TWOPI
 (
M_PI
 * 2.0)

	)

56 
	#TABLE_SIZE
 (512)

	)

58 
	s·Te¡D©a


60 
	mnumSšes
;

61 
	msše
[
TABLE_SIZE
 + 1];

62 
	mpha£s
[
MAX_SINES
];

64 
	t·Te¡D©a
;

69 
LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 );

70 
	$LookupSše
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 )

72 
fIndex
 = 
pha£
*
TABLE_SIZE
;

73 
šdex
 = (è
fIndex
;

74 
äaù
 = 
fIndex
 - 
šdex
;

75 
lo
 = 
d©a
->
sše
[
šdex
];

76 
hi
 = 
d©a
->
sše
[
šdex
+1];

77 
v®
 = 
lo
 + 
äaù
*(
hi
-lo);

78  
v®
;

79 
	}
}

85 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

86 
äamesP”Bufãr
,

87 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

89 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

90 *
out
 = (*)
ouutBufãr
;

91 
outSam¶e
;

92 
sÿËr
;

93 
numFÜSÿË
;

94 
i
;

95 
j
;

96 
fšished
 = 0;

97 (è
outTime
;

98 (è
šputBufãr
;

101 
numFÜSÿË
 = 
d©a
->
numSšes
;

102 ifĞ
numFÜSÿË
 < 8 )‚umForScale = 8;

103 
sÿËr
 = 1.0à/ 
numFÜSÿË
;

105  
i
=0; i<
äamesP”Bufãr
; i++ )

107 
ouut
 = 0.0;

108 
pha£Inc
 = 
MIN_PHASE_INC
;

109 
pha£
;

110  
j
=0; j<
d©a
->
numSšes
; j++ )

113 
pha£
 = 
d©a
->
pha£s
[
j
];

114 
pha£
 +ğ
pha£Inc
;

115 ifĞ
pha£
 >= 1.0 )…hase -= 1.0;

117 
ouut
 +ğ
	`LookupSše
(
d©a
, 
pha£
);

118 
d©a
->
pha£s
[
j
] = 
pha£
;

120 
pha£Inc
 *= 1.02f;

121 ifĞ
pha£Inc
 > 
MAX_PHASE_INC
 )…ha£Inøğ
MIN_PHASE_INC
;

124 
outSam¶e
 = (è(
ouut
 * 
sÿËr
);

125 *
out
++ = 
outSam¶e
;

126 *
out
++ = 
outSam¶e
;

128  
fšished
;

129 
	}
}

132 
maš
();

133 
	$maš
()

135 
i
;

136 
PÜtAudioSŒ—m
 *
¡»am
;

137 
PaE¼Ü
 
”r
;

138 
·Te¡D©a
 
d©a
 = {0};

139 
lßd
;

140 
	`´štf
("PÜtAudiØTe¡: ouuˆsšwave. SR = %d, BufSizğ%d\n", 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
);

143  
i
=0; i<
TABLE_SIZE
; i++ )

145 
d©a
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

147 
d©a
.
sše
[
TABLE_SIZE
] = data.sine[0];

149 
”r
 = 
	`Pa_In™Ÿlize
();

150 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

151 
”r
 = 
	`Pa_O³nSŒ—m
(

152 &
¡»am
,

153 
·NoDeviû
,

155 
·Flßt32
,

156 
NULL
,

157 
	`Pa_G‘DeçuÉOuutDeviûID
(),

159 
·Flßt32
,

160 
NULL
,

161 
SAMPLE_RATE
,

162 
FRAMES_PER_BUFFER
,

164 
·ClOff
,

165 
·‹¡C®lback
,

166 &
d©a
 );

167 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

168 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

169 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

174 
d©a
.
numSšes
++;

175 
	`Pa_SË•
( 200 );

177 
lßd
 = 
	`Pa_G‘CPULßd
Ğ
¡»am
 );

178 
	`´štf
("numSše ğ%d, CPU†ßd = %f\n", 
d©a
.
numSšes
, 
lßd
 );

179 
	`fæush
Ğ
¡dout
 );

181  (
lßd
 < 
MAX_USAGE
è&& (
d©a
.
numSšes
 < 
MAX_SINES
) );

183 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

184 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

185 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

186 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

187 
	`Pa_T”mš©e
();

188 
	`´štf
("Test finished.\n");

189  
”r
;

190 
”rÜ
:

191 
	`Pa_T”mš©e
();

192 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

193 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

194 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

195  
”r
;

196 
	}
}

	@portaudio/pa_tests/patest_pink.c

45 
	~<¡dio.h
>

46 
	~<m©h.h
>

47 
	~"pÜudio.h
"

48 
	#PINK_MAX_RANDOM_ROWS
 (30)

	)

49 
	#PINK_RANDOM_BITS
 (24)

	)

50 
	#PINK_RANDOM_SHIFT
 ((()*8)-
PINK_RANDOM_BITS
)

	)

53 
	mpšk_Rows
[
PINK_MAX_RANDOM_ROWS
];

54 
	mpšk_RuÂšgSum
;

55 
	mpšk_Index
;

56 
	mpšk_IndexMask
;

57 
	mpšk_SÿÏr
;

59 
	tPškNoi£
;

61 
G’”©eRªdomNumb”
( );

62 
In™ŸlizePškNoi£
Ğ
PškNoi£
 *
pšk
, 
numRows
 );

63 
G’”©ePškNoi£
Ğ
PškNoi£
 *
pšk
 );

66 
	$G’”©eRªdomNumb”
( )

69 
¿ndS“d
 = 22222;

70 
¿ndS“d
 = (randSeed * 196314165) + 907633515;

71  
¿ndS“d
;

72 
	}
}

75 
	$In™ŸlizePškNoi£
Ğ
PškNoi£
 *
pšk
, 
numRows
 )

77 
i
;

78 
pmax
;

79 
pšk
->
pšk_Index
 = 0;

80 
pšk
->
pšk_IndexMask
 = (1<<
numRows
) - 1;

82 
pmax
 = (
numRows
 + 1è* (1<<(
PINK_RANDOM_BITS
-1));

83 
pšk
->
pšk_SÿÏr
 = 1.0à/ 
pmax
;

85  
i
=0; i<
numRows
; i++ ) 
pšk
->
pšk_Rows
[i] = 0;

86 
pšk
->
pšk_RuÂšgSum
 = 0;

87 
	}
}

88 
	#PINK_MEASURE


	)

89 #ifdeà
PINK_MEASURE


90 
	gpškMax
 = -999.0;

91 
	gpškMš
 = 999.0;

94 
	$G’”©ePškNoi£
Ğ
PškNoi£
 *
pšk
 )

96 
ÃwRªdom
;

97 
sum
;

98 
ouut
;

100 
pšk
->
pšk_Index
 = (pšk->pšk_Index + 1è&…šk->
pšk_IndexMask
;

102 ifĞ
pšk
->
pšk_Index
 != 0 )

106 
numZ”os
 = 0;

107 
n
 = 
pšk
->
pšk_Index
;

108  (
n
 & 1) == 0 )

110 
n
 =‚ >> 1;

111 
numZ”os
++;

117 
pšk
->
pšk_RuÂšgSum
 -ğpšk->
pšk_Rows
[
numZ”os
];

118 
ÃwRªdom
 = (()
	`G’”©eRªdomNumb”
()è>> 
PINK_RANDOM_SHIFT
;

119 
pšk
->
pšk_RuÂšgSum
 +ğ
ÃwRªdom
;

120 
pšk
->
pšk_Rows
[
numZ”os
] = 
ÃwRªdom
;

124 
ÃwRªdom
 = (()
	`G’”©eRªdomNumb”
()è>> 
PINK_RANDOM_SHIFT
;

125 
sum
 = 
pšk
->
pšk_RuÂšgSum
 + 
ÃwRªdom
;

127 
ouut
 = 
pšk
->
pšk_SÿÏr
 * 
sum
;

128 #ifdeà
PINK_MEASURE


130 ifĞ
ouut
 > 
pškMax
 )…inkMax = output;

131 ifĞ
ouut
 < 
pškMš
 )…inkMin = output;

133  
ouut
;

134 
	}
}

136 
	#PINK_TEST


	)

137 #ifdeà
PINK_TEST


141 
PškNoi£
 
	mËáPšk
;

142 
PškNoi£
 
	mrightPšk
;

143 
	m§mpsToGo
;

145 
	t·Te¡D©a
;

150 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

151 
äamesP”Bufãr
,

152 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

154 
fšished
;

155 
i
;

156 
numF¿mes
;

157 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

158 *
out
 = (*)
ouutBufãr
;

159 (è
šputBufãr
;

160 (è
outTime
;

163 ifĞ
d©a
->
§mpsToGo
 < 
äamesP”Bufãr
 )

165 
numF¿mes
 = 
d©a
->
§mpsToGo
;

166 
fšished
 = 1;

170 
numF¿mes
 = 
äamesP”Bufãr
;

171 
fšished
 = 0;

173  
i
=0; i<
numF¿mes
; i++ )

175 *
out
++ = 
	`G’”©ePškNoi£
Ğ&
d©a
->
ËáPšk
 );

176 *
out
++ = 
	`G’”©ePškNoi£
Ğ&
d©a
->
rightPšk
 );

178 
d©a
->
§mpsToGo
 -ğ
numF¿mes
;

179  
fšished
;

180 
	}
}

182 
maš
();

183 
	$maš
()

185 
PÜtAudioSŒ—m
 *
¡»am
;

186 
PaE¼Ü
 
”r
;

187 
·Te¡D©a
 
d©a
;

188 
tÙ®Samps
;

190 
	`In™ŸlizePškNoi£
Ğ&
d©a
.
ËáPšk
, 12 );

191 
	`In™ŸlizePškNoi£
Ğ&
d©a
.
rightPšk
, 16 );

194 
i
;

195 
pšk
;

196  
i
=0; i<20; i++ )

198 
pšk
 = 
	`G’”©ePškNoi£
Ğ&
d©a
.
ËáPšk
 );

199 
	`´štf
("Pšk = %f\n", 
pšk
 );

202 
d©a
.
§mpsToGo
 = 
tÙ®Samps
 = 8*44100;

203 
”r
 = 
	`Pa_In™Ÿlize
();

204 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

206 
”r
 = 
	`Pa_O³nSŒ—m
(

207 &
¡»am
,

208 
·NoDeviû
,

210 
·Flßt32
,

211 
NULL
,

212 
	`Pa_G‘DeçuÉOuutDeviûID
(),

214 
·Flßt32
,

215 
NULL
,

219 
·ClOff
,

220 
·‹¡C®lback
,

221 &
d©a
 );

222 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

224 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

225 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

226 
	`´štf
("Waiting for soundo finish.\n");

227  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

229 
	`Pa_SË•
(100);

231 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

232 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

233 #ifdeà
PINK_MEASURE


234 
	`´štf
("Pšk mš = %f, max = %f\n", 
pškMš
, 
pškMax
 );

236 
	`Pa_T”mš©e
();

238 
”rÜ
:

239 
	`Pa_T”mš©e
();

240 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

241 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

242 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

244 
	}
}

	@portaudio/pa_tests/patest_record.c

38 
	~<¡dio.h
>

39 
	~<¡dlib.h
>

40 
	~"pÜudio.h
"

43 
	#SAMPLE_RATE
 (22050)

	)

44 
	#NUM_SECONDS
 (5)

	)

45 
	#NUM_CHANNELS
 (2)

	)

47 
	#DITHER_FLAG
 (0è

	)

48 
	#FRAMES_PER_BUFFER
 (1024)

	)

52 
	#PA_SAMPLE_TYPE
 
·Flßt32


	)

53 
	tSAMPLE
;

54 
	#SAMPLE_SILENCE
 (0.0f)

	)

56 
	#PA_SAMPLE_TYPE
 
·IÁ16


	)

57 
	tSAMPLE
;

58 
	#SAMPLE_SILENCE
 (0)

	)

60 
	#PA_SAMPLE_TYPE
 
·IÁ8


	)

61 
	tSAMPLE
;

62 
	#SAMPLE_SILENCE
 (0)

	)

64 
	#PA_SAMPLE_TYPE
 
·UIÁ8


	)

65 
	tSAMPLE
;

66 
	#SAMPLE_SILENCE
 (128)

	)

72 
	mäameIndex
;

73 
	mmaxF¿meIndex
;

74 
SAMPLE
 *
	m»cÜdedSam¶es
;

76 
	t·Te¡D©a
;

81 
	$»cÜdC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

82 
äamesP”Bufãr
,

83 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

85 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

86 
SAMPLE
 *
½Œ
 = (SAMPLE*)
šputBufãr
;

87 
SAMPLE
 *
w±r
 = &
d©a
->
»cÜdedSam¶es
[d©a->
äameIndex
 * 
NUM_CHANNELS
];

88 
äamesToC®c
;

89 
i
;

90 
fšished
;

91 
äamesLeá
 = 
d©a
->
maxF¿meIndex
 - d©a->
äameIndex
;

93 (è
ouutBufãr
;

94 (è
outTime
;

96 ifĞ
äamesLeá
 < 
äamesP”Bufãr
 )

98 
äamesToC®c
 = 
äamesLeá
;

99 
fšished
 = 1;

103 
äamesToC®c
 = 
äamesP”Bufãr
;

104 
fšished
 = 0;

106 ifĞ
šputBufãr
 =ğ
NULL
 )

108  
i
=0; i<
äamesToC®c
; i++ )

110 *
w±r
++ = 
SAMPLE_SILENCE
;

111 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = 
SAMPLE_SILENCE
;

116  
i
=0; i<
äamesToC®c
; i++ )

118 *
w±r
++ = *
½Œ
++;

119 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

122 
d©a
->
äameIndex
 +ğ
äamesToC®c
;

123  
fšished
;

124 
	}
}

130 
	$¶ayC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

131 
äamesP”Bufãr
,

132 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

134 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

135 
SAMPLE
 *
½Œ
 = &
d©a
->
»cÜdedSam¶es
[d©a->
äameIndex
 * 
NUM_CHANNELS
];

136 
SAMPLE
 *
w±r
 = (SAMPLE*)
ouutBufãr
;

137 
i
;

138 
fšished
;

139 
äamesLeá
 = 
d©a
->
maxF¿meIndex
 - d©a->
äameIndex
;

140 (è
šputBufãr
;

141 (è
outTime
;

143 ifĞ
äamesLeá
 < 
äamesP”Bufãr
 )

146  
i
=0; i<
äamesLeá
; i++ )

148 *
w±r
++ = *
½Œ
++;

149 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

151  ; 
i
<
äamesP”Bufãr
; i++ )

153 *
w±r
++ = 0;

154 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = 0;

156 
d©a
->
äameIndex
 +ğ
äamesLeá
;

157 
fšished
 = 1;

161  
i
=0; i<
äamesP”Bufãr
; i++ )

163 *
w±r
++ = *
½Œ
++;

164 ifĞ
NUM_CHANNELS
 =ğ2 ) *
w±r
++ = *
½Œ
++;

166 
d©a
->
äameIndex
 +ğ
äamesP”Bufãr
;

167 
fšished
 = 0;

169  
fšished
;

170 
	}
}

173 
maš
();

174 
	$maš
()

176 
PÜtAudioSŒ—m
 *
¡»am
;

177 
PaE¼Ü
 
”r
;

178 
·Te¡D©a
 
d©a
;

179 
i
;

180 
tÙ®F¿mes
;

181 
numSam¶es
;

182 
numBy‹s
;

183 
SAMPLE
 
max
, 
av”age
, 
v®
;

184 
	`´štf
("·‹¡_»cÜd.c\n"); 
	`fæush
(
¡dout
);

186 
d©a
.
maxF¿meIndex
 = 
tÙ®F¿mes
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

187 
d©a
.
äameIndex
 = 0;

188 
numSam¶es
 = 
tÙ®F¿mes
 * 
NUM_CHANNELS
;

190 
numBy‹s
 = 
numSam¶es
 * (
SAMPLE
);

191 
d©a
.
»cÜdedSam¶es
 = (
SAMPLE
 *è
	`m®loc
Ğ
numBy‹s
 );

192 ifĞ
d©a
.
»cÜdedSam¶es
 =ğ
NULL
 )

194 
	`´štf
("Could‚ot‡llocate„ecord‡rray.\n");

195 
	`ex™
(1);

197  
i
=0; i<
numSam¶es
; i++ ) 
d©a
.
»cÜdedSam¶es
[i] = 0;

199 
”r
 = 
	`Pa_In™Ÿlize
();

200 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

203 
”r
 = 
	`Pa_O³nSŒ—m
(

204 &
¡»am
,

205 
	`Pa_G‘DeçuÉIÅutDeviûID
(),

206 
NUM_CHANNELS
,

207 
PA_SAMPLE_TYPE
,

208 
NULL
,

209 
·NoDeviû
,

211 
PA_SAMPLE_TYPE
,

212 
NULL
,

213 
SAMPLE_RATE
,

214 
FRAMES_PER_BUFFER
,

217 
»cÜdC®lback
,

218 &
d©a
 );

219 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

221 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

222 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

223 
	`´štf
("Now„ecÜdšg!!\n"); 
	`fæush
(
¡dout
);

225  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

227 
	`Pa_SË•
(1000);

228 
	`´štf
("šdex = %d\n", 
d©a
.
äameIndex
 ); 
	`fæush
(
¡dout
);

231 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

232 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

235 
max
 = 0;

236 
av”age
 = 0;

237  
i
=0; i<
numSam¶es
; i++ )

239 
v®
 = 
d©a
.
»cÜdedSam¶es
[
i
];

240 ifĞ
v®
 < 0 ) val = -val;

241 ifĞ
v®
 > 
max
 )

243 
max
 = 
v®
;

245 
av”age
 +ğ
v®
;

248 
av”age
 =‡v”ag/ 
numSam¶es
;

250 ifĞ
PA_SAMPLE_TYPE
 =ğ
·Flßt32
 )

252 
	`´štf
("§m¶max‡m¶™udğ%f\n", 
max
 );

253 
	`´štf
("§m¶av”agğ%f\n", 
av”age
 );

257 
	`´štf
("§m¶max‡m¶™udğ%d\n", 
max
 );

258 
	`´štf
("§m¶av”agğ%d\n", 
av”age
 );

264 
FILE
 *
fid
;

265 
fid
 = 
	`fİ’
("recorded.raw", "wb");

266 ifĞ
fid
 =ğ
NULL
 )

268 
	`´štf
("Could‚ot open file.");

272 
	`fwr™e
Ğ
d©a
.
»cÜdedSam¶es
, 
NUM_CHANNELS
 * (
SAMPLE
), 
tÙ®F¿mes
, 
fid
 );

273 
	`fşo£
Ğ
fid
 );

274 
	`´štf
("Wrote datao 'recorded.raw'\n");

280 
d©a
.
äameIndex
 = 0;

281 
	`´štf
("Begš…Ïyback.\n"); 
	`fæush
(
¡dout
);

282 
”r
 = 
	`Pa_O³nSŒ—m
(

283 &
¡»am
,

284 
·NoDeviû
,

286 
PA_SAMPLE_TYPE
,

287 
NULL
,

288 
	`Pa_G‘DeçuÉOuutDeviûID
(),

289 
NUM_CHANNELS
,

290 
PA_SAMPLE_TYPE
,

291 
NULL
,

292 
SAMPLE_RATE
,

293 
FRAMES_PER_BUFFER
,

295 
·ClOff
,

296 
¶ayC®lback
,

297 &
d©a
 );

298 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

300 ifĞ
¡»am
 )

302 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

303 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

304 
	`´štf
("Wa™šg fÜ…ÏybackØfšish.\n"); 
	`fæush
(
¡dout
);

306  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) ) 
	`Pa_SË•
(100);

308 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

309 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

310 
	`´štf
("DÚe.\n"); 
	`fæush
(
¡dout
);

312 
	`ä“
Ğ
d©a
.
»cÜdedSam¶es
 );

314 
	`Pa_T”mš©e
();

317 
”rÜ
:

318 
	`Pa_T”mš©e
();

319 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

320 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

321 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

323 
	}
}

	@portaudio/pa_tests/patest_ringmix.c

3 
	~"¡dio.h
"

4 
	~"pÜudio.h
"

6 
	$myC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

7 
äamesP”Bufãr
, 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

9 *
out
 = (*è
ouutBufãr
;

10 *
š
 = (*è
šputBufãr
;

11 
ËáIÅut
, 
rightIÅut
;

12 
i
;

13 ifĞ
šputBufãr
 =ğ
NULL
 )  0;

15  
i
=0; i<
äamesP”Bufãr
; i++ )

17 
ËáIÅut
 = *
š
++;

18 
rightIÅut
 = *
š
++;

19 *
out
++ = 
ËáIÅut
 * 
rightIÅut
;

20 *
out
++ = 0.5à* (
ËáIÅut
 + 
rightIÅut
);

23 
	}
}

25 
	$maš
()

27 
PÜtAudioSŒ—m
 *
¡»am
;

28 
	`Pa_In™Ÿlize
();

29 
	`Pa_O³nDeçuÉSŒ—m
(

30 &
¡»am
,

32 
·Flßt32
, 44100.0,

34 
myC®lback
, 
NULL
 );

35 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

36 
	`Pa_SË•
( 10000 );

37 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

38 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

39 
	`Pa_T”mš©e
();

41 
	}
}

	@portaudio/pa_tests/patest_saw.c

36 
	~<¡dio.h
>

37 
	~<m©h.h
>

38 
	~"pÜudio.h
"

39 
	#NUM_SECONDS
 (4)

	)

40 
	#SAMPLE_RATE
 (44100)

	)

43 
	mËá_pha£
;

44 
	mright_pha£
;

46 
	t·Te¡D©a
;

51 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

52 
äamesP”Bufãr
,

53 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

56 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

57 *
out
 = (*)
ouutBufãr
;

58 
i
;

59 (è
outTime
;

60 (è
šputBufãr
;

62  
i
=0; i<
äamesP”Bufãr
; i++ )

64 *
out
++ = 
d©a
->
Ëá_pha£
;

65 *
out
++ = 
d©a
->
right_pha£
;

67 
d©a
->
Ëá_pha£
 += 0.01f;

69 ifĞ
d©a
->
Ëá_pha£
 >= 1.0f ) data->left_phase -= 2.0f;

71 
d©a
->
right_pha£
 += 0.03f;

72 ifĞ
d©a
->
right_pha£
 >= 1.0f ) data->right_phase -= 2.0f;

75 
	}
}

77 
·Te¡D©a
 
	gd©a
;

78 
maš
();

79 
	$maš
()

81 
PÜtAudioSŒ—m
 *
¡»am
;

82 
PaE¼Ü
 
”r
;

83 
	`´štf
("PortAudio Test: output sawtooth wave.\n");

85 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0.0;

87 
”r
 = 
	`Pa_In™Ÿlize
();

88 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

90 
”r
 = 
	`Pa_O³nDeçuÉSŒ—m
(

91 &
¡»am
,

94 
·Flßt32
,

95 
SAMPLE_RATE
,

98 
·‹¡C®lback
,

99 &
d©a
 );

100 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

101 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

102 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

104 
	`Pa_SË•
(
NUM_SECONDS
*1000);

105 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

106 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

107 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

108 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

109 
	`Pa_T”mš©e
();

110 
	`´štf
("Test finished.\n");

111  
”r
;

112 
”rÜ
:

113 
	`Pa_T”mš©e
();

114 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

115 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

116 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

117  
”r
;

118 
	}
}

	@portaudio/pa_tests/patest_sine.c

38 
	~<¡dio.h
>

39 
	~<m©h.h
>

40 
	~"pÜudio.h
"

42 
	#NUM_SECONDS
 (10)

	)

43 
	#SAMPLE_RATE
 (44100)

	)

44 
	#AMPLITUDE
 (0.9)

	)

45 
	#FRAMES_PER_BUFFER
 (64)

	)

46 
	#OUTPUT_DEVICE
 
	`Pa_G‘DeçuÉOuutDeviûID
()

	)

49 #iâdeà
M_PI


50 
	#M_PI
 (3.14159265)

	)

53 
	#TABLE_SIZE
 (200)

	)

56 
	msše
[
TABLE_SIZE
];

57 
	mËá_pha£
;

58 
	mright_pha£
;

60 
	t·Te¡D©a
;

66 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

67 
äamesP”Bufãr
,

68 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

70 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

71 *
out
 = (*)
ouutBufãr
;

72 
i
;

73 
fšished
 = 0;

74 (è
outTime
;

75 (è
šputBufãr
;

76  
i
=0; i<
äamesP”Bufãr
; i++ )

78 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

79 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

80 
d©a
->
Ëá_pha£
 += 1;

81 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

82 
d©a
->
right_pha£
 += 3;

83 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

85  
fšished
;

86 
	}
}

89 
maš
();

90 
	$maš
()

92 
PÜtAudioSŒ—m
 *
¡»am
;

93 
PaE¼Ü
 
”r
;

94 
·Te¡D©a
 
d©a
;

95 
i
;

96 
	`´štf
("PortAudio Test: output sine wave. SR = %d, BufSize = %d, devID = %d\n",

97 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
, 
OUTPUT_DEVICE
);

99  
i
=0; i<
TABLE_SIZE
; i++ )

101 
d©a
.
sše
[
i
] = (è(
AMPLITUDE
 * 
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. ));

103 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0;

104 
”r
 = 
	`Pa_In™Ÿlize
();

105 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

106 
”r
 = 
	`Pa_O³nSŒ—m
(

107 &
¡»am
,

108 
·NoDeviû
,

110 
·Flßt32
,

111 
NULL
,

112 
OUTPUT_DEVICE
,

114 
·Flßt32
,

115 
NULL
,

116 
SAMPLE_RATE
,

117 
FRAMES_PER_BUFFER
,

119 
·ClOff
,

120 
·‹¡C®lback
,

121 &
d©a
 );

122 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

123 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

124 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

125 
	`´štf
("PÏy fÜ %d secÚds.\n", 
NUM_SECONDS
 ); 
	`fæush
(
¡dout
);

126 
	`Pa_SË•
Ğ
NUM_SECONDS
 * 1000 );

128 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

129 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

130 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

131 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

132 
	`Pa_T”mš©e
();

133 
	`´štf
("Test finished.\n");

134  
”r
;

135 
”rÜ
:

136 
	`Pa_T”mš©e
();

137 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

138 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

139 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

140  
”r
;

141 
	}
}

	@portaudio/pa_tests/patest_sine8.c

37 
	~<¡dio.h
>

38 
	~<m©h.h
>

39 
	~"pÜudio.h
"

40 
	#NUM_SECONDS
 (8)

	)

41 
	#SAMPLE_RATE
 (44100)

	)

42 
	#TEST_UNSIGNED
 (1)

	)

43 #ià
TEST_UNSIGNED


44 
	#TEST_FORMAT
 
·UIÁ8


	)

46 
	#TEST_FORMAT
 
·IÁ8


	)

48 #iâdeà
M_PI


49 
	#M_PI
 (3.14159265)

	)

51 
	#TABLE_SIZE
 (200)

	)

54 #ià
TEST_UNSIGNED


55 
	msše
[
TABLE_SIZE
];

57 
	msše
[
TABLE_SIZE
];

59 
	mËá_pha£
;

60 
	mright_pha£
;

61 
	mäamesToGo
;

63 
	t·Te¡D©a
;

68 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

69 
äamesP”Bufãr
,

70 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

72 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

73 *
out
 = (*)
ouutBufãr
;

74 
i
;

75 
äamesToC®c
;

76 
fšished
 = 0;

77 (è
outTime
;

78 (è
šputBufãr
;

80 ifĞ
d©a
->
äamesToGo
 < 
äamesP”Bufãr
 )

82 
äamesToC®c
 = 
d©a
->
äamesToGo
;

83 
d©a
->
äamesToGo
 = 0;

84 
fšished
 = 1;

88 
äamesToC®c
 = 
äamesP”Bufãr
;

89 
d©a
->
äamesToGo
 -ğ
äamesP”Bufãr
;

92  
i
=0; i<
äamesToC®c
; i++ )

94 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

95 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

96 
d©a
->
Ëá_pha£
 += 1;

97 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

98 
d©a
->
right_pha£
 += 3;

99 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

102  ; 
i
<()
äamesP”Bufãr
; i++ )

104 #ià
TEST_UNSIGNED


105 *
out
++ = () 0x80;

106 *
out
++ = () 0x80;

108 *
out
++ = 0;

109 *
out
++ = 0;

113  
fšished
;

114 
	}
}

116 
maš
();

117 
	$maš
()

119 
PÜtAudioSŒ—m
 *
¡»am
;

120 
PaE¼Ü
 
”r
;

121 
·Te¡D©a
 
d©a
;

122 
i
;

123 
tÙ®Samps
;

124 #ià
TEST_UNSIGNED


125 
	`´štf
("PortAudio Test: output UNsigned 8 bit sine wave.\n");

127 
	`´štf
("PortAudio Test: output signed 8 bit sine wave.\n");

130  
i
=0; i<
TABLE_SIZE
; i++ )

132 
d©a
.
sše
[
i
] = (è(127.0 * 
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. ));

133 #ià
TEST_UNSIGNED


134 
d©a
.
sše
[
i
] += () 0x80;

138 
d©a
.
Ëá_pha£
 = d©a.
right_pha£
 = 0;

139 
d©a
.
äamesToGo
 = 
tÙ®Samps
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

140 
”r
 = 
	`Pa_In™Ÿlize
();

141 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

142 
”r
 = 
	`Pa_O³nSŒ—m
(

143 &
¡»am
,

144 
·NoDeviû
,

146 
TEST_FORMAT
,

147 
NULL
,

148 
	`Pa_G‘DeçuÉOuutDeviûID
(),

150 
TEST_FORMAT
,

151 
NULL
,

152 
SAMPLE_RATE
,

155 
·ClOff
,

156 
·‹¡C®lback
,

157 &
d©a
 );

158 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

159 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

160 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

162  
	`Pa_SŒ—mTime
Ğ
¡»am
 ) < (
tÙ®Samps
/2èè
	`Pa_SË•
(10);

164 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

165 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

166 
	`´štf
("Pause for 2 seconds.\n");

167 
	`Pa_SË•
( 2000 );

169 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

170 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

171 
	`´štf
("Waiting for soundo finish.\n");

172  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) ) 
	`Pa_SË•
(10);

173 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

174 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

175 
	`Pa_T”mš©e
();

176 
	`´štf
("Test finished.\n");

177  
”r
;

178 
”rÜ
:

179 
	`Pa_T”mš©e
();

180 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

181 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

182 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

183  
”r
;

184 
	}
}

	@portaudio/pa_tests/patest_sine_time.c

40 
	~<¡dio.h
>

41 
	~<m©h.h
>

42 
	~"pÜudio.h
"

43 
	#NUM_SECONDS
 (8)

	)

44 
	#SAMPLE_RATE
 (44100)

	)

45 
	#FRAMES_PER_BUFFER
 (64)

	)

46 
	#NUM_BUFFERS
 (0)

	)

47 #iâdeà
M_PI


48 
	#M_PI
 (3.14159265)

	)

50 
	#TABLE_SIZE
 (200)

	)

53 
	msše
[
TABLE_SIZE
];

54 
	mËá_pha£
;

55 
	mright_pha£
;

56 
	mäamesToGo
;

57 vŞ©
PaTime¡amp
 
	moutTime
;

59 
	t·Te¡D©a
;

64 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

65 
äamesP”Bufãr
,

66 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

68 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

69 *
out
 = (*)
ouutBufãr
;

70 
i
;

71 
äamesToC®c
;

72 
fšished
 = 0;

73 (è
outTime
;

74 (è
šputBufãr
;

76 
d©a
->
outTime
 = outTime;

78 ifĞ
d©a
->
äamesToGo
 < 
äamesP”Bufãr
 )

80 
äamesToC®c
 = 
d©a
->
äamesToGo
;

81 
d©a
->
äamesToGo
 = 0;

82 
fšished
 = 1;

86 
äamesToC®c
 = 
äamesP”Bufãr
;

87 
d©a
->
äamesToGo
 -ğ
äamesP”Bufãr
;

90  
i
=0; i<
äamesToC®c
; i++ )

92 *
out
++ = 
d©a
->
sše
[d©a->
Ëá_pha£
];

93 *
out
++ = 
d©a
->
sše
[d©a->
right_pha£
];

94 
d©a
->
Ëá_pha£
 += 1;

95 ifĞ
d©a
->
Ëá_pha£
 >ğ
TABLE_SIZE
 ) data->left_phase -= TABLE_SIZE;

96 
d©a
->
right_pha£
 += 3;

97 ifĞ
d©a
->
right_pha£
 >ğ
TABLE_SIZE
 ) data->right_phase -= TABLE_SIZE;

100  ; 
i
<()
äamesP”Bufãr
; i++ )

102 *
out
++ = 0;

103 *
out
++ = 0;

105  
fšished
;

106 
	}
}

108 
R•ÜtSŒ—mTime
Ğ
PÜtAudioSŒ—m
 *
¡»am
, 
·Te¡D©a
 *
d©a
 );

109 
	$R•ÜtSŒ—mTime
Ğ
PÜtAudioSŒ—m
 *
¡»am
, 
·Te¡D©a
 *
d©a
 )

111 
PaTime¡amp
 
¡»amTime
, 
Ï‹ncy
, 
outTime
;

113 
¡»amTime
 = 
	`Pa_SŒ—mTime
Ğ
¡»am
 );

114 
outTime
 = 
d©a
->outTime;

115 ifĞ
outTime
 < 0.0 )

117 
	`´štf
("SŒ—mimğ%8.1f\n", 
¡»amTime
 );

121 
Ï‹ncy
 = 
outTime
 - 
¡»amTime
;

122 
	`´štf
("Streamime = %8.1f, outTime = %8.1f,†atency = %8.1f\n",

123 
¡»amTime
, 
outTime
, 
Ï‹ncy
 );

125 
	`fæush
(
¡dout
);

126 
	}
}

129 
maš
();

130 
	$maš
()

132 
PÜtAudioSŒ—m
 *
¡»am
;

133 
PaE¼Ü
 
”r
;

134 
·Te¡D©a
 
DATA
;

135 
i
;

136 
tÙ®Samps
;

137 
	`´štf
("PÜtAudiØTe¡: ouuˆsšwave. SR = %d, BufSizğ%d\n", 
SAMPLE_RATE
, 
FRAMES_PER_BUFFER
);

139  
i
=0; i<
TABLE_SIZE
; i++ )

141 
DATA
.
sše
[
i
] = (è
	`sš
Ğ(()i/()
TABLE_SIZE
è* 
M_PI
 * 2. );

143 
DATA
.
Ëá_pha£
 = DATA.
right_pha£
 = 0;

144 
DATA
.
äamesToGo
 = 
tÙ®Samps
 = 
NUM_SECONDS
 * 
SAMPLE_RATE
;

145 
”r
 = 
	`Pa_In™Ÿlize
();

146 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

147 
”r
 = 
	`Pa_O³nSŒ—m
(

148 &
¡»am
,

149 
·NoDeviû
,

151 
·Flßt32
,

152 
NULL
,

153 
	`Pa_G‘DeçuÉOuutDeviûID
(),

155 
·Flßt32
,

156 
NULL
,

157 
SAMPLE_RATE
,

158 
FRAMES_PER_BUFFER
,

159 
NUM_BUFFERS
,

160 
·ClOff
,

161 
·‹¡C®lback
,

162 &
DATA
 );

163 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

165 
DATA
.
outTime
 = -1.0;

166 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

167 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

170 
	`´štf
("PÏy fÜ %d secÚds.\n", 
NUM_SECONDS
/2 ); 
	`fæush
(
¡dout
);

173 
	`R•ÜtSŒ—mTime
Ğ
¡»am
, &
DATA
 );

174 
	`Pa_SË•
(100);

175 }  
	`Pa_SŒ—mTime
Ğ
¡»am
 ) < (
tÙ®Samps
/2) );

178 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

179 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

180 
	`´štf
("Pau£ fÜ 2 secÚds.\n"); 
	`fæush
(
¡dout
);

181 
	`Pa_SË•
( 2000 );

183 
DATA
.
outTime
 = -1.0;

184 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

185 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

187 
	`´štf
("PÏy uÁ sound i fšished.\n"); 
	`fæush
(
¡dout
);

190 
	`R•ÜtSŒ—mTime
Ğ
¡»am
, &
DATA
 );

191 
	`Pa_SË•
(100);

192 }  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) );

194 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

195 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

196 
	`Pa_T”mš©e
();

197 
	`´štf
("Test finished.\n");

198  
”r
;

199 
”rÜ
:

200 
	`Pa_T”mš©e
();

201 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

202 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

203 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

204  
”r
;

205 
	}
}

	@portaudio/pa_tests/patest_stop.c

44 
	~<¡dio.h
>

45 
	~<m©h.h
>

46 
	~"pÜudio.h
"

47 
	#OUTPUT_DEVICE
 (
	`Pa_G‘DeçuÉOuutDeviûID
())

	)

48 
	#SLEEP_DUR
 (200)

	)

49 
	#SAMPLE_RATE
 (44100)

	)

50 
	#FRAMES_PER_BUFFER
 (256)

	)

51 
	#LATENCY_MSEC
 (3000)

	)

52 
	#NUM_BUFFERS
 ((
LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

53 
	#FRAMES_PER_NOTE
 (
SAMPLE_RATE
/2)

	)

54 
	#MAX_REPEATS
 (2)

	)

55 
	#FUNDAMENTAL
 (400.0à/ 
SAMPLE_RATE
)

	)

56 
	#NOTE_0
 (
FUNDAMENTAL
 * 1.0à/ 1.0f)

	)

57 
	#NOTE_1
 (
FUNDAMENTAL
 * 5.0à/ 4.0f)

	)

58 
	#NOTE_2
 (
FUNDAMENTAL
 * 4.0à/ 3.0f)

	)

59 
	#NOTE_3
 (
FUNDAMENTAL
 * 3.0à/ 2.0f)

	)

60 
	#NOTE_4
 (
FUNDAMENTAL
 * 2.0à/ 1.0f)

	)

61 
	#MODE_FINISH
 (0)

	)

62 
	#MODE_STOP
 (1)

	)

63 
	#MODE_ABORT
 (2)

	)

64 #iâdeà
M_PI


65 
	#M_PI
 (3.14159265)

	)

67 
	#TABLE_SIZE
 (400)

	)

70 
	mwavefÜm
[
TABLE_SIZE
 + 1];

71 
	mpha£_šüem’t
;

72 
	mpha£
;

73 *
	mtuÃ
;

74 
	mnÙesP”TuÃ
;

75 
	mäameCouÁ”
;

76 
	mnÙeCouÁ”
;

77 
	m»³©CouÁ”
;

78 
PaTime¡amp
 
	moutTime
;

79 
	m¡İMode
;

80 
	mdÚe
;

82 
	t·Te¡D©a
;

84 
Te¡StİMode
Ğ
·Te¡D©a
 *
d©a
 );

85 
LookupWavefÜm
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 );

90 
	$LookupWavefÜm
Ğ
·Te¡D©a
 *
d©a
, 
pha£
 )

92 
fIndex
 = 
pha£
*
TABLE_SIZE
;

93 
šdex
 = (è
fIndex
;

94 
äaù
 = 
fIndex
 - 
šdex
;

95 
lo
 = 
d©a
->
wavefÜm
[
šdex
];

96 
hi
 = 
d©a
->
wavefÜm
[
šdex
+1];

97 
v®
 = 
lo
 + 
äaù
*(
hi
-lo);

98  
v®
;

99 
	}
}

104 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

105 
äamesP”Bufãr
,

106 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

108 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

109 *
out
 = (*)
ouutBufãr
;

110 
v®ue
;

111 
i
 = 0;

112 
fšished
 = 0;

113 (è
outTime
;

114 (è
šputBufãr
;

116 
d©a
->
outTime
 = outTime;

117 ifĞ!
d©a
->
dÚe
 )

119  
i
=0; i<
äamesP”Bufãr
; i++ )

122 ifĞ
d©a
->
äameCouÁ”
 >ğ
FRAMES_PER_NOTE
 )

124 
d©a
->
nÙeCouÁ”
 += 1;

125 
d©a
->
äameCouÁ”
 = 0;

127 ifĞ
d©a
->
nÙeCouÁ”
 >ğd©a->
nÙesP”TuÃ
 )

129 
d©a
->
nÙeCouÁ”
 = 0;

130 
d©a
->
»³©CouÁ”
 += 1;

132 ifĞ
d©a
->
»³©CouÁ”
 >ğ
MAX_REPEATS
 )

134 
d©a
->
dÚe
 = 1;

135 ifĞ
d©a
->
¡İMode
 =ğ
MODE_FINISH
 )

137 
fšished
 = 1;

142 
d©a
->
pha£_šüem’t
 = d©a->
tuÃ
[d©a->
nÙeCouÁ”
];

144 
v®ue
 = 
	`LookupWavefÜm
(
d©a
, d©a->
pha£
);

145 *
out
++ = 
v®ue
;

146 *
out
++ = 
v®ue
;

147 
d©a
->
pha£
 +ğd©a->
pha£_šüem’t
;

148 ifĞ
d©a
->
pha£
 >= 1.0f ) data->phase -= 1.0f;

150 
d©a
->
äameCouÁ”
 += 1;

154  ; 
i
<
äamesP”Bufãr
; i++ )

156 *
out
++ = 0;

157 *
out
++ = 0;

159  
fšished
;

160 
	}
}

162 
maš
();

163 
	$maš
()

165 
·Te¡D©a
 
DATA
;

166 
i
;

167 
sim¶eTuÃ
[] = { 
NOTE_0
, 
NOTE_1
, 
NOTE_2
, 
NOTE_3
, 
NOTE_4
, NOTE_3, NOTE_2, NOTE_1 };

168 
	`´štf
("PÜtAudiØTe¡:…Ïy sÚg‡nde¡ stİpšg.‡sk fÜ %d bufãrs\n", 
NUM_BUFFERS
 );

170  
i
=0; i<
TABLE_SIZE
; i++ )

172 
DATA
.
wavefÜm
[
i
] = () (

173 (0.2 * 
	`sš
Ğ(()
i
/()
TABLE_SIZE
è* 
M_PI
 * 2. )) +

174 (0.2 * 
	`sš
Ğ(()(3*
i
)/()
TABLE_SIZE
è* 
M_PI
 * 2. )) +

175 (0.1 * 
	`sš
Ğ(()(5*
i
)/()
TABLE_SIZE
è* 
M_PI
 * 2. ))

178 
DATA
.
wavefÜm
[
TABLE_SIZE
] = DATA.waveform[0];

179 
DATA
.
tuÃ
 = &
sim¶eTuÃ
[0];

180 
DATA
.
nÙesP”TuÃ
 = (
sim¶eTuÃ
) / ();

181 
	`´štf
("Test MODE_FINISH - callback„eturns 1.\n");

182 
	`´štf
("Should h—¸’tœ%d‚ÙtuÃ„•—‹dwiû.\n", 
DATA
.
nÙesP”TuÃ
);

183 
DATA
.
¡İMode
 = 
MODE_FINISH
;

184 ifĞ
	`Te¡StİMode
Ğ&
DATA
 ) !ğ
·NoE¼Ü
 )

186 
	`´štf
("Test of MODE_FINISH failed!\n");

187 
”rÜ
;

189 
	`´štf
("Test MODE_STOP - stop when song is done.\n");

190 
	`´štf
("Should h—¸’tœ%d‚ÙtuÃ„•—‹dwiû.\n", 
DATA
.
nÙesP”TuÃ
);

191 
DATA
.
¡İMode
 = 
MODE_STOP
;

192 ifĞ
	`Te¡StİMode
Ğ&
DATA
 ) !ğ
·NoE¼Ü
 )

194 
	`´štf
("Test of MODE_STOP failed!\n");

195 
”rÜ
;

198 
	`´štf
("Test MODE_ABORT -‡bort immediately.\n");

199 
	`´štf
("Should h—¸Ï¡„•‘™iÚ cuˆshÜˆby %d m£c.\n", 
LATENCY_MSEC
);

200 
DATA
.
¡İMode
 = 
MODE_ABORT
;

201 ifĞ
	`Te¡StİMode
Ğ&
DATA
 ) !ğ
·NoE¼Ü
 )

203 
	`´štf
("Test of MODE_ABORT failed!\n");

204 
”rÜ
;

207 
”rÜ
:

209 
	}
}

211 
	$Te¡StİMode
Ğ
·Te¡D©a
 *
d©a
 )

213 
PÜtAudioSŒ—m
 *
¡»am
;

214 
PaE¼Ü
 
”r
;

215 
d©a
->
dÚe
 = 0;

216 
d©a
->
pha£
 = 0.0;

217 
d©a
->
äameCouÁ”
 = 0;

218 
d©a
->
nÙeCouÁ”
 = 0;

219 
d©a
->
»³©CouÁ”
 = 0;

220 
d©a
->
pha£_šüem’t
 = d©a->
tuÃ
[d©a->
nÙeCouÁ”
];

221 
”r
 = 
	`Pa_In™Ÿlize
();

222 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

223 
”r
 = 
	`Pa_O³nSŒ—m
(

224 &
¡»am
,

225 
·NoDeviû
,

227 
·Flßt32
,

228 
NULL
,

229 
OUTPUT_DEVICE
,

231 
·Flßt32
,

232 
NULL
,

233 
SAMPLE_RATE
,

234 
FRAMES_PER_BUFFER
,

235 
NUM_BUFFERS
,

236 
·ClOff
,

237 
·‹¡C®lback
,

238 
d©a
 );

239 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

240 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

241 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

242 ifĞ
d©a
->
¡İMode
 =ğ
MODE_FINISH
 )

244  
	`Pa_SŒ—mAùive
Ğ
¡»am
 ) )

249 
	`Pa_SË•
Ğ
SLEEP_DUR
 );

254  
d©a
->
»³©CouÁ”
 < 
MAX_REPEATS
 )

259 
	`Pa_SË•
Ğ
SLEEP_DUR
 );

262 ifĞ
d©a
->
¡İMode
 =ğ
MODE_ABORT
 )

264 
	`´štf
("Call Pa_AbortStream()\n");

265 
”r
 = 
	`Pa_AbÜtSŒ—m
Ğ
¡»am
 );

269 
	`´štf
("Call Pa_StopStream()\n");

270 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

272 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

273 
	`´štf
("C®ÈPa_Clo£SŒ—m()\n"); 
	`fæush
(
¡dout
);

274 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

275 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

276 
	`Pa_T”mš©e
();

277 
	`´štf
("Test finished.\n");

278  
”r
;

279 
”rÜ
:

280 
	`Pa_T”mš©e
();

281 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

282 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

283 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

284  
”r
;

285 
	}
}

	@portaudio/pa_tests/patest_sync.c

46 
	~<¡dio.h
>

47 
	~<m©h.h
>

48 
	~"pÜudio.h
"

49 
	#NUM_BEEPS
 (6)

	)

50 
	#SAMPLE_RATE
 (44100)

	)

51 
	#FRAMES_PER_BUFFER
 (256)

	)

52 
	#BEEP_DURATION
 (1000)

	)

53 
	#LATENCY_MSEC
 (2000)

	)

54 
	#SLEEP_MSEC
 (10)

	)

55 
	#TIMEOUT_MSEC
 ((3 * 
LATENCY_MSEC
è/ (2 * 
SLEEP_MSEC
))

	)

56 
	#NUM_BUFFERS
 ((
LATENCY_MSEC
 * 
SAMPLE_RATE
è/ (
FRAMES_PER_BUFFER
 * 1000))

	)

57 
	#STATE_BKG_IDLE
 (0)

	)

58 
	#STATE_BKG_PENDING
 (1)

	)

59 
	#STATE_BKG_BEEPING
 (2)

	)

62 
	mËá_pha£
;

63 
	mright_pha£
;

64 
	m¡©e
;

65 
	m»que¡B“p
;

66 
PaTime¡amp
 
	mb“pTime
;

67 
	mb“pCouÁ
;

69 
	t·Te¡D©a
;

70 
G’”©eRªdomNumb”
( );

73 
	$G’”©eRªdomNumb”
( )

75 
¿ndS“d
 = 22222;

76 
¿ndS“d
 = (randSeed * 196314165) + 907633515;

77  
¿ndS“d
;

78 
	}
}

83 
	$·‹¡C®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

84 
äamesP”Bufãr
,

85 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

88 
·Te¡D©a
 *
d©a
 = (·Te¡D©a*)
u£rD©a
;

89 *
out
 = (*)
ouutBufãr
;

90 
i
;

91 (è
šputBufãr
;

93  
i
=0; i<
äamesP”Bufãr
; i++ )

95  
d©a
->
¡©e
 )

97 
STATE_BKG_IDLE
:

99 ifĞ
d©a
->
»que¡B“p
 )

101 
¿ndom
 = 
	`G’”©eRªdomNumb”
() >> 14;

102 
d©a
->
b“pTime
 = 
outTime
 + (
i
 + 
¿ndom
 + (
SAMPLE_RATE
/4));

103 
d©a
->
¡©e
 = 
STATE_BKG_PENDING
;

104 
d©a
->
»que¡B“p
 = 0;

105 
d©a
->
Ëá_pha£
 = d©a->
right_pha£
 = 0.0;

107 *
out
++ = 0.0;

108 *
out
++ = 0.0;

110 
STATE_BKG_PENDING
:

111 ifĞ(
outTime
 + 
i
è>ğ
d©a
->
b“pTime
 )

113 
d©a
->
¡©e
 = 
STATE_BKG_BEEPING
;

114 
d©a
->
b“pCouÁ
 = 
BEEP_DURATION
;

116 *
out
++ = 0.0;

117 *
out
++ = 0.0;

119 
STATE_BKG_BEEPING
:

120 ifĞ
d©a
->
b“pCouÁ
 <= 0 )

122 
d©a
->
¡©e
 = 
STATE_BKG_IDLE
;

123 *
out
++ = 0.0;

124 *
out
++ = 0.0;

129 *
out
++ = 
d©a
->
Ëá_pha£
;

130 *
out
++ = 
d©a
->
right_pha£
;

132 
d©a
->
Ëá_pha£
 += 0.01f;

134 ifĞ
d©a
->
Ëá_pha£
 >= 1.0f ) data->left_phase -= 2.0f;

136 
d©a
->
right_pha£
 += 0.03f;

137 ifĞ
d©a
->
right_pha£
 >= 1.0f ) data->right_phase -= 2.0f;

139 
d©a
->
b“pCouÁ
 -= 1;

142 
d©a
->
¡©e
 = 
STATE_BKG_IDLE
;

147 
	}
}

149 
maš
();

150 
	$maš
()

152 
PÜtAudioSŒ—m
 *
¡»am
;

153 
PaE¼Ü
 
”r
;

154 
·Te¡D©a
 
DATA
;

155 
i
, 
timeout
;

156 
PaTime¡amp
 
´eviousTime
;

157 
	`´štf
("PortAudio Test: you should see BEEP‡the sameime you hear it.\n");

158 
	`´štf
("Wait for‡ few seconds„andom delay between BEEPs.\n");

159 
	`´štf
("BEEP %dimes.\n", 
NUM_BEEPS
 );

161 
DATA
.
Ëá_pha£
 = DATA.
right_pha£
 = 0.0;

162 
DATA
.
¡©e
 = 
STATE_BKG_IDLE
;

163 
DATA
.
»que¡B“p
 = 0;

165 
”r
 = 
	`Pa_In™Ÿlize
();

166 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

168 
”r
 = 
	`Pa_O³nDeçuÉSŒ—m
(

169 &
¡»am
,

172 
·Flßt32
,

173 
SAMPLE_RATE
,

174 
FRAMES_PER_BUFFER
,

175 
NUM_BUFFERS
,

176 
·‹¡C®lback
,

177 &
DATA
 );

178 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

179 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

180 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

181 
´eviousTime
 = 
	`Pa_SŒ—mTime
Ğ
¡»am
 );

182  
i
=0; i<
NUM_BEEPS
; i++ )

185 
DATA
.
»que¡B“p
 = 1;

187 
timeout
 = 
TIMEOUT_MSEC
;

188  (
DATA
.
»que¡B“p
 =ğ1è&& (
timeout
-- > 0 ) ) 
	`Pa_SË•
(
SLEEP_MSEC
);

189 ifĞ
timeout
 <= 0 )

191 
	`årštf
Ğ
¡d”r
, "Timed out waiting for backgroundo‡cknowledge„equest.\n" );

192 
”rÜ
;

195 
timeout
 = 
TIMEOUT_MSEC
 + (10000/
SLEEP_MSEC
);

196  (
	`Pa_SŒ—mTime
Ğ
¡»am
 ) < 
DATA
.
b“pTime
è&& (
timeout
-- > 0 ) )

198 
	`Pa_SË•
(
SLEEP_MSEC
);

200 ifĞ
timeout
 <= 0 )

202 
	`årštf
Ğ
¡d”r
, "Timed out waiting forime. Now = %g, Beep for %g.\n",

203 
	`Pa_SŒ—mTime
Ğ
¡»am
 ), 
DATA
.
b“pTime
 );

204 
”rÜ
;

207 
	`´štf
("BEEP");

208 
	`fæush
(
¡dout
);

209 
	`´štf
("‡t %d, delta = %d\n",

210 (è
DATA
.
b“pTime
, (è(DATA.b“pTim- 
´eviousTime
) );

211 
	`fæush
(
¡dout
);

212 
´eviousTime
 = 
DATA
.
b“pTime
;

214 
”r
 = 
	`Pa_StİSŒ—m
Ğ
¡»am
 );

215 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

216 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

217 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

218 
	`Pa_T”mš©e
();

219 
	`´štf
("Test finished.\n");

220  
”r
;

221 
”rÜ
:

222 
	`Pa_T”mš©e
();

223 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

224 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

225 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

226  
”r
;

227 
	}
}

	@portaudio/pa_tests/patest_wire.c

40 
	~<¡dio.h
>

41 
	~<m©h.h
>

42 
	~"pÜudio.h
"

44 
	#INPUT_DEVICE
 
	`Pa_G‘DeçuÉIÅutDeviûID
()

	)

45 
	#OUTPUT_DEVICE
 
	`Pa_G‘DeçuÉOuutDeviûID
()

	)

52 
	#SAMPLE_RATE
 (22050)

	)

53 
	#FRAMES_PER_BUFFER
 (64)

	)

56 
	#PA_SAMPLE_TYPE
 
·Flßt32


	)

57 
	tSAMPLE
;

59 
	#PA_SAMPLE_TYPE
 
·IÁ16


	)

60 
	tSAMPLE
;

62 
wœeC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

63 
äamesP”Bufãr
,

64 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

70 
	$wœeC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

71 
äamesP”Bufãr
,

72 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

74 
SAMPLE
 *
out
 = (SAMPLE*)
ouutBufãr
;

75 
SAMPLE
 *
š
 = (SAMPLE*)
šputBufãr
;

76 
i
;

77 (è
outTime
;

80 ifĞ
šputBufãr
 =ğ
NULL
 )

82  
i
=0; i<
äamesP”Bufãr
; i++ )

84 *
out
++ = 0;

85 *
out
++ = 0;

90  
i
=0; i<
äamesP”Bufãr
; i++ )

92 *
out
++ = *
š
++;

93 *
out
++ = *
š
++;

98 
	}
}

102 
maš
();

103 
	$maš
()

105 
PÜtAudioSŒ—m
 *
¡»am
;

106 
PaE¼Ü
 
”r
;

108 
”r
 = 
	`Pa_In™Ÿlize
();

109 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

111 
	`´štf
("PÜtAudiØTe¡: iÅuˆdeviû ID = %d\n", 
INPUT_DEVICE
 );

112 
	`´štf
("PÜtAudiØTe¡: ouuˆdeviû ID = %d\n", 
OUTPUT_DEVICE
 );

113 
”r
 = 
	`Pa_O³nSŒ—m
(

114 &
¡»am
,

115 
INPUT_DEVICE
,

117 
PA_SAMPLE_TYPE
,

118 
NULL
,

119 
OUTPUT_DEVICE
,

121 
PA_SAMPLE_TYPE
,

122 
NULL
,

123 
SAMPLE_RATE
,

124 
FRAMES_PER_BUFFER
,

126 
·ClOff
,

127 
wœeC®lback
,

128 
NULL
 );

129 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

131 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
¡»am
 );

132 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

134 
	`´štf
("Full duplex soundest in…rogress.\n");

135 
	`´štf
("H™ ENTERØex™e¡.\n"); 
	`fæush
(
¡dout
);

136 
	`g‘ch¬
();

138 
	`´štf
("Closing stream.\n");

139 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
¡»am
 );

140 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

141 
	`Pa_T”mš©e
();

143 
	`´štf
("FuÎ du¶ex sounde¡ com¶‘e.\n"); 
	`fæush
(
¡dout
);

145 
”rÜ
:

146 
	`Pa_T”mš©e
();

147 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

148 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

149 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

151 
	}
}

	@portaudio/pa_unix_oss/pa_unix.c

88 
	~"·_unix.h
"

90 *(*
	t±h»ad_funùiÚ_t
)(*);

94 
š‹º®PÜtAudioDeviû
 *
	gsDeviûLi¡
 = 
NULL
;

95 
	gsDeçuÉIÅutDeviûID
 = 
·NoDeviû
;

96 
	gsDeçuÉOuutDeviûID
 = 
·NoDeviû
;

97 
	gsPaHo¡E¼Ü
 = 0;

100 
	$Pa_S¹U§geC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

102 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

103 ifĞ
·hsc
 =ğ
NULL
 ) ;

105 
	`g‘timeofday
Ğ&
·hsc
->
·hsc_EÁryTime
, 
NULL
 );

106 
	}
}

108 
	$SubŒaùTime_AmšusB
Ğ
timev®
 *
timeA
, timev® *
timeB
 )

110 
£cs
 = 
timeA
->
tv_£c
 - 
timeB
->tv_sec;

111 
u£cs
 = 
£cs
 * 1000000;

112 
u£cs
 +ğ(
timeA
->
tv_u£c
 - 
timeB
->tv_usec);

113  
u£cs
;

114 
	}
}

120 
	$Pa_EndU§geC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

122 
timev®
 
cu¼’tTime
;

123 
u£csEÏp£d
;

124 
ÃwU§ge
;

126 
	#LOWPASS_COEFFICIENT_0
 (0.95)

	)

127 
	#LOWPASS_COEFFICIENT_1
 (0.99999 - 
LOWPASS_COEFFICIENT_0
)

	)

129 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

130 ifĞ
·hsc
 =ğ
NULL
 ) ;

132 ifĞ
	`g‘timeofday
Ğ&
cu¼’tTime
, 
NULL
 ) == 0 )

134 
u£csEÏp£d
 = 
	`SubŒaùTime_AmšusB
Ğ&
cu¼’tTime
, &
·hsc
->
·hsc_EÁryTime
 );

136 
ÃwU§ge
 = 
u£csEÏp£d
 * 
·hsc
->
·hsc_Inv”£MiüosP”Bufãr
;

138 
·¡
->
·¡_U§ge
 = (
LOWPASS_COEFFICIENT_0
 *…ast->past_Usage) +

139 (
LOWPASS_COEFFICIENT_1
 * 
ÃwU§ge
);

142 
	}
}

150 
PaE¼Ü
 
	$Pa_Qu”yDeviûs
( )

152 
š‹º®PÜtAudioDeviû
 *
·d
, *
Ï¡Pad
;

153 
go
 = 1;

154 
numDeviûs
 = 0;

155 
PaE¼Ü
 
‹¡ResuÉ
;

156 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

157 *
’vdev
;

159 
sDeçuÉIÅutDeviûID
 = 
·NoDeviû
;

160 
sDeçuÉOuutDeviûID
 = 
·NoDeviû
;

162 
Ï¡Pad
 = 
NULL
;

164  
go
 )

167 
·d
 = (
š‹º®PÜtAudioDeviû
 *)

168 
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ(
š‹º®PÜtAudioDeviû
) );

169 ifĞ
·d
 =ğ
NULL
 )  
·Insuffic›ÁMemÜy
;

170 
	`mem£t
Ğ
·d
, 0, (
š‹º®PÜtAudioDeviû
) );

173 ifĞ
numDeviûs
 == 0 )

175 
	`¥rštf
Ğ
·d
->
·d_DeviûName
, 
DEVICE_NAME_BASE
);

179 
	`¥rštf
Ğ
·d
->
·d_DeviûName
, 
DEVICE_NAME_BASE
 "%d", 
numDeviûs
 );

182 
	`DBUG
(("Try deviû %s\n", 
·d
->
·d_DeviûName
 ));

183 
‹¡ResuÉ
 = 
	`Pa_Qu”yDeviû
Ğ
·d
->
·d_DeviûName
,…ad );

184 
	`DBUG
(("Pa_Qu”yDeviû„‘uºed %d\n", 
‹¡ResuÉ
 ));

185 ifĞ
‹¡ResuÉ
 !ğ
·NoE¼Ü
 )

187 ifĞ
Ï¡Pad
 =ğ
NULL
 )

189 
»suÉ
 = 
‹¡ResuÉ
;

191 
go
 = 0;

192 
	`PaHo¡_F»eFa¡MemÜy
Ğ
·d
, (
š‹º®PÜtAudioDeviû
) );

196 
numDeviûs
 += 1;

198 ifĞ
Ï¡Pad
 )

200 
Ï¡Pad
->
·d_Next
 = 
·d
;

204 
sDeviûLi¡
 = 
·d
;

206 
Ï¡Pad
 = 
·d
;

215 
	`DBUG
(("Checking for AUDIODEV‡nd UTAUDIODEV\n"));

216 
’vdev
 = 
	`g‘’v
("AUDIODEV");

217 ià(
’vdev
 !ğ
NULL
 && !
	`¡r¡r
Ónvdev, 
DEVICE_NAME_BASE
)) {

218 
»suÉ
 = 
·NoE¼Ü
;

221 
·d
 = (
š‹º®PÜtAudioDeviû
 *)

222 
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ(
š‹º®PÜtAudioDeviû
) );

223 ifĞ
·d
 =ğ
NULL
 )  
·Insuffic›ÁMemÜy
;

224 
	`mem£t
Ğ
·d
, 0, (
š‹º®PÜtAudioDeviû
) );

227 
	`¡rıy
(
·d
->
·d_DeviûName
, 
’vdev
);

229 
	`DBUG
(("Try deviû %s\n", 
·d
->
·d_DeviûName
 ));

230 
‹¡ResuÉ
 = 
	`Pa_Qu”yDeviû
Ğ
·d
->
·d_DeviûName
,…ad );

231 
	`DBUG
(("Pa_Qu”yDeviû„‘uºed %d\n", 
‹¡ResuÉ
 ));

232 ifĞ
‹¡ResuÉ
 !ğ
·NoE¼Ü
 )

234 ifĞ
Ï¡Pad
 =ğ
NULL
 )

236 
»suÉ
 = 
‹¡ResuÉ
;

238 
	`PaHo¡_F»eFa¡MemÜy
Ğ
·d
, (
š‹º®PÜtAudioDeviû
) );

242 
numDeviûs
 += 1;

244 ifĞ
Ï¡Pad
 )

246 
Ï¡Pad
->
·d_Next
 = 
·d
;

250 
sDeviûLi¡
 = 
·d
;

252 
Ï¡Pad
 = 
·d
;

256 
’vdev
 = 
	`g‘’v
("UTAUDIODEV");

257 ià(
’vdev
 !ğ
NULL
 && !
	`¡r¡r
Ónvdev, 
DEVICE_NAME_BASE
è&& 
	`g‘’v
("AUDIODEV"è!ğNULL && 
	`¡rcmp
(envdev, getenv("AUDIODEV"))) {

258 
»suÉ
 = 
·NoE¼Ü
;

261 
·d
 = (
š‹º®PÜtAudioDeviû
 *)

262 
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ(
š‹º®PÜtAudioDeviû
) );

263 ifĞ
·d
 =ğ
NULL
 )  
·Insuffic›ÁMemÜy
;

264 
	`mem£t
Ğ
·d
, 0, (
š‹º®PÜtAudioDeviû
) );

267 
	`¡rıy
(
·d
->
·d_DeviûName
, 
’vdev
);

269 
	`DBUG
(("Try deviû %s\n", 
·d
->
·d_DeviûName
 ));

270 
‹¡ResuÉ
 = 
	`Pa_Qu”yDeviû
Ğ
·d
->
·d_DeviûName
,…ad );

271 
	`DBUG
(("Pa_Qu”yDeviû„‘uºed %d\n", 
‹¡ResuÉ
 ));

272 ifĞ
‹¡ResuÉ
 !ğ
·NoE¼Ü
 )

274 ifĞ
Ï¡Pad
 =ğ
NULL
 )

276 
»suÉ
 = 
‹¡ResuÉ
;

278 
	`PaHo¡_F»eFa¡MemÜy
Ğ
·d
, (
š‹º®PÜtAudioDeviû
) );

282 
numDeviûs
 += 1;

284 ifĞ
Ï¡Pad
 )

286 
Ï¡Pad
->
·d_Next
 = 
·d
;

290 
sDeviûLi¡
 = 
·d
;

292 
Ï¡Pad
 = 
·d
;

296  
»suÉ
;

297 
	}
}

300 
	$Pa_CouÁDeviûs
()

302 
numDeviûs
 = 0;

303 
š‹º®PÜtAudioDeviû
 *
·d
;

305 ifĞ
sDeviûLi¡
 =ğ
NULL
 ) 
	`Pa_In™Ÿlize
();

307 
·d
 = 
sDeviûLi¡
;

308  
·d
 !ğ
NULL
 )

310 
·d
 =…ad->
·d_Next
;

311 
numDeviûs
++;

314  
numDeviûs
;

315 
	}
}

318 
š‹º®PÜtAudioDeviû
 *
	$Pa_G‘IÁ”ÇlDeviû
Ğ
PaDeviûID
 
id
 )

320 
š‹º®PÜtAudioDeviû
 *
·d
;

321 ifĞ(
id
 < 0è|| ( id >ğ
	`Pa_CouÁDeviûs
()èè 
NULL
;

322 
·d
 = 
sDeviûLi¡
;

323  
id
 > 0 )

325 
·d
 =…ad->
·d_Next
;

326 
id
--;

328  
·d
;

329 
	}
}

332 cÚ¡ 
PaDeviûInfo
* 
	$Pa_G‘DeviûInfo
Ğ
PaDeviûID
 
id
 )

334 
š‹º®PÜtAudioDeviû
 *
·d
;

335 ifĞ(
id
 < 0è|| ( id >ğ
	`Pa_CouÁDeviûs
()èè 
NULL
;

336 
·d
 = 
	`Pa_G‘IÁ”ÇlDeviû
Ğ
id
 );

337  &
·d
->
·d_Info
 ;

338 
	}
}

340 
PaE¼Ü
 
	$Pa_MaybeQu”yDeviûs
( )

342 ifĞ
sDeviûLi¡
 =ğ
NULL
 )

344  
	`Pa_Qu”yDeviûs
();

347 
	}
}

349 
PaDeviûID
 
	$Pa_G‘DeçuÉIÅutDeviûID
( )

353 
	}
}

355 
PaDeviûID
 
	$Pa_G‘DeçuÉOuutDeviûID
( )

358 
	}
}

364 
PaE¼Ü
 
	$PaHo¡_In™
( )

366  
	`Pa_MaybeQu”yDeviûs
();

367 
	}
}

376 
	#SCHEDULER_POLICY
 
SCHED_RR


	)

377 
	#WATCHDOG_MAX_SECONDS
 (3)

	)

378 
	#WATCHDOG_INTERVAL_USEC
 (1000000)

	)

380 
	$PaHo¡_Cª¬yProc
Ğ
PaHo¡SoundCÚŒŞ
 *
·hsc
 )

382 
»suÉ
 = 0;

384 #ifdeà
GNUSTEP


385 
	`GSRegi¡”Cu¼’tTh»ad
();

388  
·hsc
->
·hsc_Cª¬yRun
) {

389 
	`u¦“p
Ğ
WATCHDOG_INTERVAL_USEC
 );

390 
	`g‘timeofday
Ğ&
·hsc
->
·hsc_Cª¬yTime
, 
NULL
 );

393 
	`DBUG
(("PaHost_CanaryProc:ƒxiting.\n"));

395 #ifdeà
GNUSTEP


396 
	`GSUÄegi¡”Cu¼’tTh»ad
();

399  
»suÉ
;

400 
	}
}

410 
PaE¼Ü
 
	$PaHo¡_W©chDogProc
Ğ
PaHo¡SoundCÚŒŞ
 *
·hsc
 )

412 
sched_·¿m
 
schp
 = { 0 };

413 
maxPri
;

415 #ifdeà
GNUSTEP


416 
	`GSRegi¡”Cu¼’tTh»ad
();

421 
schp
.
sched_´iÜ™y
 = 
·hsc
->
·hsc_AudioPriÜ™y
 + 4;

422 
maxPri
 = 
	`sched_g‘_´iÜ™y_max
(
SCHEDULER_POLICY
);

423 ifĞ
schp
.
sched_´iÜ™y
 > 
maxPri
 ) schp.sched_priority = maxPri;

425 ià(
	`sched_£tscheduËr
(0, 
SCHEDULER_POLICY
, &
schp
) != 0)

427 
	`ERR_RPT
(("PaHost_WatchDogProc: cannot set watch dog…riority!\n"));

428 
klAudio
;

433  
·hsc
->
·hsc_W©chDogRun
 )

436 
d–
;

437 
timev®
 
cu¼’tTime
;

439 
	`u¦“p
Ğ
WATCHDOG_INTERVAL_USEC
 );

440 
	`g‘timeofday
Ğ&
cu¼’tTime
, 
NULL
 );

443 
d–
 = 
cu¼’tTime
.
tv_£c
 - 
·hsc
->
·hsc_EÁryTime
.tv_sec;

444 
	`DBUG
(("PaHo¡_W©chDogProc:‡udiØd– = %d\n", 
d–
 ));

445 ifĞ
d–
 > 
WATCHDOG_MAX_SECONDS
 )

447 
klAudio
;

451 
d–
 = 
cu¼’tTime
.
tv_£c
 - 
·hsc
->
·hsc_Cª¬yTime
.tv_sec;

452 ifĞ
d–
 > 
WATCHDOG_MAX_SECONDS
 )

454 
	`ERR_RPT
(("PaHost_WatchDogProc: canary died!\n"));

455 
low”Audio
;

459 
	`DBUG
(("PaHost_WatchDogProc:ƒxiting.\n"));

460 #ifdeà
GNUSTEP


461 
	`GSUÄegi¡”Cu¼’tTh»ad
();

465 
low”Audio
:

467 
sched_·¿m
 
sch©
 = { 0 };

468 ifĞ
	`sched_£tscheduËr
(
·hsc
->
·hsc_AudioTh»adPID
, 
SCHED_OTHER
, &
sch©
) != 0)

470 
	`ERR_RPT
(("PaHo¡_W©chDogProc: faedØlow”‡udiØ´iÜ™y.ƒ¼nØğ%d\n", 
”ºo
 ));

475 
	`ERR_RPT
(("PaHost_WatchDogProc:†owered‡udio…riorityo…revent hogging of CPU.\n"));

476 
ş—nup
;

480 
klAudio
:

481 
	`ERR_RPT
(("PaHost_WatchDogProc: killing hung‡udiohread!\n"));

482 
	`±h»ad_kl
Ğ
·hsc
->
·hsc_AudioTh»ad
, 
SIGKILL
 );

484 
ş—nup
:

485 
·hsc
->
·hsc_Cª¬yRun
 = 0;

486 
	`DBUG
(("PaHost_WatchDogProc: cancel Canary\n"));

487 
	`±h»ad_ÿnûl
Ğ
·hsc
->
·hsc_Cª¬yTh»ad
 );

488 
	`DBUG
(("PaHost_WatchDogProc: join Canary\n"));

489 
	`±h»ad_još
Ğ
·hsc
->
·hsc_Cª¬yTh»ad
, 
NULL
 );

490 
	`DBUG
(("PaHost_WatchDogProc: forget Canary\n"));

491 
·hsc
->
·hsc_IsCª¬yTh»adV®id
 = 0;

493 #ifdeà
GNUSTEP


494 
	`GSUÄegi¡”Cu¼’tTh»ad
();

497 
	}
}

500 
	$PaHo¡_StİW©chDog
Ğ
PaHo¡SoundCÚŒŞ
 *
·hsc
 )

503 ifĞ
·hsc
->
·hsc_IsW©chDogTh»adV®id
 )

505 
·hsc
->
·hsc_W©chDogRun
 = 0;

506 
	`DBUG
(("PaHost_StopWatchDog: cancel WatchDog\n"));

507 
	`±h»ad_ÿnûl
Ğ
·hsc
->
·hsc_W©chDogTh»ad
 );

508 
	`±h»ad_još
Ğ
·hsc
->
·hsc_W©chDogTh»ad
, 
NULL
 );

509 
·hsc
->
·hsc_IsW©chDogTh»adV®id
 = 0;

512 ifĞ
·hsc
->
·hsc_IsCª¬yTh»adV®id
 )

514 
·hsc
->
·hsc_Cª¬yRun
 = 0;

515 
	`DBUG
(("PaHost_StopWatchDog: cancel Canary\n"));

516 
	`±h»ad_ÿnûl
Ğ
·hsc
->
·hsc_Cª¬yTh»ad
 );

517 
	`DBUG
(("PaHost_StopWatchDog: join Canary\n"));

518 
	`±h»ad_još
Ğ
·hsc
->
·hsc_Cª¬yTh»ad
, 
NULL
 );

519 
·hsc
->
·hsc_IsCª¬yTh»adV®id
 = 0;

521 
	}
}

524 
PaE¼Ü
 
	$PaHo¡_S¹W©chDog
Ğ
PaHo¡SoundCÚŒŞ
 *
·hsc
 )

526 
h»s
;

527 
PaE¼Ü
 
»suÉ
 = 0;

530 
	`g‘timeofday
Ğ&
·hsc
->
·hsc_EÁryTime
, 
NULL
 );

531 
	`g‘timeofday
Ğ&
·hsc
->
·hsc_Cª¬yTime
, 
NULL
 );

534 
·hsc
->
·hsc_Cª¬yRun
 = 1;

535 
h»s
 = 
	`±h»ad_ü—‹
(&(
·hsc
->
·hsc_Cª¬yTh»ad
),

536 
NULL
 ,

537 (
±h»ad_funùiÚ_t
)
PaHo¡_Cª¬yProc
, 
·hsc
);

538 ifĞ
h»s
 != 0 )

540 
·hsc
->
·hsc_IsCª¬yTh»adV®id
 = 0;

541 
»suÉ
 = 
·Ho¡E¼Ü
;

542 
sPaHo¡E¼Ü
 = 
h»s
;

543 
”rÜ
;

545 
·hsc
->
·hsc_IsCª¬yTh»adV®id
 = 1;

548 
·hsc
->
·hsc_W©chDogRun
 = 1;

549 
h»s
 = 
	`±h»ad_ü—‹
(&(
·hsc
->
·hsc_W©chDogTh»ad
),

550 
NULL
 ,

551 (
±h»ad_funùiÚ_t
)
PaHo¡_W©chDogProc
, 
·hsc
);

552 ifĞ
h»s
 != 0 )

554 
·hsc
->
·hsc_IsW©chDogTh»adV®id
 = 0;

555 
»suÉ
 = 
·Ho¡E¼Ü
;

556 
sPaHo¡E¼Ü
 = 
h»s
;

557 
”rÜ
;

559 
·hsc
->
·hsc_IsW©chDogTh»adV®id
 = 1;

560  
»suÉ
;

562 
”rÜ
:

563 
	`PaHo¡_StİW©chDog
Ğ
·hsc
 );

564  
»suÉ
;

565 
	}
}

571 
PaE¼Ü
 
	$PaHo¡_Boo¡PriÜ™y
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

573 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

574 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

575 
sched_·¿m
 
schp
 = { 0 };

577 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

578 ifĞ
·hsc
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

580 
·hsc
->
·hsc_AudioTh»adPID
 = 
	`g‘pid
();

581 
	`DBUG
(("PaHo¡_Boo¡PriÜ™y:‡udiØPID = %d\n", 
·hsc
->
·hsc_AudioTh»adPID
 ));

584 
·hsc
->
·hsc_AudioPriÜ™y
 = (
	`sched_g‘_´iÜ™y_max
(
SCHEDULER_POLICY
) -

585 
	`sched_g‘_´iÜ™y_mš
(
SCHEDULER_POLICY
)) / 2;

586 
schp
.
sched_´iÜ™y
 = 
·hsc
->
·hsc_AudioPriÜ™y
;

588 ià(
	`sched_£tscheduËr
(0, 
SCHEDULER_POLICY
, &
schp
) != 0)

590 
	`DBUG
(("PortAudio: only superuser can use„eal-time…riority.\n"));

594 
	`DBUG
(("PÜtAudio:‡udiØÿÎback…riÜ™y s‘ØËv– %d!\n", 
schp
.
sched_´iÜ™y
));

596 
»suÉ
 = 
	`PaHo¡_S¹W©chDog
Ğ
·hsc
 );

599  
»suÉ
;

600 
	}
}

603 
PaE¼Ü
 
	$Pa_AudioTh»adProc
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

605 
PaE¼Ü
 
»suÉ
;

606 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

607 
ssize_t
 
by‹s_»ad
, 
by‹s_wr™‹n
;

609 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

610 ifĞ
·hsc
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

612 #ifdeà
GNUSTEP


613 
	`GSRegi¡”Cu¼’tTh»ad
();

616 
»suÉ
 = 
	`PaHo¡_Boo¡PriÜ™y
Ğ
·¡
 );

617 ifĞ
»suÉ
 < 0 ) 
”rÜ
;

619 
·¡
->
·¡_IsAùive
 = 1;

620 
	`DBUG
(("enteringhread.\n"));

622  (
·¡
->
·¡_StİNow
 =ğ0è&& (·¡->
·¡_StİSoÚ
 == 0) )

625 if(
·hsc
->
·hsc_N©iveIÅutBufãr
)

627 
tÙ®»ad
 = 0;

628 
	`DBUG
(("Pa_AudioTh»adProc:‡‰em±Ø»ad %d by‹s\n", 
·hsc
->
·hsc_By‹sP”IÅutBufãr
));

631 
by‹s_»ad
 = 
	`»ad
(
·hsc
->
·hsc_IÅutHªdË
,

632 (*)
·hsc
->
·hsc_N©iveIÅutBufãr
 + 
tÙ®»ad
,

633 
·hsc
->
·hsc_By‹sP”IÅutBufãr
 - 
tÙ®»ad
);

635 ià(
by‹s_»ad
 < 0)

637 
	`ERR_RPT
(("PortAudio:„ead interrupted!\n"));

641 
tÙ®»ad
 +ğ
by‹s_»ad
;

642 }  
tÙ®»ad
 < 
·hsc
->
·hsc_By‹sP”IÅutBufãr
);

646 
	`DBUG
(("converting...\n"));

647 
	`Pa_S¹U§geC®cuÏtiÚ
Ğ
·¡
 );

648 
»suÉ
 = 
	`Pa_C®lCÚv”tIÁ16
Ğ
·¡
,

649 
·hsc
->
·hsc_N©iveIÅutBufãr
,

650 
·hsc
->
·hsc_N©iveOuutBufãr
 );

651 
	`Pa_EndU§geC®cuÏtiÚ
Ğ
·¡
 );

652 ifĞ
»suÉ
 != 0)

654 
	`DBUG
(("hmm, Pa_CallConvertInt16() says: %d. i'm bailing.\n",

655 
»suÉ
));

660 ifĞ
·hsc
->
·hsc_N©iveOuutBufãr
 )

662 
tÙ®wr™‹n
 = 0;

665 
by‹s_wr™‹n
 = 
	`wr™e
(
·hsc
->
·hsc_OuutHªdË
,

666 (*)
·hsc
->
·hsc_N©iveOuutBufãr
,

667 
·hsc
->
·hsc_By‹sP”OuutBufãr
);

668 ifĞ
by‹s_wr™‹n
 < 0 )

670 
	`ERR_RPT
(("PortAudio: write interrupted!"));

674 
tÙ®wr™‹n
 +ğ
by‹s_wr™‹n
;

675 }  
tÙ®wr™‹n
 < 
·hsc
->
·hsc_By‹sP”OuutBufãr
);

678 
	`Pa_Upd©eSŒ—mTime
(
·hsc
);

680 
	`DBUG
(("Pa_AudioThreadProc:†eft‡udio†oop.\n"));

682 
·¡
->
·¡_IsAùive
 = 0;

683 
	`PaHo¡_StİW©chDog
Ğ
·hsc
 );

685 
”rÜ
:

686 
	`DBUG
(("leaving‡udiohread.\n"));

687 #ifdeà
GNUSTEP


688 
	`GSUÄegi¡”Cu¼’tTh»ad
();

690  
»suÉ
;

691 
	}
}

702 
	#PA_LATENCY_ENV_NAME
 ("PA_MIN_LATENCY_MSEC")

	)

704 
	$Pa_G‘MšNumBufãrs
Ğ
äamesP”Bufãr
, 
äamesP”SecÚd
 )

706 
mšBufãrs
;

707 
mšL©’cyM£c
 = 
MIN_LATENCY_MSEC
;

708 *
mšL©’cyText
 = 
	`g‘’v
(
PA_LATENCY_ENV_NAME
);

709 ifĞ
mšL©’cyText
 !ğ
NULL
 )

711 
	`PRINT
(("PA_MIN_LATENCY_MSEC = %s\n", 
mšL©’cyText
 ));

712 
mšL©’cyM£c
 = 
	`©oi
Ğ
mšL©’cyText
 );

713 ifĞ
mšL©’cyM£c
 < 1 ) minLatencyMsec = 1;

714 ifĞ
mšL©’cyM£c
 > 5000 ) minLatencyMsec = 5000;

717 
mšBufãrs
 = (è((
mšL©’cyM£c
 * 
äamesP”SecÚd
è/ ( 1000.0 * 
äamesP”Bufãr
 ));

718 ifĞ
mšBufãrs
 < 2 ) minBuffers = 2;

719  
mšBufãrs
;

720 
	}
}

723 
PaE¼Ü
 
	$PaHo¡_O³nSŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

725 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

726 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

727 
mšNumBufãrs
;

728 
š‹º®PÜtAudioDeviû
 *
·d
;

729 
	`DBUG
(("PaHost_OpenStream() called.\n" ));

732 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
	`m®loc
((PaHostSoundControl));

733 ifĞ
·hsc
 =ğ
NULL
 )

735 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

736 
”rÜ
;

738 
	`mem£t
Ğ
·hsc
, 0, (
PaHo¡SoundCÚŒŞ
) );

739 
·¡
->
·¡_DeviûD©a
 = (*è
·hsc
;

741 
·hsc
->
·hsc_OuutHªdË
 = 
BAD_DEVICE_ID
;

742 
·hsc
->
·hsc_IÅutHªdË
 = 
BAD_DEVICE_ID
;

743 
·hsc
->
·hsc_IsAudioTh»adV®id
 = 0;

744 
·hsc
->
·hsc_IsW©chDogTh»adV®id
 = 0;

747 
·hsc
->
·hsc_By‹sP”IÅutBufãr
 = 
·¡
->
·¡_F¿mesP”U£rBufãr
 *

748 
·¡
->
·¡_NumIÅutChªÃls
 * ();

749 ifĞ
·¡
->
·¡_NumIÅutChªÃls
 > 0)

751 
·hsc
->
·hsc_N©iveIÅutBufãr
 = (*è
	`m®loc
Õahsc->
·hsc_By‹sP”IÅutBufãr
);

752 ifĞ
·hsc
->
·hsc_N©iveIÅutBufãr
 =ğ
NULL
 )

754 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

755 
”rÜ
;

758 
·hsc
->
·hsc_By‹sP”OuutBufãr
 = 
·¡
->
·¡_F¿mesP”U£rBufãr
 *

759 
·¡
->
·¡_NumOuutChªÃls
 * ();

760 ifĞ
·¡
->
·¡_NumOuutChªÃls
 > 0)

762 
·hsc
->
·hsc_N©iveOuutBufãr
 = (*è
	`m®loc
Õahsc->
·hsc_By‹sP”OuutBufãr
);

763 ifĞ
·hsc
->
·hsc_N©iveOuutBufãr
 =ğ
NULL
 )

765 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

766 
”rÜ
;

771 
mšNumBufãrs
 = 
	`Pa_G‘MšNumBufãrs
Ğ
·¡
->
·¡_F¿mesP”U£rBufãr
,…a¡->
·¡_Sam¶eR©e
 );

772 
·¡
->
·¡_NumU£rBufãrs
 = ( 
mšNumBufãrs
 >…ast->past_NumUserBuffers ) ? minNumBuffers :…ast->past_NumUserBuffers;

774 
·hsc
->
·hsc_Inv”£MiüosP”Bufãr
 = 
·¡
->
·¡_Sam¶eR©e
 / (1000000.0 *…a¡->
·¡_F¿mesP”U£rBufãr
);

775 
	`DBUG
(("·¡_Sam¶eR©ğ%g\n", 
·¡
->
·¡_Sam¶eR©e
 ));

776 
	`DBUG
(("·¡_F¿mesP”U£rBufã¸ğ%d\n", 
·¡
->
·¡_F¿mesP”U£rBufãr
 ));

777 
	`DBUG
(("·hsc_Inv”£MiüosP”Bufã¸ğ%g\n", 
·hsc
->
·hsc_Inv”£MiüosP”Bufãr
 ));

782 ià(
·¡
->
·¡_OuutDeviûID
 =ğ·¡->
·¡_IÅutDeviûID
)

785 ià((
·¡
->
·¡_NumOuutChªÃls
 > 0è&& (·¡->
·¡_NumIÅutChªÃls
 > 0) )

787 
·d
 = 
	`Pa_G‘IÁ”ÇlDeviû
Ğ
·¡
->
·¡_OuutDeviûID
 );

788 
	`DBUG
(("PaHo¡_O³nSŒ—m:‡‰em±Øİ’ % fÜ O_RDWR\n", 
·d
->
·d_DeviûName
 ));

792 
·hsc
->
·hsc_IÅutHªdË
 = 
	`İ’
(
·d
->
·d_DeviûName
,
O_RDWR
|
O_NONBLOCK
);

793 if(
·hsc
->
·hsc_IÅutHªdË
==-1)

795 
	`ERR_RPT
(("PaHo¡_O³nSŒ—m: could‚Ù o³À% fÜ O_RDWR\n", 
·d
->
·d_DeviûName
 ));

796 
»suÉ
 = 
·Ho¡E¼Ü
;

797 
”rÜ
;

799 
	`şo£
(
·hsc
->
·hsc_IÅutHªdË
);

801 
·hsc
->
·hsc_OuutHªdË
 =…ahsc->
·hsc_IÅutHªdË
 =

802 
	`İ’
(
·d
->
·d_DeviûName
,
O_RDWR
);

803 if(
·hsc
->
·hsc_IÅutHªdË
==-1)

805 
	`ERR_RPT
(("PaHo¡_O³nSŒ—m: could‚Ù o³À% fÜ O_RDWR\n", 
·d
->
·d_DeviûName
 ));

806 
»suÉ
 = 
·Ho¡E¼Ü
;

807 
”rÜ
;

809 
	`Pa_S‘L©’cy
Ğ
·hsc
->
·hsc_OuutHªdË
,

810 
·¡
->
·¡_NumU£rBufãrs
,…a¡->
·¡_F¿mesP”U£rBufãr
,

811 
·¡
->
·¡_NumOuutChªÃls
 );

812 
»suÉ
 = 
	`Pa_S‘upDeviûFÜm©
Ğ
·hsc
->
·hsc_OuutHªdË
,

813 
·¡
->
·¡_NumOuutChªÃls
, (ía¡->
·¡_Sam¶eR©e
 );

818 ià(
·¡
->
·¡_NumOuutChªÃls
 > 0)

820 
·d
 = 
	`Pa_G‘IÁ”ÇlDeviû
Ğ
·¡
->
·¡_OuutDeviûID
 );

821 
	`DBUG
(("PaHo¡_O³nSŒ—m:‡‰em±Øİ’ % fÜ O_WRONLY\n", 
·d
->
·d_DeviûName
 ));

824 
·hsc
->
·hsc_OuutHªdË
 = 
	`İ’
(
·d
->
·d_DeviûName
,
O_WRONLY
|
O_NONBLOCK
);

825 if(
·hsc
->
·hsc_OuutHªdË
==-1)

827 
	`ERR_RPT
(("PaHo¡_O³nSŒ—m: could‚Ù o³À% fÜ O_WRONLY\n", 
·d
->
·d_DeviûName
 ));

828 
»suÉ
 = 
·Ho¡E¼Ü
;

829 
”rÜ
;

831 
	`şo£
(
·hsc
->
·hsc_OuutHªdË
);

833 
·hsc
->
·hsc_OuutHªdË
 = 
	`İ’
(
·d
->
·d_DeviûName
,
O_WRONLY
);

834 if(
·hsc
->
·hsc_OuutHªdË
==-1)

836 
	`ERR_RPT
(("PaHo¡_O³nSŒ—m: could‚Ù o³À% fÜ O_WRONLY\n", 
·d
->
·d_DeviûName
 ));

837 
»suÉ
 = 
·Ho¡E¼Ü
;

838 
”rÜ
;

840 
	`Pa_S‘L©’cy
Ğ
·hsc
->
·hsc_OuutHªdË
,

841 
·¡
->
·¡_NumU£rBufãrs
,…a¡->
·¡_F¿mesP”U£rBufãr
,

842 
·¡
->
·¡_NumOuutChªÃls
 );

843 
»suÉ
 = 
	`Pa_S‘upOuutDeviûFÜm©
Ğ
·hsc
->
·hsc_OuutHªdË
,

844 
·¡
->
·¡_NumOuutChªÃls
, (ía¡->
·¡_Sam¶eR©e
 );

847 ià(
·¡
->
·¡_NumIÅutChªÃls
 > 0)

849 
·d
 = 
	`Pa_G‘IÁ”ÇlDeviû
Ğ
·¡
->
·¡_IÅutDeviûID
 );

850 
	`DBUG
(("PaHo¡_O³nSŒ—m:‡‰em±Øİ’ % fÜ O_RDONLY\n", 
·d
->
·d_DeviûName
 ));

853 
·hsc
->
·hsc_IÅutHªdË
 = 
	`İ’
(
·d
->
·d_DeviûName
,
O_RDONLY
|
O_NONBLOCK
);

854 if(
·hsc
->
·hsc_IÅutHªdË
==-1)

856 
	`ERR_RPT
(("PaHo¡_O³nSŒ—m: could‚Ù o³À% fÜ O_RDONLY\n", 
·d
->
·d_DeviûName
 ));

857 
»suÉ
 = 
·Ho¡E¼Ü
;

858 
”rÜ
;

860 
	`şo£
(
·hsc
->
·hsc_IÅutHªdË
);

862 
·hsc
->
·hsc_IÅutHªdË
 = 
	`İ’
(
·d
->
·d_DeviûName
,
O_RDONLY
);

863 if(
·hsc
->
·hsc_IÅutHªdË
==-1)

865 
	`ERR_RPT
(("PaHo¡_O³nSŒ—m: could‚Ù o³À% fÜ O_RDONLY\n", 
·d
->
·d_DeviûName
 ));

866 
»suÉ
 = 
·Ho¡E¼Ü
;

867 
”rÜ
;

869 
	`Pa_S‘L©’cy
Ğ
·hsc
->
·hsc_IÅutHªdË
,

870 
·¡
->
·¡_NumU£rBufãrs
,…a¡->
·¡_F¿mesP”U£rBufãr
,

871 
·¡
->
·¡_NumIÅutChªÃls
 );

872 
»suÉ
 = 
	`Pa_S‘upIÅutDeviûFÜm©
Ğ
·hsc
->
·hsc_IÅutHªdË
,

873 
·¡
->
·¡_NumIÅutChªÃls
, (ía¡->
·¡_Sam¶eR©e
 );

878 
	`DBUG
(("PaHo¡_O³nSŒ—m: SUCCESS -„esuÉ = %d\n", 
»suÉ
 ));

879  
»suÉ
;

881 
”rÜ
:

882 
	`ERR_RPT
(("PaHo¡_O³nSŒ—m: ERROR -„esuÉ = %d\n", 
»suÉ
 ));

883 
	`PaHo¡_Clo£SŒ—m
Ğ
·¡
 );

884  
»suÉ
;

885 
	}
}

888 
PaE¼Ü
 
	$PaHo¡_S¹Ouut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

890  
·NoE¼Ü
;

891 
	}
}

894 
PaE¼Ü
 
	$PaHo¡_S¹IÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

896  
·NoE¼Ü
;

897 
	}
}

900 
PaE¼Ü
 
	$PaHo¡_S¹Engše
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

902 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

903 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

904 
h»s
;

906 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

908 
·¡
->
·¡_StİSoÚ
 = 0;

909 
·¡
->
·¡_StİNow
 = 0;

910 
·¡
->
·¡_IsAùive
 = 1;

916 
h»s
 = 
	`±h»ad_ü—‹
(&(
·hsc
->
·hsc_AudioTh»ad
),

917 
NULL
 ,

918 (
±h»ad_funùiÚ_t
)
Pa_AudioTh»adProc
, 
·¡
);

919 ifĞ
h»s
 != 0 )

921 
»suÉ
 = 
·Ho¡E¼Ü
;

922 
sPaHo¡E¼Ü
 = 
h»s
;

923 
·hsc
->
·hsc_IsAudioTh»adV®id
 = 0;

924 
”rÜ
;

926 
·hsc
->
·hsc_IsAudioTh»adV®id
 = 1;

928 
”rÜ
:

929  
»suÉ
;

930 
	}
}

933 
PaE¼Ü
 
	$PaHo¡_StİEngše
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

935 
h»s
;

936 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

937 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

939 ifĞ
·hsc
 =ğ
NULL
 )  
·NoE¼Ü
;

942 
·¡
->
·¡_StİSoÚ
 = 1;

944 ifĞ
abÜt
 ) 
·¡
->
·¡_StİNow
 = 1;

947 ifĞ
·hsc
->
·hsc_IsAudioTh»adV®id
 )

950 iàĞ!
	`±h»ad_equ®
Ğ
·hsc
->
·hsc_AudioTh»ad
, 
	`±h»ad_£lf
() ) )

952 
h»s
 = 
	`±h»ad_još
Ğ
·hsc
->
·hsc_AudioTh»ad
, 
NULL
 );

956 
	`DBUG
(("Playhread was stopped from itself - can't do…thread_join()\n"));

957 
h»s
 = 0;

960 ifĞ
h»s
 != 0 )

962 
»suÉ
 = 
·Ho¡E¼Ü
;

963 
sPaHo¡E¼Ü
 = 
h»s
;

965 
·hsc
->
·hsc_IsAudioTh»adV®id
 = 0;

968 
·¡
->
·¡_IsAùive
 = 0;

970  
»suÉ
;

971 
	}
}

974 
PaE¼Ü
 
	$PaHo¡_StİIÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

976  
·NoE¼Ü
;

977 
	}
}

980 
PaE¼Ü
 
	$PaHo¡_StİOuut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

982  
·NoE¼Ü
;

983 
	}
}

986 
PaE¼Ü
 
	$PaHo¡_Clo£SŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

988 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

990 ifĞ
·¡
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

991 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

992 ifĞ
·hsc
 =ğ
NULL
 )  
·NoE¼Ü
;

994 ifĞ
·hsc
->
·hsc_OuutHªdË
 !ğ
BAD_DEVICE_ID
 )

996 
”r
 = 0;

997 
	`DBUG
(("PaHost_CloseStream:‡ttempto close output device handle = %d\n",

998 
·hsc
->
·hsc_OuutHªdË
 ));

1000 
	`Pa_FlushSŒ—m
(
·hsc
->
·hsc_OuutHªdË
);

1002 
”r
 = 
	`şo£
(
·hsc
->
·hsc_OuutHªdË
);

1003 ifĞ
”r
 < 0 )

1005 
	`ERR_RPT
(("PaHost_CloseStream: warning, closing output device failed.\n"));

1009 ifĞ(
·hsc
->
·hsc_IÅutHªdË
 !ğ
BAD_DEVICE_ID
) &&

1010 (
·hsc
->
·hsc_IÅutHªdË
 !ğ·hsc->
·hsc_OuutHªdË
) )

1012 
”r
 = 0;

1013 
	`DBUG
(("PaHost_CloseStream:‡ttempto close input device handle = %d\n",

1014 
·hsc
->
·hsc_IÅutHªdË
 ));

1016 
	`Pa_FlushSŒ—m
(
·hsc
->
·hsc_IÅutHªdË
);

1018 
”r
 = 
	`şo£
(
·hsc
->
·hsc_IÅutHªdË
);

1019 ifĞ
”r
 < 0 )

1021 
	`ERR_RPT
(("PaHost_CloseStream: warning, closing input device failed.\n"));

1024 
·hsc
->
·hsc_OuutHªdË
 = 
BAD_DEVICE_ID
;

1025 
·hsc
->
·hsc_IÅutHªdË
 = 
BAD_DEVICE_ID
;

1027 ifĞ
·hsc
->
·hsc_N©iveIÅutBufãr
 )

1029 
	`ä“
Ğ
·hsc
->
·hsc_N©iveIÅutBufãr
 );

1030 
·hsc
->
·hsc_N©iveIÅutBufãr
 = 
NULL
;

1032 ifĞ
·hsc
->
·hsc_N©iveOuutBufãr
 )

1034 
	`ä“
Ğ
·hsc
->
·hsc_N©iveOuutBufãr
 );

1035 
·hsc
->
·hsc_N©iveOuutBufãr
 = 
NULL
;

1038 
	`ä“
Ğ
·hsc
 );

1039 
·¡
->
·¡_DeviûD©a
 = 
NULL
;

1040  
·NoE¼Ü
;

1041 
	}
}

1044 
PaE¼Ü
 
	$PaHo¡_T”m
( )

1047 
š‹º®PÜtAudioDeviû
 *
·d
, *
ÃxtPad
;

1048 
·d
 = 
sDeviûLi¡
;

1049  
·d
 !ğ
NULL
 )

1051 
ÃxtPad
 = 
·d
->
·d_Next
;

1052 
	`DBUG
(("PaHo¡_T”m: f»ešg %s\n", 
·d
->
·d_DeviûName
 ));

1053 
	`PaHo¡_F»eFa¡MemÜy
Ğ
·d
, (
š‹º®PÜtAudioDeviû
) );

1054 
·d
 = 
ÃxtPad
;

1056 
sDeviûLi¡
 = 
NULL
;

1058 
	}
}

1063 
	$Pa_SË•
Ğ
m£c
 )

1066 
timev®
 
timeout
;

1067 
timeout
.
tv_£c
 = 
m£c
 / 1000;

1068 
timeout
.
tv_u£c
 = (
m£c
 % 1000) * 1000;

1069 
	`£Ëù
Ğ0, 
NULL
, NULL, NULL, &
timeout
 );

1071 
u£cs
 = 
m£c
 * 1000;

1072 
	`u¦“p
Ğ
u£cs
 );

1074 
	}
}

1082 *
	$PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ
numBy‹s
 )

1084 *
addr
 = 
	`m®loc
Ğ
numBy‹s
 );

1085 ifĞ
addr
 !ğ
NULL
 ) 
	`mem£t
Ğaddr, 0, 
numBy‹s
 );

1086  
addr
;

1087 
	}
}

1093 
	$PaHo¡_F»eFa¡MemÜy
Ğ*
addr
, 
numBy‹s
 )

1095 ifĞ
addr
 !ğ
NULL
 ) 
	`ä“
(‡ddr );

1096 
	}
}

1100 
PaE¼Ü
 
	$PaHo¡_SŒ—mAùive
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1102 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1103 ifĞ
·¡
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

1104 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

1105 ifĞ
·hsc
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

1106  (
PaE¼Ü
è(
·¡
->
·¡_IsAùive
 != 0);

1107 
	}
}

1110 
	$Pa_G‘Ho¡E¼Ü
( )

1112  (è
sPaHo¡E¼Ü
;

1113 
	}
}

	@portaudio/pa_unix_oss/pa_unix.h

45 
	sPaDriv”Info


48 
	msize
;

50 cÚ¡ *
	mÇme
;

51 
	md©a
;

53 
	tPaDriv”Info
;

55 
	~<¡dio.h
>

56 
	~<¡dlib.h
>

58 
	~<memÜy.h
>

59 
	~<m©h.h
>

60 
	~<sys/ioùl.h
>

61 
	~<sys/time.h
>

62 
	~<fú.h
>

63 
	~<uni¡d.h
>

64 
	~<sigÇl.h
>

65 
	~<sched.h
>

66 
	~<±h»ad.h
>

67 
	~<”ºo.h
>

69 
	~"pÜudio.h
"

70 
	~"·_ho¡.h
"

71 
	~"·_Œaû.h
"

73 
	#PRINT
(
x
è{ 
´štf
 x; 
	`fæush
(
¡dout
); }

	)

74 
	#ERR_RPT
(
x
è
	`PRINT
(x)

	)

75 
	#DBUG
(
x
è

	)

76 
	#DBUGX
(
x
è

	)

78 
	#BAD_DEVICE_ID
 (-1)

	)

80 
	#MIN_LATENCY_MSEC
 (100)

	)

81 
	#MIN_TIMEOUT_MSEC
 (100)

	)

82 
	#MAX_TIMEOUT_MSEC
 (1000)

	)

85 #ifdeà
__lšux__


86 
	#DEVICE_NAME_BASE
 "/dev/d¥"

	)

88 
	#DEVICE_NAME_BASE
 "/dev/audio"

	)

91 
	#MAX_CHARS_DEVNAME
 (32)

	)

92 
	#MAX_SAMPLE_RATES
 (10)

	)

93 
	sš‹º®PÜtAudioDeviû


95 
š‹º®PÜtAudioDeviû
 *
	m·d_Next
;

96 
	m·d_Sam¶eR©es
[
MAX_SAMPLE_RATES
];

97 
	m·d_DeviûName
[
MAX_CHARS_DEVNAME
];

98 
PaDeviûInfo
 
	m·d_Info
;

100 
	tš‹º®PÜtAudioDeviû
;

103 
	sPaHo¡SoundCÚŒŞ


105 
	m·hsc_OuutHªdË
;

106 
	m·hsc_IÅutHªdË
;

107 
	m·hsc_AudioPriÜ™y
;

108 
±h»ad_t
 
	m·hsc_AudioTh»ad
;

109 
	m·hsc_IsAudioTh»adV®id
; 
pid_t
 
	m·hsc_AudioTh»adPID
;

110 
±h»ad_t
 
	m·hsc_W©chDogTh»ad
;

111 
	m·hsc_IsW©chDogTh»adV®id
;

112 
	m·hsc_W©chDogRun
;

113 
±h»ad_t
 
	m·hsc_Cª¬yTh»ad
;

114 
	m·hsc_IsCª¬yTh»adV®id
;

115 
timev®
 
	m·hsc_Cª¬yTime
;

116 
	m·hsc_Cª¬yRun
;

117 *
	m·hsc_N©iveIÅutBufãr
;

118 *
	m·hsc_N©iveOuutBufãr
;

119 
	m·hsc_By‹sP”IÅutBufãr
;

120 
	m·hsc_By‹sP”OuutBufãr
;

122 
timev®
 
	m·hsc_EÁryTime
;

123 
	m·hsc_Inv”£MiüosP”Bufãr
;

126 
	m·hsc_La¡PosPŒ
;

127 
	m·hsc_La¡SŒ—mBy‹s
;

129 
	tPaHo¡SoundCÚŒŞ
;

133 
š‹º®PÜtAudioDeviû
 *
Pa_G‘IÁ”ÇlDeviû
Ğ
PaDeviûID
 
id
 );

134 
PaE¼Ü
 
Pa_Qu”yDeviûs
( );

135 
PaE¼Ü
 
Pa_Qu”yDeviû
ĞcÚ¡ *
deviûName
, 
š‹º®PÜtAudioDeviû
 *
·d
 );

136 
PaE¼Ü
 
Pa_S‘upDeviûFÜm©
Ğ
devHªdË
, 
numChªÃls
, 
§m¶eR©e
 );

137 
PaE¼Ü
 
Pa_S‘upIÅutDeviûFÜm©
Ğ
devHªdË
, 
numChªÃls
, 
§m¶eR©e
 );

138 
PaE¼Ü
 
Pa_S‘upOuutDeviûFÜm©
Ğ
devHªdË
, 
numChªÃls
, 
§m¶eR©e
 );

139 
Pa_S‘L©’cy
Ğ
devHªdË
, 
numBufãrs
, 
äamesP”Bufãr
, 
chªÃlsP”F¿me
 );

140 
Pa_Upd©eSŒ—mTime
(
PaHo¡SoundCÚŒŞ
 *
·hsc
);

141 
Pa_FlushSŒ—m
(
devHªdË
);

	@portaudio/pa_unix_oss/pa_unix_oss.c

41 
	~"·_unix.h
"

43 #ifdeà
__lšux__


44 
	~<lšux/soundÿrd.h
>

46 
	~<machše/soundÿrd.h
>

50 #iâdeà
AFMT_S16_NE


51 
	#AFMT_S16_NE
 
	`G‘_AFMT_S16_NE
()

	)

56 
	$G‘_AFMT_S16_NE
( )

58 
‹¡D©a
 = 1;

59 *
±r
 = (*è&
‹¡D©a
;

60 
isL™e
 = ( *
±r
 == 1 );

61  
isL™e
 ? 
AFMT_S16_LE
 : 
AFMT_S16_BE
;

62 
	}
}

71 
PaE¼Ü
 
	$Pa_Qu”yDeviû
ĞcÚ¡ *
deviûName
, 
š‹º®PÜtAudioDeviû
 *
·d
 )

73 
»suÉ
 = 
·Ho¡E¼Ü
;

74 
‹mpDevHªdË
;

75 
numChªÃls
, 
maxNumChªÃls
;

76 
fÜm©
;

77 
numSam¶eR©es
;

78 
§m¶eR©e
;

79 
numR©esToTry
;

80 
Ï¡R©e
;

81 
¿‹sToTry
[9] = {96000, 48000, 44100, 32000, 24000, 22050, 16000, 11025, 8000};

82 
i
;

91 iàĞ(
‹mpDevHªdË
 = 
	`İ’
(
deviûName
,
O_WRONLY
|
O_NONBLOCK
)) == -1 )

93 
	`DBUG
(("Pa_Qu”yDeviû: could‚Ù o³À%s\n", 
deviûName
 ));

94  
·Ho¡E¼Ü
;

98 
·d
->
·d_Info
.
ÇtiveSam¶eFÜm©s
 = 0;

100 ià(
	`ioùl
(
‹mpDevHªdË
, 
SNDCTL_DSP_GETFMTS
, &
fÜm©
) == -1)

102 
	`ERR_RPT
(("Pa_QueryDevice: could‚ot get format info\n" ));

103 
”rÜ
;

105 ifĞ
fÜm©
 & 
AFMT_U8
 ) 
·d
->
·d_Info
.
ÇtiveSam¶eFÜm©s
 |ğ
·UIÁ8
;

106 ifĞ
fÜm©
 & 
AFMT_S16_NE
 ) 
·d
->
·d_Info
.
ÇtiveSam¶eFÜm©s
 |ğ
·IÁ16
;

113 
maxNumChªÃls
 = 0;

114  
numChªÃls
 = 1;‚umChannels <= 16;‚umChannels++ )

116 
‹mp
 = 
numChªÃls
;

117 
	`DBUG
(("Pa_Qu”yDeviû: u£ SNDCTL_DSP_CHANNELS,‚umChªÃl ğ%d\n", 
numChªÃls
 ))

118 if(
	`ioùl
(
‹mpDevHªdË
, 
SNDCTL_DSP_CHANNELS
, &
‹mp
) < 0 )

121 ifĞ
numChªÃls
 > 2 ) ;

128 ifĞ(
numChªÃls
 > 2è&& (
‹mp
 !=‚umChannels) ) ;

129 
	`DBUG
(("Pa_Qu”yDeviû:em°ğ%d\n", 
‹mp
 ))

130 ifĞ
‹mp
 > 
maxNumChªÃls
 ) maxNumChannels =emp;

135 ifĞ
maxNumChªÃls
 < 1 )

137 
¡”eo
 = 1;

138 if(
	`ioùl
(
‹mpDevHªdË
, 
SNDCTL_DSP_STEREO
, &
¡”eo
) < 0)

140 
maxNumChªÃls
 = 1;

144 
maxNumChªÃls
 = (
¡”eo
) ? 2 : 1;

146 
	`DBUG
(("Pa_Qu”yDeviû: u£ SNDCTL_DSP_STEREO, maxNumChªÃl ğ%d\n", 
maxNumChªÃls
 ))

149 
·d
->
·d_Info
.
maxOuutChªÃls
 = 
maxNumChªÃls
;

150 
	`DBUG
(("Pa_Qu”yDeviû: maxNumChªÃl ğ%d\n", 
maxNumChªÃls
))

156 
‹mp
 = 
maxNumChªÃls
;

157 ifĞ
‹mp
 > 2 )emp = 2;

158 
	`ioùl
(
‹mpDevHªdË
, 
SNDCTL_DSP_CHANNELS
, &
‹mp
);

164 
·d
->
·d_Info
.
maxIÅutChªÃls
 =…ad->·d_Info.
maxOuutChªÃls
;

166 
	`DBUG
(("Pa_QueryDevice: maxInputChannels = %d\n",

167 
·d
->
·d_Info
.
maxIÅutChªÃls
))

173 
numSam¶eR©es
 = 0;

174 
Ï¡R©e
 = 0;

175 
numR©esToTry
 = (
¿‹sToTry
)/();

176 
i
 = 0; i < 
numR©esToTry
; i++)

178 
§m¶eR©e
 = 
¿‹sToTry
[
i
];

180 ià(
	`ioùl
(
‹mpDevHªdË
, 
SNDCTL_DSP_SPEED
, &
§m¶eR©e
) >= 0 )

183 ià(
§m¶eR©e
 !ğ
Ï¡R©e
)

185 
	`DBUG
(("Pa_Qu”yDeviû:‡ddšg sam¶¿‹: %d\n", 
§m¶eR©e
))

186 
·d
->
·d_Sam¶eR©es
[
numSam¶eR©es
] = ()
§m¶eR©e
;

187 
numSam¶eR©es
++;

188 
Ï¡R©e
 = 
§m¶eR©e
;

192 
	`DBUG
(("Pa_Qu”yDeviû: dªg - gÙ sam¶¿‹ %d‡gaš!\n", 
§m¶eR©e
))

197 
	`DBUG
(("Pa_Qu”yDeviû: fš®‚umSam¶eR©e ğ%d\n", 
numSam¶eR©es
))

198 ià(
numSam¶eR©es
==0)

201 
	`ERR_RPT
(("Pa_QueryDevice:‚o supported sample„ate (or SNDCTL_DSP_SPEED ioctl call failed). Force 44100 Hz\n" ));

202 
·d
->
·d_Sam¶eR©es
[
numSam¶eR©es
++] = 44100;

205 
·d
->
·d_Info
.
numSam¶eR©es
 =‚umSampleRates;

206 
·d
->
·d_Info
.
§m¶eR©es
 =…ad->
·d_Sam¶eR©es
;

208 
·d
->
·d_Info
.
Çme
 = 
deviûName
;

210 
»suÉ
 = 
·NoE¼Ü
;

212 
”rÜ
:

214 
	`şo£
(
‹mpDevHªdË
);

216  
»suÉ
;

217 
	}
}

220 
PaE¼Ü
 
	$Pa_S‘upDeviûFÜm©
Ğ
devHªdË
, 
numChªÃls
, 
§m¶eR©e
 )

222 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

223 
tmp
;

227 
tmp
 = 
AFMT_S16_NE
;

228 ifĞ
	`ioùl
(
devHªdË
,
SNDCTL_DSP_SETFMT
,&
tmp
) == -1)

230 
	`ERR_RPT
(("Pa_SetupDeviceFormat: could‚ot SNDCTL_DSP_SETFMT\n" ));

231  
·Ho¡E¼Ü
;

233 ifĞ
tmp
 !ğ
AFMT_S16_NE
 )

235 
	`ERR_RPT
(("Pa_SetupDeviceFormat: HW does‚ot support AFMT_S16_NE\n" ));

236  
·Ho¡E¼Ü
;

241 
tmp
 = 
numChªÃls
;

242 ià(
	`ioùl
(
devHªdË
, 
SNDCTL_DSP_CHANNELS
, &
numChªÃls
) == -1)

244 
	`ERR_RPT
(("Pa_SetupDeviceFormat: could‚ot SNDCTL_DSP_CHANNELS\n" ));

245  
·Ho¡E¼Ü
;

247 ifĞ
tmp
 !ğ
numChªÃls
)

249 
	`ERR_RPT
(("Pa_S‘upDeviûFÜm©: HW dÛ nÙ suµÜˆ%d chªÃls\n", 
numChªÃls
 ));

250  
·Ho¡E¼Ü
;

254 
tmp
 = 
§m¶eR©e
;

255 ifĞ
	`ioùl
(
devHªdË
,
SNDCTL_DSP_SPEED
,&
tmp
) == -1)

257 
	`ERR_RPT
(("Pa_SetupDeviceFormat: could‚ot SNDCTL_DSP_SPEED\n" ));

258  
·Ho¡E¼Ü
;

260 ifĞ
tmp
 !ğ
§m¶eR©e
 )

262 
³rûÁE¼Ü
 = 
	`abs
Ğ(100 * (
§m¶eR©e
 - 
tmp
)) / sampleRate );

263 
	`PRINT
(("Pa_SetupDeviceFormat: warning -„equested sample„ate = %d Hz - closest = %d\n",

264 
§m¶eR©e
, 
tmp
 ));

268 ifĞ
³rûÁE¼Ü
 > 10 )

270 
	`ERR_RPT
(("Pa_S‘upDeviûFÜm©: HW dÛ nÙ suµÜˆ%d Hz sam¶¿‹\n",
§m¶eR©e
 ));

271  
·Ho¡E¼Ü
;

275  
»suÉ
;

276 
	}
}

278 
PaE¼Ü
 
	$Pa_S‘upOuutDeviûFÜm©
Ğ
devHªdË
, 
numChªÃls
, 
§m¶eR©e
 )

280  
	`Pa_S‘upDeviûFÜm©
(
devHªdË
, 
numChªÃls
, 
§m¶eR©e
);

281 
	}
}

283 
PaE¼Ü
 
	$Pa_S‘upIÅutDeviûFÜm©
Ğ
devHªdË
, 
numChªÃls
, 
§m¶eR©e
 )

285  
	`Pa_S‘upDeviûFÜm©
(
devHªdË
, 
numChªÃls
, 
§m¶eR©e
);

286 
	}
}

293 
	$C®cHigh”LogTwo
Ğ
n
 )

295 
log2
 = 0;

296  (1<<
log2
è< 
n
 )†og2++;

297  
log2
;

298 
	}
}

300 
	$Pa_S‘L©’cy
Ğ
devHªdË
, 
numBufãrs
, 
äamesP”Bufãr
, 
chªÃlsP”F¿me
 )

302 
tmp
;

303 
bufãrSize
, 
pow”OfTwo
;

306  
numBufãrs
 > 8 )

308 
numBufãrs
 = (numBuffers + 1) >> 1;

309 
äamesP”Bufãr
 = framesPerBuffer << 1;

313 
bufãrSize
 = 
äamesP”Bufãr
 * 
chªÃlsP”F¿me
 * ();

316 
pow”OfTwo
 = 
	`C®cHigh”LogTwo
Ğ
bufãrSize
 );

317 
	`DBUG
(("Pa_SetLatency:‚umBuffers = %d, framesPerBuffer = %d,…owerOfTwo = %d\n",

318 
numBufãrs
, 
äamesP”Bufãr
, 
pow”OfTwo
 ));

321 
tmp
=(
numBufãrs
<<16è+ 
pow”OfTwo
;

323 if(
	`ioùl
(
devHªdË
,
SNDCTL_DSP_SETFRAGMENT
,&
tmp
) == -1)

325 
	`ERR_RPT
(("Pa_SetLatency: could‚ot SNDCTL_DSP_SETFRAGMENT\n" ));

327 
	`ERR_RPT
(("Pa_SetLatency:‚umBuffers = %d, framesPerBuffer = %d,…owerOfTwo = %d\n",

328 
numBufãrs
, 
äamesP”Bufãr
, 
pow”OfTwo
 ));

330 
	}
}

333 
PaTime¡amp
 
	$Pa_SŒ—mTime
Ğ
PÜtAudioSŒ—m
 *
¡»am
 )

335 
š‹º®PÜtAudioSŒ—m
 *
·¡
 = (š‹º®PÜtAudioSŒ—m *è
¡»am
;

336 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

338 
couÁ_šfo
 
šfo
;

339 
d–
;

340 
numchª
;

342 ifĞ
·¡
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

344 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

346 ifĞ
·hsc
->
·hsc_N©iveOuutBufãr
 )

348 
	`ioùl
(
·hsc
->
·hsc_OuutHªdË
, 
SNDCTL_DSP_GETOPTR
, &
šfo
);

349 
numchª
 = 
·¡
->
·¡_NumOuutChªÃls
;

353 
	`ioùl
(
·hsc
->
·hsc_IÅutHªdË
, 
SNDCTL_DSP_GETIPTR
, &
šfo
);

354 
numchª
 = 
·¡
->
·¡_NumIÅutChªÃls
;

357 
d–
 = 
šfo
.
by‹s
 - 
·hsc
->
·hsc_La¡PosPŒ
;

359 ià(
d–
 > 0x000FFFFF)

360 
d–
 = 0;

362  (
·hsc
->
·hsc_La¡SŒ—mBy‹s
 + 
d–
è/ (
numchª
 * ());

363 
	}
}

365 
	$Pa_Upd©eSŒ—mTime
(
PaHo¡SoundCÚŒŞ
 *
·hsc
)

367 
couÁ_šfo
 
šfo
;

368 
d–
;

372 ifĞ
·hsc
->
·hsc_N©iveOuutBufãr
 )

374 
	`ioùl
(
·hsc
->
·hsc_OuutHªdË
, 
SNDCTL_DSP_GETOPTR
, &
šfo
);

378 
	`ioùl
(
·hsc
->
·hsc_IÅutHªdË
, 
SNDCTL_DSP_GETIPTR
, &
šfo
);

380 
d–
 = 
šfo
.
by‹s
 - 
·hsc
->
·hsc_La¡PosPŒ
;

382 ià(
d–
 <= 0x000FFFFF) {

383 
·hsc
->
·hsc_La¡SŒ—mBy‹s
 +ğ
d–
;

384 
·hsc
->
·hsc_La¡PosPŒ
 = 
šfo
.
by‹s
;

386 
	}
}

388 
PaE¼Ü
 
	$Pa_FlushSŒ—m
(
devHªdË
)

392  
·NoE¼Ü
;

393 
	}
}

	@portaudio/pa_win_ds/dsound_wrapper.c

36 
	~<¡dio.h
>

37 
	~<¡dlib.h
>

38 
	~<m©h.h
>

39 
	#INITGUID


40 
	~<objba£.h
>

	)

41 
	~<unknwn.h
>

42 
	~"dsound_w¿µ”.h
"

43 
	~"·_Œaû.h
"

46 
	$DSW_T”m
Ğ
DSoundW¿µ”
 *
dsw
 )

49 ià(
dsw
->
dsw_OuutBufãr
)

51 
	`IDœeùSoundBufãr_Stİ
Ğ
dsw
->
dsw_OuutBufãr
 );

52 
	`IDœeùSoundBufãr_R–—£
Ğ
dsw
->
dsw_OuutBufãr
 );

53 
dsw
->
dsw_OuutBufãr
 = 
NULL
;

55 #ià
SUPPORT_AUDIO_CAPTURE


56 ià(
dsw
->
dsw_IÅutBufãr
)

58 
	`IDœeùSoundC­tu»Bufãr_Stİ
Ğ
dsw
->
dsw_IÅutBufãr
 );

59 
	`IDœeùSoundC­tu»Bufãr_R–—£
Ğ
dsw
->
dsw_IÅutBufãr
 );

60 
dsw
->
dsw_IÅutBufãr
 = 
NULL
;

62 ià(
dsw
->
dsw_pDœeùSoundC­tu»
)

64 
	`IDœeùSoundC­tu»_R–—£
Ğ
dsw
->
dsw_pDœeùSoundC­tu»
 );

65 
dsw
->
dsw_pDœeùSoundC­tu»
 = 
NULL
;

68 ià(
dsw
->
dsw_pDœeùSound
)

70 
	`IDœeùSound_R–—£
Ğ
dsw
->
dsw_pDœeùSound
 );

71 
dsw
->
dsw_pDœeùSound
 = 
NULL
;

73 
	}
}

75 
HRESULT
 
	$DSW_In™
Ğ
DSoundW¿µ”
 *
dsw
 )

77 
	`mem£t
Ğ
dsw
, 0, (
DSoundW¿µ”
) );

79 
	}
}

81 
HRESULT
 
	$DSW_In™OuutDeviû
Ğ
DSoundW¿µ”
 *
dsw
, 
LPGUID
 
ÍGUID
 )

84 
HRESULT
 
hr
 = 
	`DœeùSoundC»©e
Ğ
ÍGUID
, &
dsw
->
dsw_pDœeùSound
, 
NULL
 );

85 ifĞ
hr
 !ğ
DS_OK
 )  hr;

86  
hr
;

87 
	}
}

90 
HRESULT
 
	$DSW_In™OuutBufãr
Ğ
DSoundW¿µ”
 *
dsw
, 
nF¿meR©e
, 
nChªÃls
, 
by‹sP”Bufãr
 )

92 
DWORD
 
dwD©aL’
;

93 
DWORD
 
¶ayCursÜ
;

94 
HRESULT
 
»suÉ
;

95 
LPDIRECTSOUNDBUFFER
 
pPrim¬yBufãr
;

96 
HWND
 
hWnd
;

97 
HRESULT
 
hr
;

98 
WAVEFORMATEX
 
wfFÜm©
;

99 
DSBUFFERDESC
 
´im¬yDesc
;

100 
DSBUFFERDESC
 
£cÚd¬yDesc
;

101 * 
pDSBuffD©a
;

102 
LARGE_INTEGER
 
couÁ”F»qu’cy
;

103 
dsw
->
dsw_OuutSize
 = 
by‹sP”Bufãr
;

104 
dsw
->
dsw_OuutRuÂšg
 = 
FALSE
;

105 
dsw
->
dsw_OuutUnd”æows
 = 0;

106 
dsw
->
dsw_F¿mesWr™‹n
 = 0;

107 
dsw
->
dsw_By‹sP”F¿me
 = 
nChªÃls
 * ();

113 
hWnd
 = 
	`G‘DesktİWšdow
();

116 ià((
hr
 = 
	`IDœeùSound_S‘Coİ”©iveLev–
Ğ
dsw
->
dsw_pDœeùSound
,

117 
hWnd
, 
DSSCL_EXCLUSIVE
)è!ğ
DS_OK
)

119  
hr
;

125 
	`Z”oMemÜy
(&
´im¬yDesc
, (
DSBUFFERDESC
));

126 
´im¬yDesc
.
dwSize
 = (
DSBUFFERDESC
);

127 
´im¬yDesc
.
dwFÏgs
 = 
DSBCAPS_PRIMARYBUFFER
;

128 
´im¬yDesc
.
dwBufãrBy‹s
 = 0;

129 
´im¬yDesc
.
ÍwfxFÜm©
 = 
NULL
;

131 ià((
»suÉ
 = 
	`IDœeùSound_C»©eSoundBufãr
Ğ
dsw
->
dsw_pDœeùSound
,

132 &
´im¬yDesc
, &
pPrim¬yBufãr
, 
NULL
)è!ğ
DS_OK
è 
»suÉ
;

134 
wfFÜm©
.
wFÜm©Tag
 = 
WAVE_FORMAT_PCM
;

135 
wfFÜm©
.
nChªÃls
 =‚Channels;

136 
wfFÜm©
.
nSam¶esP”Sec
 = 
nF¿meR©e
;

137 
wfFÜm©
.
wB™sP”Sam¶e
 = 8 * ();

138 
wfFÜm©
.
nBlockAlign
 = wfFÜm©.
nChªÃls
 * wfFÜm©.
wB™sP”Sam¶e
 / 8;

139 
wfFÜm©
.
nAvgBy‹sP”Sec
 = wfFÜm©.
nSam¶esP”Sec
 * wfFÜm©.
nBlockAlign
;

140 
wfFÜm©
.
cbSize
 = 0;

142 if((
»suÉ
 = 
	`IDœeùSoundBufãr_S‘FÜm©
Ğ
pPrim¬yBufãr
, &
wfFÜm©
)è!ğ
DS_OK
) „esult;

145 
	`Z”oMemÜy
(&
£cÚd¬yDesc
, (
DSBUFFERDESC
));

146 
£cÚd¬yDesc
.
dwSize
 = (
DSBUFFERDESC
);

147 
£cÚd¬yDesc
.
dwFÏgs
 = 
DSBCAPS_GLOBALFOCUS
 | 
DSBCAPS_GETCURRENTPOSITION2
;

148 
£cÚd¬yDesc
.
dwBufãrBy‹s
 = 
by‹sP”Bufãr
;

149 
£cÚd¬yDesc
.
ÍwfxFÜm©
 = &
wfFÜm©
;

151 ià((
»suÉ
 = 
	`IDœeùSound_C»©eSoundBufãr
Ğ
dsw
->
dsw_pDœeùSound
,

152 &
£cÚd¬yDesc
, &
dsw
->
dsw_OuutBufãr
, 
NULL
)è!ğ
DS_OK
è 
»suÉ
;

154 ià((
»suÉ
 = 
	`IDœeùSoundBufãr_Lock
Ğ
dsw
->
dsw_OuutBufãr
, 0, dsw->
dsw_OuutSize
, (
LPVOID
*)&
pDSBuffD©a
,

155 &
dwD©aL’
, 
NULL
, 0, 0)è!ğ
DS_OK
è 
»suÉ
;

157 
	`Z”oMemÜy
(
pDSBuffD©a
, 
dwD©aL’
);

159 ià((
»suÉ
 = 
	`IDœeùSoundBufãr_UÆock
Ğ
dsw
->
dsw_OuutBufãr
, 
pDSBuffD©a
, 
dwD©aL’
, 
NULL
, 0)è!ğ
DS_OK
) „esult;

160 ifĞ
	`Qu”yP”fÜmªûF»qu’cy
Ğ&
couÁ”F»qu’cy
 ) )

162 
äamesInBufãr
 = 
by‹sP”Bufãr
 / (
nChªÃls
 * ());

163 
dsw
->
dsw_CouÁ”TicksP”Bufãr
.
QuadP¬t
 = (
couÁ”F»qu’cy
.QuadP¬ˆ* 
äamesInBufãr
è/ 
nF¿meR©e
;

164 
	`AddT¿ûMes§ge
("dsw_CouÁ”TicksP”Bufã¸ğ%d\n", 
dsw
->
dsw_CouÁ”TicksP”Bufãr
.
LowP¬t
 );

168 
dsw
->
dsw_CouÁ”TicksP”Bufãr
.
QuadP¬t
 = 0;

172 
hr
 = 
	`IDœeùSoundBufãr_G‘Cu¼’tPos™iÚ
Ğ
dsw
->
dsw_OuutBufãr
, &
¶ayCursÜ
, &dsw->
dsw_Wr™eOff£t
 );

173 ifĞ
hr
 !ğ
DS_OK
 )

175  
hr
;

177 
dsw
->
dsw_F¿mesWr™‹n
 = dsw->
dsw_Wr™eOff£t
 / dsw->
dsw_By‹sP”F¿me
;

179  
DS_OK
;

180 
	}
}

183 
HRESULT
 
	$DSW_S¹Ouut
Ğ
DSoundW¿µ”
 *
dsw
 )

185 
HRESULT
 
hr
;

186 
	`Qu”yP”fÜmªûCouÁ”
Ğ&
dsw
->
dsw_La¡PÏyTime
 );

187 
dsw
->
dsw_La¡PÏyCursÜ
 = 0;

188 
dsw
->
dsw_F¿mesPÏyed
 = 0;

189 
hr
 = 
	`IDœeùSoundBufãr_S‘Cu¼’tPos™iÚ
Ğ
dsw
->
dsw_OuutBufãr
, 0 );

190 ifĞ
hr
 !ğ
DS_OK
 )

192  
hr
;

195 ifĞ
dsw
->
dsw_OuutBufãr
 !ğ
NULL
 )

197 
hr
 = 
	`IDœeùSoundBufãr_PÏy
Ğ
dsw
->
dsw_OuutBufãr
, 0, 0, 
DSBPLAY_LOOPING
 );

198 ifĞ
hr
 !ğ
DS_OK
 )

200  
hr
;

202 
dsw
->
dsw_OuutRuÂšg
 = 
TRUE
;

206 
	}
}

208 
HRESULT
 
	$DSW_StİOuut
Ğ
DSoundW¿µ”
 *
dsw
 )

211 ifĞ
dsw
->
dsw_OuutBufãr
 !ğ
NULL
 )

213 
dsw
->
dsw_OuutRuÂšg
 = 
FALSE
;

214  
	`IDœeùSoundBufãr_Stİ
Ğ
dsw
->
dsw_OuutBufãr
 );

217 
	}
}

220 
HRESULT
 
	$DSW_Qu”yOuutS·û
Ğ
DSoundW¿µ”
 *
dsw
, *
by‹sEm±y
 )

222 
HRESULT
 
hr
;

223 
DWORD
 
¶ayCursÜ
;

224 
DWORD
 
wr™eCursÜ
;

225 
numBy‹sEm±y
;

226 
¶ayWr™eG­
;

231 
hr
 = 
	`IDœeùSoundBufãr_G‘Cu¼’tPos™iÚ
Ğ
dsw
->
dsw_OuutBufãr
, &
¶ayCursÜ
, &
wr™eCursÜ
 );

232 ifĞ
hr
 !ğ
DS_OK
 )

234  
hr
;

236 
	`AddT¿ûMes§ge
("¶ayCursÜ", 
¶ayCursÜ
);

237 
	`AddT¿ûMes§ge
("dsw_Wr™eOff£t", 
dsw
->
dsw_Wr™eOff£t
);

239 
¶ayWr™eG­
 = 
wr™eCursÜ
 - 
¶ayCursÜ
;

240 ifĞ
¶ayWr™eG­
 < 0 )…ÏyWr™eG­ +ğ
dsw
->
dsw_OuutSize
;

243 ifĞ
dsw
->
dsw_OuutRuÂšg
 && (dsw->
dsw_CouÁ”TicksP”Bufãr
.
QuadP¬t
 != 0) )

246 
LARGE_INTEGER
 
cu¼’tTime
;

247 
LARGE_INTEGER
 
–­£dTime
;

248 
by‹sPÏyed
;

249 
by‹sEx³ùed
;

250 
bufãrsW¿µed
;

251 
	`Qu”yP”fÜmªûCouÁ”
Ğ&
cu¼’tTime
 );

252 
–­£dTime
.
QuadP¬t
 = 
cu¼’tTime
.QuadP¬ˆ- 
dsw
->
dsw_La¡PÏyTime
.QuadPart;

253 
dsw
->
dsw_La¡PÏyTime
 = 
cu¼’tTime
;

255 
by‹sPÏyed
 = 
¶ayCursÜ
 - 
dsw
->
dsw_La¡PÏyCursÜ
;

256 ifĞ
by‹sPÏyed
 < 0 ) by‹sPÏyed +ğ
dsw
->
dsw_OuutSize
;

257 
dsw
->
dsw_La¡PÏyCursÜ
 = 
¶ayCursÜ
;

259 
by‹sEx³ùed
 = (è((
–­£dTime
.
QuadP¬t
 * 
dsw
->
dsw_OuutSize
è/ dsw->
dsw_CouÁ”TicksP”Bufãr
.QuadPart);

260 
bufãrsW¿µed
 = (
by‹sEx³ùed
 - 
by‹sPÏyed
è/ 
dsw
->
dsw_OuutSize
;

261 ifĞ
bufãrsW¿µed
 > 0 )

263 
	`AddT¿ûMes§ge
("¶ayCursÜ w¿µed! by‹sPÏyed", 
by‹sPÏyed
 );

264 
	`AddT¿ûMes§ge
("¶ayCursÜ w¿µed! by‹sEx³ùed", 
by‹sEx³ùed
 );

265 
¶ayCursÜ
 +ğ(
bufãrsW¿µed
 * 
dsw
->
dsw_OuutSize
);

266 
by‹sPÏyed
 +ğ(
bufãrsW¿µed
 * 
dsw
->
dsw_OuutSize
);

269 
dsw
->
dsw_F¿mesPÏyed
 +ğ(
by‹sPÏyed
 / dsw->
dsw_By‹sP”F¿me
);

271 
numBy‹sEm±y
 = 
¶ayCursÜ
 - 
dsw
->
dsw_Wr™eOff£t
;

272 ifĞ
numBy‹sEm±y
 < 0 )‚umBy‹sEm±y +ğ
dsw
->
dsw_OuutSize
;

274 ifĞ
numBy‹sEm±y
 > (
dsw
->
dsw_OuutSize
 - 
¶ayWr™eG­
) )

276 ifĞ
dsw
->
dsw_OuutRuÂšg
 )

278 
dsw
->
dsw_OuutUnd”æows
 += 1;

279 
	`AddT¿ûMes§ge
("und”æow d‘eùed!‚umBy‹sEm±y", 
numBy‹sEm±y
 );

281 
dsw
->
dsw_Wr™eOff£t
 = 
wr™eCursÜ
;

282 
numBy‹sEm±y
 = 
dsw
->
dsw_OuutSize
 - 
¶ayWr™eG­
;

284 *
by‹sEm±y
 = 
numBy‹sEm±y
;

285  
hr
;

286 
	}
}

289 
HRESULT
 
	$DSW_Z”oEm±yS·û
Ğ
DSoundW¿µ”
 *
dsw
 )

291 
HRESULT
 
hr
;

292 
LPBYTE
 
Íbuf1
 = 
NULL
;

293 
LPBYTE
 
Íbuf2
 = 
NULL
;

294 
DWORD
 
dwsize1
 = 0;

295 
DWORD
 
dwsize2
 = 0;

296 
by‹sEm±y
;

297 
hr
 = 
	`DSW_Qu”yOuutS·û
Ğ
dsw
, &
by‹sEm±y
 );

298 ià(
hr
 !ğ
DS_OK
)  hr;

299 ifĞ
by‹sEm±y
 =ğ0 )  
DS_OK
;

301 
hr
 = 
	`IDœeùSoundBufãr_Lock
Ğ
dsw
->
dsw_OuutBufãr
, dsw->
dsw_Wr™eOff£t
, 
by‹sEm±y
, (**è&
Íbuf1
, &
dwsize1
,

302 (**è&
Íbuf2
, &
dwsize2
, 0);

303 ià(
hr
 =ğ
DS_OK
)

306 
	`Z”oMemÜy
(
Íbuf1
, 
dwsize1
);

307 if(
Íbuf2
 !ğ
NULL
)

309 
	`Z”oMemÜy
(
Íbuf2
, 
dwsize2
);

312 
dsw
->
dsw_Wr™eOff£t
 = (dsw->dsw_Wr™eOff£ˆ+ 
dwsize1
 + 
dwsize2
è% dsw->
dsw_OuutSize
;

313 
	`IDœeùSoundBufãr_UÆock
Ğ
dsw
->
dsw_OuutBufãr
, 
Íbuf1
, 
dwsize1
, 
Íbuf2
, 
dwsize2
);

314 
dsw
->
dsw_F¿mesWr™‹n
 +ğ
by‹sEm±y
 / dsw->
dsw_By‹sP”F¿me
;

316  
hr
;

317 
	}
}

320 
HRESULT
 
	$DSW_Wr™eBlock
Ğ
DSoundW¿µ”
 *
dsw
, *
buf
, 
numBy‹s
 )

322 
HRESULT
 
hr
;

323 
LPBYTE
 
Íbuf1
 = 
NULL
;

324 
LPBYTE
 
Íbuf2
 = 
NULL
;

325 
DWORD
 
dwsize1
 = 0;

326 
DWORD
 
dwsize2
 = 0;

328 
hr
 = 
	`IDœeùSoundBufãr_Lock
Ğ
dsw
->
dsw_OuutBufãr
, dsw->
dsw_Wr™eOff£t
, 
numBy‹s
, (**è&
Íbuf1
, &
dwsize1
,

329 (**è&
Íbuf2
, &
dwsize2
, 0);

330 ià(
hr
 =ğ
DS_OK
)

333 
	`CİyMemÜy
(
Íbuf1
, 
buf
, 
dwsize1
);

334 if(
Íbuf2
 !ğ
NULL
)

336 
	`CİyMemÜy
(
Íbuf2
, 
buf
+
dwsize1
, 
dwsize2
);

339 
dsw
->
dsw_Wr™eOff£t
 = (dsw->dsw_Wr™eOff£ˆ+ 
dwsize1
 + 
dwsize2
è% dsw->
dsw_OuutSize
;

340 
	`IDœeùSoundBufãr_UÆock
Ğ
dsw
->
dsw_OuutBufãr
, 
Íbuf1
, 
dwsize1
, 
Íbuf2
, 
dwsize2
);

341 
dsw
->
dsw_F¿mesWr™‹n
 +ğ
numBy‹s
 / dsw->
dsw_By‹sP”F¿me
;

343  
hr
;

344 
	}
}

347 
DWORD
 
	$DSW_G‘OuutStus
Ğ
DSoundW¿µ”
 *
dsw
 )

349 
DWORD
 
¡©us
;

350 ià(
	`IDœeùSoundBufãr_G‘Stus
Ğ
dsw
->
dsw_OuutBufãr
, &
¡©us
 ) !ğ
DS_OK
)

351 Ğ
DSERR_INVALIDPARAM
 );

353 Ğ
¡©us
 );

354 
	}
}

356 #ià
SUPPORT_AUDIO_CAPTURE


362 
HRESULT
 
	$DSW_In™IÅutDeviû
Ğ
DSoundW¿µ”
 *
dsw
, 
LPGUID
 
ÍGUID
 )

364 
HRESULT
 
hr
 = 
	`DœeùSoundC­tu»C»©e
Ğ
ÍGUID
, &
dsw
->
dsw_pDœeùSoundC­tu»
, 
NULL
 );

365 ifĞ
hr
 !ğ
DS_OK
 )  hr;

366  
hr
;

367 
	}
}

369 
HRESULT
 
	$DSW_In™IÅutBufãr
Ğ
DSoundW¿µ”
 *
dsw
, 
nF¿meR©e
, 
nChªÃls
, 
by‹sP”Bufãr
 )

371 
DSCBUFFERDESC
 
ÿ±u»Desc
;

372 
WAVEFORMATEX
 
wfFÜm©
;

373 
HRESULT
 
»suÉ
;

375 
wfFÜm©
.
wFÜm©Tag
 = 
WAVE_FORMAT_PCM
;

376 
wfFÜm©
.
nChªÃls
 =‚Channels;

377 
wfFÜm©
.
nSam¶esP”Sec
 = 
nF¿meR©e
;

378 
wfFÜm©
.
wB™sP”Sam¶e
 = 8 * ();

379 
wfFÜm©
.
nBlockAlign
 = wfFÜm©.
nChªÃls
 * (wfFÜm©.
wB™sP”Sam¶e
 / 8);

380 
wfFÜm©
.
nAvgBy‹sP”Sec
 = wfFÜm©.
nSam¶esP”Sec
 * wfFÜm©.
nBlockAlign
;

381 
wfFÜm©
.
cbSize
 = 0;

382 
dsw
->
dsw_IÅutSize
 = 
by‹sP”Bufãr
;

385 
	`Z”oMemÜy
(&
ÿ±u»Desc
, (
DSCBUFFERDESC
));

386 
ÿ±u»Desc
.
dwSize
 = (
DSCBUFFERDESC
);

387 
ÿ±u»Desc
.
dwFÏgs
 = 0;

388 
ÿ±u»Desc
.
dwBufãrBy‹s
 = 
by‹sP”Bufãr
;

389 
ÿ±u»Desc
.
ÍwfxFÜm©
 = &
wfFÜm©
;

391 ià((
»suÉ
 = 
	`IDœeùSoundC­tu»_C»©eC­tu»Bufãr
Ğ
dsw
->
dsw_pDœeùSoundC­tu»
,

392 &
ÿ±u»Desc
, &
dsw
->
dsw_IÅutBufãr
, 
NULL
)è!ğ
DS_OK
è 
»suÉ
;

393 
dsw
->
dsw_R—dOff£t
 = 0;

394  
DS_OK
;

395 
	}
}

398 
HRESULT
 
	$DSW_S¹IÅut
Ğ
DSoundW¿µ”
 *
dsw
 )

401 ifĞ
dsw
->
dsw_IÅutBufãr
 !ğ
NULL
 )

403  
	`IDœeùSoundC­tu»Bufãr_S¹
Ğ
dsw
->
dsw_IÅutBufãr
, 
DSCBSTART_LOOPING
 );

406 
	}
}

409 
HRESULT
 
	$DSW_StİIÅut
Ğ
DSoundW¿µ”
 *
dsw
 )

412 ifĞ
dsw
->
dsw_IÅutBufãr
 !ğ
NULL
 )

414  
	`IDœeùSoundC­tu»Bufãr_Stİ
Ğ
dsw
->
dsw_IÅutBufãr
 );

417 
	}
}

420 
HRESULT
 
	$DSW_Qu”yIÅutFËd
Ğ
DSoundW¿µ”
 *
dsw
, *
by‹sFËd
 )

422 
HRESULT
 
hr
;

423 
DWORD
 
ÿ±u»Pos
;

424 
DWORD
 
»adPos
;

425 
fËd
;

429 
hr
 = 
	`IDœeùSoundC­tu»Bufãr_G‘Cu¼’tPos™iÚ
Ğ
dsw
->
dsw_IÅutBufãr
, &
ÿ±u»Pos
, &
»adPos
 );

430 ifĞ
hr
 !ğ
DS_OK
 )

432  
hr
;

434 
fËd
 = 
»adPos
 - 
dsw
->
dsw_R—dOff£t
;

435 ifĞ
fËd
 < 0 ) fËd +ğ
dsw
->
dsw_IÅutSize
;

436 *
by‹sFËd
 = 
fËd
;

437  
hr
;

438 
	}
}

441 
HRESULT
 
	$DSW_R—dBlock
Ğ
DSoundW¿µ”
 *
dsw
, *
buf
, 
numBy‹s
 )

443 
HRESULT
 
hr
;

444 
LPBYTE
 
Íbuf1
 = 
NULL
;

445 
LPBYTE
 
Íbuf2
 = 
NULL
;

446 
DWORD
 
dwsize1
 = 0;

447 
DWORD
 
dwsize2
 = 0;

449 
hr
 = 
	`IDœeùSoundC­tu»Bufãr_Lock
 ( 
dsw
->
dsw_IÅutBufãr
, dsw->
dsw_R—dOff£t
, 
numBy‹s
, (**è&
Íbuf1
, &
dwsize1
,

450 (**è&
Íbuf2
, &
dwsize2
, 0);

451 ià(
hr
 =ğ
DS_OK
)

454 
	`CİyMemÜy
Ğ
buf
, 
Íbuf1
, 
dwsize1
);

455 if(
Íbuf2
 !ğ
NULL
)

457 
	`CİyMemÜy
Ğ
buf
+
dwsize1
, 
Íbuf2
, 
dwsize2
);

460 
dsw
->
dsw_R—dOff£t
 = (dsw->dsw_R—dOff£ˆ+ 
dwsize1
 + 
dwsize2
è% dsw->
dsw_IÅutSize
;

461 
	`IDœeùSoundC­tu»Bufãr_UÆock
 ( 
dsw
->
dsw_IÅutBufãr
, 
Íbuf1
, 
dwsize1
, 
Íbuf2
, 
dwsize2
);

463  
hr
;

464 
	}
}

	@portaudio/pa_win_ds/dsound_wrapper.h

1 #iâdeà
__DSOUND_WRAPPER_H


2 
	#__DSOUND_WRAPPER_H


	)

38 
	~<DSound.h
>

39 #ià!
defšed
(
BOOL
)

40 
	#BOOL
 

	)

42 #iâdeà
SUPPORT_AUDIO_CAPTURE


43 
	#SUPPORT_AUDIO_CAPTURE
 (1)

	)

46 #ifdeà
__ılu¥lus


51 
	#DSW_NUM_POSITIONS
 (4)

	)

52 
	#DSW_NUM_EVENTS
 (5)

	)

53 
	#DSW_TERMINATION_EVENT
 (
DSW_NUM_POSITIONS
)

	)

58 
LPDIRECTSOUND
 
dsw_pDœeùSound
;

59 
LPDIRECTSOUNDBUFFER
 
dsw_OuutBufãr
;

60 
DWORD
 
dsw_Wr™eOff£t
;

61 
INT
 
dsw_OuutSize
;

62 
INT
 
dsw_By‹sP”F¿me
;

64 
LARGE_INTEGER
 
dsw_CouÁ”TicksP”Bufãr
;

65 
LARGE_INTEGER
 
dsw_La¡PÏyTime
;

66 
UINT
 
dsw_La¡PÏyCursÜ
;

67 
UINT
 
dsw_OuutUnd”æows
;

68 
BOOL
 
dsw_OuutRuÂšg
;

70 
dsw_F¿mesWr™‹n
;

71 
dsw_F¿mesPÏyed
;

72 #ià
SUPPORT_AUDIO_CAPTURE


74 
LPDIRECTSOUNDCAPTURE
 
dsw_pDœeùSoundC­tu»
;

75 
LPDIRECTSOUNDCAPTUREBUFFER
 
dsw_IÅutBufãr
;

76 
UINT
 
dsw_R—dOff£t
;

77 
UINT
 
dsw_IÅutSize
;

81 
	tDSoundW¿µ”
;

82 
HRESULT
 
DSW_In™
Ğ
DSoundW¿µ”
 *
dsw
 );

83 
DSW_T”m
Ğ
DSoundW¿µ”
 *
dsw
 );

84 
HRESULT
 
DSW_In™OuutBufãr
Ğ
DSoundW¿µ”
 *
dsw
, 
nF¿meR©e
,

85 
nChªÃls
, 
bufSize
 );

86 
HRESULT
 
DSW_S¹Ouut
Ğ
DSoundW¿µ”
 *
dsw
 );

87 
HRESULT
 
DSW_StİOuut
Ğ
DSoundW¿µ”
 *
dsw
 );

88 
DWORD
 
DSW_G‘OuutStus
Ğ
DSoundW¿µ”
 *
dsw
 );

89 
HRESULT
 
DSW_Wr™eBlock
Ğ
DSoundW¿µ”
 *
dsw
, *
buf
, 
numBy‹s
 );

90 
HRESULT
 
DSW_Z”oEm±yS·û
Ğ
DSoundW¿µ”
 *
dsw
 );

91 
HRESULT
 
DSW_Qu”yOuutS·û
Ğ
DSoundW¿µ”
 *
dsw
, *
by‹sEm±y
 );

92 
HRESULT
 
DSW_Enum”©e
Ğ
DSoundW¿µ”
 *
dsw
 );

94 #ià
SUPPORT_AUDIO_CAPTURE


95 
HRESULT
 
DSW_In™IÅutBufãr
Ğ
DSoundW¿µ”
 *
dsw
, 
nF¿meR©e
,

96 
nChªÃls
, 
bufSize
 );

97 
HRESULT
 
DSW_S¹IÅut
Ğ
DSoundW¿µ”
 *
dsw
 );

98 
HRESULT
 
DSW_StİIÅut
Ğ
DSoundW¿µ”
 *
dsw
 );

99 
HRESULT
 
DSW_R—dBlock
Ğ
DSoundW¿µ”
 *
dsw
, *
buf
, 
numBy‹s
 );

100 
HRESULT
 
DSW_Qu”yIÅutFËd
Ğ
DSoundW¿µ”
 *
dsw
, *
by‹sFËd
 );

103 #ifdeà
__ılu¥lus


	@portaudio/pa_win_ds/pa_dsound.c

42 
	~<¡dio.h
>

43 
	~<¡dlib.h
>

44 #iâdeà
__MWERKS__


45 
	~<m®loc.h
>

46 
	~<memÜy.h
>

48 
	~<m©h.h
>

49 
	~"pÜudio.h
"

50 
	~"·_ho¡.h
"

51 
	~"·_Œaû.h
"

52 
	~"dsound_w¿µ”.h
"

54 
	#PRINT
(
x
è{ 
´štf
 x; 
	`fæush
(
¡dout
); }

	)

55 
	#ERR_RPT
(
x
è
	`PRINT
(x)

	)

56 
	#DBUG
(
x
è

	)

57 
	#DBUGX
(
x
è

	)

59 
	#PA_USE_HIGH_LATENCY
 (0)

	)

60 #ià
PA_USE_HIGH_LATENCY


61 
	#PA_WIN_9X_LATENCY
 (500)

	)

62 
	#PA_WIN_NT_LATENCY
 (600)

	)

64 
	#PA_WIN_9X_LATENCY
 (140)

	)

65 
	#PA_WIN_NT_LATENCY
 (280)

	)

68 
	#PA_WIN_WDM_LATENCY
 (120)

	)

71 
	#PA_SIMULATE_UNDERFLOW
 (0)

	)

72 #ià
PA_SIMULATE_UNDERFLOW


73 
	ggUnd”C®lbackCouÁ”
 = 0;

74 
	#UNDER_START_GAP
 (10)

	)

75 
	#UNDER_STOP_GAP
 (
UNDER_START_GAP
 + 4)

	)

79 
š‹º®PÜtAudioSŒ—m
 
	tš‹º®PÜtAudioSŒ—m
;

80 
	sš‹º®PÜtAudioDeviû


82 
GUID
 
	m·d_GUID
;

83 
GUID
 *
	m·d_ÍGUID
;

84 
	m·d_Sam¶eR©es
[10];

85 
PaDeviûInfo
 
	m·d_Info
;

87 
	tš‹º®PÜtAudioDeviû
;

90 
	sPaHo¡SoundCÚŒŞ


92 
DSoundW¿µ”
 
	m·hsc_DSoundW¿µ”
;

93 
MMRESULT
 
	m·hsc_Tim”ID
;

94 
BOOL
 
	m·hsc_IfInsideC®lback
;

95 *
	m·hsc_N©iveBufãr
;

96 
	m·hsc_By‹sP”Bufãr
;

97 
	m·hsc_V®idF¿mesWr™‹n
;

98 
	m·hsc_F¿mesP”DSBufãr
;

100 
LARGE_INTEGER
 
	m·hsc_EÁryCouÁ
;

101 
	m·hsc_Inv”£TicksP”U£rBufãr
;

103 
	tPaHo¡SoundCÚŒŞ
;

107 
	gsNumDeviûs
 = 0;

108 
	gsDeviûIndex
 = 0;

109 
š‹º®PÜtAudioDeviû
 *
	gsDeviûs
 = 
NULL
;

110 
	gsDeçuÉIÅutDeviûID
 = 
·NoDeviû
;

111 
	gsDeçuÉOuutDeviûID
 = 
·NoDeviû
;

112 
	gsEnum”©iÚE¼Ü
;

113 
	gsPaHo¡E¼Ü
 = 0;

115 
š‹º®PÜtAudioDeviû
 *
Pa_G‘IÁ”ÇlDeviû
Ğ
PaDeviûID
 
id
 );

116 
BOOL
 
CALLBACK
 
Pa_EnumProc
(
LPGUID
 
ÍGUID
,

117 
LPCTSTR
 
ÍszDesc
,

118 
LPCTSTR
 
ÍszDrvName
,

119 
LPVOID
 
ÍCÚ‹xt
 );

120 
BOOL
 
CALLBACK
 
Pa_CouÁDevProc
(
LPGUID
 
ÍGUID
,

121 
LPCTSTR
 
ÍszDesc
,

122 
LPCTSTR
 
ÍszDrvName
,

123 
LPVOID
 
ÍCÚ‹xt
 );

124 
Pa_Qu”yDeviûs
( );

125 
CALLBACK
 
Pa_Tim”C®lback
(
UINT
 
uID
, UINT 
uMsg
,

126 
DWORD
 
dwU£r
, DWORD 
dw1
, DWORD 
dw2
);

129 
	$Pa_S¹U§geC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

131 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

132 ifĞ
·hsc
 =ğ
NULL
 ) ;

134 
	`Qu”yP”fÜmªûCouÁ”
Ğ&
·hsc
->
·hsc_EÁryCouÁ
 );

135 
	}
}

137 
	$Pa_EndU§geC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

139 
LARGE_INTEGER
 
Cu¼’tCouÁ
 = { 0, 0 };

140 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

141 ifĞ
·hsc
 =ğ
NULL
 ) ;

146 
	#LOWPASS_COEFFICIENT_0
 (0.9)

	)

147 
	#LOWPASS_COEFFICIENT_1
 (0.99999 - 
LOWPASS_COEFFICIENT_0
)

	)

148 ifĞ
	`Qu”yP”fÜmªûCouÁ”
Ğ&
Cu¼’tCouÁ
 ) )

150 
LONGLONG
 
InsideCouÁ
 = 
Cu¼’tCouÁ
.
QuadP¬t
 - 
·hsc
->
·hsc_EÁryCouÁ
.QuadPart;

151 
ÃwU§ge
 = 
InsideCouÁ
 * 
·hsc
->
·hsc_Inv”£TicksP”U£rBufãr
;

152 
·¡
->
·¡_U§ge
 = (
LOWPASS_COEFFICIENT_0
 *…ast->past_Usage) +

153 (
LOWPASS_COEFFICIENT_1
 * 
ÃwU§ge
);

155 
	}
}

158 
PaE¼Ü
 
	$Pa_Qu”yDeviûs
( )

160 
numBy‹s
;

161 
sDeçuÉIÅutDeviûID
 = 
·NoDeviû
;

162 
sDeçuÉOuutDeviûID
 = 
·NoDeviû
;

164 
sNumDeviûs
 = 0;

165 
	`DœeùSoundEnum”©e
Ğ(
LPDSENUMCALLBACK
)
Pa_CouÁDevProc
, 
NULL
 );

166 #ià
SUPPORT_AUDIO_CAPTURE


167 
	`DœeùSoundC­tu»Enum”©e
Ğ(
LPDSENUMCALLBACK
)
Pa_CouÁDevProc
, 
NULL
 );

170 
numBy‹s
 = 
sNumDeviûs
 * (
š‹º®PÜtAudioDeviû
);

171 
sDeviûs
 = (
š‹º®PÜtAudioDeviû
 *)
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ
numBy‹s
 );

172 ifĞ
sDeviûs
 =ğ
NULL
 )  
·Insuffic›ÁMemÜy
;

174 
sDeviûIndex
 = 0;

175 
sEnum”©iÚE¼Ü
 = 0;

176 
	`DœeùSoundEnum”©e
Ğ(
LPDSENUMCALLBACK
)
Pa_EnumProc
, (*)0 );

177 #ià
SUPPORT_AUDIO_CAPTURE


178 ifĞ
sEnum”©iÚE¼Ü
 !ğ
·NoE¼Ü
 )  sEnumerationError;

179 
sEnum”©iÚE¼Ü
 = 0;

180 
	`DœeùSoundC­tu»Enum”©e
Ğ(
LPDSENUMCALLBACK
)
Pa_EnumProc
, (*)1 );

182  
sEnum”©iÚE¼Ü
;

183 
	}
}

185 
	$Pa_G‘Ho¡E¼Ü
()

187  
sPaHo¡E¼Ü
;

188 
	}
}

192 
BOOL
 
CALLBACK
 
	$Pa_CouÁDevProc
(
LPGUID
 
ÍGUID
,

193 
LPCTSTR
 
ÍszDesc
,

194 
LPCTSTR
 
ÍszDrvName
,

195 
LPVOID
 
ÍCÚ‹xt
 )

197 
sNumDeviûs
++;

198  
TRUE
;

199 
	}
}

203 
BOOL
 
CALLBACK
 
	$Pa_EnumProc
(
LPGUID
 
ÍGUID
,

204 
LPCTSTR
 
ÍszDesc
,

205 
LPCTSTR
 
ÍszDrvName
,

206 
LPVOID
 
ÍCÚ‹xt
 )

208 
HRESULT
 
hr
;

209 
LPDIRECTSOUND
 
ÍDœeùSound
;

210 #ià
SUPPORT_AUDIO_CAPTURE


211 
LPDIRECTSOUNDCAPTURE
 
ÍDœeùSoundC­tu»
;

213 
isIÅut
 = (è
ÍCÚ‹xt
;

214 
š‹º®PÜtAudioDeviû
 *
·d
;

216 ifĞ
sDeviûIndex
 >ğ
sNumDeviûs
 )

218 
sEnum”©iÚE¼Ü
 = 
·IÁ”ÇlE¼Ü
;

219  
FALSE
;

221 
·d
 = &
sDeviûs
[
sDeviûIndex
];

223 ifĞ
ÍGUID
 =ğ
NULL
 )

225 
·d
->
·d_ÍGUID
 = 
NULL
;

229 
	`memıy
Ğ&
·d
->
·d_GUID
, 
ÍGUID
, (
GUID
) );

230 
·d
->
·d_ÍGUID
 = &·d->
·d_GUID
;

232 
·d
->
·d_Info
.
§m¶eR©es
 =…ad->
·d_Sam¶eR©es
;

234 ifĞ
ÍszDesc
 !ğ
NULL
 )

236 
Ën
 = 
	`¡¾’
(
ÍszDesc
);

237 
·d
->
·d_Info
.
Çme
 = (*)
	`m®loc
Ğ
Ën
+1 );

238 ifĞ
·d
->
·d_Info
.
Çme
 =ğ
NULL
 )

240 
sEnum”©iÚE¼Ü
 = 
·Insuffic›ÁMemÜy
;

241  
FALSE
;

243 
	`memıy
Ğ(*è
·d
->
·d_Info
.
Çme
, 
ÍszDesc
, 
Ën
+1 );

245 #ià
SUPPORT_AUDIO_CAPTURE


246 ifĞ
isIÅut
 )

249 
DSCCAPS
 
ÿps
;

250 ifĞ
ÍGUID
 =ğ
NULL
 ) 
sDeçuÉIÅutDeviûID
 = 
sDeviûIndex
;

251 
hr
 = 
	`DœeùSoundC­tu»C»©e
Ğ
ÍGUID
, &
ÍDœeùSoundC­tu»
, 
NULL
 );

252 ifĞ
hr
 !ğ
DS_OK
 )

254 
·d
->
·d_Info
.
maxIÅutChªÃls
 = 0;

255 
	`DBUG
(("CªnÙ c»©C­tu» fÜ %s. ResuÉ = 0x%x\n", 
ÍszDesc
, 
hr
 ));

260 
ÿps
.
dwSize
 = (caps);

261 
	`IDœeùSoundC­tu»_G‘C­s
Ğ
ÍDœeùSoundC­tu»
, &
ÿps
 );

263 
·d
->
·d_Info
.
maxIÅutChªÃls
 = 
ÿps
.
dwChªÃls
;

265 ifĞ
ÿps
.
dwChªÃls
 == 2 )

267 
šdex
 = 0;

268 ifĞ
ÿps
.
dwFÜm©s
 & 
WAVE_FORMAT_1S16
è
·d
->
·d_Sam¶eR©es
[
šdex
++] = 11025.0;

269 ifĞ
ÿps
.
dwFÜm©s
 & 
WAVE_FORMAT_2S16
è
·d
->
·d_Sam¶eR©es
[
šdex
++] = 22050.0;

270 ifĞ
ÿps
.
dwFÜm©s
 & 
WAVE_FORMAT_4S16
è
·d
->
·d_Sam¶eR©es
[
šdex
++] = 44100.0;

271 
·d
->
·d_Info
.
numSam¶eR©es
 = 
šdex
;

273 ifĞ
ÿps
.
dwChªÃls
 == 1 )

275 
šdex
 = 0;

276 ifĞ
ÿps
.
dwFÜm©s
 & 
WAVE_FORMAT_1M16
è
·d
->
·d_Sam¶eR©es
[
šdex
++] = 11025.0;

277 ifĞ
ÿps
.
dwFÜm©s
 & 
WAVE_FORMAT_2M16
è
·d
->
·d_Sam¶eR©es
[
šdex
++] = 22050.0;

278 ifĞ
ÿps
.
dwFÜm©s
 & 
WAVE_FORMAT_4M16
è
·d
->
·d_Sam¶eR©es
[
šdex
++] = 44100.0;

279 
·d
->
·d_Info
.
numSam¶eR©es
 = 
šdex
;

281 
·d
->
·d_Info
.
numSam¶eR©es
 = 0;

282 
	`IDœeùSoundC­tu»_R–—£
Ğ
ÍDœeùSoundC­tu»
 );

290 
DSCAPS
 
ÿps
;

291 ifĞ
ÍGUID
 =ğ
NULL
 ) 
sDeçuÉOuutDeviûID
 = 
sDeviûIndex
;

293 
hr
 = 
	`DœeùSoundC»©e
Ğ
ÍGUID
, &
ÍDœeùSound
, 
NULL
 );

294 ifĞ
hr
 !ğ
DS_OK
 )

296 
·d
->
·d_Info
.
maxOuutChªÃls
 = 0;

297 
	`DBUG
(("CªnÙ c»©dsound fÜ %s. ResuÉ = 0x%x\n", 
ÍszDesc
, 
hr
 ));

302 
ÿps
.
dwSize
 = (caps);

303 
	`IDœeùSound_G‘C­s
Ğ
ÍDœeùSound
, &
ÿps
 );

304 
·d
->
·d_Info
.
maxOuutChªÃls
 = ( 
ÿps
.
dwFÏgs
 & 
DSCAPS_PRIMARYSTEREO
 ) ? 2 : 1;

306 
·d
->
·d_Sam¶eR©es
[0] = (è
ÿps
.
dwMšSecÚd¬ySam¶eR©e
;

307 
·d
->
·d_Sam¶eR©es
[1] = (è
ÿps
.
dwMaxSecÚd¬ySam¶eR©e
;

308 ifĞ
ÿps
.
dwFÏgs
 & 
DSCAPS_CONTINUOUSRATE
 ) 
·d
->
·d_Info
.
numSam¶eR©es
 = -1;

309 ifĞ
ÿps
.
dwMšSecÚd¬ySam¶eR©e
 =ğÿps.
dwMaxSecÚd¬ySam¶eR©e
 )

311 ifĞ
ÿps
.
dwMšSecÚd¬ySam¶eR©e
 == 0 )

318 
·d
->
·d_Sam¶eR©es
[0] = 11025.0f;

319 
·d
->
·d_Sam¶eR©es
[1] = 48000.0f;

320 
·d
->
·d_Info
.
numSam¶eR©es
 = -1;

322 
	`DBUG
(("PA - R•Ü‹d„©e bÙh z”o. S‘tšgØçkv®ue fÜ deviû #%d\n", 
sDeviûIndex
 ));

326 
·d
->
·d_Info
.
numSam¶eR©es
 = 1;

329 ifĞ(
ÿps
.
dwMšSecÚd¬ySam¶eR©e
 < 1000.0è&& (ÿps.
dwMaxSecÚd¬ySam¶eR©e
 > 50000.0) )

335 
·d
->
·d_Info
.
numSam¶eR©es
 = -1;

336 
	`DBUG
(("PA - Sam¶¿‹„ªgu£d in¡—d oàtwØodd v®ue fÜ deviû #%d\n", 
sDeviûIndex
 ));

338 
·d
->
·d_Info
.
numSam¶eR©es
 = 2;

339 
	`IDœeùSound_R–—£
Ğ
ÍDœeùSound
 );

342 
·d
->
·d_Info
.
ÇtiveSam¶eFÜm©s
 = 
·IÁ16
;

343 
sDeviûIndex
++;

344 Ğ
TRUE
 );

345 
	}
}

347 
	$Pa_CouÁDeviûs
()

349 ifĞ
sNumDeviûs
 <ğ0 ) 
	`Pa_In™Ÿlize
();

350  
sNumDeviûs
;

351 
	}
}

352 
š‹º®PÜtAudioDeviû
 *
	$Pa_G‘IÁ”ÇlDeviû
Ğ
PaDeviûID
 
id
 )

354 ifĞ(
id
 < 0è|| ( id >ğ
	`Pa_CouÁDeviûs
()èè 
NULL
;

355  &
sDeviûs
[
id
];

356 
	}
}

358 cÚ¡ 
PaDeviûInfo
* 
	$Pa_G‘DeviûInfo
Ğ
PaDeviûID
 
id
 )

360 
š‹º®PÜtAudioDeviû
 *
·d
;

361 ifĞ(
id
 < 0è|| ( id >ğ
	`Pa_CouÁDeviûs
()èè 
NULL
;

362 
·d
 = 
	`Pa_G‘IÁ”ÇlDeviû
Ğ
id
 );

363  &
·d
->
·d_Info
 ;

364 
	}
}

365 
PaE¼Ü
 
	$Pa_MaybeQu”yDeviûs
( )

367 ifĞ
sNumDeviûs
 == 0 )

369  
	`Pa_Qu”yDeviûs
();

372 
	}
}

383 
	#PA_ENV_BUF_SIZE
 (32)

	)

384 
	#PA_REC_IN_DEV_ENV_NAME
 ("PA_RECOMMENDED_INPUT_DEVICE")

	)

385 
	#PA_REC_OUT_DEV_ENV_NAME
 ("PA_RECOMMENDED_OUTPUT_DEVICE")

	)

386 
PaDeviûID
 
	$PaHo¡_G‘EnvDeçuÉDeviûID
Ğ*
’vName
 )

388 
DWORD
 
h»suÉ
;

389 
’vbuf
[
PA_ENV_BUF_SIZE
];

390 
PaDeviûID
 
»comm’dedID
 = 
·NoDeviû
;

392 
h»suÉ
 = 
	`G‘EnvœÚm’tV¬ŸbË
Ğ
’vName
, 
’vbuf
, 
PA_ENV_BUF_SIZE
 );

393 ifĞ(
h»suÉ
 > 0è&& (h»suÉ < 
PA_ENV_BUF_SIZE
) )

395 
»comm’dedID
 = 
	`©oi
Ğ
’vbuf
 );

397  
»comm’dedID
;

398 
	}
}

399 
PaDeviûID
 
	$Pa_G‘DeçuÉIÅutDeviûID
( )

401 
PaE¼Ü
 
»suÉ
;

402 
»suÉ
 = 
	`PaHo¡_G‘EnvDeçuÉDeviûID
Ğ
PA_REC_IN_DEV_ENV_NAME
 );

403 ifĞ
»suÉ
 < 0 )

405 
»suÉ
 = 
	`Pa_MaybeQu”yDeviûs
();

406 ifĞ
»suÉ
 < 0 ) „esult;

407 
»suÉ
 = 
sDeçuÉIÅutDeviûID
;

409  
»suÉ
;

410 
	}
}

411 
PaDeviûID
 
	$Pa_G‘DeçuÉOuutDeviûID
( )

413 
PaE¼Ü
 
»suÉ
;

414 
»suÉ
 = 
	`PaHo¡_G‘EnvDeçuÉDeviûID
Ğ
PA_REC_OUT_DEV_ENV_NAME
 );

415 ifĞ
»suÉ
 < 0 )

417 
»suÉ
 = 
	`Pa_MaybeQu”yDeviûs
();

418 ifĞ
»suÉ
 < 0 ) „esult;

419 
»suÉ
 = 
sDeçuÉOuutDeviûID
;

421  
»suÉ
;

422 
	}
}

426 
PaE¼Ü
 
	$PaHo¡_In™
( )

428 #ià
PA_SIMULATE_UNDERFLOW


429 
	`PRINT
(("WARNING - Underflow Simulation Enabled - Expect‡ Big Glitch!!!\n"));

431  
	`Pa_MaybeQu”yDeviûs
();

432 
	}
}

433 
PaE¼Ü
 
	$Pa_TimeSliû
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

435 
PaE¼Ü
 
»suÉ
 = 0;

436 
by‹sEm±y
 = 0;

437 
by‹sFËd
 = 0;

438 
by‹sToXãr
 = 0;

439 
numChunks
;

440 
HRESULT
 
h»suÉ
;

441 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

442 *
ÇtiveBufPŒ
;

443 
·¡
->
·¡_NumC®lbacks
 += 1;

444 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

445 ifĞ
·hsc
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

447 #ià
SUPPORT_AUDIO_CAPTURE


448 ifĞ
·¡
->
·¡_NumIÅutChªÃls
 > 0 )

450 
	`DSW_Qu”yIÅutFËd
Ğ&
·hsc
->
·hsc_DSoundW¿µ”
, &
by‹sFËd
 );

451 
by‹sToXãr
 = 
by‹sFËd
;

455 ifĞ
·¡
->
·¡_NumOuutChªÃls
 > 0 )

457 
	`DSW_Qu”yOuutS·û
Ğ&
·hsc
->
·hsc_DSoundW¿µ”
, &
by‹sEm±y
 );

458 
by‹sToXãr
 = 
by‹sEm±y
;

460 
	`AddT¿ûMes§ge
Ğ"by‹sEm±y ", 
by‹sEm±y
 );

462 ifĞ(
·¡
->
·¡_NumIÅutChªÃls
 > 0è&& (·¡->
·¡_NumOuutChªÃls
 > 0) )

464 
by‹sToXãr
 = ( 
by‹sFËd
 < 
by‹sEm±y
 ) ? bytesFilled : bytesEmpty;

470 
numChunks
 = 
by‹sToXãr
 / 
·hsc
->
·hsc_By‹sP”Bufãr
;

471 ifĞ
numChunks
 > ()(
·¡
->
·¡_NumU£rBufãrs
/2) )

473 
numChunks
 = ()
·¡
->
·¡_NumU£rBufãrs
/2;

475 ifĞ
numChunks
 < 0 )

477 
numChunks
 = 0;

479 
	`AddT¿ûMes§ge
Ğ"numChunk ", 
numChunks
 );

480 
ÇtiveBufPŒ
 = 
·hsc
->
·hsc_N©iveBufãr
;

481 ifĞ
numChunks
 > 0 )

483  
numChunks
-- > 0 )

486 
	`Pa_S¹U§geC®cuÏtiÚ
Ğ
·¡
 );

487 #ià
SUPPORT_AUDIO_CAPTURE


489 ifĞ
·¡
->
·¡_NumIÅutChªÃls
 > 0 )

491 
h»suÉ
 = 
	`DSW_R—dBlock
Ğ&
·hsc
->
·hsc_DSoundW¿µ”
, (*è
ÇtiveBufPŒ
,…ahsc->
·hsc_By‹sP”Bufãr
 );

492 ifĞ
h»suÉ
 < 0 )

494 
	`ERR_RPT
(("DœeùSound R—dBlock faed, h»suÉ = 0x%x\n",
h»suÉ
));

495 
sPaHo¡E¼Ü
 = 
h»suÉ
;

501 
»suÉ
 = 
	`Pa_C®lCÚv”tIÁ16
Ğ
·¡
, 
ÇtiveBufPŒ
,‚ativeBufPtr );

502 ifĞ
»suÉ
 != 0) ;

504 ifĞ
·¡
->
·¡_NumOuutChªÃls
 > 0 )

509 
h»suÉ
 = 
	`DSW_Wr™eBlock
Ğ&
·hsc
->
·hsc_DSoundW¿µ”
, (*è
ÇtiveBufPŒ
,…ahsc->
·hsc_By‹sP”Bufãr
 );

510 ifĞ
h»suÉ
 < 0 )

512 
	`ERR_RPT
(("DœeùSound Wr™eBlock faed,„esuÉ = 0x%x\n",
h»suÉ
));

513 
sPaHo¡E¼Ü
 = 
h»suÉ
;

517 
	`Pa_EndU§geC®cuÏtiÚ
Ğ
·¡
 );

520  
»suÉ
;

521 
	}
}

523 
CALLBACK
 
	$Pa_Tim”C®lback
(
UINT
 
uID
, UINT 
uMsg
, 
DWORD
 
dwU£r
, DWORD 
dw1
, DWORD 
dw2
)

525 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

526 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

527 #ià
PA_SIMULATE_UNDERFLOW


528 
gUnd”C®lbackCouÁ”
++;

529 ifĞ(
gUnd”C®lbackCouÁ”
 >ğ
UNDER_START_GAP
) &&

530 (
gUnd”C®lbackCouÁ”
 <ğ
UNDER_STOP_GAP
) )

532 ifĞ
gUnd”C®lbackCouÁ”
 =ğ
UNDER_START_GAP
)

534 
	`AddT¿ûMes§ge
("Begš sÎ: gUnd”C®lbackCouÁ” =======", 
gUnd”C®lbackCouÁ”
 );

536 ifĞ
gUnd”C®lbackCouÁ”
 =ğ
UNDER_STOP_GAP
)

538 
	`AddT¿ûMes§ge
("End sÎ: gUnd”C®lbackCouÁ” =======", 
gUnd”C®lbackCouÁ”
 );

543 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
dwU£r
;

544 ifĞ
·¡
 =ğ
NULL
 ) ;

545 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

546 ifĞ
·hsc
 =ğ
NULL
 ) ;

547 ifĞ!
·hsc
->
·hsc_IfInsideC®lback
 && 
·¡
->
·¡_IsAùive
 )

549 ifĞ
·¡
->
·¡_StİNow
 )

551 
·¡
->
·¡_IsAùive
 = 0;

553 ifĞ
·¡
->
·¡_StİSoÚ
 )

555 
DSoundW¿µ”
 *
dsw
 = &
·hsc
->
·hsc_DSoundW¿µ”
;

556 ifĞ
·¡
->
·¡_NumOuutChªÃls
 > 0 )

558 
	`DSW_Z”oEm±yS·û
Ğ
dsw
 );

559 
	`AddT¿ûMes§ge
("Pa_Tim”C®lback: wa™šg - wr™‹À", (è
dsw
->
dsw_F¿mesWr™‹n
 );

560 
	`AddT¿ûMes§ge
("Pa_Tim”C®lback: wa™šg -…Ïyed ", (è
dsw
->
dsw_F¿mesPÏyed
 );

562 ifĞ
dsw
->
dsw_F¿mesPÏyed
 >ğ
·¡
->
·¡_F¿meCouÁ
 )

564 
·¡
->
·¡_IsAùive
 = 0;

569 
·¡
->
·¡_IsAùive
 = 0;

574 
·hsc
->
·hsc_IfInsideC®lback
 = 1;

575 ifĞ
	`Pa_TimeSliû
Ğ
·¡
 ) != 0)

577 
·¡
->
·¡_StİSoÚ
 = 1;

579 
·hsc
->
·hsc_IfInsideC®lback
 = 0;

582 
	}
}

584 
PaE¼Ü
 
	$PaHo¡_O³nSŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

586 
HRESULT
 
hr
;

587 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

588 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

589 
numBy‹s
, 
maxChªÃls
;

590 
mšNumBufãrs
;

591 
š‹º®PÜtAudioDeviû
 *
·d
;

592 
DSoundW¿µ”
 *
dsw
;

594 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
((PaHostSoundControl));

595 ifĞ
·hsc
 =ğ
NULL
 )

597 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

598 
”rÜ
;

600 
	`mem£t
Ğ
·hsc
, 0, (
PaHo¡SoundCÚŒŞ
) );

601 
·¡
->
·¡_DeviûD©a
 = (*è
·hsc
;

602 
·hsc
->
·hsc_Tim”ID
 = 0;

603 
dsw
 = &
·hsc
->
·hsc_DSoundW¿µ”
;

604 
	`DSW_In™
Ğ
dsw
 );

606 
maxChªÃls
 = ( 
·¡
->
·¡_NumOuutChªÃls
 >…a¡->
·¡_NumIÅutChªÃls
 ) ?

607 
·¡
->
·¡_NumOuutChªÃls
 :…a¡->
·¡_NumIÅutChªÃls
;

608 
·hsc
->
·hsc_By‹sP”Bufãr
 = 
·¡
->
·¡_F¿mesP”U£rBufãr
 * 
maxChªÃls
 * ();

609 ifĞ
maxChªÃls
 > 0 )

611 
·hsc
->
·hsc_N©iveBufãr
 = (*è
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
Õahsc->
·hsc_By‹sP”Bufãr
);

612 ifĞ
·hsc
->
·hsc_N©iveBufãr
 =ğ
NULL
 )

614 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

615 
”rÜ
;

620 
»suÉ
 = 
·Inv®idChªÃlCouÁ
;

621 
”rÜ
;

624 
	`DBUG
(("PaHo¡_O³nSŒ—m:…ahsc_MšF¿mesP”Ho¡Bufã¸ğ%d\n", 
·hsc
->
·hsc_MšF¿mesP”Ho¡Bufãr
 ));

625 
mšNumBufãrs
 = 
	`Pa_G‘MšNumBufãrs
Ğ
·¡
->
·¡_F¿mesP”U£rBufãr
,…a¡->
·¡_Sam¶eR©e
 );

626 
·¡
->
·¡_NumU£rBufãrs
 = ( 
mšNumBufãrs
 >…ast->past_NumUserBuffers ) ? minNumBuffers :…ast->past_NumUserBuffers;

627 
numBy‹s
 = 
·hsc
->
·hsc_By‹sP”Bufãr
 * 
·¡
->
·¡_NumU£rBufãrs
;

628 ifĞ
numBy‹s
 < 
DSBSIZE_MIN
 )

630 
»suÉ
 = 
·BufãrTooSm®l
;

631 
”rÜ
;

633 ifĞ
numBy‹s
 > 
DSBSIZE_MAX
 )

635 
»suÉ
 = 
·BufãrTooBig
;

636 
”rÜ
;

638 
·hsc
->
·hsc_F¿mesP”DSBufãr
 = 
·¡
->
·¡_F¿mesP”U£rBufãr
 *…a¡->
·¡_NumU£rBufãrs
;

640 
m£cL©’cy
 = (è((
·hsc
->
·hsc_F¿mesP”DSBufãr
 * 1000è/ 
·¡
->
·¡_Sam¶eR©e
);

641 
	`PRINT
(("PÜtAudiØÚ DœeùSound - L©’cy = %d f¿mes, %d m£c\n", 
·hsc
->
·hsc_F¿mesP”DSBufãr
, 
m£cL©’cy
 ));

644 ifĞ(
·¡
->
·¡_OuutDeviûID
 >ğ0è&& (·¡->
·¡_NumOuutChªÃls
 > 0) )

646 
	`DBUG
(("PaHo¡_O³nSŒ—m: deviûID = 0x%x\n", 
·¡
->
·¡_OuutDeviûID
));

647 
·d
 = 
	`Pa_G‘IÁ”ÇlDeviû
Ğ
·¡
->
·¡_OuutDeviûID
 );

648 
hr
 = 
	`DœeùSoundC»©e
Ğ
·d
->
·d_ÍGUID
, &
dsw
->
dsw_pDœeùSound
, 
NULL
 );

650 ifĞ
hr
 !ğ
DS_OK
 )

652 
i
;

653 
	`ERR_RPT
(("Creation of„equested Audio Output device '%s' failed.\n",

654 ((
·d
->
·d_ÍGUID
 =ğ
NULL
è? "DeçuÉ" :…ad->
·d_Info
.
Çme
) ));

655  
i
=0; i<
	`Pa_CouÁDeviûs
(); i++ )

657 
·d
 = 
	`Pa_G‘IÁ”ÇlDeviû
Ğ
i
 );

658 ifĞ
·d
->
·d_Info
.
maxOuutChªÃls
 >ğ
·¡
->
·¡_NumOuutChªÃls
 )

660 
	`DBUG
(("Try deviû '%s' in¡—d.\n", 
·d
->
·d_Info
.
Çme
 ));

661 
hr
 = 
	`DœeùSoundC»©e
Ğ
·d
->
·d_ÍGUID
, &
dsw
->
dsw_pDœeùSound
, 
NULL
 );

662 ifĞ
hr
 =ğ
DS_OK
 )

664 
	`ERR_RPT
(("Usšg deviû '%s' in¡—d.\n", 
·d
->
·d_Info
.
Çme
 ));

670 ifĞ
hr
 !ğ
DS_OK
 )

672 
	`ERR_RPT
(("PortAudio: DirectSoundCreate() failed!\n"));

673 
»suÉ
 = 
·Ho¡E¼Ü
;

674 
sPaHo¡E¼Ü
 = 
hr
;

675 
”rÜ
;

677 
hr
 = 
	`DSW_In™OuutBufãr
Ğ
dsw
,

678 (è(
·¡
->
·¡_Sam¶eR©e
 + 0.5),

679 
·¡
->
·¡_NumOuutChªÃls
, 
numBy‹s
 );

680 
	`DBUG
(("DSW_In™OuutBufãr(è»tuº %x\n", 
hr
));

681 ifĞ
hr
 !ğ
DS_OK
 )

683 
»suÉ
 = 
·Ho¡E¼Ü
;

684 
sPaHo¡E¼Ü
 = 
hr
;

685 
”rÜ
;

687 
·¡
->
·¡_F¿meCouÁ
 = 
·hsc
->
·hsc_DSoundW¿µ”
.
dsw_F¿mesWr™‹n
;

689 #ià
SUPPORT_AUDIO_CAPTURE


691 ifĞ(
·¡
->
·¡_IÅutDeviûID
 >ğ0è&& (·¡->
·¡_NumIÅutChªÃls
 > 0) )

693 
·d
 = 
	`Pa_G‘IÁ”ÇlDeviû
Ğ
·¡
->
·¡_IÅutDeviûID
 );

694 
hr
 = 
	`DœeùSoundC­tu»C»©e
Ğ
·d
->
·d_ÍGUID
, &
dsw
->
dsw_pDœeùSoundC­tu»
, 
NULL
 );

696 ifĞ
hr
 !ğ
DS_OK
 )

698 
i
;

699 
	`ERR_RPT
(("Creation of„equested Audio Capture device '%s' failed.\n",

700 ((
·d
->
·d_ÍGUID
 =ğ
NULL
è? "DeçuÉ" :…ad->
·d_Info
.
Çme
) ));

701  
i
=0; i<
	`Pa_CouÁDeviûs
(); i++ )

703 
·d
 = 
	`Pa_G‘IÁ”ÇlDeviû
Ğ
i
 );

704 ifĞ
·d
->
·d_Info
.
maxIÅutChªÃls
 >ğ
·¡
->
·¡_NumIÅutChªÃls
 )

706 
	`PRINT
(("Try deviû '%s' in¡—d.\n", 
·d
->
·d_Info
.
Çme
 ));

707 
hr
 = 
	`DœeùSoundC­tu»C»©e
Ğ
·d
->
·d_ÍGUID
, &
dsw
->
dsw_pDœeùSoundC­tu»
, 
NULL
 );

708 ifĞ
hr
 =ğ
DS_OK
 ) ;

712 ifĞ
hr
 !ğ
DS_OK
 )

714 
	`ERR_RPT
(("PortAudio: DirectSoundCaptureCreate() failed!\n"));

715 
»suÉ
 = 
·Ho¡E¼Ü
;

716 
sPaHo¡E¼Ü
 = 
hr
;

717 
”rÜ
;

719 
hr
 = 
	`DSW_In™IÅutBufãr
Ğ
dsw
,

720 (è(
·¡
->
·¡_Sam¶eR©e
 + 0.5),

721 
·¡
->
·¡_NumIÅutChªÃls
, 
numBy‹s
 );

722 
	`DBUG
(("DSW_In™IÅutBufãr(è»tuº %x\n", 
hr
));

723 ifĞ
hr
 !ğ
DS_OK
 )

725 
	`ERR_RPT
(("PÜtAudio: DSW_In™IÅutBufãr(è»tuº %x\n", 
hr
));

726 
»suÉ
 = 
·Ho¡E¼Ü
;

727 
sPaHo¡E¼Ü
 = 
hr
;

728 
”rÜ
;

734 
LARGE_INTEGER
 
äequ’cy
;

735 ifĞ
	`Qu”yP”fÜmªûF»qu’cy
Ğ&
äequ’cy
 ) == 0 )

737 
·hsc
->
·hsc_Inv”£TicksP”U£rBufãr
 = 0.0;

741 
·hsc
->
·hsc_Inv”£TicksP”U£rBufãr
 = 
·¡
->
·¡_Sam¶eR©e
 /

742 Ğ()
äequ’cy
.
QuadP¬t
 * 
·¡
->
·¡_F¿mesP”U£rBufãr
 );

743 
	`DBUG
(("·hsc_Inv”£TicksP”U£rBufã¸ğ%g\n", 
·hsc
->
·hsc_Inv”£TicksP”U£rBufãr
 ));

746  
»suÉ
;

747 
”rÜ
:

748 
	`PaHo¡_Clo£SŒ—m
Ğ
·¡
 );

749  
»suÉ
;

750 
	}
}

752 
PaE¼Ü
 
	$PaHo¡_S¹Ouut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

754 
HRESULT
 
hr
;

755 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

756 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

757 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

759 
»suÉ
 = 
	`Pa_TimeSliû
Ğ
·¡
 );

760 ifĞ
»suÉ
 !ğ
·NoE¼Ü
 ) „esult;

761 
hr
 = 
	`DSW_S¹Ouut
Ğ&
·hsc
->
·hsc_DSoundW¿µ”
 );

762 
	`DBUG
(("PaHo¡_S¹Ouut: DSW_S¹Ouuˆ»tuºed = 0x%X.\n", 
hr
));

763 ifĞ
hr
 !ğ
DS_OK
 )

765 
»suÉ
 = 
·Ho¡E¼Ü
;

766 
sPaHo¡E¼Ü
 = 
hr
;

767 
”rÜ
;

769 
”rÜ
:

770  
»suÉ
;

771 
	}
}

773 
PaE¼Ü
 
	$PaHo¡_S¹IÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

775 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

776 #ià
SUPPORT_AUDIO_CAPTURE


777 
HRESULT
 
hr
;

778 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

779 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

780 
hr
 = 
	`DSW_S¹IÅut
Ğ&
·hsc
->
·hsc_DSoundW¿µ”
 );

781 
	`DBUG
(("Pa_S¹SŒ—m: DSW_S¹IÅuˆ»tuºed = 0x%X.\n", 
hr
));

782 ifĞ
hr
 !ğ
DS_OK
 )

784 
»suÉ
 = 
·Ho¡E¼Ü
;

785 
sPaHo¡E¼Ü
 = 
hr
;

786 
”rÜ
;

788 
”rÜ
:

790  
»suÉ
;

791 
	}
}

793 
PaE¼Ü
 
	$PaHo¡_S¹Engše
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

795 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

796 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

797 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

798 
·¡
->
·¡_StİNow
 = 0;

799 
·¡
->
·¡_StİSoÚ
 = 0;

800 
·¡
->
·¡_IsAùive
 = 1;

803 
m£cP”Bufãr
;

804 
»sŞutiÚ
;

805 
bufsP”IÁ”ru±
;

807 
	`DBUG
(("PaHo¡_S¹Engše:…a¡_NumU£rBufãr ğ%d\n", 
·¡
->
·¡_NumU£rBufãrs
));

809 ifĞ
·¡
->
·¡_NumU£rBufãrs
 == 2 )

812 
m£cP”Bufãr
 = (500 * 
·¡
->
·¡_F¿mesP”U£rBufãr
è/ (è·¡->
·¡_Sam¶eR©e
;

816 iàĞ
·¡
->
·¡_NumU£rBufãrs
 >ğ16 ) 
bufsP”IÁ”ru±
 =…ast->past_NumUserBuffers/8;

817 iàĞ
·¡
->
·¡_NumU£rBufãrs
 >ğ8 ) 
bufsP”IÁ”ru±
 = 2;

818 
bufsP”IÁ”ru±
 = 1;

820 
m£cP”Bufãr
 = 1000 * (
bufsP”IÁ”ru±
 * 
·¡
->
·¡_F¿mesP”U£rBufãr
è/ (è·¡->
·¡_Sam¶eR©e
;

822 
	`DBUG
(("PaHo¡_S¹Engše: bufsP”IÁ”ru± = %d\n", 
bufsP”IÁ”ru±
));

825 
	`DBUG
(("PaHo¡_S¹Engše: m£cP”Bufã¸ğ%d\n", 
m£cP”Bufãr
));

827 ifĞ
m£cP”Bufãr
 < 10 ) msecPerBuffer = 10;

828 ifĞ
m£cP”Bufãr
 > 100 ) msecPerBuffer = 100;

829 
	`DBUG
(("PaHo¡_S¹Engše: cl³d m£cP”Bufã¸ğ%d\n", 
m£cP”Bufãr
));

831 
»sŞutiÚ
 = 
m£cP”Bufãr
/4;

832 
·hsc
->
·hsc_Tim”ID
 = 
	`timeS‘Ev’t
Ğ
m£cP”Bufãr
, 
»sŞutiÚ
, (
LPTIMECALLBACK
è
Pa_Tim”C®lback
,

833 (
DWORD
è
·¡
, 
TIME_PERIODIC
 );

835 ifĞ
·hsc
->
·hsc_Tim”ID
 == 0 )

837 
·¡
->
·¡_IsAùive
 = 0;

838 
»suÉ
 = 
·Ho¡E¼Ü
;

839 
sPaHo¡E¼Ü
 = 0;

840 
”rÜ
;

842 
”rÜ
:

843  
»suÉ
;

844 
	}
}

846 
PaE¼Ü
 
	$PaHo¡_StİEngše
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

848 
timeoutM£c
;

849 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

850 ifĞ
·hsc
 =ğ
NULL
 )  
·NoE¼Ü
;

851 ifĞ
abÜt
 ) 
·¡
->
·¡_StİNow
 = 1;

852 
·¡
->
·¡_StİSoÚ
 = 1;

854 
timeoutM£c
 = (è(1200.0 * 
·hsc
->
·hsc_F¿mesP”DSBufãr
 / 
·¡
->
·¡_Sam¶eR©e
);

855  
·¡
->
·¡_IsAùive
 && (
timeoutM£c
 > 0) )

857 
	`SË•
(10);

858 
timeoutM£c
 -= 10;

860 ifĞ
·hsc
->
·hsc_Tim”ID
 != 0 )

862 
	`timeKlEv’t
(
·hsc
->
·hsc_Tim”ID
);

863 
·hsc
->
·hsc_Tim”ID
 = 0;

865  
·NoE¼Ü
;

866 
	}
}

868 
PaE¼Ü
 
	$PaHo¡_StİIÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

870 #ià
SUPPORT_AUDIO_CAPTURE


871 
HRESULT
 
hr
;

872 
PaHo¡SoundCÚŒŞ
 *
·hsc
 = (PaHo¡SoundCÚŒŞ *è
·¡
->
·¡_DeviûD©a
;

873 ifĞ
·hsc
 =ğ
NULL
 )  
·NoE¼Ü
;

874 (è
abÜt
;

875 
hr
 = 
	`DSW_StİIÅut
Ğ&
·hsc
->
·hsc_DSoundW¿µ”
 );

876 
	`DBUG
(("DSW_StİIÅut(è»suÉ i %x\n", 
hr
));

878  
·NoE¼Ü
;

879 
	}
}

881 
PaE¼Ü
 
	$PaHo¡_StİOuut
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
, 
abÜt
 )

883 
HRESULT
 
hr
;

884 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

885 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

886 ifĞ
·hsc
 =ğ
NULL
 )  
·NoE¼Ü
;

887 (è
abÜt
;

888 
hr
 = 
	`DSW_StİOuut
Ğ&
·hsc
->
·hsc_DSoundW¿µ”
 );

889 
	`DBUG
(("DSW_StİOuut(è»suÉ i %x\n", 
hr
));

890  
·NoE¼Ü
;

891 
	}
}

893 
PaE¼Ü
 
	$PaHo¡_Clo£SŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

895 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

896 ifĞ
·¡
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

897 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

898 ifĞ
·hsc
 =ğ
NULL
 )  
·NoE¼Ü
;

899 
	`DSW_T”m
Ğ&
·hsc
->
·hsc_DSoundW¿µ”
 );

900 ifĞ
·hsc
->
·hsc_N©iveBufãr
 )

902 
	`PaHo¡_F»eFa¡MemÜy
Ğ
·hsc
->
·hsc_N©iveBufãr
,…ahsc->
·hsc_By‹sP”Bufãr
 );

903 
·hsc
->
·hsc_N©iveBufãr
 = 
NULL
;

905 
	`PaHo¡_F»eFa¡MemÜy
Ğ
·hsc
, (
PaHo¡SoundCÚŒŞ
) );

906 
·¡
->
·¡_DeviûD©a
 = 
NULL
;

907  
·NoE¼Ü
;

908 
	}
}

913 
	$PaHo¡_G‘MšSy¡emL©’cy
( )

915 
mšL©’cyM£c
;

919 
OSVERSIONINFO
 
osvi
;

920 
osvi
.
dwOSV”siÚInfoSize
 = ( osvi );

921 
	`G‘V”siÚEx
Ğ&
osvi
 );

922 
	`DBUG
(("PA - PÏtfÜmId = 0x%x\n", 
osvi
.
dwPÏtfÜmId
 ));

923 
	`DBUG
(("PA - MajÜV”siÚ = 0x%x\n", 
osvi
.
dwMajÜV”siÚ
 ));

924 
	`DBUG
(("PA - MšÜV”siÚ = 0x%x\n", 
osvi
.
dwMšÜV”siÚ
 ));

926 ifĞ(
osvi
.
dwMajÜV”siÚ
 =ğ4è&& (osvi.
dwPÏtfÜmId
 == 2) )

928 
mšL©’cyM£c
 = 
PA_WIN_NT_LATENCY
;

930 if(
osvi
.
dwMajÜV”siÚ
 >= 5)

932 
mšL©’cyM£c
 = 
PA_WIN_WDM_LATENCY
;

936 
mšL©’cyM£c
 = 
PA_WIN_9X_LATENCY
;

938  
mšL©’cyM£c
;

939 
	}
}

952 
	#PA_LATENCY_ENV_NAME
 ("PA_MIN_LATENCY_MSEC")

	)

953 
	$Pa_G‘MšNumBufãrs
Ğ
äamesP”Bufãr
, 
§m¶eR©e
 )

955 
’vbuf
[
PA_ENV_BUF_SIZE
];

956 
DWORD
 
h»suÉ
;

957 
mšL©’cyM£c
 = 0;

958 
m£cP”Bufãr
 = (1000.0 * 
äamesP”Bufãr
è/ 
§m¶eR©e
;

959 
mšBufãrs
;

961 
h»suÉ
 = 
	`G‘EnvœÚm’tV¬ŸbË
Ğ
PA_LATENCY_ENV_NAME
, 
’vbuf
, 
PA_ENV_BUF_SIZE
 );

962 ifĞ(
h»suÉ
 > 0è&& (h»suÉ < 
PA_ENV_BUF_SIZE
) )

964 
mšL©’cyM£c
 = 
	`©oi
Ğ
’vbuf
 );

968 
mšL©’cyM£c
 = 
	`PaHo¡_G‘MšSy¡emL©’cy
();

969 #ià
PA_USE_HIGH_LATENCY


970 
	`PRINT
(("PA - Mšimum L©’cy s‘Ø%d m£c!\n", 
mšL©’cyM£c
 ));

974 
mšBufãrs
 = (è(1.0 + (()
mšL©’cyM£c
 / 
m£cP”Bufãr
));

975 ifĞ
mšBufãrs
 < 2 ) minBuffers = 2;

976  
mšBufãrs
;

977 
	}
}

979 
PaE¼Ü
 
	$PaHo¡_T”m
( )

981 
i
;

983  
i
=0; i<
sNumDeviûs
; i++ )

985 ifĞ
sDeviûs
[
i
].
·d_Info
.
Çme
 !ğ
NULL
 )

987 
	`ä“
Ğ(*è
sDeviûs
[
i
].
·d_Info
.
Çme
 );

988 
sDeviûs
[
i
].
·d_Info
.
Çme
 = 
NULL
;

991 ifĞ
sDeviûs
 !ğ
NULL
 )

993 
	`PaHo¡_F»eFa¡MemÜy
Ğ
sDeviûs
, 
sNumDeviûs
 * (
š‹º®PÜtAudioDeviû
) );

994 
sDeviûs
 = 
NULL
;

995 
sNumDeviûs
 = 0;

998 
	}
}

999 
	$Pa_SË•
Ğ
m£c
 )

1001 
	`SË•
Ğ
m£c
 );

1002 
	}
}

1010 *
	$PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ
numBy‹s
 )

1012 *
addr
 = 
	`Glob®AÎoc
Ğ
GPTR
, 
numBy‹s
 );

1013  
addr
;

1014 
	}
}

1019 
	$PaHo¡_F»eFa¡MemÜy
Ğ*
addr
, 
numBy‹s
 )

1021 ifĞ
addr
 !ğ
NULL
 ) 
	`Glob®F»e
(‡ddr );

1022 
	}
}

1024 
PaE¼Ü
 
	$PaHo¡_SŒ—mAùive
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 )

1026 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1027 ifĞ
·¡
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

1028 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

1029 ifĞ
·hsc
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

1030  (
PaE¼Ü
è(
·¡
->
·¡_IsAùive
);

1031 
	}
}

1033 
PaTime¡amp
 
	$Pa_SŒ—mTime
Ğ
PÜtAudioSŒ—m
 *
¡»am
 )

1035 
DSoundW¿µ”
 *
dsw
;

1036 
š‹º®PÜtAudioSŒ—m
 *
·¡
 = (š‹º®PÜtAudioSŒ—m *è
¡»am
;

1037 
PaHo¡SoundCÚŒŞ
 *
·hsc
;

1038 ifĞ
·¡
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

1039 
·hsc
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

1040 
dsw
 = &
·hsc
->
·hsc_DSoundW¿µ”
;

1041  
dsw
->
dsw_F¿mesPÏyed
;

1042 
	}
}

	@portaudio/pa_win_wmme/pa_win_wmme.c

60 
	~<¡dio.h
>

61 
	~<¡dlib.h
>

62 
	~<m©h.h
>

63 
	~<wšdows.h
>

64 
	~<mmsy¡em.h
>

65 
	~<´oûss.h
>

67 #iâdeà
__MWERKS__


68 
	~<m®loc.h
>

69 
	~<memÜy.h
>

71 
	~"pÜudio.h
"

72 
	~"·_ho¡.h
"

73 
	~"·_Œaû.h
"

76 
	#PA_TRACK_MEMORY
 (0)

	)

78 
	#PA_USE_TIMER_CALLBACK
 (0è

	)

80 
	#PA_SIMULATE_UNDERFLOW
 (0è

	)

83 
	#PA_TRACE_RUN
 (0)

	)

84 
	#PA_TRACE_START_STOP
 (1)

	)

86 
	#PA_USE_HIGH_LATENCY
 (0è

	)

88 #ià
PA_USE_HIGH_LATENCY


89 
	#PA_MIN_MSEC_PER_HOST_BUFFER
 (100)

	)

90 
	#PA_MAX_MSEC_PER_HOST_BUFFER
 (300è

	)

91 
	#PA_MIN_NUM_HOST_BUFFERS
 (4)

	)

92 
	#PA_MAX_NUM_HOST_BUFFERS
 (16è

	)

93 
	#PA_WIN_9X_LATENCY
 (400)

	)

95 
	#PA_MIN_MSEC_PER_HOST_BUFFER
 (10)

	)

96 
	#PA_MAX_MSEC_PER_HOST_BUFFER
 (100è

	)

97 
	#PA_MIN_NUM_HOST_BUFFERS
 (3)

	)

98 
	#PA_MAX_NUM_HOST_BUFFERS
 (16è

	)

99 
	#PA_WIN_9X_LATENCY
 (200)

	)

101 
	#MIN_TIMEOUT_MSEC
 (1000)

	)

107 
	#PA_WIN_NT_LATENCY
 (
PA_WIN_9X_LATENCY
 * 2)

	)

108 
	#PA_WIN_WDM_LATENCY
 (
PA_WIN_9X_LATENCY
)

	)

110 #ià
PA_SIMULATE_UNDERFLOW


111 
	ggUnd”C®lbackCouÁ”
 = 0;

112 
	#UNDER_SLEEP_AT
 (40)

	)

113 
	#UNDER_SLEEP_FOR
 (500)

	)

116 
	#PRINT
(
x
è{ 
´štf
 x; 
	`fæush
(
¡dout
); }

	)

117 
	#ERR_RPT
(
x
è
	`PRINT
(x)

	)

118 
	#DBUG
(
x
è

	)

119 
	#DBUGX
(
x
è

	)

125 
	sPaWMMESŒ—mD©a


128 
HWAVEIN
 
	mhWaveIn
;

129 
WAVEHDR
 *
	mšputBufãrs
;

130 
	mcu¼’tIÅutBufãr
;

131 
	mby‹sP”Ho¡IÅutBufãr
;

132 
	mby‹sP”U£rIÅutBufãr
;

134 
HWAVEOUT
 
	mhWaveOut
;

135 
WAVEHDR
 *
	mouutBufãrs
;

136 
	mcu¼’tOuutBufãr
;

137 
	mby‹sP”Ho¡OuutBufãr
;

138 
	mby‹sP”U£rOuutBufãr
;

140 
PaTime¡amp
 
	mäamesPÏyed
;

141 
	mÏ¡Pos™iÚ
;

143 
LARGE_INTEGER
 
	m’ŒyCouÁ
;

144 
	mšv”£TicksP”Ho¡Bufãr
;

146 
	mnumHo¡Bufãrs
;

147 
	mäamesP”Ho¡Bufãr
;

148 
	mu£rBufãrsP”Ho¡Bufãr
;

149 
CRITICAL_SECTION
 
	m¡»amLock
;

150 
INT
 
	m¡»amLockIn™ed
;

151 #ià
PA_USE_TIMER_CALLBACK


152 
BOOL
 
	mifInsideC®lback
;

153 
MMRESULT
 
	mtim”ID
;

155 
HANDLE
 
	mabÜtEv’t
;

156 
	mabÜtEv’tIn™ed
;

157 
HANDLE
 
	mbufãrEv’t
;

158 
	mbufãrEv’tIn™ed
;

159 
HANDLE
 
	m’gšeTh»ad
;

160 
DWORD
 
	m’gšeTh»adID
;

163 
	tPaWMMESŒ—mD©a
;

166 
	gsNumIÅutDeviûs
 = 0;

167 
	gsNumOuutDeviûs
 = 0;

168 
	gsNumDeviûs
 = 0;

169 
PaDeviûInfo
 **
	gsDeviûPŒs
 = 
NULL
;

170 
	gsDeçuÉIÅutDeviûID
 = 
·NoDeviû
;

171 
	gsDeçuÉOuutDeviûID
 = 
·NoDeviû
;

172 
	gsPaHo¡E¼Ü
 = 0;

173 cÚ¡ 
	gsM­³rSuffixIÅut
[] = " - Input";

174 cÚ¡ 
	gsM­³rSuffixOuut
[] = " - Output";

176 #ià
PA_TRACK_MEMORY


177 
	gsNumAÎoÿtiÚs
 = 0;

182 
	#PaDeviûIdToWšId
(
id
è(((idè< 
sNumIÅutDeviûs
è? (id - 1è: (id - sNumIÅutDeviû - 1))

	)

185 
Pa_In™ŸlizeNumDeviûs
( );

186 
PaE¼Ü
 
Pa_AÎoÿ‹DeviûPŒs
( );

188 
CALLBACK
 
Pa_Tim”C®lback
(
UINT
 
uID
, UINT 
uMsg
,

189 
DWORD
 
dwU£r
, DWORD 
dw1
, DWORD 
dw2
);

190 
PaE¼Ü
 
PaHo¡_G‘TÙ®BufãrF¿mes
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

191 
PaE¼Ü
 
PaHo¡_Upd©eSŒ—mTime
Ğ
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 );

192 
PaE¼Ü
 
PaHo¡_BackgroundMªag”
Ğ
š‹º®PÜtAudioSŒ—m
 *
·¡
 );

194 *
PaHo¡_AÎoÿ‹T¿ckedMemÜy
Ğ
numBy‹s
 );

195 
PaHo¡_F»eT¿ckedMemÜy
Ğ*
addr
 );

198 
PaE¼Ü
 
	$PaHo¡_AÎoÿ‹WMMESŒ—mD©a
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

200 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

201 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
;

203 
wmmeSŒ—mD©a
 = (
PaWMMESŒ—mD©a
 *è
	`PaHo¡_AÎoÿ‹Fa¡MemÜy
((PaWMMEStreamData));

204 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 )

206 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

207 
”rÜ
;

209 
	`mem£t
Ğ
wmmeSŒ—mD©a
, 0, (
PaWMMESŒ—mD©a
) );

210 
¡»am
->
·¡_DeviûD©a
 = (*è
wmmeSŒ—mD©a
;

212  
»suÉ
;

214 
”rÜ
:

215  
»suÉ
;

216 
	}
}

219 
	$PaHo¡_F»eWMMESŒ—mD©a
Ğ
š‹º®PÜtAudioSŒ—m
 *
š‹º®SŒ—m
 )

221 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = (PaWMMESŒ—mD©¨*è
š‹º®SŒ—m
->
·¡_DeviûD©a
;

223 
	`PaHo¡_F»eFa¡MemÜy
Ğ
wmmeSŒ—mD©a
, (
PaWMMESŒ—mD©a
) );

224 
š‹º®SŒ—m
->
·¡_DeviûD©a
 = 
NULL
;

225 
	}
}

227 
PaWMMESŒ—mD©a
* 
	$PaHo¡_G‘WMMESŒ—mD©a
Ğ
š‹º®PÜtAudioSŒ—m
* 
š‹º®SŒ—m
 )

229 
PaWMMESŒ—mD©a
 *
»suÉ
 = 
NULL
;

231 ifĞ
š‹º®SŒ—m
 !ğ
NULL
 )

233 
»suÉ
 = (
PaWMMESŒ—mD©a
 *è
š‹º®SŒ—m
->
·¡_DeviûD©a
;

235  
»suÉ
;

236 
	}
}

239 
	$Pa_In™ŸlizeCpuU§geSÿÏr
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

241 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = (PaWMMESŒ—mD©¨*è
¡»am
->
·¡_DeviûD©a
;

243 
LARGE_INTEGER
 
äequ’cy
;

244 ifĞ
	`Qu”yP”fÜmªûF»qu’cy
Ğ&
äequ’cy
 ) == 0 )

246 
wmmeSŒ—mD©a
->
šv”£TicksP”Ho¡Bufãr
 = 0.0;

250 
wmmeSŒ—mD©a
->
šv”£TicksP”Ho¡Bufãr
 = 
¡»am
->
·¡_Sam¶eR©e
 /

251 Ğ()
äequ’cy
.
QuadP¬t
 * 
¡»am
->
·¡_F¿mesP”U£rBufãr
 * 
wmmeSŒ—mD©a
->
u£rBufãrsP”Ho¡Bufãr
 );

252 
	`DBUG
(("šv”£TicksP”Ho¡Bufã¸ğ%g\n", 
wmmeSŒ—mD©a
->
šv”£TicksP”Ho¡Bufãr
 ));

254 
	}
}

255 
	$Pa_S¹U§geC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

257 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = (PaWMMESŒ—mD©¨*è
¡»am
->
·¡_DeviûD©a
;

259 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 ) ;

261 
	`Qu”yP”fÜmªûCouÁ”
Ğ&
wmmeSŒ—mD©a
->
’ŒyCouÁ
 );

262 
	}
}

263 
	$Pa_EndU§geC®cuÏtiÚ
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

265 
LARGE_INTEGER
 
Cu¼’tCouÁ
;

266 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = (PaWMMESŒ—mD©¨*è
¡»am
->
·¡_DeviûD©a
;

268 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 ) ;

273 
	#LOWPASS_COEFFICIENT_0
 (0.9)

	)

274 
	#LOWPASS_COEFFICIENT_1
 (0.99999 - 
LOWPASS_COEFFICIENT_0
)

	)

275 ifĞ
	`Qu”yP”fÜmªûCouÁ”
Ğ&
Cu¼’tCouÁ
 ) )

277 
LONGLONG
 
InsideCouÁ
 = 
Cu¼’tCouÁ
.
QuadP¬t
 - 
wmmeSŒ—mD©a
->
’ŒyCouÁ
.QuadPart;

278 
ÃwU§ge
 = 
InsideCouÁ
 * 
wmmeSŒ—mD©a
->
šv”£TicksP”Ho¡Bufãr
;

279 
¡»am
->
·¡_U§ge
 = (
LOWPASS_COEFFICIENT_0
 * stream->past_Usage) +

280 (
LOWPASS_COEFFICIENT_1
 * 
ÃwU§ge
);

282 
	}
}

285 
	$Pa_In™ŸlizeNumDeviûs
( )

287 
sNumIÅutDeviûs
 = 
	`waveInG‘NumDevs
();

288 ifĞ
sNumIÅutDeviûs
 > 0 )

290 
sNumIÅutDeviûs
 += 1;

291 
sDeçuÉIÅutDeviûID
 = 0;

295 
sDeçuÉIÅutDeviûID
 = 
·NoDeviû
;

298 
sNumOuutDeviûs
 = 
	`waveOutG‘NumDevs
();

299 ifĞ
sNumOuutDeviûs
 > 0 )

301 
sNumOuutDeviûs
 += 1;

302 
sDeçuÉOuutDeviûID
 = 
sNumIÅutDeviûs
;

306 
sDeçuÉOuutDeviûID
 = 
·NoDeviû
;

309 
sNumDeviûs
 = 
sNumIÅutDeviûs
 + 
sNumOuutDeviûs
;

310 
	}
}

312 
PaE¼Ü
 
	$Pa_AÎoÿ‹DeviûPŒs
( )

314 
numBy‹s
;

315 
i
;

321 ifĞ
sNumDeviûs
 > 0 )

323 
numBy‹s
 = 
sNumDeviûs
 * (
PaDeviûInfo
 *);

324 
sDeviûPŒs
 = (
PaDeviûInfo
 **è
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
Ğ
numBy‹s
 );

325 ifĞ
sDeviûPŒs
 =ğ
NULL
 )  
·Insuffic›ÁMemÜy
;

327  
i
 = 0; i < 
sNumDeviûs
; i++ )

328 
sDeviûPŒs
[
i
] = 
NULL
;

332 
sDeviûPŒs
 = 
NULL
;

335  
·NoE¼Ü
;

336 
	}
}

338 
	$Pa_G‘Ho¡E¼Ü
()

340  
sPaHo¡E¼Ü
;

341 
	}
}

343 
	$Pa_CouÁDeviûs
()

345 ifĞ
	`PaHo¡_IsIn™Ÿlized
() )

346  
sNumDeviûs
;

349 
	}
}

357 cÚ¡ 
PaDeviûInfo
* 
	$Pa_G‘DeviûInfo
Ğ
PaDeviûID
 
id
 )

359 
	#NUM_STANDARDSAMPLINGRATES
 3

	)

360 
DWORD
 
cu¡omSam¶šgR©es
[] = { 8000, 32000, 48000, 64000, 88200, 96000 };

361 
	#NUM_CUSTOMSAMPLINGRATES
 ((
cu¡omSam¶šgR©es
)/(
DWORD
))

	)

362 
	#MAX_NUMSAMPLINGRATES
 (
NUM_STANDARDSAMPLINGRATES
+
NUM_CUSTOMSAMPLINGRATES
)

	)

364 
PaDeviûInfo
 *
deviûInfo
;

365 *
§m¶eR©es
;

366 
i
;

367 *
s
;

369 ifĞ
id
 < 0 || id >ğ
sNumDeviûs
 )

370  
NULL
;

371 ifĞ
sDeviûPŒs
[ 
id
 ] !ğ
NULL
 )

373  
sDeviûPŒs
[ 
id
 ];

375 
deviûInfo
 = (
PaDeviûInfo
 *)
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
( (PaDeviceInfo) );

376 ifĞ
deviûInfo
 =ğ
NULL
 )  NULL;

377 
deviûInfo
->
¡ruùV”siÚ
 = 1;

378 
deviûInfo
->
maxIÅutChªÃls
 = 0;

379 
deviûInfo
->
maxOuutChªÃls
 = 0;

380 
deviûInfo
->
numSam¶eR©es
 = 0;

381 
§m¶eR©es
 = (*)
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
Ğ
MAX_NUMSAMPLINGRATES
 * () );

382 
deviûInfo
->
§m¶eR©es
 = sampleRates;

383 
deviûInfo
->
ÇtiveSam¶eFÜm©s
 = 
·IÁ16
;

384 ifĞ
id
 < 
sNumIÅutDeviûs
 )

387 
šputMmID
 = 
	`PaDeviûIdToWšId
(
id
);

388 
WAVEINCAPS
 
wic
;

389 ifĞ
	`waveInG‘DevC­s
Ğ
šputMmID
, &
wic
, Ğ
WAVEINCAPS
 ) ) !ğ
MMSYSERR_NOERROR
 )

390 
”rÜ
;

393 ifĞ
šputMmID
 =ğ
WAVE_MAPPER
 )

395 
s
 = (*è
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
Ğ
	`¡¾’
Ğ
wic
.
szPÇme
 ) + 1 + (
sM­³rSuffixIÅut
) );

396 
	`¡rıy
Ğ
s
, 
wic
.
szPÇme
 );

397 
	`¡rÿt
Ğ
s
, 
sM­³rSuffixIÅut
 );

401 
s
 = (*è
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
Ğ
	`¡¾’
Ğ
wic
.
szPÇme
 ) + 1 );

402 
	`¡rıy
Ğ
s
, 
wic
.
szPÇme
 );

404 
deviûInfo
->
Çme
 = 
s
;

405 
deviûInfo
->
maxIÅutChªÃls
 = 
wic
.
wChªÃls
;

410 ifĞ(
deviûInfo
->
maxIÅutChªÃls
 < 1) || (deviceInfo->maxInputChannels > 256) )

412 
	`ERR_RPT
(("Pa_G‘DeviûInfo: Num iÅuˆchªÃl »pÜ‹d‡ %d! ChªgedØ2.\n", 
deviûInfo
->
maxOuutChªÃls
 ));

413 
deviûInfo
->
maxIÅutChªÃls
 = 2;

417 ifĞ
wic
.
dwFÜm©s
 & 
WAVE_FORMAT_1M16
 ||wic.dwFÜm© & 
WAVE_FORMAT_1S16
 )

418 
§m¶eR©es
[ 
deviûInfo
->
numSam¶eR©es
++ ] = 11025.;

419 ifĞ
wic
.
dwFÜm©s
 & 
WAVE_FORMAT_2M16
 ||wic.dwFÜm© & 
WAVE_FORMAT_2S16
 )

420 
§m¶eR©es
[ 
deviûInfo
->
numSam¶eR©es
++ ] = 22050.;

421 ifĞ
wic
.
dwFÜm©s
 & 
WAVE_FORMAT_4M16
 ||wic.dwFÜm© & 
WAVE_FORMAT_4S16
 )

422 
§m¶eR©es
[ 
deviûInfo
->
numSam¶eR©es
++ ] = 44100.;

425  
i
=0; i < 
NUM_CUSTOMSAMPLINGRATES
; i++ )

427 
WAVEFORMATEX
 
wfx
;

428 
wfx
.
wFÜm©Tag
 = 
WAVE_FORMAT_PCM
;

429 
wfx
.
nSam¶esP”Sec
 = 
cu¡omSam¶šgR©es
[
i
];

430 
wfx
.
wB™sP”Sam¶e
 = 16;

431 
wfx
.
cbSize
 = 0;

432 
wfx
.
nChªÃls
 = (
WORD
)
deviûInfo
->
maxIÅutChªÃls
;

433 
wfx
.
nAvgBy‹sP”Sec
 = wfx.
nChªÃls
 * wfx.
nSam¶esP”Sec
 * ();

434 
wfx
.
nBlockAlign
 = (
WORD
)(wfx.
nChªÃls
 * ());

435 ifĞ
	`waveInO³n
Ğ
NULL
, 
šputMmID
, &
wfx
, 0, 0, 
WAVE_FORMAT_QUERY
 ) =ğ
MMSYSERR_NOERROR
 )

437 
§m¶eR©es
[ 
deviûInfo
->
numSam¶eR©es
++ ] = 
cu¡omSam¶šgR©es
[
i
];

442 ifĞ
id
 - 
sNumIÅutDeviûs
 < 
sNumOuutDeviûs
 )

445 
ouutMmID
 = 
	`PaDeviûIdToWšId
(
id
);

446 
WAVEOUTCAPS
 
woc
;

447 ifĞ
	`waveOutG‘DevC­s
Ğ
ouutMmID
, &
woc
, Ğ
WAVEOUTCAPS
 ) ) !ğ
MMSYSERR_NOERROR
 )

448 
”rÜ
;

450 ifĞ
ouutMmID
 =ğ
WAVE_MAPPER
 )

452 
s
 = (*è
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
Ğ
	`¡¾’
Ğ
woc
.
szPÇme
 ) + 1 + (
sM­³rSuffixOuut
) );

453 
	`¡rıy
Ğ
s
, 
woc
.
szPÇme
 );

454 
	`¡rÿt
Ğ
s
, 
sM­³rSuffixOuut
 );

458 
s
 = (*è
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
Ğ
	`¡¾’
Ğ
woc
.
szPÇme
 ) + 1 );

459 
	`¡rıy
Ğ
s
, 
woc
.
szPÇme
 );

461 
deviûInfo
->
Çme
 = 
s
;

462 
deviûInfo
->
maxOuutChªÃls
 = 
woc
.
wChªÃls
;

467 ifĞ(
deviûInfo
->
maxOuutChªÃls
 < 1) || (deviceInfo->maxOutputChannels > 256) )

470 
deviûInfo
->
maxOuutChªÃls
 = 2;

475 
	`ERR_RPT
(("Pa_G‘DeviûInfo: Num ouuˆchªÃl »pÜ‹d‡ %d!", 
deviûInfo
->
maxOuutChªÃls
 ));

476 
deviûInfo
->
maxOuutChªÃls
 = 0;

478  
i
=2; i<16; i += 2 )

480 
WAVEFORMATEX
 
wfx
;

481 
wfx
.
wFÜm©Tag
 = 
WAVE_FORMAT_PCM
;

482 
wfx
.
nSam¶esP”Sec
 = 44100;

483 
wfx
.
wB™sP”Sam¶e
 = 16;

484 
wfx
.
cbSize
 = 0;

485 
wfx
.
nChªÃls
 = (
WORD
è
i
;

486 
wfx
.
nAvgBy‹sP”Sec
 = wfx.
nChªÃls
 * wfx.
nSam¶esP”Sec
 * ();

487 
wfx
.
nBlockAlign
 = (
WORD
)(wfx.
nChªÃls
 * ());

488 ifĞ
	`waveOutO³n
Ğ
NULL
, 
ouutMmID
, &
wfx
, 0, 0, 
WAVE_FORMAT_QUERY
 ) =ğ
MMSYSERR_NOERROR
 )

490 
deviûInfo
->
maxOuutChªÃls
 = 
i
;

498 
	`ERR_RPT
((" ChªgedØ%d.\n", 
deviûInfo
->
maxOuutChªÃls
 ));

503 ifĞ
woc
.
dwFÜm©s
 & 
WAVE_FORMAT_1M16
 ||woc.dwFÜm© & 
WAVE_FORMAT_1S16
 )

504 
§m¶eR©es
[ 
deviûInfo
->
numSam¶eR©es
++ ] = 11025.;

505 ifĞ
woc
.
dwFÜm©s
 & 
WAVE_FORMAT_2M16
 ||woc.dwFÜm© & 
WAVE_FORMAT_2S16
 )

506 
§m¶eR©es
[ 
deviûInfo
->
numSam¶eR©es
++ ] = 22050.;

507 ifĞ
woc
.
dwFÜm©s
 & 
WAVE_FORMAT_4M16
 ||woc.dwFÜm© & 
WAVE_FORMAT_4S16
 )

508 
§m¶eR©es
[ 
deviûInfo
->
numSam¶eR©es
++ ] = 44100.;

512  
i
=0; i < 
NUM_CUSTOMSAMPLINGRATES
; i++ )

514 
WAVEFORMATEX
 
wfx
;

515 
wfx
.
wFÜm©Tag
 = 
WAVE_FORMAT_PCM
;

516 
wfx
.
nSam¶esP”Sec
 = 
cu¡omSam¶šgR©es
[
i
];

517 
wfx
.
wB™sP”Sam¶e
 = 16;

518 
wfx
.
cbSize
 = 0;

519 
wfx
.
nChªÃls
 = (
WORD
)
deviûInfo
->
maxOuutChªÃls
;

520 
wfx
.
nAvgBy‹sP”Sec
 = wfx.
nChªÃls
 * wfx.
nSam¶esP”Sec
 * ();

521 
wfx
.
nBlockAlign
 = (
WORD
)(wfx.
nChªÃls
 * ());

522 ifĞ
	`waveOutO³n
Ğ
NULL
, 
ouutMmID
, &
wfx
, 0, 0, 
WAVE_FORMAT_QUERY
 ) =ğ
MMSYSERR_NOERROR
 )

524 
§m¶eR©es
[ 
deviûInfo
->
numSam¶eR©es
++ ] = 
cu¡omSam¶šgR©es
[
i
];

528 
sDeviûPŒs
[ 
id
 ] = 
deviûInfo
;

529  
deviûInfo
;

531 
”rÜ
:

532 
	`PaHo¡_F»eT¿ckedMemÜy
Ğ
§m¶eR©es
 );

533 
	`PaHo¡_F»eT¿ckedMemÜy
Ğ
deviûInfo
 );

535  
NULL
;

536 
	}
}

547 
	#PA_ENV_BUF_SIZE
 (32)

	)

548 
	#PA_REC_IN_DEV_ENV_NAME
 ("PA_RECOMMENDED_INPUT_DEVICE")

	)

549 
	#PA_REC_OUT_DEV_ENV_NAME
 ("PA_RECOMMENDED_OUTPUT_DEVICE")

	)

550 
PaDeviûID
 
	$PaHo¡_G‘EnvDeçuÉDeviûID
Ğ*
’vName
 )

552 
DWORD
 
h»suÉ
;

553 
’vbuf
[
PA_ENV_BUF_SIZE
];

554 
PaDeviûID
 
»comm’dedID
 = 
·NoDeviû
;

557 
h»suÉ
 = 
	`G‘EnvœÚm’tV¬ŸbË
Ğ
’vName
, 
’vbuf
, 
PA_ENV_BUF_SIZE
 );

558 ifĞ(
h»suÉ
 > 0è&& (h»suÉ < 
PA_ENV_BUF_SIZE
) )

560 
»comm’dedID
 = 
	`©oi
Ğ
’vbuf
 );

562  
»comm’dedID
;

563 
	}
}

567 
PaDeviûID
 
	$Pa_G‘DeçuÉIÅutDeviûID
( )

569 
PaDeviûID
 
»suÉ
;

571 
»suÉ
 = 
	`PaHo¡_G‘EnvDeçuÉDeviûID
Ğ
PA_REC_IN_DEV_ENV_NAME
 );

572 ifĞ
»suÉ
 =ğ
·NoDeviû
 ||„esuÉ < 0 ||„esuÉ >ğ
sNumIÅutDeviûs
 )

574 
»suÉ
 = 
sDeçuÉIÅutDeviûID
;

576  
»suÉ
;

577 
	}
}

578 
PaDeviûID
 
	$Pa_G‘DeçuÉOuutDeviûID
( )

580 
PaDeviûID
 
»suÉ
;

582 
»suÉ
 = 
	`PaHo¡_G‘EnvDeçuÉDeviûID
Ğ
PA_REC_OUT_DEV_ENV_NAME
 );

583 ifĞ
»suÉ
 =ğ
·NoDeviû
 ||„esuÉ < 
sNumIÅutDeviûs
 ||„esuÉ >ğ
sNumDeviûs
 )

585 
»suÉ
 = 
sDeçuÉOuutDeviûID
;

587  
»suÉ
;

588 
	}
}

592 
PaE¼Ü
 
	$PaHo¡_In™
( )

595 #ià
PA_TRACK_MEMORY


596 
	`PRINT
(("PaHo¡_In™: sNumAÎoÿtiÚ ğ%d\n", 
sNumAÎoÿtiÚs
 ));

599 #ià
PA_SIMULATE_UNDERFLOW


600 
	`PRINT
(("WARNING - Underflow Simulation Enabled - Expect‡ Big Glitch!!!\n"));

604 
	`Pa_In™ŸlizeNumDeviûs
();

606  
	`Pa_AÎoÿ‹DeviûPŒs
();

607 
	}
}

623 
PaE¼Ü
 
	$Pa_TimeSliû
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

625 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

626 
MMRESULT
 
mm»suÉ
;

627 *
šBufPŒ
;

628 *
outBufPŒ
;

629 
gÙIÅut
 = 0;

630 
gÙOuut
 = 0;

631 
i
;

632 
bufãrsProûs£d
 = 0;

633 
dÚe
 = 0;

634 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = (PaWMMESŒ—mD©¨*è
¡»am
->
·¡_DeviûD©a
;

636 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

638 
¡»am
->
·¡_NumC®lbacks
 += 1;

639 #ià
PA_TRACE_RUN


640 
	`AddT¿ûMes§ge
("Pa_TimeSliû:…a¡_NumC®lback ", 
¡»am
->
·¡_NumC®lbacks
 );

645  !
dÚe
 && !
¡»am
->
·¡_StİSoÚ
 )

647 #ià
PA_SIMULATE_UNDERFLOW


648 if(
gUnd”C®lbackCouÁ”
++ =ğ
UNDER_SLEEP_AT
)

650 
	`SË•
(
UNDER_SLEEP_FOR
);

655 
gÙOuut
 = 0;

656 
outBufPŒ
 = 
NULL
;

657 ifĞ
¡»am
->
·¡_NumOuutChªÃls
 > 0 )

659 if((
wmmeSŒ—mD©a
->
ouutBufãrs
[ wmmeSŒ—mD©a->
cu¼’tOuutBufãr
 ].
dwFÏgs
 & 
WHDR_DONE
) == 0)

665 
outBufPŒ
 = 
wmmeSŒ—mD©a
->
ouutBufãrs
[ wmmeSŒ—mD©a->
cu¼’tOuutBufãr
 ].
ÍD©a
;

666 
gÙOuut
 = 1;

670 
gÙIÅut
 = 0;

671 
šBufPŒ
 = 
NULL
;

672 ifĞĞ
¡»am
->
·¡_NumIÅutChªÃls
 > 0 ) &&

673 (
wmmeSŒ—mD©a
->
šputBufãrs
[ wmmeSŒ—mD©a->
cu¼’tIÅutBufãr
 ].
dwFÏgs
 & 
WHDR_DONE
) )

675 
šBufPŒ
 = 
wmmeSŒ—mD©a
->
šputBufãrs
[ wmmeSŒ—mD©a->
cu¼’tIÅutBufãr
 ].
ÍD©a
;

676 
gÙIÅut
 = 1;

677 #ià
PA_TRACE_RUN


678 
	`AddT¿ûMes§ge
("Pa_TimeSliû: gÙ iÅuˆbufã¸© ", ()
šBufPŒ
 );

679 
	`AddT¿ûMes§ge
("Pa_TimeSliû: gÙ iÅuˆbufã¸# ", 
wmmeSŒ—mD©a
->
cu¼’tIÅutBufãr
 );

684 ifĞ!
gÙIÅut
 && !
gÙOuut
 ) ;

685 
bufãrsProûs£d
 += 1;

688 
	`Pa_S¹U§geC®cuÏtiÚ
Ğ
¡»am
 );

689  
i
=0; i<
wmmeSŒ—mD©a
->
u£rBufãrsP”Ho¡Bufãr
; i++ )

691 ifĞ
dÚe
 )

693 ifĞ
gÙOuut
 )

696 
	`AddT¿ûMes§ge
("Pa_TimeSliû: z”Ø»¡ oàwavbufã¸", 
i
 );

697 
	`mem£t
Ğ
outBufPŒ
, 0, 
wmmeSŒ—mD©a
->
by‹sP”U£rOuutBufãr
 );

703 
»suÉ
 = 
	`Pa_C®lCÚv”tIÁ16
Ğ
¡»am
, (*è
šBufPŒ
, (*è
outBufPŒ
 );

704 ifĞ
»suÉ
 !ğ0è
dÚe
 = 1;

706 ifĞ
gÙIÅut
 ) 
šBufPŒ
 +ğ
wmmeSŒ—mD©a
->
by‹sP”U£rIÅutBufãr
;

707 ifĞ
gÙOuut
è
outBufPŒ
 +ğ
wmmeSŒ—mD©a
->
by‹sP”U£rOuutBufãr
;

709 
	`Pa_EndU§geC®cuÏtiÚ
Ğ
¡»am
 );

711 ifĞ
gÙIÅut
 )

713 
mm»suÉ
 = 
	`waveInAddBufãr
Ğ
wmmeSŒ—mD©a
->
hWaveIn
,

714 &
wmmeSŒ—mD©a
->
šputBufãrs
[ wmmeSŒ—mD©a->
cu¼’tIÅutBufãr
 ],

715 (
WAVEHDR
) );

716 ifĞ
mm»suÉ
 !ğ
MMSYSERR_NOERROR
 )

718 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

719 
»suÉ
 = 
·Ho¡E¼Ü
;

722 
wmmeSŒ—mD©a
->
cu¼’tIÅutBufãr
 = (wmmeSŒ—mD©a->cu¼’tIÅutBufãr+1 >ğwmmeSŒ—mD©a->
numHo¡Bufãrs
) ?

723 0 : 
wmmeSŒ—mD©a
->
cu¼’tIÅutBufãr
+1;

726 ifĞ
gÙOuut
 )

728 #ià
PA_TRACE_START_STOP


729 
	`AddT¿ûMes§ge
Ğ"Pa_TimeSliû: wr™šg bufã¸", 
wmmeSŒ—mD©a
->
cu¼’tOuutBufãr
 );

731 
mm»suÉ
 = 
	`waveOutWr™e
Ğ
wmmeSŒ—mD©a
->
hWaveOut
,

732 &
wmmeSŒ—mD©a
->
ouutBufãrs
[ wmmeSŒ—mD©a->
cu¼’tOuutBufãr
 ],

733 (
WAVEHDR
) );

734 ifĞ
mm»suÉ
 !ğ
MMSYSERR_NOERROR
 )

736 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

737 
»suÉ
 = 
·Ho¡E¼Ü
;

740 
wmmeSŒ—mD©a
->
cu¼’tOuutBufãr
 = (wmmeSŒ—mD©a->cu¼’tOuutBufãr+1 >ğwmmeSŒ—mD©a->
numHo¡Bufãrs
) ?

741 0 : 
wmmeSŒ—mD©a
->
cu¼’tOuutBufãr
+1;

746 #ià
PA_TRACE_RUN


747 
	`AddT¿ûMes§ge
("Pa_TimeSliû: bufãrsProûs£d ", 
bufãrsProûs£d
 );

749  (
»suÉ
 !ğ0è?„esuÉ : 
dÚe
;

750 
	}
}

753 
PaE¼Ü
 
	$PaHo¡_BackgroundMªag”
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

755 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

756 
i
;

757 
numQueuedouutBufãrs
 = 0;

758 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = (PaWMMESŒ—mD©¨*è
¡»am
->
·¡_DeviûD©a
;

761 ifĞ
¡»am
->
·¡_StİNow
 )

763 
¡»am
->
·¡_IsAùive
 = 0;

768 ifĞ
¡»am
->
·¡_StİSoÚ
 )

772 
numQueuedouutBufãrs
 = 0;

773 ifĞ
¡»am
->
·¡_NumOuutChªÃls
 > 0 )

775  
i
=0; i<
wmmeSŒ—mD©a
->
numHo¡Bufãrs
; i++ )

777 ifĞ!Ğ
wmmeSŒ—mD©a
->
ouutBufãrs
[ 
i
 ].
dwFÏgs
 & 
WHDR_DONE
) )

779 #ià
PA_TRACE_START_STOP


780 
	`AddT¿ûMes§ge
Ğ"PaHo¡_BackgroundMªag”: wa™šg fÜ bufã¸", 
i
 );

782 
numQueuedouutBufãrs
++;

786 #ià
PA_TRACE_START_STOP


787 
	`AddT¿ûMes§ge
Ğ"PaHo¡_BackgroundMªag”:‚umQueuedouutBufãr ", 
numQueuedouutBufãrs
 );

789 ifĞ
numQueuedouutBufãrs
 == 0 )

791 
¡»am
->
·¡_IsAùive
 = 0;

797 ifĞ(
»suÉ
 = 
	`Pa_TimeSliû
Ğ
¡»am
 )) != 0)

800 #ià
PA_TRACE_START_STOP


801 
	`AddT¿ûMes§ge
Ğ"PaHo¡_BackgroundMªag”: TimeSliû(è»tuºed ", 
»suÉ
 );

803 
¡»am
->
·¡_StİSoÚ
 = 1;

804 
»suÉ
 = 
·NoE¼Ü
;

808 
	`PaHo¡_Upd©eSŒ—mTime
Ğ
wmmeSŒ—mD©a
 );

809  
»suÉ
;

810 
	}
}

812 #ià
PA_USE_TIMER_CALLBACK


814 
CALLBACK
 
	$Pa_Tim”C®lback
(
UINT
 
uID
, UINT 
uMsg
, 
DWORD
 
dwU£r
, DWORD 
dw1
, DWORD 
dw2
)

816 
š‹º®PÜtAudioSŒ—m
 *
¡»am
;

817 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
;

818 
PaE¼Ü
 
»suÉ
;

820 
¡»am
 = (
š‹º®PÜtAudioSŒ—m
 *è
dwU£r
;

821 ifĞ
¡»am
 =ğ
NULL
 ) ;

822 
wmmeSŒ—mD©a
 = (
PaWMMESŒ—mD©a
 *è
¡»am
->
·¡_DeviûD©a
;

823 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 ) ;

824 ifĞ
wmmeSŒ—mD©a
->
ifInsideC®lback
 )

826 ifĞ
wmmeSŒ—mD©a
->
tim”ID
 != 0 )

828 
	`timeKlEv’t
(
wmmeSŒ—mD©a
->
tim”ID
);

829 
wmmeSŒ—mD©a
->
tim”ID
 = 0;

833 
wmmeSŒ—mD©a
->
ifInsideC®lback
 = 1;

835 
»suÉ
 = 
	`PaHo¡_BackgroundMªag”
Ğ
¡»am
 );

836 ifĞ
»suÉ
 !ğ
·NoE¼Ü
 )

838 
¡»am
->
·¡_IsAùive
 = 0;

840 
wmmeSŒ—mD©a
->
ifInsideC®lback
 = 0;

841 
	}
}

844 
DWORD
 
WINAPI
 
	$WšMMPa_OuutTh»adProc
Ğ*
pArg
 )

846 
š‹º®PÜtAudioSŒ—m
 *
¡»am
;

847 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
;

848 
HANDLE
 
ev’ts
[2];

849 
numEv’ts
 = 0;

850 
DWORD
 
»suÉ
 = 0;

851 
DWORD
 
wa™ResuÉ
;

852 
DWORD
 
numTimeouts
 = 0;

853 
DWORD
 
timeOut
;

854 
¡»am
 = (
š‹º®PÜtAudioSŒ—m
 *è
pArg
;

855 
wmmeSŒ—mD©a
 = (
PaWMMESŒ—mD©a
 *è
¡»am
->
·¡_DeviûD©a
;

856 #ià
PA_TRACE_START_STOP


857 
	`AddT¿ûMes§ge
Ğ"WšMMPa_OuutTh»adProc:imeoutP”iod", 
timeoutP”iod
 );

858 
	`AddT¿ûMes§ge
Ğ"WšMMPa_OuutTh»adProc:…a¡_NumU£rBufãrs", 
¡»am
->
·¡_NumU£rBufãrs
 );

861 
timeOut
 = (
DWORD
è(500.0 * 
	`PaHo¡_G‘TÙ®BufãrF¿mes
Ğ
¡»am
 ) / sŒ—m->
·¡_Sam¶eR©e
);

863 
ev’ts
[
numEv’ts
++] = 
wmmeSŒ—mD©a
->
bufãrEv’t
;

864 ifĞ
wmmeSŒ—mD©a
->
abÜtEv’tIn™ed
 ) 
ev’ts
[
numEv’ts
++] = wmmeSŒ—mD©a->
abÜtEv’t
;

866  
¡»am
->
·¡_IsAùive
 )

871 
wa™ResuÉ
 = 
	`Wa™FÜMuÉËObjeùs
Ğ
numEv’ts
, 
ev’ts
, 
FALSE
, 
timeOut
 );

873 ifĞ
wa™ResuÉ
 =ğ
WAIT_FAILED
 )

875 
sPaHo¡E¼Ü
 = 
	`G‘La¡E¼Ü
();

876 
»suÉ
 = 
·Ho¡E¼Ü
;

877 
¡»am
->
·¡_IsAùive
 = 0;

880 ifĞ
wa™ResuÉ
 =ğ
WAIT_TIMEOUT
 )

882 #ià
PA_TRACE_START_STOP


883 
	`AddT¿ûMes§ge
Ğ"WšMMPa_OuutTh»adProc:imed ouˆ", 
numQueuedouutBufãrs
 );

885 
numTimeouts
 += 1;

888 
»suÉ
 = 
	`PaHo¡_BackgroundMªag”
Ğ
¡»am
 );

889 ifĞ
»suÉ
 !ğ
·NoE¼Ü
 )

891 
¡»am
->
·¡_IsAùive
 = 0;

894  
»suÉ
;

895 
	}
}

899 
PaE¼Ü
 
	$PaHo¡_O³nIÅutSŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

901 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

902 
MMRESULT
 
mm»suÉ
;

903 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
;

904 
i
;

905 
šputMmId
;

906 
by‹sP”IÅutF¿me
;

907 
WAVEFORMATEX
 
wfx
;

908 cÚ¡ 
PaDeviûInfo
 *
deviûInfo
;

910 
wmmeSŒ—mD©a
 = (
PaWMMESŒ—mD©a
 *è
¡»am
->
·¡_DeviûD©a
;

911 
	`DBUG
(("PaHo¡_O³nSŒ—m: deviûID = 0x%x\n", 
¡»am
->
·¡_IÅutDeviûID
));

912 
deviûInfo
 = 
	`Pa_G‘DeviûInfo
Ğ
¡»am
->
·¡_IÅutDeviûID
 );

913 ifĞ
deviûInfo
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

915  
deviûInfo
->
ÇtiveSam¶eFÜm©s
 )

917 
·IÁ32
:

918 
·Flßt32
:

919 
by‹sP”IÅutF¿me
 = (è* 
¡»am
->
·¡_NumIÅutChªÃls
;

922 
by‹sP”IÅutF¿me
 = (è* 
¡»am
->
·¡_NumIÅutChªÃls
;

925 
wfx
.
wFÜm©Tag
 = 
WAVE_FORMAT_PCM
;

926 
wfx
.
nChªÃls
 = (
WORD
è
¡»am
->
·¡_NumIÅutChªÃls
;

927 
wfx
.
nSam¶esP”Sec
 = (
DWORD
è
¡»am
->
·¡_Sam¶eR©e
;

928 
wfx
.
nAvgBy‹sP”Sec
 = (
DWORD
)(
by‹sP”IÅutF¿me
 * 
¡»am
->
·¡_Sam¶eR©e
);

929 
wfx
.
nBlockAlign
 = (
WORD
)
by‹sP”IÅutF¿me
;

930 
wfx
.
wB™sP”Sam¶e
 = (
WORD
)((
by‹sP”IÅutF¿me
/
¡»am
->
·¡_NumIÅutChªÃls
) * 8);

931 
wfx
.
cbSize
 = 0;

932 
šputMmId
 = 
	`PaDeviûIdToWšId
Ğ
¡»am
->
·¡_IÅutDeviûID
 );

933 #ià
PA_USE_TIMER_CALLBACK


934 
mm»suÉ
 = 
	`waveInO³n
Ğ&
wmmeSŒ—mD©a
->
hWaveIn
, 
šputMmId
, &
wfx
,

935 0, 0, 
CALLBACK_NULL
 );

937 
mm»suÉ
 = 
	`waveInO³n
Ğ&
wmmeSŒ—mD©a
->
hWaveIn
, 
šputMmId
, &
wfx
,

938 (
DWORD
)
wmmeSŒ—mD©a
->
bufãrEv’t
, (DWORDè
¡»am
, 
CALLBACK_EVENT
 );

940 ifĞ
mm»suÉ
 !ğ
MMSYSERR_NOERROR
 )

942 
	`ERR_RPT
(("PortAudio: PaHost_OpenInputStream() failed!\n"));

943 
»suÉ
 = 
·Ho¡E¼Ü
;

944 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

945 
”rÜ
;

948 
wmmeSŒ—mD©a
->
šputBufãrs
 = (
WAVEHDR
 *è
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
Ğ(WAVEHDR)*wmmeSŒ—mD©a->
numHo¡Bufãrs
 );

949 ifĞ
wmmeSŒ—mD©a
->
šputBufãrs
 =ğ
NULL
 )

951 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

952 
”rÜ
;

955  
i
=0; i<
wmmeSŒ—mD©a
->
numHo¡Bufãrs
; i++ )

957 
wmmeSŒ—mD©a
->
šputBufãrs
[
i
].
ÍD©a
 = (*)
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
ĞwmmeSŒ—mD©a->
by‹sP”Ho¡IÅutBufãr
 );

958 ifĞ
wmmeSŒ—mD©a
->
šputBufãrs
[
i
].
ÍD©a
 =ğ
NULL
 )

960 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

961 
”rÜ
;

963 
wmmeSŒ—mD©a
->
šputBufãrs
[
i
].
dwBufãrL’gth
 = wmmeSŒ—mD©a->
by‹sP”Ho¡IÅutBufãr
;

964 
wmmeSŒ—mD©a
->
šputBufãrs
[
i
].
dwU£r
 = i;

965 ifĞĞ
mm»suÉ
 = 
	`waveInP»·»H—d”
Ğ
wmmeSŒ—mD©a
->
hWaveIn
, &wmmeSŒ—mD©a->
šputBufãrs
[
i
], (
WAVEHDR
è)è!ğ
MMSYSERR_NOERROR
 )

967 
»suÉ
 = 
·Ho¡E¼Ü
;

968 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

969 
”rÜ
;

972  
»suÉ
;

974 
”rÜ
:

975  
»suÉ
;

976 
	}
}

978 
PaE¼Ü
 
	$PaHo¡_O³nOuutSŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

980 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

981 
MMRESULT
 
mm»suÉ
;

982 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
;

983 
i
;

984 
ouutMmID
;

985 
by‹sP”OuutF¿me
;

986 
WAVEFORMATEX
 
wfx
;

987 cÚ¡ 
PaDeviûInfo
 *
deviûInfo
;

989 
wmmeSŒ—mD©a
 = (
PaWMMESŒ—mD©a
 *è
¡»am
->
·¡_DeviûD©a
;

990 
	`DBUG
(("PaHo¡_O³nSŒ—m: deviûID = 0x%x\n", 
¡»am
->
·¡_OuutDeviûID
));

992 
deviûInfo
 = 
	`Pa_G‘DeviûInfo
Ğ
¡»am
->
·¡_OuutDeviûID
 );

993 ifĞ
deviûInfo
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

995  
deviûInfo
->
ÇtiveSam¶eFÜm©s
 )

997 
·IÁ32
:

998 
·Flßt32
:

999 
by‹sP”OuutF¿me
 = (è* 
¡»am
->
·¡_NumOuutChªÃls
;

1002 
by‹sP”OuutF¿me
 = (è* 
¡»am
->
·¡_NumOuutChªÃls
;

1005 
wfx
.
wFÜm©Tag
 = 
WAVE_FORMAT_PCM
;

1006 
wfx
.
nChªÃls
 = (
WORD
è
¡»am
->
·¡_NumOuutChªÃls
;

1007 
wfx
.
nSam¶esP”Sec
 = (
DWORD
è
¡»am
->
·¡_Sam¶eR©e
;

1008 
wfx
.
nAvgBy‹sP”Sec
 = (
DWORD
)(
by‹sP”OuutF¿me
 * 
¡»am
->
·¡_Sam¶eR©e
);

1009 
wfx
.
nBlockAlign
 = (
WORD
)
by‹sP”OuutF¿me
;

1010 
wfx
.
wB™sP”Sam¶e
 = (
WORD
)((
by‹sP”OuutF¿me
/
¡»am
->
·¡_NumOuutChªÃls
) * 8);

1011 
wfx
.
cbSize
 = 0;

1012 
ouutMmID
 = 
	`PaDeviûIdToWšId
Ğ
¡»am
->
·¡_OuutDeviûID
 );

1013 #ià
PA_USE_TIMER_CALLBACK


1014 
mm»suÉ
 = 
	`waveOutO³n
Ğ&
wmmeSŒ—mD©a
->
hWaveOut
, 
ouutMmID
, &
wfx
,

1015 0, 0, 
CALLBACK_NULL
 );

1018 
wmmeSŒ—mD©a
->
abÜtEv’t
 = 
	`C»©eEv’t
Ğ
NULL
, 
TRUE
, 
FALSE
, NULL );

1019 ifĞ
wmmeSŒ—mD©a
->
abÜtEv’t
 =ğ
NULL
 )

1021 
»suÉ
 = 
·Ho¡E¼Ü
;

1022 
sPaHo¡E¼Ü
 = 
	`G‘La¡E¼Ü
();

1023 
”rÜ
;

1025 
wmmeSŒ—mD©a
->
abÜtEv’tIn™ed
 = 1;

1026 
mm»suÉ
 = 
	`waveOutO³n
Ğ&
wmmeSŒ—mD©a
->
hWaveOut
, 
ouutMmID
, &
wfx
,

1027 (
DWORD
)
wmmeSŒ—mD©a
->
bufãrEv’t
, (DWORDè
¡»am
, 
CALLBACK_EVENT
 );

1029 ifĞ
mm»suÉ
 !ğ
MMSYSERR_NOERROR
 )

1031 
	`ERR_RPT
(("PortAudio: PaHost_OpenOutputStream() failed!\n"));

1032 
»suÉ
 = 
·Ho¡E¼Ü
;

1033 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

1034 
”rÜ
;

1037 
wmmeSŒ—mD©a
->
ouutBufãrs
 = (
WAVEHDR
 *è
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
Ğ(WAVEHDR)*wmmeSŒ—mD©a->
numHo¡Bufãrs
 );

1038 ifĞ
wmmeSŒ—mD©a
->
ouutBufãrs
 =ğ
NULL
 )

1040 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

1041 
”rÜ
;

1044  
i
=0; i<
wmmeSŒ—mD©a
->
numHo¡Bufãrs
; i++ )

1046 
wmmeSŒ—mD©a
->
ouutBufãrs
[
i
].
ÍD©a
 = (*è
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
ĞwmmeSŒ—mD©a->
by‹sP”Ho¡OuutBufãr
 );

1047 ifĞ
wmmeSŒ—mD©a
->
ouutBufãrs
[
i
].
ÍD©a
 =ğ
NULL
 )

1049 
»suÉ
 = 
·Insuffic›ÁMemÜy
;

1050 
”rÜ
;

1052 
wmmeSŒ—mD©a
->
ouutBufãrs
[
i
].
dwBufãrL’gth
 = wmmeSŒ—mD©a->
by‹sP”Ho¡OuutBufãr
;

1053 
wmmeSŒ—mD©a
->
ouutBufãrs
[
i
].
dwU£r
 = i;

1054 ifĞ(
mm»suÉ
 = 
	`waveOutP»·»H—d”
Ğ
wmmeSŒ—mD©a
->
hWaveOut
, &wmmeSŒ—mD©a->
ouutBufãrs
[
i
], (
WAVEHDR
è)è!ğ
MMSYSERR_NOERROR
 )

1056 
»suÉ
 = 
·Ho¡E¼Ü
;

1057 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

1058 
”rÜ
;

1061  
»suÉ
;

1063 
”rÜ
:

1064  
»suÉ
;

1065 
	}
}

1067 
PaE¼Ü
 
	$PaHo¡_G‘TÙ®BufãrF¿mes
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

1069 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = (PaWMMESŒ—mD©¨*è
¡»am
->
·¡_DeviûD©a
;

1070  
wmmeSŒ—mD©a
->
numHo¡Bufãrs
 * wmmeSŒ—mD©a->
äamesP”Ho¡Bufãr
;

1071 
	}
}

1076 
	$PaHo¡_C®cNumHo¡Bufãrs
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

1078 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = (PaWMMESŒ—mD©¨*è
¡»am
->
·¡_DeviûD©a
;

1079 
mšNumBufãrs
;

1080 
mšäamesP”Ho¡Bufãr
;

1081 
maxäamesP”Ho¡Bufãr
;

1082 
mšTÙ®F¿mes
;

1083 
u£rBufãrsP”Ho¡Bufãr
;

1084 
äamesP”Ho¡Bufãr
;

1085 
numHo¡Bufãrs
;

1088 
mšäamesP”Ho¡Bufãr
 = (è(
PA_MIN_MSEC_PER_HOST_BUFFER
 * 
¡»am
->
·¡_Sam¶eR©e
 * 0.001);

1089 
mšäamesP”Ho¡Bufãr
 = (minframesPerHostBuffer + 7) & ~7;

1090 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs: mšäamesP”Ho¡Bufã¸ğ%d\n", 
mšäamesP”Ho¡Bufãr
 ));

1091 
maxäamesP”Ho¡Bufãr
 = (è(
PA_MAX_MSEC_PER_HOST_BUFFER
 * 
¡»am
->
·¡_Sam¶eR©e
 * 0.001);

1092 
maxäamesP”Ho¡Bufãr
 = (maxframesPerHostBuffer + 7) & ~7;

1093 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs: maxäamesP”Ho¡Bufã¸ğ%d\n", 
maxäamesP”Ho¡Bufãr
 ));

1095 
mšNumBufãrs
 = 
	`Pa_G‘MšNumBufãrs
Ğ
¡»am
->
·¡_F¿mesP”U£rBufãr
, sŒ—m->
·¡_Sam¶eR©e
 );

1096 
¡»am
->
·¡_NumU£rBufãrs
 = ( 
mšNumBufãrs
 > stream->past_NumUserBuffers ) ? minNumBuffers : stream->past_NumUserBuffers;

1097 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs: mš…a¡_NumU£rBufãr ğ%d\n", 
¡»am
->
·¡_NumU£rBufãrs
 ));

1098 
mšTÙ®F¿mes
 = 
¡»am
->
·¡_NumU£rBufãrs
 * sŒ—m->
·¡_F¿mesP”U£rBufãr
;

1100 ifĞ(è
¡»am
->
·¡_F¿mesP”U£rBufãr
 < 
mšäamesP”Ho¡Bufãr
 )

1102 
u£rBufãrsP”Ho¡Bufãr
 =

1103 (
mšäamesP”Ho¡Bufãr
 + 
¡»am
->
·¡_F¿mesP”U£rBufãr
 - 1) /

1104 
¡»am
->
·¡_F¿mesP”U£rBufãr
;

1108 
u£rBufãrsP”Ho¡Bufãr
 = 1;

1110 
äamesP”Ho¡Bufãr
 = 
¡»am
->
·¡_F¿mesP”U£rBufãr
 * 
u£rBufãrsP”Ho¡Bufãr
;

1112 
numHo¡Bufãrs
 = (
mšTÙ®F¿mes
 + 
äamesP”Ho¡Bufãr
 - 1) / framesPerHostBuffer;

1114 ifĞ
numHo¡Bufãrs
 < 
PA_MIN_NUM_HOST_BUFFERS
)

1116 
numHo¡Bufãrs
 = 
PA_MIN_NUM_HOST_BUFFERS
;

1118 ifĞ(
numHo¡Bufãrs
 > 
PA_MAX_NUM_HOST_BUFFERS
) &&

1119 ((è
¡»am
->
·¡_F¿mesP”U£rBufãr
 < (
maxäamesP”Ho¡Bufãr
/2) ) )

1122 
numHo¡Bufãrs
 > 
PA_MAX_NUM_HOST_BUFFERS
)

1124 
u£rBufãrsP”Ho¡Bufãr
 += 1;

1125 
äamesP”Ho¡Bufãr
 = 
¡»am
->
·¡_F¿mesP”U£rBufãr
 * 
u£rBufãrsP”Ho¡Bufãr
;

1126 
numHo¡Bufãrs
 = (
mšTÙ®F¿mes
 + 
äamesP”Ho¡Bufãr
 - 1) / framesPerHostBuffer;

1128 ifĞ(
äamesP”Ho¡Bufãr
 > 
maxäamesP”Ho¡Bufãr
) ||

1129 (
numHo¡Bufãrs
 < 
PA_MAX_NUM_HOST_BUFFERS
) )

1131 
u£rBufãrsP”Ho¡Bufãr
 -= 1;

1132 
äamesP”Ho¡Bufãr
 = 
¡»am
->
·¡_F¿mesP”U£rBufãr
 * 
u£rBufãrsP”Ho¡Bufãr
;

1133 
numHo¡Bufãrs
 = (
mšTÙ®F¿mes
 + 
äamesP”Ho¡Bufãr
 - 1) / framesPerHostBuffer;

1139 
wmmeSŒ—mD©a
->
u£rBufãrsP”Ho¡Bufãr
 = userBuffersPerHostBuffer;

1140 
wmmeSŒ—mD©a
->
äamesP”Ho¡Bufãr
 = framesPerHostBuffer;

1141 
wmmeSŒ—mD©a
->
numHo¡Bufãrs
 =‚umHostBuffers;

1142 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs: u£rBufãrsP”Ho¡Bufã¸ğ%d\n", 
wmmeSŒ—mD©a
->
u£rBufãrsP”Ho¡Bufãr
 ));

1143 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs:‚umHo¡Bufãr ğ%d\n", 
wmmeSŒ—mD©a
->
numHo¡Bufãrs
 ));

1144 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs: f¿mesP”Ho¡Bufã¸ğ%d\n", 
wmmeSŒ—mD©a
->
äamesP”Ho¡Bufãr
 ));

1145 
	`DBUG
(("PaHo¡_C®cNumHo¡Bufãrs:…a¡_NumU£rBufãr ğ%d\n", 
¡»am
->
·¡_NumU£rBufãrs
 ));

1146 
	}
}

1148 
PaE¼Ü
 
	$PaHo¡_O³nSŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

1150 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1151 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
;

1153 
»suÉ
 = 
	`PaHo¡_AÎoÿ‹WMMESŒ—mD©a
Ğ
¡»am
 );

1154 ifĞ
»suÉ
 !ğ
·NoE¼Ü
 ) „esult;

1156 
wmmeSŒ—mD©a
 = 
	`PaHo¡_G‘WMMESŒ—mD©a
Ğ
¡»am
 );

1159 
	`PaHo¡_C®cNumHo¡Bufãrs
Ğ
¡»am
 );

1161 
m£cL©’cy
 = (è((
	`PaHo¡_G‘TÙ®BufãrF¿mes
(
¡»am
è* 1000è/ sŒ—m->
·¡_Sam¶eR©e
);

1162 
	`DBUG
(("PÜtAudiØÚ WMME - L©’cy = %d f¿mes, %d m£c\n", 
	`PaHo¡_G‘TÙ®BufãrF¿mes
(
¡»am
), 
m£cL©’cy
 ));

1164 
	`In™ŸlizeCr™iÿlSeùiÚ
Ğ&
wmmeSŒ—mD©a
->
¡»amLock
 );

1165 
wmmeSŒ—mD©a
->
¡»amLockIn™ed
 = 1;

1167 #ià(
PA_USE_TIMER_CALLBACK
 == 0)

1168 
wmmeSŒ—mD©a
->
bufãrEv’tIn™ed
 = 0;

1169 
wmmeSŒ—mD©a
->
bufãrEv’t
 = 
	`C»©eEv’t
Ğ
NULL
, 
FALSE
, FALSE, NULL );

1170 ifĞ
wmmeSŒ—mD©a
->
bufãrEv’t
 =ğ
NULL
 )

1172 
»suÉ
 = 
·Ho¡E¼Ü
;

1173 
sPaHo¡E¼Ü
 = 
	`G‘La¡E¼Ü
();

1174 
”rÜ
;

1176 
wmmeSŒ—mD©a
->
bufãrEv’tIn™ed
 = 1;

1179 
wmmeSŒ—mD©a
->
by‹sP”U£rOuutBufãr
 = 
¡»am
->
·¡_F¿mesP”U£rBufãr
 * sŒ—m->
·¡_NumOuutChªÃls
 * ();

1180 
wmmeSŒ—mD©a
->
by‹sP”Ho¡OuutBufãr
 = wmmeSŒ—mD©a->
u£rBufãrsP”Ho¡Bufãr
 * wmmeSŒ—mD©a->
by‹sP”U£rOuutBufãr
;

1181 ifĞ(
¡»am
->
·¡_OuutDeviûID
 !ğ
·NoDeviû
è&& (¡»am->
·¡_NumOuutChªÃls
 > 0) )

1183 
»suÉ
 = 
	`PaHo¡_O³nOuutSŒ—m
Ğ
¡»am
 );

1184 ifĞ
»suÉ
 < 0 ) 
”rÜ
;

1187 
wmmeSŒ—mD©a
->
by‹sP”U£rIÅutBufãr
 = 
¡»am
->
·¡_F¿mesP”U£rBufãr
 * sŒ—m->
·¡_NumIÅutChªÃls
 * ();

1188 
wmmeSŒ—mD©a
->
by‹sP”Ho¡IÅutBufãr
 = wmmeSŒ—mD©a->
u£rBufãrsP”Ho¡Bufãr
 * wmmeSŒ—mD©a->
by‹sP”U£rIÅutBufãr
;

1189 ifĞ(
¡»am
->
·¡_IÅutDeviûID
 !ğ
·NoDeviû
è&& (¡»am->
·¡_NumIÅutChªÃls
 > 0) )

1191 
»suÉ
 = 
	`PaHo¡_O³nIÅutSŒ—m
Ğ
¡»am
 );

1192 ifĞ
»suÉ
 < 0 ) 
”rÜ
;

1195 
	`Pa_In™ŸlizeCpuU§geSÿÏr
Ğ
¡»am
 );

1197  
»suÉ
;

1199 
”rÜ
:

1200 
	`PaHo¡_Clo£SŒ—m
Ğ
¡»am
 );

1201  
»suÉ
;

1202 
	}
}

1204 
PaE¼Ü
 
	$PaHo¡_S¹Ouut
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

1206 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1207 
MMRESULT
 
mm»suÉ
;

1208 
i
;

1209 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = 
	`PaHo¡_G‘WMMESŒ—mD©a
Ğ
¡»am
 );

1211 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

1213 ifĞ
¡»am
->
·¡_OuutDeviûID
 !ğ
·NoDeviû
 )

1215 ifĞ(
mm»suÉ
 = 
	`waveOutPau£
Ğ
wmmeSŒ—mD©a
->
hWaveOut
 )è!ğ
MMSYSERR_NOERROR
 )

1217 
»suÉ
 = 
·Ho¡E¼Ü
;

1218 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

1219 
”rÜ
;

1221  
i
=0; i<
wmmeSŒ—mD©a
->
numHo¡Bufãrs
; i++ )

1223 
	`Z”oMemÜy
Ğ
wmmeSŒ—mD©a
->
ouutBufãrs
[
i
].
ÍD©a
, wmmeSŒ—mD©a->ouutBufãrs[i].
dwBufãrL’gth
 );

1224 
mm»suÉ
 = 
	`waveOutWr™e
Ğ
wmmeSŒ—mD©a
->
hWaveOut
, &wmmeSŒ—mD©a->
ouutBufãrs
[
i
], (
WAVEHDR
) );

1225 ifĞ
mm»suÉ
 !ğ
MMSYSERR_NOERROR
 )

1227 
»suÉ
 = 
·Ho¡E¼Ü
;

1228 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

1229 
”rÜ
;

1231 
¡»am
->
·¡_F¿meCouÁ
 +ğ
wmmeSŒ—mD©a
->
äamesP”Ho¡Bufãr
;

1233 
wmmeSŒ—mD©a
->
cu¼’tOuutBufãr
 = 0;

1234 ifĞ(
mm»suÉ
 = 
	`waveOutRe¡¬t
Ğ
wmmeSŒ—mD©a
->
hWaveOut
 )è!ğ
MMSYSERR_NOERROR
 )

1236 
»suÉ
 = 
·Ho¡E¼Ü
;

1237 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

1238 
”rÜ
;

1242 
”rÜ
:

1243 
	`DBUG
(("PaHo¡_S¹Ouut: wav»tuºed mm»suÉ = 0x%X.\n", 
mm»suÉ
));

1244  
»suÉ
;

1245 
	}
}

1247 
PaE¼Ü
 
	$PaHo¡_S¹IÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
š‹º®SŒ—m
 )

1249 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1250 
MMRESULT
 
mm»suÉ
;

1251 
i
;

1252 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = 
	`PaHo¡_G‘WMMESŒ—mD©a
Ğ
š‹º®SŒ—m
 );

1254 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

1256 ifĞ
š‹º®SŒ—m
->
·¡_IÅutDeviûID
 !ğ
·NoDeviû
 )

1258  
i
=0; i<
wmmeSŒ—mD©a
->
numHo¡Bufãrs
; i++ )

1260 
mm»suÉ
 = 
	`waveInAddBufãr
Ğ
wmmeSŒ—mD©a
->
hWaveIn
, &wmmeSŒ—mD©a->
šputBufãrs
[
i
], (
WAVEHDR
) );

1261 ifĞ
mm»suÉ
 !ğ
MMSYSERR_NOERROR
 )

1263 
»suÉ
 = 
·Ho¡E¼Ü
;

1264 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

1265 
”rÜ
;

1268 
wmmeSŒ—mD©a
->
cu¼’tIÅutBufãr
 = 0;

1269 
mm»suÉ
 = 
	`waveInS¹
Ğ
wmmeSŒ—mD©a
->
hWaveIn
 );

1270 
	`DBUG
(("Pa_S¹SŒ—m: waveInS¹„‘uºed = 0x%X.\n", 
mm»suÉ
));

1271 ifĞ
mm»suÉ
 !ğ
MMSYSERR_NOERROR
 )

1273 
»suÉ
 = 
·Ho¡E¼Ü
;

1274 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

1275 
”rÜ
;

1279 
”rÜ
:

1280  
»suÉ
;

1281 
	}
}

1283 
PaE¼Ü
 
	$PaHo¡_S¹Engše
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

1285 
PaE¼Ü
 
»suÉ
 = 
·NoE¼Ü
;

1286 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = 
	`PaHo¡_G‘WMMESŒ—mD©a
Ğ
¡»am
 );

1287 #ià
PA_USE_TIMER_CALLBACK


1288 
»sŞutiÚ
;

1289 
bufsP”Tim”C®lback
;

1290 
m£cP”Bufãr
;

1293 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

1295 
¡»am
->
·¡_StİSoÚ
 = 0;

1296 
¡»am
->
·¡_StİNow
 = 0;

1297 
¡»am
->
·¡_IsAùive
 = 1;

1298 
wmmeSŒ—mD©a
->
äamesPÏyed
 = 0.0;

1299 
wmmeSŒ—mD©a
->
Ï¡Pos™iÚ
 = 0;

1300 #ià
PA_TRACE_START_STOP


1301 
	`AddT¿ûMes§ge
Ğ"PaHo¡_S¹Engše: TimeSliû(è»tuºed ", 
»suÉ
 );

1303 #ià
PA_USE_TIMER_CALLBACK


1305 
bufsP”Tim”C®lback
 = 
wmmeSŒ—mD©a
->
numHo¡Bufãrs
/4;

1306 ifĞ
bufsP”Tim”C®lback
 < 1 ) bufsPerTimerCallback = 1;

1307 ifĞ
bufsP”Tim”C®lback
 < 1 ) bufsPerTimerCallback = 1;

1308 
m£cP”Bufãr
 = (1000 * 
bufsP”Tim”C®lback
 *

1309 
wmmeSŒ—mD©a
->
u£rBufãrsP”Ho¡Bufãr
 *

1310 
š‹º®SŒ—m
->
·¡_F¿mesP”U£rBufãr
 ) / (èš‹º®SŒ—m->
·¡_Sam¶eR©e
;

1311 ifĞ
m£cP”Bufãr
 < 10 ) msecPerBuffer = 10;

1312 ifĞ
m£cP”Bufãr
 > 100 ) msecPerBuffer = 100;

1313 
»sŞutiÚ
 = 
m£cP”Bufãr
/4;

1314 
wmmeSŒ—mD©a
->
tim”ID
 = 
	`timeS‘Ev’t
Ğ
m£cP”Bufãr
, 
»sŞutiÚ
,

1315 (
LPTIMECALLBACK
è
Pa_Tim”C®lback
,

1316 (
DWORD
è
¡»am
, 
TIME_PERIODIC
 );

1317 ifĞ
wmmeSŒ—mD©a
->
tim”ID
 == 0 )

1319 
»suÉ
 = 
·Ho¡E¼Ü
;

1320 
sPaHo¡E¼Ü
 = 
	`G‘La¡E¼Ü
();;

1321 
”rÜ
;

1324 
	`Re£tEv’t
Ğ
wmmeSŒ—mD©a
->
abÜtEv’t
 );

1326 
wmmeSŒ—mD©a
->
’gšeTh»ad
 = 
	`C»©eTh»ad
Ğ0, 0, 
WšMMPa_OuutTh»adProc
, 
¡»am
, 0, &wmmeSŒ—mD©a->
’gšeTh»adID
 );

1327 ifĞ
wmmeSŒ—mD©a
->
’gšeTh»ad
 =ğ
NULL
 )

1329 
»suÉ
 = 
·Ho¡E¼Ü
;

1330 
sPaHo¡E¼Ü
 = 
	`G‘La¡E¼Ü
();;

1331 
”rÜ
;

1333 #ià
PA_TRACE_START_STOP


1334 
	`AddT¿ûMes§ge
Ğ"PaHo¡_S¹Engše:h»ad ", (è
wmmeSŒ—mD©a
->
’gšeTh»ad
 );

1344 ifĞ!
	`S‘PriÜ™yCÏss
Ğ
	`G‘Cu¼’tProûss
(), 
HIGH_PRIORITY_CLASS
 ) )

1346 
»suÉ
 = 
·Ho¡E¼Ü
;

1347 
sPaHo¡E¼Ü
 = 
	`G‘La¡E¼Ü
();;

1348 
”rÜ
;

1352 ifĞ!
	`S‘Th»adPriÜ™y
Ğ
wmmeSŒ—mD©a
->
’gšeTh»ad
, 
THREAD_PRIORITY_HIGHEST
 ) )

1354 
»suÉ
 = 
·Ho¡E¼Ü
;

1355 
sPaHo¡E¼Ü
 = 
	`G‘La¡E¼Ü
();;

1356 
”rÜ
;

1360 
”rÜ
:

1361  
»suÉ
;

1362 
	}
}

1364 
PaE¼Ü
 
	$PaHo¡_StİEngše
Ğ
š‹º®PÜtAudioSŒ—m
 *
š‹º®SŒ—m
, 
abÜt
 )

1366 
timeOut
;

1367 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = 
	`PaHo¡_G‘WMMESŒ—mD©a
Ğ
š‹º®SŒ—m
 );

1369 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 )  
·NoE¼Ü
;

1372 
š‹º®SŒ—m
->
·¡_StİSoÚ
 = 1;

1374 ifĞ
abÜt
 ) 
š‹º®SŒ—m
->
·¡_StİNow
 = 1;

1377 
timeOut
 = (
DWORD
è(1500.0 * 
	`PaHo¡_G‘TÙ®BufãrF¿mes
Ğ
š‹º®SŒ—m
 ) / iÁ”ÇlSŒ—m->
·¡_Sam¶eR©e
);

1378 ifĞ
timeOut
 < 
MIN_TIMEOUT_MSEC
 )imeOut = MIN_TIMEOUT_MSEC;

1380 #ià
PA_USE_TIMER_CALLBACK


1381 ifĞ(
š‹º®SŒ—m
->
·¡_OuutDeviûID
 !ğ
·NoDeviû
) &&

1382 
š‹º®SŒ—m
->
·¡_IsAùive
 &&

1383 (
wmmeSŒ—mD©a
->
tim”ID
 != 0) )

1386  (
š‹º®SŒ—m
->
·¡_IsAùive
è&& (
timeOut
 > 0) )

1388 
	`SË•
(10);

1389 
timeOut
 -= 10;

1391 
	`timeKlEv’t
Ğ
wmmeSŒ—mD©a
->
tim”ID
 );

1392 
wmmeSŒ—mD©a
->
tim”ID
 = 0;

1395 #ià
PA_TRACE_START_STOP


1396 
	`AddT¿ûMes§ge
Ğ"PaHo¡_StİEngše:h»ad ", (è
wmmeSŒ—mD©a
->
’gšeTh»ad
 );

1398 ifĞ(
š‹º®SŒ—m
->
·¡_OuutDeviûID
 !ğ
·NoDeviû
) &&

1399 (
š‹º®SŒ—m
->
·¡_IsAùive
) &&

1400 (
wmmeSŒ—mD©a
->
’gšeTh»ad
 !ğ
NULL
) )

1402 
DWORD
 
gÙ
;

1404 
	`DBUG
(("PaHost_StopEngine: waiting for backgroundhread.\n"));

1405 
gÙ
 = 
	`Wa™FÜSšgËObjeù
Ğ
wmmeSŒ—mD©a
->
’gšeTh»ad
, 
timeOut
 );

1406 ifĞ
gÙ
 =ğ
WAIT_TIMEOUT
 )

1408 
	`ERR_RPT
(("PaHost_StopEngine:imed out while waiting for backgroundhreado finish.\n"));

1409  
·TimedOut
;

1411 
	`Clo£HªdË
Ğ
wmmeSŒ—mD©a
->
’gšeTh»ad
 );

1412 
wmmeSŒ—mD©a
->
’gšeTh»ad
 = 
NULL
;

1416 
š‹º®SŒ—m
->
·¡_IsAùive
 = 0;

1417  
·NoE¼Ü
;

1418 
	}
}

1420 
PaE¼Ü
 
	$PaHo¡_StİIÅut
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
, 
abÜt
 )

1422 
MMRESULT
 
mm»suÉ
;

1423 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = 
	`PaHo¡_G‘WMMESŒ—mD©a
Ğ
¡»am
 );

1425 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 )  
·NoE¼Ü
;

1426 (è
abÜt
;

1428 ifĞ
wmmeSŒ—mD©a
->
hWaveIn
 !ğ
NULL
 )

1430 
mm»suÉ
 = 
	`waveInRe£t
Ğ
wmmeSŒ—mD©a
->
hWaveIn
 );

1431 ifĞ
mm»suÉ
 !ğ
MMSYSERR_NOERROR
 )

1433 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

1434  
·Ho¡E¼Ü
;

1437  
·NoE¼Ü
;

1438 
	}
}

1440 
PaE¼Ü
 
	$PaHo¡_StİOuut
Ğ
š‹º®PÜtAudioSŒ—m
 *
š‹º®SŒ—m
, 
abÜt
 )

1442 
MMRESULT
 
mm»suÉ
;

1443 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = 
	`PaHo¡_G‘WMMESŒ—mD©a
Ğ
š‹º®SŒ—m
 );

1445 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 )  
·NoE¼Ü
;

1446 (è
abÜt
;

1448 #ià
PA_TRACE_START_STOP


1449 
	`AddT¿ûMes§ge
Ğ"PaHo¡_StİOuut: hWaveOuˆ", (è
wmmeSŒ—mD©a
->
hWaveOut
 );

1451 ifĞ
wmmeSŒ—mD©a
->
hWaveOut
 !ğ
NULL
 )

1453 
mm»suÉ
 = 
	`waveOutRe£t
Ğ
wmmeSŒ—mD©a
->
hWaveOut
 );

1454 ifĞ
mm»suÉ
 !ğ
MMSYSERR_NOERROR
 )

1456 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

1457  
·Ho¡E¼Ü
;

1460  
·NoE¼Ü
;

1461 
	}
}

1463 
PaE¼Ü
 
	$PaHo¡_Clo£SŒ—m
Ğ
š‹º®PÜtAudioSŒ—m
 *
¡»am
 )

1465 
i
;

1466 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = 
	`PaHo¡_G‘WMMESŒ—mD©a
Ğ
¡»am
 );

1468 ifĞ
¡»am
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

1469 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 )  
·NoE¼Ü
;

1471 #ià
PA_TRACE_START_STOP


1472 
	`AddT¿ûMes§ge
Ğ"PaHo¡_Clo£SŒ—m: hWaveOuˆ", (è
wmmeSŒ—mD©a
->
hWaveOut
 );

1475 ifĞ
wmmeSŒ—mD©a
->
hWaveOut
 )

1477 ifĞ
wmmeSŒ—mD©a
->
ouutBufãrs
 )

1479  
i
=0; i<
wmmeSŒ—mD©a
->
numHo¡Bufãrs
; i++ )

1481 
	`waveOutUÅ»·»H—d”
Ğ
wmmeSŒ—mD©a
->
hWaveOut
, &wmmeSŒ—mD©a->
ouutBufãrs
[
i
], (
WAVEHDR
) );

1482 
	`PaHo¡_F»eT¿ckedMemÜy
Ğ
wmmeSŒ—mD©a
->
ouutBufãrs
[
i
].
ÍD©a
 );

1484 
	`PaHo¡_F»eT¿ckedMemÜy
Ğ
wmmeSŒ—mD©a
->
ouutBufãrs
 );

1486 
	`waveOutClo£
Ğ
wmmeSŒ—mD©a
->
hWaveOut
 );

1489 ifĞ
wmmeSŒ—mD©a
->
hWaveIn
 )

1491 ifĞ
wmmeSŒ—mD©a
->
šputBufãrs
 )

1493  
i
=0; i<
wmmeSŒ—mD©a
->
numHo¡Bufãrs
; i++ )

1495 
	`waveInUÅ»·»H—d”
Ğ
wmmeSŒ—mD©a
->
hWaveIn
, &wmmeSŒ—mD©a->
šputBufãrs
[
i
], (
WAVEHDR
) );

1496 
	`PaHo¡_F»eT¿ckedMemÜy
Ğ
wmmeSŒ—mD©a
->
šputBufãrs
[
i
].
ÍD©a
 );

1498 
	`PaHo¡_F»eT¿ckedMemÜy
Ğ
wmmeSŒ—mD©a
->
šputBufãrs
 );

1500 
	`waveInClo£
Ğ
wmmeSŒ—mD©a
->
hWaveIn
 );

1502 #ià(
PA_USE_TIMER_CALLBACK
 == 0)

1503 ifĞ
wmmeSŒ—mD©a
->
abÜtEv’tIn™ed
 ) 
	`Clo£HªdË
ĞwmmeSŒ—mD©a->
abÜtEv’t
 );

1504 ifĞ
wmmeSŒ—mD©a
->
bufãrEv’tIn™ed
 ) 
	`Clo£HªdË
ĞwmmeSŒ—mD©a->
bufãrEv’t
 );

1506 ifĞ
wmmeSŒ—mD©a
->
¡»amLockIn™ed
 )

1507 
	`D–‘eCr™iÿlSeùiÚ
Ğ&
wmmeSŒ—mD©a
->
¡»amLock
 );

1509 
	`PaHo¡_F»eWMMESŒ—mD©a
Ğ
¡»am
 );

1511  
·NoE¼Ü
;

1512 
	}
}

1524 
	#PA_LATENCY_ENV_NAME
 ("PA_MIN_LATENCY_MSEC")

	)

1525 
	$Pa_G‘MšNumBufãrs
Ğ
äamesP”Bufãr
, 
§m¶eR©e
 )

1527 
’vbuf
[
PA_ENV_BUF_SIZE
];

1528 
DWORD
 
h»suÉ
;

1529 
mšL©’cyM£c
 = 0;

1530 
m£cP”Bufãr
 = (1000.0 * 
äamesP”Bufãr
è/ 
§m¶eR©e
;

1531 
mšBufãrs
;

1534 
h»suÉ
 = 
	`G‘EnvœÚm’tV¬ŸbË
Ğ
PA_LATENCY_ENV_NAME
, 
’vbuf
, 
PA_ENV_BUF_SIZE
 );

1535 ifĞ(
h»suÉ
 > 0è&& (h»suÉ < 
PA_ENV_BUF_SIZE
) )

1537 
mšL©’cyM£c
 = 
	`©oi
Ğ
’vbuf
 );

1544 
OSVERSIONINFO
 
osvi
;

1545 
osvi
.
dwOSV”siÚInfoSize
 = ( osvi );

1546 
	`G‘V”siÚEx
Ğ&
osvi
 );

1547 
	`DBUG
(("PA - PÏtfÜmId = 0x%x\n", 
osvi
.
dwPÏtfÜmId
 ));

1548 
	`DBUG
(("PA - MajÜV”siÚ = 0x%x\n", 
osvi
.
dwMajÜV”siÚ
 ));

1549 
	`DBUG
(("PA - MšÜV”siÚ = 0x%x\n", 
osvi
.
dwMšÜV”siÚ
 ));

1551 ifĞ(
osvi
.
dwMajÜV”siÚ
 =ğ4è&& (osvi.
dwPÏtfÜmId
 == 2) )

1553 
mšL©’cyM£c
 = 
PA_WIN_NT_LATENCY
;

1555 if(
osvi
.
dwMajÜV”siÚ
 >= 5)

1557 
mšL©’cyM£c
 = 
PA_WIN_WDM_LATENCY
;

1561 
mšL©’cyM£c
 = 
PA_WIN_9X_LATENCY
;

1563 #ià
PA_USE_HIGH_LATENCY


1564 
	`PRINT
(("PA - Mšimum L©’cy s‘Ø%d m£c!\n", 
mšL©’cyM£c
 ));

1568 
	`DBUG
(("PA - Mšimum L©’cy s‘Ø%d m£c!\n", 
mšL©’cyM£c
 ));

1569 
mšBufãrs
 = (è(1.0 + (()
mšL©’cyM£c
 / 
m£cP”Bufãr
));

1570 ifĞ
mšBufãrs
 < 2 ) minBuffers = 2;

1571  
mšBufãrs
;

1572 
	}
}

1576 
PaE¼Ü
 
	$PaHo¡_T”m
( )

1578 
i
;

1580 ifĞ
sNumDeviûs
 > 0 )

1582 ifĞ
sDeviûPŒs
 !ğ
NULL
 )

1584  
i
=0; i<
sNumDeviûs
; i++ )

1586 ifĞ
sDeviûPŒs
[
i
] !ğ
NULL
 )

1588 
	`PaHo¡_F»eT¿ckedMemÜy
Ğ(*)
sDeviûPŒs
[
i
]->
Çme
 );

1589 
	`PaHo¡_F»eT¿ckedMemÜy
Ğ(*)
sDeviûPŒs
[
i
]->
§m¶eR©es
 );

1590 
	`PaHo¡_F»eT¿ckedMemÜy
Ğ
sDeviûPŒs
[
i
] );

1593 
	`PaHo¡_F»eT¿ckedMemÜy
Ğ
sDeviûPŒs
 );

1594 
sDeviûPŒs
 = 
NULL
;

1596 
sNumDeviûs
 = 0;

1599 #ià
PA_TRACK_MEMORY


1600 
	`PRINT
(("PaHo¡_T”m: sNumAÎoÿtiÚ ğ%d\n", 
sNumAÎoÿtiÚs
 ));

1603  
·NoE¼Ü
;

1604 
	}
}

1606 
	$Pa_SË•
Ğ
m£c
 )

1608 
	`SË•
Ğ
m£c
 );

1609 
	}
}

1618 *
	$PaHo¡_AÎoÿ‹Fa¡MemÜy
Ğ
numBy‹s
 )

1620  
	`PaHo¡_AÎoÿ‹T¿ckedMemÜy
Ğ
numBy‹s
 );

1621 
	}
}

1626 
	$PaHo¡_F»eFa¡MemÜy
Ğ*
addr
, 
numBy‹s
 )

1628 (è
numBy‹s
;

1630 
	`PaHo¡_F»eT¿ckedMemÜy
Ğ
addr
 );

1631 
	}
}

1636 *
	$PaHo¡_AÎoÿ‹T¿ckedMemÜy
Ğ
numBy‹s
 )

1638 *
»suÉ
 = 
	`Glob®AÎoc
Ğ
GPTR
, 
numBy‹s
 );

1640 #ià
PA_TRACK_MEMORY


1641 ifĞ
»suÉ
 !ğ
NULL
 ) 
sNumAÎoÿtiÚs
 += 1;

1643  
»suÉ
;

1644 
	}
}

1646 
	$PaHo¡_F»eT¿ckedMemÜy
Ğ*
addr
 )

1648 ifĞ
addr
 !ğ
NULL
 )

1650 
	`Glob®F»e
Ğ
addr
 );

1651 #ià
PA_TRACK_MEMORY


1652 
sNumAÎoÿtiÚs
 -= 1;

1655 
	}
}

1658 
PaE¼Ü
 
	$PaHo¡_SŒ—mAùive
Ğ
š‹º®PÜtAudioSŒ—m
 *
š‹º®SŒ—m
 )

1660 ifĞ
š‹º®SŒ—m
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

1662  (
PaE¼Ü
è
š‹º®SŒ—m
->
·¡_IsAùive
;

1663 
	}
}

1668 
PaE¼Ü
 
	$PaHo¡_Upd©eSŒ—mTime
Ğ
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 )

1670 
MMRESULT
 
mm»suÉ
;

1671 
MMTIME
 
mmtime
;

1672 cÚ¡ 
shiá
 = 6;

1673 
mmtime
.
wTy³
 = 
TIME_SAMPLES
;

1675 ifĞ
wmmeSŒ—mD©a
->
hWaveOut
 !ğ
NULL
 )

1677 
mm»suÉ
 = 
	`waveOutG‘Pos™iÚ
Ğ
wmmeSŒ—mD©a
->
hWaveOut
, &
mmtime
, (mmtime) );

1681 
mm»suÉ
 = 
	`waveInG‘Pos™iÚ
Ğ
wmmeSŒ—mD©a
->
hWaveIn
, &
mmtime
, (mmtime) );

1684 ifĞ
mm»suÉ
 !ğ
MMSYSERR_NOERROR
 )

1686 
sPaHo¡E¼Ü
 = 
mm»suÉ
;

1687  
·Ho¡E¼Ü
;

1692 
	`EÁ”Cr™iÿlSeùiÚ
Ğ&
wmmeSŒ—mD©a
->
¡»amLock
 );

1700 
wmmeSŒ—mD©a
->
äamesPÏyed
 +=

1701 (()((((
DWORD
)
mmtime
.
u
.
§m¶e
)<<
shiá
) -

1702 (((
DWORD
)(
wmmeSŒ—mD©a
->
Ï¡Pos™iÚ
))<<
shiá
)))>>shift;

1708 
wmmeSŒ—mD©a
->
Ï¡Pos™iÚ
 = ()
mmtime
.
u
.
§m¶e
;

1709 
	`L—veCr™iÿlSeùiÚ
Ğ&
wmmeSŒ—mD©a
->
¡»amLock
 );

1711  
·NoE¼Ü
;

1712 
	}
}

1714 
PaTime¡amp
 
	$Pa_SŒ—mTime
Ğ
PÜtAudioSŒ—m
 *
¡»am
 )

1716 
š‹º®PÜtAudioSŒ—m
 *
š‹º®SŒ—m
 = 
	`PaHo¡_G‘SŒ—mR•»£Á©iÚ
Ğ
¡»am
 );

1717 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
 = 
	`PaHo¡_G‘WMMESŒ—mD©a
Ğ
š‹º®SŒ—m
 );

1719 ifĞ
š‹º®SŒ—m
 =ğ
NULL
 )  
·BadSŒ—mPŒ
;

1720 ifĞ
wmmeSŒ—mD©a
 =ğ
NULL
 )  
·IÁ”ÇlE¼Ü
;

1722 
	`PaHo¡_Upd©eSŒ—mTime
Ğ
wmmeSŒ—mD©a
 );

1723  
wmmeSŒ—mD©a
->
äamesPÏyed
;

1724 
	}
}

	@portaudio/pablio/pablio.c

41 
	~<¡dio.h
>

42 
	~<¡dlib.h
>

43 
	~<m©h.h
>

44 
	~"pÜudio.h
"

45 
	~"ršgbufãr.h
"

46 
	~"·blio.h
"

47 
	~<¡ršg.h
>

53 
	#FRAMES_PER_BUFFER
 (256)

	)

59 
blockšgIOC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

60 
äamesP”Bufãr
,

61 
PaTime¡amp
 
outTime
, *
u£rD©a
 );

62 
PaE¼Ü
 
PABLIO_In™FIFO
Ğ
RšgBufãr
 *
rbuf
, 
numF¿mes
, 
by‹sP”F¿me
 );

63 
PaE¼Ü
 
PABLIO_T”mFIFO
Ğ
RšgBufãr
 *
rbuf
 );

72 
	$blockšgIOC®lback
Ğ*
šputBufãr
, *
ouutBufãr
,

73 
äamesP”Bufãr
,

74 
PaTime¡amp
 
outTime
, *
u£rD©a
 )

76 
PABLIO_SŒ—m
 *
d©a
 = (PABLIO_SŒ—m*)
u£rD©a
;

77 
numBy‹s
 = 
d©a
->
by‹sP”F¿me
 * 
äamesP”Bufãr
;

78 (è
outTime
;

81 ifĞ
šputBufãr
 !ğ
NULL
 )

83 
	`RšgBufãr_Wr™e
Ğ&
d©a
->
šFIFO
, 
šputBufãr
, 
numBy‹s
 );

85 ifĞ
ouutBufãr
 !ğ
NULL
 )

87 
i
;

88 
numR—d
 = 
	`RšgBufãr_R—d
Ğ&
d©a
->
outFIFO
, 
ouutBufãr
, 
numBy‹s
 );

90  
i
=
numR—d
; i<
numBy‹s
; i++ )

92 ((*)
ouutBufãr
)[
i
] = 0;

97 
	}
}

100 
PaE¼Ü
 
	$PABLIO_In™FIFO
Ğ
RšgBufãr
 *
rbuf
, 
numF¿mes
, 
by‹sP”F¿me
 )

102 
numBy‹s
 = 
numF¿mes
 * 
by‹sP”F¿me
;

103 *
bufãr
 = (*è
	`m®loc
Ğ
numBy‹s
 );

104 ifĞ
bufãr
 =ğ
NULL
 )  
·Insuffic›ÁMemÜy
;

105 
	`mem£t
Ğ
bufãr
, 0, 
numBy‹s
 );

106  (
PaE¼Ü
è
	`RšgBufãr_In™
Ğ
rbuf
, 
numBy‹s
, 
bufãr
 );

107 
	}
}

110 
PaE¼Ü
 
	$PABLIO_T”mFIFO
Ğ
RšgBufãr
 *
rbuf
 )

112 ifĞ
rbuf
->
bufãr
 ) 
	`ä“
(„buf->buffer );

113 
rbuf
->
bufãr
 = 
NULL
;

114  
·NoE¼Ü
;

115 
	}
}

121 
	$Wr™eAudioSŒ—m
Ğ
PABLIO_SŒ—m
 *
aSŒ—m
, *
d©a
, 
numF¿mes
 )

123 
by‹sWr™‹n
;

124 *
p
 = (*è
d©a
;

125 
numBy‹s
 = 
aSŒ—m
->
by‹sP”F¿me
 * 
numF¿mes
;

126  
numBy‹s
 > 0)

128 
by‹sWr™‹n
 = 
	`RšgBufãr_Wr™e
Ğ&
aSŒ—m
->
outFIFO
, 
p
, 
numBy‹s
 );

129 
numBy‹s
 -ğ
by‹sWr™‹n
;

130 
p
 +ğ
by‹sWr™‹n
;

131 ifĞ
numBy‹s
 > 0è
	`Pa_SË•
(10);

133  
numF¿mes
;

134 
	}
}

140 
	$R—dAudioSŒ—m
Ğ
PABLIO_SŒ—m
 *
aSŒ—m
, *
d©a
, 
numF¿mes
 )

142 
by‹sR—d
;

143 *
p
 = (*è
d©a
;

144 
numBy‹s
 = 
aSŒ—m
->
by‹sP”F¿me
 * 
numF¿mes
;

145  
numBy‹s
 > 0)

147 
by‹sR—d
 = 
	`RšgBufãr_R—d
Ğ&
aSŒ—m
->
šFIFO
, 
p
, 
numBy‹s
 );

148 
numBy‹s
 -ğ
by‹sR—d
;

149 
p
 +ğ
by‹sR—d
;

150 ifĞ
numBy‹s
 > 0è
	`Pa_SË•
(10);

152  
numF¿mes
;

153 
	}
}

159 
	$G‘AudioSŒ—mWr™—bË
Ğ
PABLIO_SŒ—m
 *
aSŒ—m
 )

161 
by‹sEm±y
 = 
	`RšgBufãr_G‘Wr™eAvaabË
Ğ&
aSŒ—m
->
outFIFO
 );

162  
by‹sEm±y
 / 
aSŒ—m
->
by‹sP”F¿me
;

163 
	}
}

169 
	$G‘AudioSŒ—mR—dabË
Ğ
PABLIO_SŒ—m
 *
aSŒ—m
 )

171 
by‹sFuÎ
 = 
	`RšgBufãr_G‘R—dAvaabË
Ğ&
aSŒ—m
->
šFIFO
 );

172  
by‹sFuÎ
 / 
aSŒ—m
->
by‹sP”F¿me
;

173 
	}
}

176 
	$RoundUpToNextPow”Of2
Ğ
n
 )

178 
numB™s
 = 0;

179 ifĞ((
n
-1) &‚) == 0) ‚;

180  
n
 > 0 )

182 
n
=‚>>1;

183 
numB™s
++;

185  (1<<
numB™s
);

186 
	}
}

196 
PaE¼Ü
 
	$O³nAudioSŒ—m
Ğ
PABLIO_SŒ—m
 **
rwblPŒ
, 
§m¶eR©e
,

197 
PaSam¶eFÜm©
 
fÜm©
, 
æags
 )

199 
by‹sP”Sam¶e
;

200 
doR—d
 = 0;

201 
doWr™e
 = 0;

202 
PaE¼Ü
 
”r
;

203 
PABLIO_SŒ—m
 *
aSŒ—m
;

204 
mšNumBufãrs
;

205 
numF¿mes
;

208 
aSŒ—m
 = (
PABLIO_SŒ—m
 *è
	`m®loc
( (PABLIO_Stream) );

209 ifĞ
aSŒ—m
 =ğ
NULL
 )  
·Insuffic›ÁMemÜy
;

210 
	`mem£t
Ğ
aSŒ—m
, 0, (
PABLIO_SŒ—m
) );

213 
by‹sP”Sam¶e
 = 
	`Pa_G‘Sam¶eSize
Ğ
fÜm©
 );

214 ifĞ
by‹sP”Sam¶e
 < 0 )

216 
”r
 = (
PaE¼Ü
è
by‹sP”Sam¶e
;

217 
”rÜ
;

219 
aSŒ—m
->
§m¶esP”F¿me
 = ((
æags
&
PABLIO_MONO
) != 0) ? 1 : 2;

220 
aSŒ—m
->
by‹sP”F¿me
 = 
by‹sP”Sam¶e
 *‡SŒ—m->
§m¶esP”F¿me
;

223 
”r
 = 
	`Pa_In™Ÿlize
();

224 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

229 
mšNumBufãrs
 = 2 * 
	`Pa_G‘MšNumBufãrs
Ğ
FRAMES_PER_BUFFER
, 
§m¶eR©e
 );

230 
numF¿mes
 = 
mšNumBufãrs
 * 
FRAMES_PER_BUFFER
;

236 cÚ¡ 
§ãL©’cyMSec
 = 200;

237 
mšL©’cyMSec
 = (1000 * 
numF¿mes
è/ 
§m¶eR©e
;

238 ifĞ
mšL©’cyMSec
 < 
§ãL©’cyMSec
 )

240 
numF¿mes
 = (è((
§ãL©’cyMSec
 * 
§m¶eR©e
) / 1000);

243 
numF¿mes
 = 
	`RoundUpToNextPow”Of2
(‚umFrames );

246 
doR—d
 = ((
æags
 & 
PABLIO_READ
) != 0);

247 
doWr™e
 = ((
æags
 & 
PABLIO_WRITE
) != 0);

248 if(
doR—d
)

250 
”r
 = 
	`PABLIO_In™FIFO
Ğ&
aSŒ—m
->
šFIFO
, 
numF¿mes
,‡SŒ—m->
by‹sP”F¿me
 );

251 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

253 if(
doWr™e
)

255 
numBy‹s
;

256 
”r
 = 
	`PABLIO_In™FIFO
Ğ&
aSŒ—m
->
outFIFO
, 
numF¿mes
,‡SŒ—m->
by‹sP”F¿me
 );

257 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

259 
numBy‹s
 = 
	`RšgBufãr_G‘Wr™eAvaabË
Ğ&
aSŒ—m
->
outFIFO
 );

260 
	`RšgBufãr_AdvªûWr™eIndex
Ğ&
aSŒ—m
->
outFIFO
, 
numBy‹s
 );

265 
”r
 = 
	`Pa_O³nSŒ—m
(

266 &
aSŒ—m
->
¡»am
,

267 (
doR—d
 ? 
	`Pa_G‘DeçuÉIÅutDeviûID
(è: 
·NoDeviû
),

268 (
doR—d
 ? 
aSŒ—m
->
§m¶esP”F¿me
 : 0 ),

269 
fÜm©
,

270 
NULL
,

271 (
doWr™e
 ? 
	`Pa_G‘DeçuÉOuutDeviûID
(è: 
·NoDeviû
),

272 (
doWr™e
 ? 
aSŒ—m
->
§m¶esP”F¿me
 : 0 ),

273 
fÜm©
,

274 
NULL
,

275 
§m¶eR©e
,

276 
FRAMES_PER_BUFFER
,

277 
mšNumBufãrs
,

278 
·ClOff
,

279 
blockšgIOC®lback
,

280 
aSŒ—m
 );

281 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

283 
”r
 = 
	`Pa_S¹SŒ—m
Ğ
aSŒ—m
->
¡»am
 );

284 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

286 *
rwblPŒ
 = 
aSŒ—m
;

287  
·NoE¼Ü
;

289 
”rÜ
:

290 
	`Clo£AudioSŒ—m
Ğ
aSŒ—m
 );

291 *
rwblPŒ
 = 
NULL
;

292  
”r
;

293 
	}
}

296 
PaE¼Ü
 
	$Clo£AudioSŒ—m
Ğ
PABLIO_SŒ—m
 *
aSŒ—m
 )

298 
PaE¼Ü
 
”r
 = 
·NoE¼Ü
;

299 
by‹sEm±y
;

300 
by‹Size
 = 
aSŒ—m
->
outFIFO
.
bufãrSize
;

302 ifĞ
aSŒ—m
->
¡»am
 !ğ
NULL
 )

305 ifĞ
by‹Size
 > 0 )

307 
timeOutMSec
 = 2000;

308 
by‹sEm±y
 = 
	`RšgBufãr_G‘Wr™eAvaabË
Ğ&
aSŒ—m
->
outFIFO
 );

309  (
by‹sEm±y
 < 
by‹Size
è&& (
timeOutMSec
 > 0) )

311 
	`Pa_SË•
( 20 );

312 
timeOutMSec
 -= 20;

313 
by‹sEm±y
 = 
	`RšgBufãr_G‘Wr™eAvaabË
Ğ&
aSŒ—m
->
outFIFO
 );

316 
”r
 = 
	`Pa_StİSŒ—m
Ğ
aSŒ—m
->
¡»am
 );

317 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

318 
”r
 = 
	`Pa_Clo£SŒ—m
Ğ
aSŒ—m
->
¡»am
 );

321 
”rÜ
:

322 
	`Pa_T”mš©e
();

323 
	`PABLIO_T”mFIFO
Ğ&
aSŒ—m
->
šFIFO
 );

324 
	`PABLIO_T”mFIFO
Ğ&
aSŒ—m
->
outFIFO
 );

325 
	`ä“
Ğ
aSŒ—m
 );

326  
”r
;

327 
	}
}

	@portaudio/pablio/pablio.h

1 #iâdeà
_PABLIO_H


2 
	#_PABLIO_H


	)

4 #ifdeà
__ılu¥lus


45 
	~<¡dio.h
>

46 
	~<¡dlib.h
>

47 
	~<m©h.h
>

48 
	~"pÜudio.h
"

49 
	~"ršgbufãr.h
"

50 
	~<¡ršg.h
>

54 
RšgBufãr
 
šFIFO
;

55 
RšgBufãr
 
outFIFO
;

56 
PÜtAudioSŒ—m
 *
¡»am
;

57 
by‹sP”F¿me
;

58 
§m¶esP”F¿me
;

60 
	tPABLIO_SŒ—m
;

63 
	#PABLIO_READ
 (1<<0)

	)

64 
	#PABLIO_WRITE
 (1<<1)

	)

65 
	#PABLIO_READ_WRITE
 (
PABLIO_READ
|
PABLIO_WRITE
)

	)

66 
	#PABLIO_MONO
 (1<<2)

	)

67 
	#PABLIO_STEREO
 (1<<3)

	)

73 
Wr™eAudioSŒ—m
Ğ
PABLIO_SŒ—m
 *
aSŒ—m
, *
d©a
, 
numF¿mes
 );

79 
R—dAudioSŒ—m
Ğ
PABLIO_SŒ—m
 *
aSŒ—m
, *
d©a
, 
numF¿mes
 );

85 
G‘AudioSŒ—mWr™—bË
Ğ
PABLIO_SŒ—m
 *
aSŒ—m
 );

91 
G‘AudioSŒ—mR—dabË
Ğ
PABLIO_SŒ—m
 *
aSŒ—m
 );

101 
PaE¼Ü
 
O³nAudioSŒ—m
Ğ
PABLIO_SŒ—m
 **
aSŒ—mPŒ
, 
§m¶eR©e
,

102 
PaSam¶eFÜm©
 
fÜm©
, 
æags
 );

104 
PaE¼Ü
 
Clo£AudioSŒ—m
Ğ
PABLIO_SŒ—m
 *
aSŒ—m
 );

106 #ifdeà
__ılu¥lus


	@portaudio/pablio/ringbuffer.c

36 
	~<¡dio.h
>

37 
	~<¡dlib.h
>

38 
	~<m©h.h
>

39 
	~"ršgbufãr.h
"

40 
	~<¡ršg.h
>

46 
	$RšgBufãr_In™
Ğ
RšgBufãr
 *
rbuf
, 
numBy‹s
, *
d©aPŒ
 )

48 ifĞ((
numBy‹s
-1) &‚umBytes) != 0)  -1;

49 
rbuf
->
bufãrSize
 = 
numBy‹s
;

50 
rbuf
->
bufãr
 = (*)
d©aPŒ
;

51 
	`RšgBufãr_Flush
Ğ
rbuf
 );

52 
rbuf
->
bigMask
 = (
numBy‹s
*2)-1;

53 
rbuf
->
sm®lMask
 = (
numBy‹s
)-1;

55 
	}
}

58 
	$RšgBufãr_G‘R—dAvaabË
Ğ
RšgBufãr
 *
rbuf
 )

60  ( (
rbuf
->
wr™eIndex
 -„buf->
»adIndex
è&„buf->
bigMask
 );

61 
	}
}

64 
	$RšgBufãr_G‘Wr™eAvaabË
Ğ
RšgBufãr
 *
rbuf
 )

66  ( 
rbuf
->
bufãrSize
 - 
	`RšgBufãr_G‘R—dAvaabË
(rbuf));

67 
	}
}

71 
	$RšgBufãr_Flush
Ğ
RšgBufãr
 *
rbuf
 )

73 
rbuf
->
wr™eIndex
 =„buf->
»adIndex
 = 0;

74 
	}
}

82 
	$RšgBufãr_G‘Wr™eRegiÚs
Ğ
RšgBufãr
 *
rbuf
, 
numBy‹s
,

83 **
d©aPŒ1
, *
sizePŒ1
,

84 **
d©aPŒ2
, *
sizePŒ2
 )

86 
šdex
;

87 
avaabË
 = 
	`RšgBufãr_G‘Wr™eAvaabË
Ğ
rbuf
 );

88 ifĞ
numBy‹s
 > 
avaabË
 )‚umBytes =‡vailable;

90 
šdex
 = 
rbuf
->
wr™eIndex
 &„buf->
sm®lMask
;

91 ifĞ(
šdex
 + 
numBy‹s
è> 
rbuf
->
bufãrSize
 )

94 
fœ¡H®f
 = 
rbuf
->
bufãrSize
 - 
šdex
;

95 *
d©aPŒ1
 = &
rbuf
->
bufãr
[
šdex
];

96 *
sizePŒ1
 = 
fœ¡H®f
;

97 *
d©aPŒ2
 = &
rbuf
->
bufãr
[0];

98 *
sizePŒ2
 = 
numBy‹s
 - 
fœ¡H®f
;

102 *
d©aPŒ1
 = &
rbuf
->
bufãr
[
šdex
];

103 *
sizePŒ1
 = 
numBy‹s
;

104 *
d©aPŒ2
 = 
NULL
;

105 *
sizePŒ2
 = 0;

107  
numBy‹s
;

108 
	}
}

113 
	$RšgBufãr_AdvªûWr™eIndex
Ğ
RšgBufãr
 *
rbuf
, 
numBy‹s
 )

115  
rbuf
->
wr™eIndex
 = (rbuf->wr™eIndex + 
numBy‹s
è&„buf->
bigMask
;

116 
	}
}

124 
	$RšgBufãr_G‘R—dRegiÚs
Ğ
RšgBufãr
 *
rbuf
, 
numBy‹s
,

125 **
d©aPŒ1
, *
sizePŒ1
,

126 **
d©aPŒ2
, *
sizePŒ2
 )

128 
šdex
;

129 
avaabË
 = 
	`RšgBufãr_G‘R—dAvaabË
Ğ
rbuf
 );

130 ifĞ
numBy‹s
 > 
avaabË
 )‚umBytes =‡vailable;

132 
šdex
 = 
rbuf
->
»adIndex
 &„buf->
sm®lMask
;

133 ifĞ(
šdex
 + 
numBy‹s
è> 
rbuf
->
bufãrSize
 )

136 
fœ¡H®f
 = 
rbuf
->
bufãrSize
 - 
šdex
;

137 *
d©aPŒ1
 = &
rbuf
->
bufãr
[
šdex
];

138 *
sizePŒ1
 = 
fœ¡H®f
;

139 *
d©aPŒ2
 = &
rbuf
->
bufãr
[0];

140 *
sizePŒ2
 = 
numBy‹s
 - 
fœ¡H®f
;

144 *
d©aPŒ1
 = &
rbuf
->
bufãr
[
šdex
];

145 *
sizePŒ1
 = 
numBy‹s
;

146 *
d©aPŒ2
 = 
NULL
;

147 *
sizePŒ2
 = 0;

149  
numBy‹s
;

150 
	}
}

153 
	$RšgBufãr_AdvªûR—dIndex
Ğ
RšgBufãr
 *
rbuf
, 
numBy‹s
 )

155  
rbuf
->
»adIndex
 = (rbuf->»adIndex + 
numBy‹s
è&„buf->
bigMask
;

156 
	}
}

160 
	$RšgBufãr_Wr™e
Ğ
RšgBufãr
 *
rbuf
, *
d©a
, 
numBy‹s
 )

162 
size1
, 
size2
, 
numWr™‹n
;

163 *
d©a1
, *
d©a2
;

164 
numWr™‹n
 = 
	`RšgBufãr_G‘Wr™eRegiÚs
Ğ
rbuf
, 
numBy‹s
, &
d©a1
, &
size1
, &
d©a2
, &
size2
 );

165 ifĞ
size2
 > 0 )

168 
	`memıy
Ğ
d©a1
, 
d©a
, 
size1
 );

169 
d©a
 = ((*)d©aè+ 
size1
;

170 
	`memıy
Ğ
d©a2
, 
d©a
, 
size2
 );

174 
	`memıy
Ğ
d©a1
, 
d©a
, 
size1
 );

176 
	`RšgBufãr_AdvªûWr™eIndex
Ğ
rbuf
, 
numWr™‹n
 );

177  
numWr™‹n
;

178 
	}
}

182 
	$RšgBufãr_R—d
Ğ
RšgBufãr
 *
rbuf
, *
d©a
, 
numBy‹s
 )

184 
size1
, 
size2
, 
numR—d
;

185 *
d©a1
, *
d©a2
;

186 
numR—d
 = 
	`RšgBufãr_G‘R—dRegiÚs
Ğ
rbuf
, 
numBy‹s
, &
d©a1
, &
size1
, &
d©a2
, &
size2
 );

187 ifĞ
size2
 > 0 )

189 
	`memıy
Ğ
d©a
, 
d©a1
, 
size1
 );

190 
d©a
 = ((*)d©aè+ 
size1
;

191 
	`memıy
Ğ
d©a
, 
d©a2
, 
size2
 );

195 
	`memıy
Ğ
d©a
, 
d©a1
, 
size1
 );

197 
	`RšgBufãr_AdvªûR—dIndex
Ğ
rbuf
, 
numR—d
 );

198  
numR—d
;

199 
	}
}

	@portaudio/pablio/ringbuffer.h

1 #iâdeà
_RINGBUFFER_H


2 
	#_RINGBUFFER_H


	)

3 #ifdeà
__ılu¥lus


43 
	~<¡dio.h
>

44 
	~<¡dlib.h
>

45 
	~<m©h.h
>

46 
	~"ršgbufãr.h
"

47 
	~<¡ršg.h
>

51 
bufãrSize
;

52 
wr™eIndex
;

53 
»adIndex
;

54 
bigMask
;

55 
sm®lMask
;

56 *
bufãr
;

58 
	tRšgBufãr
;

63 
RšgBufãr_In™
Ğ
RšgBufãr
 *
rbuf
, 
numBy‹s
, *
d©aPŒ
 );

66 
RšgBufãr_Flush
Ğ
RšgBufãr
 *
rbuf
 );

69 
RšgBufãr_G‘Wr™eAvaabË
Ğ
RšgBufãr
 *
rbuf
 );

71 
RšgBufãr_G‘R—dAvaabË
Ğ
RšgBufãr
 *
rbuf
 );

73 
RšgBufãr_Wr™e
Ğ
RšgBufãr
 *
rbuf
, *
d©a
, 
numBy‹s
 );

75 
RšgBufãr_R—d
Ğ
RšgBufãr
 *
rbuf
, *
d©a
, 
numBy‹s
 );

82 
RšgBufãr_G‘Wr™eRegiÚs
Ğ
RšgBufãr
 *
rbuf
, 
numBy‹s
,

83 **
d©aPŒ1
, *
sizePŒ1
,

84 **
d©aPŒ2
, *
sizePŒ2
 );

85 
RšgBufãr_AdvªûWr™eIndex
Ğ
RšgBufãr
 *
rbuf
, 
numBy‹s
 );

92 
RšgBufãr_G‘R—dRegiÚs
Ğ
RšgBufãr
 *
rbuf
, 
numBy‹s
,

93 **
d©aPŒ1
, *
sizePŒ1
,

94 **
d©aPŒ2
, *
sizePŒ2
 );

96 
RšgBufãr_AdvªûR—dIndex
Ğ
RšgBufãr
 *
rbuf
, 
numBy‹s
 );

98 #ifdeà
__ılu¥lus


	@portaudio/pablio/test_rw.c

38 
	~<¡dio.h
>

39 
	~<¡dlib.h
>

40 
	~"·blio.h
"

47 
	#SAMPLE_RATE
 (44100)

	)

48 
	#NUM_SECONDS
 (5)

	)

49 
	#SAMPLES_PER_FRAME
 (2)

	)

50 
	#FRAMES_PER_BLOCK
 (64)

	)

54 
	#SAMPLE_TYPE
 
·Flßt32


	)

55 
	tSAMPLE
;

57 
	#SAMPLE_TYPE
 
·IÁ16


	)

58 
	tSAMPLE
;

62 
maš
();

63 
	$maš
()

65 
i
;

66 
SAMPLE
 
§m¶es
[
SAMPLES_PER_FRAME
 * 
FRAMES_PER_BLOCK
];

67 
PaE¼Ü
 
”r
;

68 
PABLIO_SŒ—m
 *
aSŒ—m
;

70 
	`´štf
("Full duplex soundest using PortAudio‡nd RingBuffers\n");

71 
	`fæush
(
¡dout
);

74 
”r
 = 
	`O³nAudioSŒ—m
Ğ&
aSŒ—m
, 
SAMPLE_RATE
, 
SAMPLE_TYPE
,

75 (
PABLIO_READ_WRITE
 | 
PABLIO_STEREO
) );

76 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

79  
i
=0; i<(
NUM_SECONDS
 * 
SAMPLE_RATE
); i +ğ
FRAMES_PER_BLOCK
 )

82 
	`R—dAudioSŒ—m
Ğ
aSŒ—m
, 
§m¶es
, 
FRAMES_PER_BLOCK
 );

84 
	`Wr™eAudioSŒ—m
Ğ
aSŒ—m
, 
§m¶es
, 
FRAMES_PER_BLOCK
 );

87 
	`Clo£AudioSŒ—m
Ğ
aSŒ—m
 );

89 
	`´štf
("Full duplex soundest complete.\n" );

90 
	`fæush
(
¡dout
);

93 
”rÜ
:

94 
	`Pa_T”mš©e
();

95 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while usinghe…ortaudio stream\n" );

96 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

97 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

99 
	}
}

	@portaudio/pablio/test_rw_echo.c

43 
	~<¡dio.h
>

44 
	~<¡dlib.h
>

45 
	~<m©h.h
>

46 
	~"·blio.h
"

47 
	~<¡ršg.h
>

54 
	#SAMPLE_RATE
 (22050)

	)

55 
	#NUM_SECONDS
 (20)

	)

56 
	#SAMPLES_PER_FRAME
 (2)

	)

60 
	#SAMPLE_TYPE
 
·Flßt32


	)

61 
	tSAMPLE
;

63 
	#SAMPLE_TYPE
 
·IÁ16


	)

64 
	tSAMPLE
;

67 
	#NUM_ECHO_FRAMES
 (2*
SAMPLE_RATE
)

	)

68 
SAMPLE
 
	g§m¶es
[
NUM_ECHO_FRAMES
][
SAMPLES_PER_FRAME
] = {0.0};

71 
maš
();

72 
	$maš
()

74 
i
;

75 
PaE¼Ü
 
”r
;

76 
PABLIO_SŒ—m
 *
aInSŒ—m
;

77 
PABLIO_SŒ—m
 *
aOutSŒ—m
;

78 
šdex
;

80 
	`´štf
("Full duplex soundest using PABLIO\n");

81 
	`fæush
(
¡dout
);

85 
”r
 = 
	`O³nAudioSŒ—m
Ğ&
aInSŒ—m
, 
SAMPLE_RATE
, 
SAMPLE_TYPE
,

86 (
PABLIO_READ
 | 
PABLIO_STEREO
) );

87 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

90 
”r
 = 
	`O³nAudioSŒ—m
Ğ&
aOutSŒ—m
, 
SAMPLE_RATE
, 
SAMPLE_TYPE
,

91 (
PABLIO_WRITE
 | 
PABLIO_STEREO
) );

92 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

96 
šdex
 = 0;

97  
i
=0; i<(
NUM_SECONDS
 * 
SAMPLE_RATE
); i++ )

101 
	`Wr™eAudioSŒ—m
Ğ
aOutSŒ—m
, &
§m¶es
[
šdex
][0], 1 );

104 
	`R—dAudioSŒ—m
Ğ
aInSŒ—m
, &
§m¶es
[
šdex
][0], 1 );

105 
šdex
 += 1;

106 ifĞ
šdex
 >ğ
NUM_ECHO_FRAMES
 ) index = 0;

108 ifĞ(
i
 & 0xFFFFè=ğ0 ) 
	`´štf
("˜ğ%d\n", i ); 
	`fæush
(
¡dout
);

111 
	`Clo£AudioSŒ—m
Ğ
aOutSŒ—m
 );

112 
	`Clo£AudioSŒ—m
Ğ
aInSŒ—m
 );

114 
	`´štf
("R/Wƒcho soundest complete.\n" );

115 
	`fæush
(
¡dout
);

118 
”rÜ
:

119 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while using PortAudio\n" );

120 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

121 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

123 
	}
}

	@portaudio/pablio/test_w_saw.c

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~<m©h.h
>

42 
	~"·blio.h
"

43 
	~<¡ršg.h
>

45 
	#SAMPLE_RATE
 (44100)

	)

46 
	#NUM_SECONDS
 (15)

	)

47 
	#SAMPLES_PER_FRAME
 (2)

	)

49 
	#FREQUENCY
 (220.0f)

	)

50 
	#PHASE_INCREMENT
 (2.0à* 
FREQUENCY
 / 
SAMPLE_RATE
)

	)

51 
	#FRAMES_PER_BLOCK
 (100)

	)

53 
	g§m¶es
[
FRAMES_PER_BLOCK
][
SAMPLES_PER_FRAME
];

54 
	gpha£s
[
SAMPLES_PER_FRAME
];

57 
maš
();

58 
	$maš
()

60 
i
,
j
;

61 
PaE¼Ü
 
”r
;

62 
PABLIO_SŒ—m
 *
aOutSŒ—m
;

64 
	`´štf
("Generate sawtooth waves using PABLIO.\n");

65 
	`fæush
(
¡dout
);

68 
”r
 = 
	`O³nAudioSŒ—m
Ğ&
aOutSŒ—m
, 
SAMPLE_RATE
, 
·Flßt32
,

69 (
PABLIO_WRITE
 | 
PABLIO_STEREO
) );

70 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

73 
pha£s
[0] = 0.0;

74 
pha£s
[1] = 0.0;

76  
i
=0; i<(
NUM_SECONDS
 * 
SAMPLE_RATE
); i +ğ
FRAMES_PER_BLOCK
 )

79  
j
=0; j<
FRAMES_PER_BLOCK
; j++ )

82 
pha£s
[0] +ğ
PHASE_INCREMENT
;

84 ifĞ
pha£s
[0] > 1.0f )…hases[0] -= 2.0f;

85 
§m¶es
[
j
][0] = 
pha£s
[0];

88 
pha£s
[1] +ğ
PHASE_INCREMENT
 * (3.0f / 2.0f);

89 ifĞ
pha£s
[1] > 1.0f )…hases[1] -= 2.0f;

90 
§m¶es
[
j
][1] = 
pha£s
[1];

94 
	`Wr™eAudioSŒ—m
Ğ
aOutSŒ—m
, 
§m¶es
, 
FRAMES_PER_BLOCK
 );

97 
	`Clo£AudioSŒ—m
Ğ
aOutSŒ—m
 );

99 
	`´štf
("Sawtooth soundest complete.\n" );

100 
	`fæush
(
¡dout
);

103 
”rÜ
:

104 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while using PABLIO\n" );

105 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

106 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

108 
	}
}

	@portaudio/pablio/test_w_saw8.c

39 
	~<¡dio.h
>

40 
	~<¡dlib.h
>

41 
	~<m©h.h
>

42 
	~"·blio.h
"

43 
	~<¡ršg.h
>

45 
	#SAMPLE_RATE
 (22050)

	)

46 
	#NUM_SECONDS
 (6)

	)

47 
	#SAMPLES_PER_FRAME
 (2)

	)

50 
	#FRAMES_PER_BLOCK
 (100)

	)

52 
	g§m¶es
[
FRAMES_PER_BLOCK
][
SAMPLES_PER_FRAME
];

53 
	gpha£s
[
SAMPLES_PER_FRAME
];

56 
maš
();

57 
	$maš
()

59 
i
,
j
;

60 
PaE¼Ü
 
”r
;

61 
PABLIO_SŒ—m
 *
aOutSŒ—m
;

63 
	`´štf
("Generate unsigned 8 bit sawtooth waves using PABLIO.\n");

64 
	`fæush
(
¡dout
);

67 
”r
 = 
	`O³nAudioSŒ—m
Ğ&
aOutSŒ—m
, 
SAMPLE_RATE
, 
·UIÁ8
,

68 (
PABLIO_WRITE
 | 
PABLIO_STEREO
) );

69 ifĞ
”r
 !ğ
·NoE¼Ü
 ) 
”rÜ
;

72 
pha£s
[0] = 128;

73 
pha£s
[1] = 128;

75  
i
=0; i<(
NUM_SECONDS
 * 
SAMPLE_RATE
); i +ğ
FRAMES_PER_BLOCK
 )

78  
j
=0; j<
FRAMES_PER_BLOCK
; j++ )

81 
pha£s
[0] += 1;

84 
§m¶es
[
j
][0] = 
pha£s
[0];

87 
pha£s
[1] += 3;

88 
§m¶es
[
j
][1] = 
pha£s
[1];

92 
	`Wr™eAudioSŒ—m
Ğ
aOutSŒ—m
, 
§m¶es
, 
FRAMES_PER_BLOCK
 );

95 
	`Clo£AudioSŒ—m
Ğ
aOutSŒ—m
 );

97 
	`´štf
("Sawtooth soundest complete.\n" );

98 
	`fæush
(
¡dout
);

101 
”rÜ
:

102 
	`årštf
Ğ
¡d”r
, "Anƒrror occured while using PABLIO\n" );

103 
	`årštf
Ğ
¡d”r
, "E¼Ü‚umb”: %d\n", 
”r
 );

104 
	`årštf
Ğ
¡d”r
, "E¼Ü mes§ge: %s\n", 
	`Pa_G‘E¼ÜText
Ğ
”r
 ) );

106 
	}
}

	@portmixer/px_common/portmixer.h

1 #iâdeà
PORT_MIXER_H


2 
	#PORT_MIXER_H


	)

4 #ifdeà
__ılu¥lus


47 
	~"pÜudio.h
"

49 
	tPxMix”
;

51 
	tPxVŞume
;

52 
	tPxB®ªû
;

62 
Px_G‘NumMix”s
Ğ*
·_¡»am
 );

63 cÚ¡ *
Px_G‘Mix”Name
Ğ*
·_¡»am
, 
i
 );

70 
PxMix”
 *
Px_O³nMix”
Ğ*
·_¡»am
, 
i
 );

77 
Px_Clo£Mix”
(
PxMix”
 *
mix”
);

83 
PxVŞume
 
Px_G‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
 );

84 
Px_S‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 );

90 
PxVŞume
 
Px_G‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
 );

91 
Px_S‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 );

92 
Px_SuµÜtsPCMOuutVŞume
Ğ
PxMix”
* 
mix”
 ) ;

98 
Px_G‘NumOuutVŞumes
Ğ
PxMix”
 *
mix”
 );

99 cÚ¡ *
Px_G‘OuutVŞumeName
Ğ
PxMix”
 *
mix”
, 
i
 );

100 
PxVŞume
 
Px_G‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
 );

101 
Px_S‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
, 
PxVŞume
 
vŞume
 );

107 
Px_G‘NumIÅutSourûs
Ğ
PxMix”
 *
mix”
 );

108 cÚ¡ *
Px_G‘IÅutSourûName
Ğ
PxMix”
 *
mix”
, 
i
);

109 
Px_G‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
 );

110 
Px_S‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
, 
i
 );

116 
PxVŞume
 
Px_G‘IÅutVŞume
Ğ
PxMix”
 *
mix”
 );

117 
Px_S‘IÅutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 );

123 
Px_SuµÜtsOuutB®ªû
Ğ
PxMix”
 *
mix”
 );

124 
PxB®ªû
 
Px_G‘OuutB®ªû
Ğ
PxMix”
 *
mix”
 );

125 
Px_S‘OuutB®ªû
Ğ
PxMix”
 *
mix”
, 
PxB®ªû
 
b®ªû
 );

131 
Px_SuµÜtsPÏythrough
Ğ
PxMix”
 *
mix”
 );

132 
PxVŞume
 
Px_G‘PÏythrough
Ğ
PxMix”
 *
mix”
 );

133 
Px_S‘PÏythrough
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 );

135 #ifdeà
__ılu¥lus


	@portmixer/px_mac/px_mac.c

38 
	~<¡dlib.h
>

39 
	~<¡ršg.h
>

41 
	~"pÜudio.h
"

42 
	~"·_ho¡.h
"

43 
	~"pÜtmix”.h
"

45 
	#PA_MAX_NUM_HOST_BUFFERS
 (16è

	)

47 
	sMuÉiBufãr


49 *
	mbufãrs
[
PA_MAX_NUM_HOST_BUFFERS
];

50 
	mnumBufãrs
;

51 
	mÃxtWr™e
;

52 
	mÃxtR—d
;

54 
	tMuÉiBufãr
;

57 
	sPaHo¡SoundCÚŒŞ


59 
UIÁ64
 
	m·hsc_EÁryCouÁ
;

60 
	m·hsc_Inv”£MiüosP”Ho¡Bufãr
;

63 vŞ©
	m·hsc_IsRecÜdšg
;

64 vŞ©
	m·hsc_StİRecÜdšg
;

65 vŞ©
	m·hsc_IfInsideC®lback
;

67 
SPB
 
	m·hsc_IÅutP¬ams
;

68 
SICom¶‘iÚUPP
 
	m·hsc_IÅutCom¶‘iÚProc
;

69 
MuÉiBufãr
 
	m·hsc_IÅutMuÉiBufãr
;

70 
št32
 
	m·hsc_By‹sP”IÅutHo¡Bufãr
;

71 
št32
 
	m·hsc_IÅutRefNum
;

73 
CmpSoundH—d”
 
	m·hsc_SoundH—d”s
[
PA_MAX_NUM_HOST_BUFFERS
];

74 
št32
 
	m·hsc_By‹sP”OuutHo¡Bufãr
;

75 
SndChªÃlPŒ
 
	m·hsc_ChªÃl
;

76 
SndC®lBackUPP
 
	m·hsc_OuutCom¶‘iÚProc
;

77 
št32
 
	m·hsc_NumOutsQueued
;

78 
št32
 
	m·hsc_NumOutsPÏyed
;

79 
PaTime¡amp
 
	m·hsc_NumF¿mesDÚe
;

80 
UIÁ64
 
	m·hsc_Wh’F¿mesDÚeInüem’‹d
;

82 
št32
 
	m·hsc_NumHo¡Bufãrs
;

83 
št32
 
	m·hsc_F¿mesP”Ho¡Bufãr
;

84 
št32
 
	m·hsc_U£rBufãrsP”Ho¡Bufãr
;

85 
št32
 
	m·hsc_MšF¿mesP”Ho¡Bufãr
;

87 
	tPaHo¡SoundCÚŒŞ
;

89 
	sPxSourû


91 
	mÇme
[256];

92 } 
	tPxSourû
;

94 
	sPxInfo


96 
SPB
 *
	mšput
;

97 
št32
 
	mšputRefNum
;

98 
SndChªÃlPŒ
 
	mouut
;

99 
št32
 
	mnumSourûs
;

100 
PxSourû
 *
	msourûs
;

101 } 
	tPxInfo
;

103 
	$Px_G‘NumMix”s
Ğ*
·_¡»am
 )

106 
	}
}

108 cÚ¡ *
	$Px_G‘Mix”Name
Ğ*
·_¡»am
, 
šdex
 )

111 
	}
}

113 
PxMix”
 *
	$Px_O³nMix”
Ğ*
·_¡»am
, 
šdex
 )

115 
PxInfo
 *
šfo
;

116 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

117 
PaHo¡SoundCÚŒŞ
 *
macInfo
;

118 
OSE¼
 
”r
;

119 
i
, 
j
;

120 
HªdË
 
h
;

121 *
d©a
;

123 
šfo
 = (
PxInfo
 *)
	`m®loc
((PxInfo));

124 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
·_¡»am
;

125 
macInfo
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

127 
šfo
->
šput
 = &
macInfo
->
·hsc_IÅutP¬ams
;

128 
šfo
->
šputRefNum
 = 
macInfo
->
·hsc_IÅutRefNum
;

129 
šfo
->
ouut
 = 
macInfo
->
·hsc_ChªÃl
;

131 
šfo
->
numSourûs
 = 0;

132 
šfo
->
sourûs
 = 
NULL
;

134 
”r
 = 
	`SPBG‘DeviûInfo
 (
šfo
->
šputRefNum
, 
siIÅutSourûNames
, &
h
);

135 ià(
”r
)

136  (
PxMix”
 *)
šfo
;

138 
	`HLock
(
h
);

139 
	`HNoPurge
(
h
);

141 
d©a
 = (*)*
h
;

142 
šfo
->
numSourûs
 = ((*)
d©a
)[0];

143 ià(
šfo
->
numSourûs
 <= 0 || info->numSources > 50) {

144 
	`HUÆock
(
h
);

145  (
PxMix”
 *)
šfo
;

148 
šfo
->
sourûs
 = (
PxSourû
 *)
	`m®loc
(šfo->
numSourûs
 * (PxSource));

149 
d©a
 += 2;

150 
i
=0; i<
šfo
->
numSourûs
; i++) {

151 
Ën
 = *
d©a
++;

153 ià(
Ën
 > 63) {

154 
šfo
->
numSourûs
 = 0;

155 
	`ä“
(
šfo
->
sourûs
);

156 
šfo
->
sourûs
 = 
NULL
;

157 
	`HUÆock
(
h
);

158  (
PxMix”
 *)
šfo
;

161 
j
=0; j<
Ën
; j++)

162 
šfo
->
sourûs
[
i
].
Çme
[
j
] = *
d©a
++;

164 
šfo
->
sourûs
[
i
].
Çme
[
Ën
] = 0;

166 
	`HUÆock
(
h
);

168  (
PxMix”
 *)
šfo
;

169 
	}
}

176 
	$Px_Clo£Mix”
(
PxMix”
 *
mix”
)

178 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

180 ià(
šfo
->
sourûs
)

181 
	`ä“
(
šfo
->
sourûs
);

182 
	`ä“
(
šfo
);

183 
	}
}

189 
PxVŞume
 
	$Px_G‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
 )

191 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

194 
	}
}

196 
	$Px_S‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

198 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

199 
	}
}

205 
	$Px_SuµÜtsPCMOuutVŞume
Ğ
PxMix”
* 
mix”
 )

208 
	}
}

210 
PxVŞume
 
	$Px_G‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
 )

212 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

213 
OSE¼
 
”r
;

214 
·ckedVŞ
;

215 
SndCommªd
 
cmd
;

217 
cmd
.cmd = 
g‘VŞumeCmd
;

218 
cmd
.
·¿m1
 = 0;

219 
cmd
.
·¿m2
 = ()&
·ckedVŞ
;

221 
”r
 = 
	`SndDoImmedŸ‹
(
šfo
->
ouut
, &
cmd
);

222 ià(
”r
)

225  ((
·ckedVŞ
 & 0xFFFF) + ((packedVol & 0xFFFF0000) >> 16) / 2.0) / 256.0;

226 
	}
}

228 
	$Px_S‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

230 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

231 
OSE¼
 
”r
;

232 
·ckedVŞ
;

233 
SndCommªd
 
cmd
;

235 
·ckedVŞ
 = ()
vŞume
 * 256.0;

236 
·ckedVŞ
 += (packedVol << 16);

238 
cmd
.cmd = 
vŞumeCmd
;

239 
cmd
.
·¿m1
 = 0;

240 
cmd
.
·¿m2
 = 
·ckedVŞ
;

241 
”r
 = 
	`SndDoImmedŸ‹
(
šfo
->
ouut
, &
cmd
);

242 
	}
}

248 
	$Px_G‘NumOuutVŞumes
Ğ
PxMix”
 *
mix”
 )

250 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

253 
	}
}

255 cÚ¡ *
	$Px_G‘OuutVŞumeName
Ğ
PxMix”
 *
mix”
, 
i
 )

257 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

259  
NULL
;

260 
	}
}

262 
PxVŞume
 
	$Px_G‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
 )

264 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

266  
NULL
;

267 
	}
}

269 
	$Px_S‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
, 
PxVŞume
 
vŞume
 )

271 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

272 
	}
}

278 
	$Px_G‘NumIÅutSourûs
Ğ
PxMix”
 *
mix”
 )

280 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

282  
šfo
->
numSourûs
;

283 
	}
}

285 cÚ¡ *
	$Px_G‘IÅutSourûName
Ğ
PxMix”
 *
mix”
, 
i
)

287 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

289 ià(
i
 >ğ0 && i < 
šfo
->
numSourûs
)

290  
šfo
->
sourûs
[
i
].
Çme
;

293 
	}
}

295 
	$Px_G‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
 )

297 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

298 
£Ëùed
;

299 
OSE¼
 
”r
;

301 
”r
 = 
	`SPBG‘DeviûInfo
 (
šfo
->
šputRefNum
, 
siIÅutSourû
, &
£Ëùed
);

302 ià(
”r
)

305  
£Ëùed
 - 1;

306 
	}
}

308 
	$Px_S‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
, 
i
 )

310 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

311 
£Ëùed
 = 
i
+1;

312 
OSE¼
 
”r
;

314 
”r
 = 
	`SPBS‘DeviûInfo
 (
šfo
->
šputRefNum
, 
siIÅutSourû
, &
£Ëùed
);

315 
	}
}

321 
PxVŞume
 
	$Px_G‘IÅutVŞume
Ğ
PxMix”
 *
mix”
 )

323 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

324 
Fixed
 
fixedGaš
;

325 
PxVŞume
 
vŞ
;

326 
OSE¼
 
”r
;

328 ià(
šfo
->
šput
) {

329 
”r
 = 
	`SPBG‘DeviûInfo
(
šfo
->
šputRefNum
, 
siIÅutGaš
, (
PŒ
)&
fixedGaš
);

330 ià(
”r
)

333 
vŞ
 = (
fixedGaš
 / 65536.0) - 0.5;

334  
vŞ
;

338 
	}
}

340 
	$Px_S‘IÅutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

342 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

343 
Fixed
 
fixedGaš
;

344 
OSE¼
 
”r
;

346 ià(
šfo
->
šput
) {

347 
fixedGaš
 = (
Fixed
)((
vŞume
 + 0.5) * 65536.0);

348 
”r
 = 
	`SPBS‘DeviûInfo
(
šfo
->
šputRefNum
, 
siIÅutGaš
, (
PŒ
)&
fixedGaš
);

350 
	}
}

356 
	$Px_SuµÜtsOuutB®ªû
Ğ
PxMix”
 *
mix”
 )

359 
	}
}

361 
PxB®ªû
 
	$Px_G‘OuutB®ªû
Ğ
PxMix”
 *
mix”
 )

364 
	}
}

366 
	$Px_S‘OuutB®ªû
Ğ
PxMix”
 *
mix”
, 
PxB®ªû
 
b®ªû
 )

368 
	}
}

374 
	$Px_SuµÜtsPÏythrough
Ğ
PxMix”
 *
mix”
 )

376 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

378  (
šfo
->
šput
 !ğ
NULL
);

379 
	}
}

381 
PxVŞume
 
	$Px_G‘PÏythrough
Ğ
PxMix”
 *
mix”
 )

383 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

384 
OSE¼
 
”r
;

385 
Ëv–
;

387 
”r
 = 
	`SPBG‘DeviûInfo
(
šfo
->
šputRefNum
, 
siPÏyThruOnOff
, (
PŒ
)&
Ëv–
);

388 ià(
”r
)

391 ià(
Ëv–
 < 0)

392 
Ëv–
 = 0;

393 ià(
Ëv–
 > 7)

394 
Ëv–
 = 7;

396  (
PxVŞume
)(
Ëv–
 / 7.0);

397 
	}
}

399 
	$Px_S‘PÏythrough
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

401 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

402 
OSE¼
 
”r
;

403 
Ëv–
 = ()(
vŞume
 * 7.0 + 0.5);

405 
”r
 = 
	`SPBS‘DeviûInfo
(
šfo
->
šputRefNum
, 
siPÏyThruOnOff
, (
PŒ
)&
Ëv–
);

406 
	}
}

	@portmixer/px_mac_core/px_mac_core.c

38 
	~<CÜeS”viûs/CÜeS”viûs.h
>

39 
	~<CÜeAudio/CÜeAudio.h
>

40 
	~<AudioToŞbox/AudioCÚv”‹r.h
>

41 
	~<sys/time.h
>

42 
	~<sys/»sourû.h
>

43 
	~<uni¡d.h
>

44 
	~<¡dlib.h
>

46 
	~"pÜudio.h
"

47 
	~"·_ho¡.h
"

48 
	~"pÜtmix”.h
"

50 
	ePaDeviûMode


52 
	mPA_MODE_OUTPUT_ONLY
,

53 
	mPA_MODE_INPUT_ONLY
,

54 
	mPA_MODE_IO_ONE_DEVICE
,

55 
	mPA_MODE_IO_TWO_DEVICES


56 } 
	tPaDeviûMode
;

58 
	sPaHo¡InOut_s


60 
AudioDeviûID
 
	maudioDeviûID
;

61 
	mby‹sP”U£rN©iveBufãr
;

62 
AudioCÚv”‹rRef
 
	mcÚv”‹r
;

63 *
	mcÚv”‹rBufãr
;

64 
	mnumChªÃls
;

65 } 
	tPaHo¡InOut
;

71 
	sPaHo¡SoundCÚŒŞ


73 
PaHo¡InOut
 
	mšput
;

74 
PaHo¡InOut
 
	mouut
;

75 
AudioDeviûID
 
	m´im¬yDeviûID
;

76 } 
	tPaHo¡SoundCÚŒŞ
;

79 
	#IS_INPUT
 (
Œue
)

	)

80 
	#IS_OUTPUT
 (
çl£
)

	)

82 
	sPxInfo


84 
AudioDeviûID
 
	mšput
;

85 
AudioDeviûID
 
	mouut
;

86 } 
	tPxInfo
;

88 
	$Px_G‘NumMix”s
Ğ*
·_¡»am
 )

91 
	}
}

93 cÚ¡ *
	$Px_G‘Mix”Name
Ğ*
·_¡»am
, 
šdex
 )

96 
	}
}

98 
PxMix”
 *
	$Px_O³nMix”
Ğ*
·_¡»am
, 
šdex
 )

100 
PxInfo
 *
šfo
;

101 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

102 
PaHo¡SoundCÚŒŞ
 *
macInfo
;

104 
šfo
 = (
PxInfo
 *)
	`m®loc
((PxInfo));

105 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
·_¡»am
;

106 
macInfo
 = (
PaHo¡SoundCÚŒŞ
 *è
·¡
->
·¡_DeviûD©a
;

108 
šfo
->
šput
 = 
macInfo
->šput.
audioDeviûID
;

109 
šfo
->
ouut
 = 
macInfo
->ouut.
audioDeviûID
;

111  (
PxMix”
 *)
šfo
;

112 
	}
}

119 
	$Px_Clo£Mix”
(
PxMix”
 *
mix”
)

121 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

123 
	`ä“
(
šfo
);

124 
	}
}

130 
PxVŞume
 
	$Px_G‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
 )

132 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

135 
	}
}

137 
	$Px_S‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

139 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

140 
	}
}

146 
PxVŞume
 
	$Px_G‘VŞume
(
AudioDeviûID
 
deviû
, 
BoŞ—n
 
isIÅut
)

148 
OSStus
 
”r
;

149 
UIÁ32
 
outSize
;

150 
Flßt32
 
vŞ
, 
maxvŞ
=0.0;

151 
UIÁ32
 
mu‹
, 
ªymu‹d
=0;

152 
ch
;

153 
PxVŞume
 
max
;

155 
ch
=0; ch<=2; ch++) {

156 
outSize
 = (
Flßt32
);

157 
”r
 = 
	`AudioDeviûG‘Prİ”ty
(
deviû
, 
ch
, 
isIÅut
,

158 
kAudioDeviûPrİ”tyVŞumeSÿÏr
,

159 &
outSize
, &
vŞ
);

160 ià(!
”r
) {

161 ià(
vŞ
 > 
maxvŞ
)

162 
maxvŞ
 = 
vŞ
;

165 
outSize
 = (
UIÁ32
);

166 
”r
 = 
	`AudioDeviûG‘Prİ”ty
(
deviû
, 
ch
, 
isIÅut
,

167 
kAudioDeviûPrİ”tyMu‹
,

168 &
outSize
, &
mu‹
);

170 ià(!
”r
) {

171 ià(
mu‹
)

172 
ªymu‹d
 = 1;

176 ià(
ªymu‹d
)

177 
maxvŞ
 = 0.0;

179  
maxvŞ
;

180 
	}
}

182 
	$Px_S‘VŞume
(
AudioDeviûID
 
deviû
, 
BoŞ—n
 
isIÅut
,

183 
PxVŞume
 
vŞume
)

185 
Flßt32
 
vŞ
 = 
vŞume
;

186 
UIÁ32
 
mu‹
 = 0;

187 
ch
;

188 
OSStus
 
”r
;

196 
ch
=0; ch<=2; ch++) {

197 
”r
 = 
	`AudioDeviûS‘Prİ”ty
(
deviû
, 0, 
ch
, 
isIÅut
,

198 
kAudioDeviûPrİ”tyVŞumeSÿÏr
,

199 (
Flßt32
), &
vŞ
);

201 ià(
vŞ
 > 0.05) {

202 
”r
 = 
	`AudioDeviûS‘Prİ”ty
(
deviû
, 0, 
ch
, 
isIÅut
,

203 
kAudioDeviûPrİ”tyMu‹
,

204 (
UIÁ32
), &
mu‹
);

207 
	}
}

209 
	$Px_SuµÜtsPCMOuutVŞume
Ğ
PxMix”
* 
mix”
 )

212 
	}
}

214 
PxVŞume
 
	$Px_G‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
 )

216 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

218  
	`Px_G‘VŞume
(
šfo
->
ouut
, 
IS_OUTPUT
);

219 
	}
}

221 
	$Px_S‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

223 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

225 
	`Px_S‘VŞume
(
šfo
->
ouut
, 
IS_OUTPUT
, 
vŞume
);

226 
	}
}

232 
	$Px_G‘NumOuutVŞumes
Ğ
PxMix”
 *
mix”
 )

234 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

237 
	}
}

239 cÚ¡ *
	$Px_G‘OuutVŞumeName
Ğ
PxMix”
 *
mix”
, 
i
 )

241 ià(
i
 == 0)

245 
	}
}

247 
PxVŞume
 
	$Px_G‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
 )

249  
	`Px_G‘PCMOuutVŞume
(
mix”
);

250 
	}
}

252 
	$Px_S‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
, 
PxVŞume
 
vŞume
 )

254 
	`Px_S‘PCMOuutVŞume
(
mix”
, 
vŞume
);

255 
	}
}

261 
	$Px_G‘NumIÅutSourûs
Ğ
PxMix”
 *
mix”
 )

263 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

266 
	}
}

268 cÚ¡ *
	$Px_G‘IÅutSourûName
Ğ
PxMix”
 *
mix”
, 
i
)

270 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

273 
	}
}

275 
	$Px_G‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
 )

277 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

280 
	}
}

282 
	$Px_S‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
, 
i
 )

284 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

285 
	}
}

291 
PxVŞume
 
	$Px_G‘IÅutVŞume
Ğ
PxMix”
 *
mix”
 )

293 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

295  
	`Px_G‘VŞume
(
šfo
->
šput
, 
IS_INPUT
);

296 
	}
}

298 
	$Px_S‘IÅutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

300 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

302 
	`Px_S‘VŞume
(
šfo
->
šput
, 
IS_INPUT
, 
vŞume
);

303 
	}
}

309 
	$Px_SuµÜtsOuutB®ªû
Ğ
PxMix”
 *
mix”
 )

312 
	}
}

314 
PxB®ªû
 
	$Px_G‘OuutB®ªû
Ğ
PxMix”
 *
mix”
 )

317 
	}
}

319 
	$Px_S‘OuutB®ªû
Ğ
PxMix”
 *
mix”
, 
PxB®ªû
 
b®ªû
 )

321 
	}
}

327 
	$Px_SuµÜtsPÏythrough
Ğ
PxMix”
 *
mix”
 )

329 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

330 
OSStus
 
”r
;

331 
UIÁ32
 
outSize
;

332 
UIÁ32
 
æag
;

333 
»suÉ
 = 0;

334 
ch
;

336 
outSize
 = (
UIÁ32
);

338 
ch
=0; ch<=2; ch++) {

339 
æag
 = 0;

340 
”r
 = 
	`AudioDeviûG‘Prİ”ty
(
šfo
->
šput
, 
ch
, 
IS_INPUT
,

341 
kAudioDeviûPrİ”tyPÏyThru
,

342 &
outSize
, &
æag
);

343 ià(!
”r
)

344 
»suÉ
 = 1;

347  
»suÉ
;

348 
	}
}

350 
PxVŞume
 
	$Px_G‘PÏythrough
Ğ
PxMix”
 *
mix”
 )

352 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

353 
OSStus
 
”r
;

354 
UIÁ32
 
outSize
;

355 
UIÁ32
 
æag
;

356 
PxVŞume
 
»suÉ
 = 0.0;

357 
ch
;

359 
outSize
 = (
UIÁ32
);

361 
ch
=0; ch<=2; ch++) {

362 
æag
 = 0;

363 
”r
 = 
	`AudioDeviûG‘Prİ”ty
(
šfo
->
šput
, 
ch
, 
IS_INPUT
,

364 
kAudioDeviûPrİ”tyPÏyThru
,

365 &
outSize
, &
æag
);

366 ià(!
”r
 && 
æag
)

367 
»suÉ
 = 1.0;

370  
»suÉ
;

371 
	}
}

373 
	$Px_S‘PÏythrough
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

375 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

376 
UIÁ32
 
æag
 = (
vŞume
 > 0.01);

377 
OSStus
 
”r
;

378 
ch
;

380 
ch
=0; ch<=2; ch++) {

381 
”r
 = 
	`AudioDeviûS‘Prİ”ty
(
šfo
->
šput
, 0, 
ch
, 
IS_INPUT
,

382 
kAudioDeviûPrİ”tyPÏyThru
,

383 (
UIÁ32
), &
æag
);

385 
	}
}

	@portmixer/px_none/px_none.c

39 
	~<¡dlib.h
>

41 
	~"pÜudio.h
"

42 
	~"pÜtmix”.h
"

44 
	sPxInfo


46 
	mdummy
;

47 } 
	tPxInfo
;

49 
	$Px_G‘NumMix”s
Ğ*
·_¡»am
 )

52 
	}
}

54 cÚ¡ *
	$Px_G‘Mix”Name
Ğ*
·_¡»am
, 
šdex
 )

56  
NULL
;

57 
	}
}

59 
PxMix”
 *
	$Px_O³nMix”
Ğ*
·_¡»am
, 
šdex
 )

61  
NULL
;

62 
	}
}

69 
	$Px_Clo£Mix”
(
PxMix”
 *
mix”
)

71 
	}
}

77 
PxVŞume
 
	$Px_G‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
 )

79 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

82 
	}
}

84 
	$Px_S‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

86 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

87 
	}
}

93 
PxVŞume
 
	$Px_G‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
 )

95 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

98 
	}
}

100 
	$Px_S‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

102 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

103 
	}
}

109 
	$Px_G‘NumOuutVŞumes
Ğ
PxMix”
 *
mix”
 )

111 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

114 
	}
}

116 cÚ¡ *
	$Px_G‘OuutVŞumeName
Ğ
PxMix”
 *
mix”
, 
i
 )

118 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

120  
NULL
;

121 
	}
}

123 
PxVŞume
 
	$Px_G‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
 )

125 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

127  
NULL
;

128 
	}
}

130 
	$Px_S‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
, 
PxVŞume
 
vŞume
 )

132 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

133 
	}
}

139 
	$Px_G‘NumIÅutSourûs
Ğ
PxMix”
 *
mix”
 )

141 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

144 
	}
}

146 cÚ¡ *
	$Px_G‘IÅutSourûName
Ğ
PxMix”
 *
mix”
, 
i
)

148 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

150  
NULL
;

151 
	}
}

153 
	$Px_G‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
 )

155 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

158 
	}
}

160 
	$Px_S‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
, 
i
 )

162 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

163 
	}
}

169 
PxVŞume
 
	$Px_G‘IÅutVŞume
Ğ
PxMix”
 *
mix”
 )

171 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

174 
	}
}

176 
	$Px_S‘IÅutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

178 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

179 
	}
}

185 
	$Px_SuµÜtsOuutB®ªû
Ğ
PxMix”
 *
mix”
 )

188 
	}
}

190 
PxB®ªû
 
	$Px_G‘OuutB®ªû
Ğ
PxMix”
 *
mix”
 )

193 
	}
}

195 
	$Px_S‘OuutB®ªû
Ğ
PxMix”
 *
mix”
, 
PxB®ªû
 
b®ªû
 )

197 
	}
}

203 
	$Px_SuµÜtsPÏythrough
Ğ
PxMix”
 *
mix”
 )

206 
	}
}

208 
PxB®ªû
 
	$Px_G‘PÏythrough
Ğ
PxMix”
 *
mix”
 )

211 
	}
}

213 
	$Px_S‘PÏythrough
Ğ
PxMix”
 *
mix”
, 
PxB®ªû
 
b®ªû
 )

215 
	}
}

	@portmixer/px_tests/px_test.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

4 
	~<uni¡d.h
>

6 
	~"pÜtmix”.h
"

7 
	~"pÜudio.h
"

10 *
İrg
;

11 
İtšd
, 
İ‹¼
, 
İtİt
;

13 
	$DummyC®lbackFunc
(*
šputBufãr
, *
ouutBufãr
,

14 
äamesP”Bufãr
,

15 
PaTime¡amp
 
outTime
, *
u£rD©a
)

18 
	}
}

20 
	$g‘vŞ¬g
(cÚ¡ *
p
)

22 
f
 = 
	`©of
(
p
);

23 ià(
f
 < 0.0)

25 ià(
f
 > 1.0)

28  
f
;

29 
	}
}

31 
	$maš
(
¬gc
, **
¬gv
)

33 
num_mix”s
;

34 
i
;

35 
PaE¼Ü
 
”rÜ
;

36 
PÜtAudioSŒ—m
 *
¡»am
;

37 
»cDeviûNum
;

38 
¶ayDeviûNum
;

39 
šputChªÃls
;

40 
ouutChªÃls
;

41 
num_deviûs
;

42 
deviû
;

43 
İt
;

44 
İts
=-1, 
İtm
=0;

45 
İtv
=-2, 
İto
=-2, 
İti
=-2, 
İth
=-2, 
İtb
=-2;

47 
	`´štf
("px_test:‡…rogramo demonstratehe capabilities of PortMixer\n");

48 
	`´štf
("By Dominic Mazzoni\n");

49 
	`´štf
("\n");

50 
	`´štf
("Usage:\n");

51 
	`´štf
(" -d [device‚umber]\n");

52 
	`´štf
(" -m [mixer‚umber]\n");

53 
	`´štf
(" -v [vol] (Master volume)\n");

54 
	`´štf
(" -o [vol] (PCM output volume)\n");

55 
	`´štf
(" -i [vol] (Input volume)\n");

56 
	`´štf
(" -s [source‚umber] (Input source)\n");

57 
	`´štf
(" -h [vol] (Playthrough)\n");

58 
	`´štf
(" -b [bal] (Balance: -1.0....1.0)\n");

59 
	`´štf
("\n");

60 
	`´štf
("All volumes‡re between 0.0‡nd 1.0.\n");

61 
	`´štf
("\n");

63 
”rÜ
 = 
	`Pa_In™Ÿlize
();

64 ià(
”rÜ
 != 0) {

65 
	`´štf
("PÜtAudiØ”rÜ: %s\n", 
	`Pa_G‘E¼ÜText
(
”rÜ
));

69 
num_deviûs
 = 
	`Pa_CouÁDeviûs
();

71 
deviû
 = 
	`Pa_G‘DeçuÉIÅutDeviûID
();

72 
»cDeviûNum
 = 
·NoDeviû
;

73 
¶ayDeviûNum
 = 
·NoDeviû
;

74 
šputChªÃls
 = 0;

75 
ouutChªÃls
 = 0;

77 -1 !ğ(
İt
=
	`g‘İt
(
¬gc
, 
¬gv
, "d:m:v:o:i:s:h:b:"))) {

78 
İt
) {

80 
deviû
 = 
	`©oi
(
İrg
);

81 
	`´štf
("S‘ deviûØ%d\n", 
deviû
);

84 
İtm
 = 
	`©oi
(
İrg
);

85 
	`´štf
("S‘ mix”‚umb”Ø%d\n", 
İtm
);

88 
İtv
 = 
	`g‘vŞ¬g
(
İrg
); ;

90 
İto
 = 
	`g‘vŞ¬g
(
İrg
); ;

92 
İti
 = 
	`g‘vŞ¬g
(
İrg
); ;

94 
İth
 = 
	`g‘vŞ¬g
(
İrg
); ;

96 
İtb
 = 
	`©of
(
İrg
); ;

98 
İts
 = 
	`©oi
(
İrg
); ;

102 
	`´štf
("Devices:\n");

103 
i
=0; i<
num_deviûs
; i++) {

104 cÚ¡ 
PaDeviûInfo
* 
deviûInfo
 = 
	`Pa_G‘DeviûInfo
(
i
);

105 ià(
i
==
deviû
) {

106 
	`´štf
("* ");

107 ià(
deviûInfo
->
maxIÅutChªÃls
 > 0) {

108 
»cDeviûNum
 = 
deviû
;

109 
šputChªÃls
 = 
deviûInfo
->
maxIÅutChªÃls
;

111 ià(
deviûInfo
->
maxOuutChªÃls
 > 0) {

112 
¶ayDeviûNum
 = 
deviû
;

113 
ouutChªÃls
 = 
deviûInfo
->
maxOuutChªÃls
;

117 
	`´štf
(" ");

118 
	`´štf
("Device %d: %s in=%d out=%d",

119 
i
, 
deviûInfo
->
Çme
,

120 
deviûInfo
->
maxIÅutChªÃls
, deviûInfo->
maxOuutChªÃls
);

121 ià(
i
 =ğ
	`Pa_G‘DeçuÉIÅutDeviûID
())

122 
	`´štf
(" (default input)");

123 ià(
i
 =ğ
	`Pa_G‘DeçuÉOuutDeviûID
())

124 
	`´štf
(" (default output)");

125 
	`´štf
("\n");

127 
	`´štf
("\n");

129 
”rÜ
 = 
	`Pa_O³nSŒ—m
(&
¡»am
, 
»cDeviûNum
, 
šputChªÃls
, 
·Flßt32
, 
NULL
,

130 
¶ayDeviûNum
, 
ouutChªÃls
, 
·Flßt32
, 
NULL
,

131 44101, 512, 1, 
·ClOff
 | 
·D™h”Off
,

132 
DummyC®lbackFunc
, 
NULL
);

134 ià(
”rÜ
) {

135 
	`´štf
("PÜtAudiØ”rÜ %d: %s\n", 
”rÜ
,

136 
	`Pa_G‘E¼ÜText
(
”rÜ
));

140 
num_mix”s
 = 
	`Px_G‘NumMix”s
(
¡»am
);

141 
	`´štf
("Numb” oàmix” fÜ deviû %d: %d\n", 
deviû
, 
num_mix”s
);

142 
i
=0; i<
num_mix”s
; i++) {

143 
PxMix”
 *
mix”
;

144 
num
;

145 
j
;

147 
	`´štf
("Mix” %d: %s\n", 
i
, 
	`Px_G‘Mix”Name
(
¡»am
, i));

148 
mix”
 = 
	`Px_O³nMix”
(
¡»am
, 
i
);

149 ià(!
mix”
) {

150 
	`´štf
(" Could‚ot open mixer!\n");

154 ià(
i
 =ğ
İtm
) {

155 ià(
İtv
!=-2) {

156 
	`Px_S‘Ma¡”VŞume
(
mix”
, 
İtv
);

157 
	`´štf
(" Set master volume\n");

159 ià(
İto
!=-2) {

160 
	`Px_S‘PCMOuutVŞume
(
mix”
, 
İto
);

161 
	`´štf
(" Set output volume\n");

163 ià(
İti
!=-2) {

164 
	`Px_S‘IÅutVŞume
(
mix”
, 
İti
);

165 
	`´štf
(" Set input volume\n");

167 ià(
İth
!=-2) {

168 
	`Px_S‘PÏythrough
(
mix”
, 
İth
);

169 
	`´štf
(" Set…laythrough volume\n");

171 ià(
İts
!=-2) {

172 
	`Px_S‘Cu¼’tIÅutSourû
(
mix”
, 
İts
);

173 
	`´štf
(" Set input source\n");

175 ià(
İtb
!=-2) {

176 
	`Px_S‘OuutB®ªû
(
mix”
, 
İtb
);

177 
	`´štf
(" Set balance\n");

181 
	`´štf
(" Ma¡” vŞume: %.2f\n", 
	`Px_G‘Ma¡”VŞume
(
mix”
));

182 
	`´štf
(" PCM ouuˆvŞume: %.2f\n", 
	`Px_G‘PCMOuutVŞume
(
mix”
));

184 
num
 = 
	`Px_G‘NumOuutVŞumes
(
mix”
);

185 
	`´štf
(" Num ouuts: %d\n", 
num
);

186 
j
=0; j<
num
; j++) {

187 
	`´štf
(" Output %d (%s): %.2f\n",

188 
j
,

189 
	`Px_G‘OuutVŞumeName
(
mix”
, 
j
),

190 
	`Px_G‘OuutVŞume
(
mix”
, 
j
));

193 
num
 = 
	`Px_G‘NumIÅutSourûs
(
mix”
);

194 
	`´štf
(" Num iÅuˆsourûs: %d\n", 
num
);

195 
j
=0; j<
num
; j++) {

196 
	`´štf
(" Input %d (%s) %s\n",

197 
j
,

198 
	`Px_G‘IÅutSourûName
(
mix”
, 
j
),

199 (
	`Px_G‘Cu¼’tIÅutSourû
(
mix”
)==
j
?

202 
	`´štf
(" IÅuˆvŞume: %.2f\n", 
	`Px_G‘IÅutVŞume
(
mix”
));

204 
	`´štf
(" Playthrough:");

205 ià(
	`Px_SuµÜtsPÏythrough
(
mix”
))

206 
	`´štf
(" %.2f\n", 
	`Px_G‘PÏythrough
(
mix”
));

208 
	`´štf
("‚ot supported.\n");

210 
	`´štf
(" Output balance:");

211 ià(
	`Px_SuµÜtsOuutB®ªû
(
mix”
))

212 
	`´štf
(" %.2f\n", 
	`Px_G‘OuutB®ªû
(
mix”
));

214 
	`´štf
("‚ot supported.\n");

216 
	`Px_Clo£Mix”
(
mix”
);

219 
	`Pa_Clo£SŒ—m
(
¡»am
);

221 
	`Pa_T”mš©e
();

224 
	}
}

	@portmixer/px_unix_oss/px_unix_oss.c

38 #ifdeà
__lšux__


39 
	~<lšux/soundÿrd.h
>

41 
	~<machše/soundÿrd.h
>

44 
	~<¡dio.h
>

45 
	~<¡dlib.h
>

46 
	~<fú.h
>

47 
	~<uni¡d.h
>

48 
	~<sys/ty³s.h
>

49 
	~<sys/¡©.h
>

50 
	~<sys/ioùl.h
>

52 
	~"pÜudio.h
"

53 
	~"pÜtmix”.h
"

55 
	sPxInfo


57 
	mšdex
;

58 
	mfd
;

60 
	mnum_out
;

61 
	mouts
[
SOUND_MIXER_NRDEVICES
];

62 
	mnum_»c
;

63 
	m»cs
[
SOUND_MIXER_NRDEVICES
];

64 } 
	tPxInfo
;

66 
	gPxDeviû
[20] = "/dev/mixerX";

68 
	gPxNumDeviûs
 = 0;

69 
	gPxDeviûs
[10];

71 
	$Px_G‘NumMix”s
Ğ*
·_¡»am
 )

73 
i
;

74 
fd
;

76 
PxNumDeviûs
 = 0;

78 
i
=0; i<11; i++) {

79 ià(
i
==0)

80 
PxDeviû
[10] = 0;

82 
PxDeviû
[10] = '0'+(
i
-1);

83 
fd
 = 
	`İ’
(
PxDeviû
, 
O_RDWR
);

84 ià(
fd
 >= 0) {

85 
PxDeviûs
[
PxNumDeviûs
] = 
i
;

86 
PxNumDeviûs
++;

87 
	`şo£
(
fd
);

91  
PxNumDeviûs
;

92 
	}
}

94 cÚ¡ *
	$Px_G‘Mix”Name
Ğ*
·_¡»am
, 
šdex
 )

96 ià(
PxNumDeviûs
 <= 0)

97 
	`Px_G‘NumMix”s
(
·_¡»am
);

99 ià(
šdex
 < 0 || index >ğ
PxNumDeviûs
)

100  
NULL
;

102 ià(
PxDeviûs
[
šdex
]==0)

103 
PxDeviû
[10] = 0;

105 
PxDeviû
[10] = '0'+(
PxDeviûs
[
šdex
]-1);

106  
PxDeviû
;

107 
	}
}

109 
PxMix”
 *
	$Px_O³nMix”
Ğ*
·_¡»am
, 
šdex
 )

111 
PxInfo
 *
šfo
;

112 
devmask
, 
»cmask
, 
outmask
;

113 
i
;

115 ià(
PxNumDeviûs
 <= 0)

116 
	`Px_G‘NumMix”s
(
·_¡»am
);

118 ià(
šdex
 < 0 || index >ğ
PxNumDeviûs
)

119  
NULL
;

121 
šfo
 = (
PxInfo
 *)
	`m®loc
((PxInfo));

122 
šfo
->
šdex
 = 
PxDeviû
[index];

124 ià(
PxDeviûs
[
šdex
]==0)

125 
PxDeviû
[10] = 0;

127 
PxDeviû
[10] = '0'+(
PxDeviûs
[
šdex
]-1);

128 
šfo
->
fd
 = 
	`İ’
(
PxDeviû
, 
O_RDWR
);

129 ià(
šfo
->
fd
 < 0)

130 
bad
;

132 ià(
	`ioùl
(
šfo
->
fd
, 
	`MIXER_READ
(
SOUND_MIXER_READ_DEVMASK
),

133 &
devmask
) == -1)

134 
bad
;

135 ià(
	`ioùl
(
šfo
->
fd
, 
	`MIXER_READ
(
SOUND_MIXER_READ_RECMASK
),

136 &
»cmask
) == -1)

137 
bad
;

138 
outmask
 = 
devmask
 ^ 
»cmask
;

140 
šfo
->
num_out
 = 0;

141 
šfo
->
num_»c
 = 0;

143 
i
=0; i<
SOUND_MIXER_NRDEVICES
; i++)

144 ià(
»cmask
 & (1<<
i
))

145 
šfo
->
»cs
[šfo->
num_»c
++] = 
i
;

146 ià(
devmask
 & (1<<
i
))

147 
šfo
->
outs
[šfo->
num_out
++] = 
i
;

149  (
PxMix”
 *)
šfo
;

151 
bad
:

152 
	`ä“
(
šfo
);

153  
NULL
;

154 
	}
}

161 
	$Px_Clo£Mix”
(
PxMix”
 *
mix”
)

163 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

165 
	`şo£
(
šfo
->
fd
);

167 
	`ä“
(
šfo
);

168 
	}
}

170 
PxVŞume
 
	$G‘VŞume
(
fd
, 
chªÃl
)

172 
vŞ
;

173 
¡”eo
;

175 ià(
	`ioùl
(
fd
, 
SOUND_MIXER_READ_STEREODEVS
, &
¡”eo
) == 0)

176 
¡”eo
 = ((¡”eØ& (1 << 
chªÃl
)) != 0);

178 
¡”eo
 = 0;

180 ià(
	`ioùl
(
fd
, 
	`MIXER_READ
(
chªÃl
), &
vŞ
) == -1)

183 ià(
¡”eo
)

184  ((
vŞ
 & 0xFF)/200.0) + (((vol>>8) & 0xFF)/200.0);

186  (
vŞ
 & 0xFF)/100.0;

187 
	}
}

193 
PxVŞume
 
	$Px_G‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
 )

195 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

197  
	`G‘VŞume
(
šfo
->
fd
, 
SOUND_MIXER_VOLUME
);

198 
	}
}

200 
	$Px_S‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

202 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

204 
vŞ
 = ()((
vŞume
 * 100.0) + 0.5);

205 
vŞ
 = (vol | (vol<<8));

206 
	`ioùl
(
šfo
->
fd
, 
	`MIXER_WRITE
(
SOUND_MIXER_VOLUME
), &
vŞ
);

207 
	}
}

213 
	$Px_SuµÜtsPCMOuutVŞume
Ğ
PxMix”
* 
mix”
 )

216 
	}
}

218 
PxVŞume
 
	$Px_G‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
 )

220 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

222  
	`G‘VŞume
(
šfo
->
fd
, 
SOUND_MIXER_PCM
);

223 
	}
}

225 
	$Px_S‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

227 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

229 
vŞ
 = ()((
vŞume
 * 100.0) + 0.5);

230 
vŞ
 = (vol | (vol<<8));

231 
	`ioùl
(
šfo
->
fd
, 
	`MIXER_WRITE
(
SOUND_MIXER_PCM
), &
vŞ
);

232 
	}
}

238 
	$Px_G‘NumOuutVŞumes
Ğ
PxMix”
 *
mix”
 )

240 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

242  
šfo
->
num_out
;

243 
	}
}

245 cÚ¡ *
	$Px_G‘OuutVŞumeName
Ğ
PxMix”
 *
mix”
, 
i
 )

247 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

248 cÚ¡ *
Ïb–s
[] = 
SOUND_DEVICE_LABELS
;

250  
Ïb–s
[
šfo
->
outs
[
i
]];

251 
	}
}

253 
PxVŞume
 
	$Px_G‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
 )

255 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

257  
	`G‘VŞume
(
šfo
->
fd
, info->
outs
[
i
]);

258 
	}
}

260 
	$Px_S‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
, 
PxVŞume
 
vŞume
 )

262 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

264 
vŞ
 = ()((
vŞume
 * 100.0) + 0.5);

265 
vŞ
 = (vol | (vol<<8));

266 
	`ioùl
(
šfo
->
fd
, 
	`MIXER_WRITE
(šfo->
outs
[
i
]), &
vŞ
);

267 
	}
}

273 
	$Px_G‘NumIÅutSourûs
Ğ
PxMix”
 *
mix”
 )

275 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

277  
šfo
->
num_»c
;

278 
	}
}

280 cÚ¡ *
	$Px_G‘IÅutSourûName
Ğ
PxMix”
 *
mix”
, 
i
)

282 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

284 cÚ¡ *
Ïb–s
[] = 
SOUND_DEVICE_LABELS
;

285  
Ïb–s
[
šfo
->
»cs
[
i
]];

286 
	}
}

288 
	$Px_G‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
 )

290 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

291 
»cmask
;

292 
i
;

297 ià(
	`ioùl
(
šfo
->
fd
, 
	`MIXER_READ
(
SOUND_MIXER_READ_RECSRC
),

298 &
»cmask
) == -1)

301 
i
=0; i<
šfo
->
num_»c
; i++)

302 ià(
»cmask
 & (1 << (
šfo
->
»cs
[
i
])))

303  
i
;

306 
	}
}

308 
	$Px_S‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
, 
i
 )

310 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

311 
Ãw»c¤cmask
 = (1 << (
šfo
->
»cs
[
i
]));

313 
	`ioùl
(
šfo
->
fd
, 
	`MIXER_WRITE
(
SOUND_MIXER_READ_RECSRC
),

314 &
Ãw»c¤cmask
);

315 
	}
}

321 
PxVŞume
 
	$Px_G‘IÅutVŞume
Ğ
PxMix”
 *
mix”
 )

323 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

324 
i
;

326 
i
 = 
	`Px_G‘Cu¼’tIÅutSourû
(
mix”
);

327 ià(
i
 < 0)

330  
	`G‘VŞume
(
šfo
->
fd
, 
SOUND_MIXER_IGAIN
);

331 
	}
}

333 
	$Px_S‘IÅutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

335 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

336 
vŞ
;

337 
i
;

339 
i
 = 
	`Px_G‘Cu¼’tIÅutSourû
(
mix”
);

340 ià(
i
 < 0)

343 
vŞ
 = ()((
vŞume
 * 100.0) + 0.5);

344 
vŞ
 = (vol | (vol<<8));

345 
	`ioùl
(
šfo
->
fd
, 
	`MIXER_WRITE
(
SOUND_MIXER_IGAIN
), &
vŞ
);

346 
	}
}

352 
	$Px_SuµÜtsOuutB®ªû
Ğ
PxMix”
 *
mix”
 )

355 
	}
}

357 
PxB®ªû
 
	$Px_G‘OuutB®ªû
Ğ
PxMix”
 *
mix”
 )

360 
	}
}

362 
	$Px_S‘OuutB®ªû
Ğ
PxMix”
 *
mix”
, 
PxB®ªû
 
b®ªû
 )

364 
	}
}

370 
	$Px_SuµÜtsPÏythrough
Ğ
PxMix”
 *
mix”
 )

373 
	}
}

375 
PxVŞume
 
	$Px_G‘PÏythrough
Ğ
PxMix”
 *
mix”
 )

377 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

378 
i
;

380 
i
 = 
	`Px_G‘Cu¼’tIÅutSourû
(
mix”
);

381 ià(
i
 < 0)

384  
	`G‘VŞume
(
šfo
->
fd
, info->
»cs
[
i
]);

385 
	}
}

387 
	$Px_S‘PÏythrough
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

389 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

390 
vŞ
;

391 
i
;

393 
i
 = 
	`Px_G‘Cu¼’tIÅutSourû
(
mix”
);

394 ià(
i
 < 0)

397 
vŞ
 = ()((
vŞume
 * 100.0) + 0.5);

398 
vŞ
 = (vol | (vol<<8));

399 
	`ioùl
(
šfo
->
fd
, 
	`MIXER_WRITE
(šfo->
»cs
[
i
]), &
vŞ
);

400 
	}
}

	@portmixer/px_win_wmme/px_win_wmme.c

38 
	~<Wšdows.h
>

40 
	~"pÜudio.h
"

41 
	~"·_ho¡.h
"

43 
	~"pÜtmix”.h
"

45 
	sPaWMMESŒ—mD©a


48 
HWAVEIN
 
	mhWaveIn
;

49 
WAVEHDR
 *
	mšputBufãrs
;

50 
	mcu¼’tIÅutBufãr
;

51 
	mby‹sP”Ho¡IÅutBufãr
;

52 
	mby‹sP”U£rIÅutBufãr
;

54 
HWAVEOUT
 
	mhWaveOut
;

55 } 
	tPaWMMESŒ—mD©a
;

57 
	sPxSrcInfo


59 
	mÇme
[256];

60 
DWORD
 
	mlšeID
;

61 
DWORD
 
	mcÚŒŞID
;

62 } 
	tPxSrcInfo
;

64 
	sPxInfo


66 
HMIXEROBJ
 
	mhIÅutMix”
;

67 
HMIXEROBJ
 
	mhOuutMix”
;

68 
	mnumIÅuts
;

69 
PxSrcInfo
 
	m¤c
[32];

70 
DWORD
 
	mmuxID
;

71 
DWORD
 
	m¥—k”ID
;

72 
DWORD
 
	mwaveID
;

73 } 
	tPxInfo
;

75 
	$Px_G‘NumMix”s
Ğ*
·_¡»am
 )

78 
	}
}

80 cÚ¡ *
	$Px_G‘Mix”Name
Ğ*
·_¡»am
, 
šdex
 )

83 
	}
}

85 
PxMix”
 *
	$Px_O³nMix”
Ğ*
·_¡»am
, 
šdex
 )

87 
š‹º®PÜtAudioSŒ—m
 *
·¡
;

88 
PaWMMESŒ—mD©a
 *
wmmeSŒ—mD©a
;

89 
HWAVEIN
 
hWaveIn
;

90 
HWAVEOUT
 
hWaveOut
;

91 
PxInfo
 *
mix”
;

92 
MMRESULT
 
»suÉ
;

93 
MIXERLINE
 
lše
;

94 
MIXERLINECONTROLS
 
cÚŒŞs
;

95 
MIXERCONTROL
 
cÚŒŞ
;

96 
MIXERCONTROLDETAILS
 
d‘as
;

97 
MIXERCONTROLDETAILS_LISTTEXT
 
mixLi¡
[32];

98 
j
;

100 
mix”
 = (
PxMix”
 *)
	`m®loc
((
PxInfo
));

101 
mix”
->
hIÅutMix”
 = 
NULL
;

102 
mix”
->
hOuutMix”
 = 
NULL
;

104 
·¡
 = (
š‹º®PÜtAudioSŒ—m
 *è
·_¡»am
;

105 
wmmeSŒ—mD©a
 = (
PaWMMESŒ—mD©a
 *è
·¡
->
·¡_DeviûD©a
;

107 
hWaveIn
 = 
wmmeSŒ—mD©a
->hWaveIn;

108 ià(
hWaveIn
) {

109 
»suÉ
 = 
	`mix”O³n
((
HMIXER
 *)&
mix”
->
hIÅutMix”
, (
UINT
)
hWaveIn
, 0, 0, 
MIXER_OBJECTF_HWAVEIN
);

110 ià(
»suÉ
 !ğ
MMSYSERR_NOERROR
) {

111 
	`ä“
(
mix”
);

112  
NULL
;

116 
hWaveOut
 = 
wmmeSŒ—mD©a
->hWaveOut;

117 ià(
hWaveOut
) {

118 
»suÉ
 = 
	`mix”O³n
((
HMIXER
 *)&
mix”
->
hOuutMix”
, (
UINT
)
hWaveOut
, 0, 0, 
MIXER_OBJECTF_HWAVEOUT
);

119 ià(
»suÉ
 !ğ
MMSYSERR_NOERROR
) {

120 
	`ä“
(
mix”
);

121  
NULL
;

125 
mix”
->
numIÅuts
 = 0;

126 
mix”
->
muxID
 = 0;

129 
mix”
->
waveID
 = 0 ;

136 ià(
mix”
->
hIÅutMix”
) {

137 
lše
.
cbSŒuù
 = (
MIXERLINE
);

138 
lše
.
dwCompÚ’tTy³
 = 
MIXERLINE_COMPONENTTYPE_DST_WAVEIN
;

139 
»suÉ
 = 
	`mix”G‘LšeInfo
(
mix”
->
hIÅutMix”
,

140 &
lše
,

141 
MIXER_GETLINEINFOF_COMPONENTTYPE
);

142 ià(
»suÉ
 =ğ
MMSYSERR_NOERROR
) {

144 
cÚŒŞs
.
cbSŒuù
 = (
MIXERLINECONTROLS
);

145 
cÚŒŞs
.
dwLšeID
 = 
lše
.dwLineID;

146 
cÚŒŞs
.
dwCÚŒŞTy³
 = 
MIXERCONTROL_CONTROLTYPE_MUX
;

147 
cÚŒŞs
.
cbmxù¾
 = (
MIXERCONTROL
);

148 
cÚŒŞs
.
·mxù¾
 = &
cÚŒŞ
;

150 
cÚŒŞ
.
cbSŒuù
 = (
MIXERCONTROL
);

152 
»suÉ
 = 
	`mix”G‘LšeCÚŒŞs
(
mix”
->
hIÅutMix”
,

153 &
cÚŒŞs
,

154 
MIXER_GETLINECONTROLSF_ONEBYTYPE
);

156 ià(
»suÉ
 !ğ
MMSYSERR_NOERROR
) {

157 
cÚŒŞs
.
dwCÚŒŞTy³
 = 
MIXERCONTROL_CONTROLTYPE_MIXER
;

158 
»suÉ
 = 
	`mix”G‘LšeCÚŒŞs
(
mix”
->
hIÅutMix”
,

159 &
cÚŒŞs
,

160 
MIXER_GETLINECONTROLSF_ONEBYTYPE
);

163 ià(
»suÉ
 =ğ
MMSYSERR_NOERROR
) {

164 
mix”
->
numIÅuts
 = 
cÚŒŞ
.
cMuÉËI‹ms
;

165 
mix”
->
muxID
 = 
cÚŒŞ
.
dwCÚŒŞID
;

167 
d‘as
.
cbSŒuù
 = (
MIXERCONTROLDETAILS
);

168 
d‘as
.
dwCÚŒŞID
 = 
mix”
->
muxID
;

169 
d‘as
.
cChªÃls
 = 1;

170 
d‘as
.
cbD‘as
 = (
MIXERCONTROLDETAILS_LISTTEXT
);

171 
d‘as
.
·D‘as
 = (
LPMIXERCONTROLDETAILS_LISTTEXT
)&
mixLi¡
[0];

172 
d‘as
.
cMuÉËI‹ms
 = 
mix”
->
numIÅuts
;

174 
»suÉ
 = 
	`mix”G‘CÚŒŞD‘as
(
mix”
->
hIÅutMix”
,

175 (
LPMIXERCONTROLDETAILS
)&
d‘as
,

176 
MIXER_GETCONTROLDETAILSF_LISTTEXT
);

178 ià(
»suÉ
 !ğ
MMSYSERR_NOERROR
)

179 
mix”
->
numIÅuts
 = 0;

181 
j
=0; j<
mix”
->
numIÅuts
; j++) {

182 
mix”
->
¤c
[
j
].
lšeID
 = 
mixLi¡
[j].
dwP¬am1
;

183 
	`¡rıy
(
mix”
->
¤c
[
j
].
Çme
, 
mixLi¡
[j].
szName
);

192 
j
=0; j<
mix”
->
numIÅuts
; j++) {

193 
cÚŒŞs
.
cbSŒuù
 = (
MIXERLINECONTROLS
);

194 
cÚŒŞs
.
dwLšeID
 = 
mix”
->
¤c
[
j
].
lšeID
;

195 
cÚŒŞs
.
dwCÚŒŞTy³
 = 
MIXERCONTROL_CONTROLTYPE_VOLUME
;

196 
cÚŒŞs
.
cbmxù¾
 = (
MIXERCONTROL
);

197 
cÚŒŞs
.
·mxù¾
 = &
cÚŒŞ
;

199 
cÚŒŞ
.
cbSŒuù
 = (
MIXERCONTROL
);

201 
»suÉ
 = 
	`mix”G‘LšeCÚŒŞs
(
mix”
->
hIÅutMix”
,

202 &
cÚŒŞs
,

203 
MIXER_GETLINECONTROLSF_ONEBYTYPE
);

204 ià(
»suÉ
 =ğ
MMSYSERR_NOERROR
)

205 
mix”
->
¤c
[
j
].
cÚŒŞID
 = 
cÚŒŞ
.
dwCÚŒŞID
;

207 
mix”
->
¤c
[
j
].
cÚŒŞID
 = 0;

216 
mix”
->
¥—k”ID
 = 0;

218 ià(
mix”
->
hOuutMix”
) {

219 
lše
.
cbSŒuù
 = (
MIXERLINE
);

220 
lše
.
dwCompÚ’tTy³
 = 
MIXERLINE_COMPONENTTYPE_DST_SPEAKERS
;

221 
»suÉ
 = 
	`mix”G‘LšeInfo
(
mix”
->
hOuutMix”
,

222 &
lše
,

223 
MIXER_GETLINEINFOF_COMPONENTTYPE
);

224 ià(
»suÉ
 =ğ
MMSYSERR_NOERROR
) {

225 
cÚŒŞs
.
cbSŒuù
 = (
MIXERLINECONTROLS
);

226 
cÚŒŞs
.
dwLšeID
 = 
lše
.dwLineID;

227 
cÚŒŞs
.
dwCÚŒŞTy³
 = 
MIXERCONTROL_CONTROLTYPE_VOLUME
;

228 
cÚŒŞs
.
cbmxù¾
 = (
MIXERCONTROL
);

229 
cÚŒŞs
.
·mxù¾
 = &
cÚŒŞ
;

231 
cÚŒŞ
.
cbSŒuù
 = (
MIXERCONTROL
);

233 
»suÉ
 = 
	`mix”G‘LšeCÚŒŞs
(
mix”
->
hOuutMix”
,

234 &
cÚŒŞs
,

235 
MIXER_GETLINECONTROLSF_ONEBYTYPE
);

237 ià(
»suÉ
 =ğ
MMSYSERR_NOERROR
)

238 
mix”
->
¥—k”ID
 = 
cÚŒŞ
.
dwCÚŒŞID
;

242  (
PxMix”
 *)
mix”
;

243 
	}
}

245 
	$VŞumeFunùiÚ
(
HMIXEROBJ
 
hMix”
, 
DWORD
 
cÚŒŞID
, 
PxVŞume
 *
vŞume
)

247 
MIXERCONTROLDETAILS
 
d‘as
;

248 
MMRESULT
 
»suÉ
;

249 
MIXERCONTROLDETAILS_UNSIGNED
 
v®ue
;

251 
	`mem£t
(&
v®ue
, 0, (
MIXERCONTROLDETAILS_UNSIGNED
));

253 
d‘as
.
cbSŒuù
 = (
MIXERCONTROLDETAILS
);

254 
d‘as
.
dwCÚŒŞID
 = 
cÚŒŞID
;

255 
d‘as
.
cChªÃls
 = 1;

256 
d‘as
.
cMuÉËI‹ms
 = 0;

257 
d‘as
.
cbD‘as
 = (
MIXERCONTROLDETAILS_UNSIGNED
);

258 
d‘as
.
·D‘as
 = &
v®ue
;

260 
»suÉ
 = 
	`mix”G‘CÚŒŞD‘as
(
hMix”
, &
d‘as
,

261 
MIXER_GETCONTROLDETAILSF_VALUE
);

263 ià(*
vŞume
 < 0.0) {

264 *
vŞume
 = (
PxVŞume
)(
v®ue
.
dwV®ue
 / 65535.0);

267 ià(
»suÉ
 !ğ
MMSYSERR_NOERROR
)

269 
v®ue
.
dwV®ue
 = ()(*
vŞume
 * 65535.0);

270 
	`mix”S‘CÚŒŞD‘as
(
hMix”
, &
d‘as
,

271 
MIXER_GETCONTROLDETAILSF_VALUE
);

273 
	}
}

280 
	$Px_Clo£Mix”
(
PxMix”
 *
mix”
)

282 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

284 ià(
šfo
->
hIÅutMix”
)

285 
	`mix”Clo£
((
HMIXER
)
šfo
->
hIÅutMix”
);

286 ià(
šfo
->
hOuutMix”
)

287 
	`mix”Clo£
((
HMIXER
)
šfo
->
hOuutMix”
);

288 
	`ä“
Ğ
mix”
 );

289 
	}
}

295 
PxVŞume
 
	$Px_G‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
 )

297 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

298 
PxVŞume
 
vŞ
;

300 
vŞ
 = -1.0;

301 
	`VŞumeFunùiÚ
(
šfo
->
hOuutMix”
, info->
¥—k”ID
, &
vŞ
);

302  
vŞ
;

303 
	}
}

305 
	$Px_S‘Ma¡”VŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

307 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

309 
	`VŞumeFunùiÚ
(
šfo
->
hOuutMix”
, info->
¥—k”ID
, &
vŞume
);

310 
	}
}

316 
	$Px_SuµÜtsPCMOuutVŞume
Ğ
PxMix”
* 
mix”
 )

318 
PxInfo
* 
šfo
 = ( PxInfo* )Ğ
mix”
 ) ;

319  ( 
šfo
->
waveID
 == -1 ) ? 0 : 1 ;

320 
	}
}

322 
PxVŞume
 
	$Px_G‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
 )

324 
MMRESULT
 
»suÉ
;

325 
DWORD
 
vŞ
 = 0;

326 
mÚo_vŞ
 = 0;

327 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

330 iàĞ
šfo
->
waveID
 == -1 )

334 
»suÉ
 = 
	`waveOutG‘VŞume
Ğ(
HWAVEOUT
)Ğ
šfo
->
waveID
 ), &
vŞ
);

337 iàĞ
»suÉ
 !ğ
MMSYSERR_NOERROR
 )

339 
šfo
->
waveID
 = -1 ;

343 
mÚo_vŞ
 = ()
vŞ
;

344  (
PxVŞume
)
mÚo_vŞ
/65535.0;

345 
	}
}

347 
	$Px_S‘PCMOuutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

349 
MMRESULT
 
»suÉ
;

350 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

353 iàĞ
šfo
->
waveID
 == -1 )

357 
»suÉ
 = 
	`waveOutS‘VŞume
Ğ(
HWAVEOUT
)Ğ
šfo
->
waveID
 ), 
	`MAKELONG
(
vŞume
*0xFFFF, volume*0xFFFF));

360 iàĞ
»suÉ
 !ğ
MMSYSERR_NOERROR
 )

362 
šfo
->
waveID
 = -1 ;

366 
	}
}

372 
	$Px_G‘NumOuutVŞumes
Ğ
PxMix”
 *
mix”
 )

374 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

377 
	}
}

379 cÚ¡ *
	$Px_G‘OuutVŞumeName
Ğ
PxMix”
 *
mix”
, 
i
 )

381 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

383 ià(
i
==1)

387 
	}
}

389 
PxVŞume
 
	$Px_G‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
 )

391 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

393 ià(
i
==1)

394  
	`Px_G‘PCMOuutVŞume
(
mix”
);

396  
	`Px_G‘Ma¡”VŞume
(
mix”
);

397 
	}
}

399 
	$Px_S‘OuutVŞume
Ğ
PxMix”
 *
mix”
, 
i
, 
PxVŞume
 
vŞume
 )

401 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

403 ià(
i
==1)

404 
	`Px_S‘PCMOuutVŞume
(
mix”
, 
vŞume
);

406 
	`Px_S‘Ma¡”VŞume
(
mix”
, 
vŞume
);

407 
	}
}

413 
	$Px_G‘NumIÅutSourûs
Ğ
PxMix”
 *
mix”
 )

415 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

417  
šfo
->
numIÅuts
;

418 
	}
}

420 cÚ¡ *
	$Px_G‘IÅutSourûName
Ğ
PxMix”
 *
mix”
, 
i
)

422 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

424  
šfo
->
¤c
[
i
].
Çme
;

425 
	}
}

427 
	$Px_G‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
 )

429 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

430 
MIXERCONTROLDETAILS
 
d‘as
;

431 
MIXERCONTROLDETAILS_BOOLEAN
 
æags
[32];

432 
MMRESULT
 
»suÉ
;

433 
i
;

435 
d‘as
.
cbSŒuù
 = (
MIXERCONTROLDETAILS
);

436 
d‘as
.
dwCÚŒŞID
 = 
šfo
->
muxID
;

437 
d‘as
.
cMuÉËI‹ms
 = 
šfo
->
numIÅuts
;

438 
d‘as
.
cChªÃls
 = 1;

439 
d‘as
.
cbD‘as
 = (
MIXERCONTROLDETAILS_BOOLEAN
);

440 
d‘as
.
·D‘as
 = (
LPMIXERCONTROLDETAILS_BOOLEAN
)&
æags
[0];

442 
»suÉ
 = 
	`mix”G‘CÚŒŞD‘as
(
šfo
->
hIÅutMix”
,

443 (
LPMIXERCONTROLDETAILS
)&
d‘as
,

444 
MIXER_GETCONTROLDETAILSF_VALUE
);

446 ià(
»suÉ
 =ğ
MMSYSERR_NOERROR
) {

447 
i
=0; i<
šfo
->
numIÅuts
; i++)

448 ià(
æags
[
i
].
fV®ue
)

449  
i
;

453 
	}
}

455 
	$Px_S‘Cu¼’tIÅutSourû
Ğ
PxMix”
 *
mix”
, 
i
 )

457 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

458 
MIXERCONTROLDETAILS
 
d‘as
;

459 
MIXERCONTROLDETAILS_BOOLEAN
 
æags
[32];

460 
MMRESULT
 
»suÉ
;

461 
j
;

463 
d‘as
.
cbSŒuù
 = (
MIXERCONTROLDETAILS
);

464 
d‘as
.
dwCÚŒŞID
 = 
šfo
->
muxID
;

465 
d‘as
.
cMuÉËI‹ms
 = 
šfo
->
numIÅuts
;

466 
d‘as
.
cChªÃls
 = 1;

467 
d‘as
.
cbD‘as
 = (
MIXERCONTROLDETAILS_BOOLEAN
);

468 
d‘as
.
·D‘as
 = (
LPMIXERCONTROLDETAILS_BOOLEAN
)&
æags
[0];

470 
j
=0; j<
šfo
->
numIÅuts
; j++)

471 
æags
[
j
].
fV®ue
 = (
i
 == j);

473 
»suÉ
 = 
	`mix”S‘CÚŒŞD‘as
(
šfo
->
hIÅutMix”
,

474 (
LPMIXERCONTROLDETAILS
)&
d‘as
,

475 
MIXER_SETCONTROLDETAILSF_VALUE
);

476 
	}
}

482 
PxVŞume
 
	$Px_G‘IÅutVŞume
Ğ
PxMix”
 *
mix”
 )

484 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

485 
PxVŞume
 
vŞ
;

486 
¤c
 = 
	`Px_G‘Cu¼’tIÅutSourû
(
mix”
);

488 
vŞ
 = -1.0;

489 
	`VŞumeFunùiÚ
(
šfo
->
hIÅutMix”
, info->
¤c
[¤c].
cÚŒŞID
, &
vŞ
);

490  
vŞ
;

491 
	}
}

493 
	$Px_S‘IÅutVŞume
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

495 
PxInfo
 *
šfo
 = (PxInfØ*)
mix”
;

496 
¤c
 = 
	`Px_G‘Cu¼’tIÅutSourû
(
mix”
);

498 
	`VŞumeFunùiÚ
(
šfo
->
hIÅutMix”
, info->
¤c
[¤c].
cÚŒŞID
, &
vŞume
);

499 
	}
}

505 
	$Px_SuµÜtsOuutB®ªû
Ğ
PxMix”
 *
mix”
 )

508 
	}
}

510 
PxB®ªû
 
	$Px_G‘OuutB®ªû
Ğ
PxMix”
 *
mix”
 )

513 
	}
}

515 
	$Px_S‘OuutB®ªû
Ğ
PxMix”
 *
mix”
, 
PxB®ªû
 
b®ªû
 )

517 
	}
}

523 
	$Px_SuµÜtsPÏythrough
Ğ
PxMix”
 *
mix”
 )

526 
	}
}

528 
PxVŞume
 
	$Px_G‘PÏythrough
Ğ
PxMix”
 *
mix”
 )

531 
	}
}

533 
	$Px_S‘PÏythrough
Ğ
PxMix”
 *
mix”
, 
PxVŞume
 
vŞume
 )

535 
	}
}

	@px_tests/px_test.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

4 
	~<uni¡d.h
>

6 
	~"pÜtmix”.h
"

7 
	~"pÜudio.h
"

10 *
İrg
;

11 
İtšd
, 
İ‹¼
, 
İtİt
;

13 
	$DummyC®lbackFunc
(*
šputBufãr
, *
ouutBufãr
,

14 
äamesP”Bufãr
,

15 
PaTime¡amp
 
outTime
, *
u£rD©a
)

18 
	}
}

20 
	$g‘vŞ¬g
(cÚ¡ *
p
)

22 
f
 = 
	`©of
(
p
);

23 ià(
f
 < 0.0)

25 ià(
f
 > 1.0)

28  
f
;

29 
	}
}

31 
	$maš
(
¬gc
, **
¬gv
)

33 
num_mix”s
;

34 
i
;

35 
PaE¼Ü
 
”rÜ
;

36 
PÜtAudioSŒ—m
 *
¡»am
;

37 
»cDeviûNum
;

38 
¶ayDeviûNum
;

39 
šputChªÃls
;

40 
ouutChªÃls
;

41 
num_deviûs
;

42 
deviû
;

43 
İt
;

44 
İts
=-1, 
İtm
=0;

45 
İtv
=-2, 
İto
=-2, 
İti
=-2, 
İth
=-2, 
İtb
=-2;

47 
	`´štf
("px_test:‡…rogramo demonstratehe capabilities of PortMixer\n");

48 
	`´štf
("By Dominic Mazzoni\n");

49 
	`´štf
("\n");

50 
	`´štf
("Usage:\n");

51 
	`´štf
(" -d [device‚umber]\n");

52 
	`´štf
(" -m [mixer‚umber]\n");

53 
	`´štf
(" -v [vol] (Master volume)\n");

54 
	`´štf
(" -o [vol] (PCM output volume)\n");

55 
	`´štf
(" -i [vol] (Input volume)\n");

56 
	`´štf
(" -s [source‚umber] (Input source)\n");

57 
	`´štf
(" -h [vol] (Playthrough)\n");

58 
	`´štf
(" -b [bal] (Balance: -1.0....1.0)\n");

59 
	`´štf
("\n");

60 
	`´štf
("All volumes‡re between 0.0‡nd 1.0.\n");

61 
	`´štf
("\n");

63 
”rÜ
 = 
	`Pa_In™Ÿlize
();

64 ià(
”rÜ
 != 0) {

65 
	`´štf
("PÜtAudiØ”rÜ: %s\n", 
	`Pa_G‘E¼ÜText
(
”rÜ
));

69 
num_deviûs
 = 
	`Pa_CouÁDeviûs
();

71 
deviû
 = 
	`Pa_G‘DeçuÉIÅutDeviûID
();

72 
»cDeviûNum
 = 
·NoDeviû
;

73 
¶ayDeviûNum
 = 
·NoDeviû
;

74 
šputChªÃls
 = 0;

75 
ouutChªÃls
 = 0;

77 -1 !ğ(
İt
=
	`g‘İt
(
¬gc
, 
¬gv
, "d:m:v:o:i:s:h:b:"))) {

78 
İt
) {

80 
deviû
 = 
	`©oi
(
İrg
);

81 
	`´štf
("S‘ deviûØ%d\n", 
deviû
);

84 
İtm
 = 
	`©oi
(
İrg
);

85 
	`´štf
("S‘ mix”‚umb”Ø%d\n", 
İtm
);

88 
İtv
 = 
	`g‘vŞ¬g
(
İrg
); ;

90 
İto
 = 
	`g‘vŞ¬g
(
İrg
); ;

92 
İti
 = 
	`g‘vŞ¬g
(
İrg
); ;

94 
İth
 = 
	`g‘vŞ¬g
(
İrg
); ;

96 
İtb
 = 
	`©of
(
İrg
); ;

98 
İts
 = 
	`©oi
(
İrg
); ;

102 
	`´štf
("Devices:\n");

103 
i
=0; i<
num_deviûs
; i++) {

104 cÚ¡ 
PaDeviûInfo
* 
deviûInfo
 = 
	`Pa_G‘DeviûInfo
(
i
);

105 ià(
i
==
deviû
) {

106 
	`´štf
("* ");

107 ià(
deviûInfo
->
maxIÅutChªÃls
 > 0) {

108 
»cDeviûNum
 = 
deviû
;

109 
šputChªÃls
 = 
deviûInfo
->
maxIÅutChªÃls
;

111 ià(
deviûInfo
->
maxOuutChªÃls
 > 0) {

112 
¶ayDeviûNum
 = 
deviû
;

113 
ouutChªÃls
 = 
deviûInfo
->
maxOuutChªÃls
;

117 
	`´štf
(" ");

118 
	`´štf
("Device %d: %s in=%d out=%d",

119 
i
, 
deviûInfo
->
Çme
,

120 
deviûInfo
->
maxIÅutChªÃls
, deviûInfo->
maxOuutChªÃls
);

121 ià(
i
 =ğ
	`Pa_G‘DeçuÉIÅutDeviûID
())

122 
	`´štf
(" (default input)");

123 ià(
i
 =ğ
	`Pa_G‘DeçuÉOuutDeviûID
())

124 
	`´štf
(" (default output)");

125 
	`´štf
("\n");

127 
	`´štf
("\n");

129 
”rÜ
 = 
	`Pa_O³nSŒ—m
(&
¡»am
, 
»cDeviûNum
, 
šputChªÃls
, 
·Flßt32
, 
NULL
,

130 
¶ayDeviûNum
, 
ouutChªÃls
, 
·Flßt32
, 
NULL
,

131 44101, 512, 1, 
·ClOff
 | 
·D™h”Off
,

132 
DummyC®lbackFunc
, 
NULL
);

134 ià(
”rÜ
) {

135 
	`´štf
("PÜtAudiØ”rÜ %d: %s\n", 
”rÜ
,

136 
	`Pa_G‘E¼ÜText
(
”rÜ
));

140 
num_mix”s
 = 
	`Px_G‘NumMix”s
(
¡»am
);

141 
	`´štf
("Numb” oàmix” fÜ deviû %d: %d\n", 
deviû
, 
num_mix”s
);

142 
i
=0; i<
num_mix”s
; i++) {

143 
PxMix”
 *
mix”
;

144 
num
;

145 
j
;

147 
	`´štf
("Mix” %d: %s\n", 
i
, 
	`Px_G‘Mix”Name
(
¡»am
, i));

148 
mix”
 = 
	`Px_O³nMix”
(
¡»am
, 
i
);

149 ià(!
mix”
) {

150 
	`´štf
(" Could‚ot open mixer!\n");

154 ià(
i
 =ğ
İtm
) {

155 ià(
İtv
!=-2) {

156 
	`Px_S‘Ma¡”VŞume
(
mix”
, 
İtv
);

157 
	`´štf
(" Set master volume\n");

159 ià(
İto
!=-2) {

160 
	`Px_S‘PCMOuutVŞume
(
mix”
, 
İto
);

161 
	`´štf
(" Set output volume\n");

163 ià(
İti
!=-2) {

164 
	`Px_S‘IÅutVŞume
(
mix”
, 
İti
);

165 
	`´štf
(" Set input volume\n");

167 ià(
İth
!=-2) {

168 
	`Px_S‘PÏythrough
(
mix”
, 
İth
);

169 
	`´štf
(" Set…laythrough volume\n");

171 ià(
İts
!=-2) {

172 
	`Px_S‘Cu¼’tIÅutSourû
(
mix”
, 
İts
);

173 
	`´štf
(" Set input source\n");

175 ià(
İtb
!=-2) {

176 
	`Px_S‘OuutB®ªû
(
mix”
, 
İtb
);

177 
	`´štf
(" Set balance\n");

181 
	`´štf
(" Ma¡” vŞume: %.2f\n", 
	`Px_G‘Ma¡”VŞume
(
mix”
));

182 
	`´štf
(" PCM ouuˆvŞume: %.2f\n", 
	`Px_G‘PCMOuutVŞume
(
mix”
));

184 
num
 = 
	`Px_G‘NumOuutVŞumes
(
mix”
);

185 
	`´štf
(" Num ouuts: %d\n", 
num
);

186 
j
=0; j<
num
; j++) {

187 
	`´štf
(" Output %d (%s): %.2f\n",

188 
j
,

189 
	`Px_G‘OuutVŞumeName
(
mix”
, 
j
),

190 
	`Px_G‘OuutVŞume
(
mix”
, 
j
));

193 
num
 = 
	`Px_G‘NumIÅutSourûs
(
mix”
);

194 
	`´štf
(" Num iÅuˆsourûs: %d\n", 
num
);

195 
j
=0; j<
num
; j++) {

196 
	`´štf
(" Input %d (%s) %s\n",

197 
j
,

198 
	`Px_G‘IÅutSourûName
(
mix”
, 
j
),

199 (
	`Px_G‘Cu¼’tIÅutSourû
(
mix”
)==
j
?

202 
	`´štf
(" IÅuˆvŞume: %.2f\n", 
	`Px_G‘IÅutVŞume
(
mix”
));

204 
	`´štf
(" Playthrough:");

205 ià(
	`Px_SuµÜtsPÏythrough
(
mix”
))

206 
	`´štf
(" %.2f\n", 
	`Px_G‘PÏythrough
(
mix”
));

208 
	`´štf
("‚ot supported.\n");

210 
	`´štf
(" Output balance:");

211 ià(
	`Px_SuµÜtsOuutB®ªû
(
mix”
))

212 
	`´štf
(" %.2f\n", 
	`Px_G‘OuutB®ªû
(
mix”
));

214 
	`´štf
("‚ot supported.\n");

216 
	`Px_Clo£Mix”
(
mix”
);

219 
	`Pa_Clo£SŒ—m
(
¡»am
);

221 
	`Pa_T”mš©e
();

224 
	}
}

	@test.c

1 
	~<¡dio.h
>

3 
	$maš
(
¬gc
, *
¬gv
[]) {

4 
	`´štf
("test sound.");

6 
	}
}

	@
1
.
0
91
2661
pa_tests/debug_dual.c
pa_tests/debug_multi_in.c
pa_tests/debug_multi_out.c
pa_tests/debug_record.c
pa_tests/debug_sine.c
pa_tests/debug_test1.c
pa_tests/pa_devs.c
pa_tests/pa_fuzz.c
pa_tests/pa_minlat.c
pa_tests/paqa_devs.c
pa_tests/paqa_errs.c
pa_tests/patest1.c
pa_tests/patest_clip.c
pa_tests/patest_dither.c
pa_tests/patest_latency.c
pa_tests/patest_leftright.c
pa_tests/patest_longsine.c
pa_tests/patest_many.c
pa_tests/patest_maxsines.c
pa_tests/patest_pink.c
pa_tests/patest_record.c
pa_tests/patest_ringmix.c
pa_tests/patest_saw.c
pa_tests/patest_sine.c
pa_tests/patest_sine8.c
pa_tests/patest_sine_time.c
pa_tests/patest_stop.c
pa_tests/patest_sync.c
pa_tests/patest_wire.c
portaudio/pa_common/pa_convert.c
portaudio/pa_common/pa_host.h
portaudio/pa_common/pa_lib.c
portaudio/pa_common/pa_trace.c
portaudio/pa_common/pa_trace.h
portaudio/pa_common/portaudio.h
portaudio/pa_mac/pa_mac.c
portaudio/pa_mac/patest_devinfo.c
portaudio/pa_mac_core/pa_mac_core.c
portaudio/pa_tests/debug_dual.c
portaudio/pa_tests/debug_multi_in.c
portaudio/pa_tests/debug_multi_out.c
portaudio/pa_tests/debug_record.c
portaudio/pa_tests/debug_sine.c
portaudio/pa_tests/debug_test1.c
portaudio/pa_tests/pa_devs.c
portaudio/pa_tests/pa_fuzz.c
portaudio/pa_tests/pa_minlat.c
portaudio/pa_tests/paqa_devs.c
portaudio/pa_tests/paqa_errs.c
portaudio/pa_tests/patest1.c
portaudio/pa_tests/patest_clip.c
portaudio/pa_tests/patest_dither.c
portaudio/pa_tests/patest_latency.c
portaudio/pa_tests/patest_leftright.c
portaudio/pa_tests/patest_longsine.c
portaudio/pa_tests/patest_many.c
portaudio/pa_tests/patest_maxsines.c
portaudio/pa_tests/patest_pink.c
portaudio/pa_tests/patest_record.c
portaudio/pa_tests/patest_ringmix.c
portaudio/pa_tests/patest_saw.c
portaudio/pa_tests/patest_sine.c
portaudio/pa_tests/patest_sine8.c
portaudio/pa_tests/patest_sine_time.c
portaudio/pa_tests/patest_stop.c
portaudio/pa_tests/patest_sync.c
portaudio/pa_tests/patest_wire.c
portaudio/pa_unix_oss/pa_unix.c
portaudio/pa_unix_oss/pa_unix.h
portaudio/pa_unix_oss/pa_unix_oss.c
portaudio/pa_win_ds/dsound_wrapper.c
portaudio/pa_win_ds/dsound_wrapper.h
portaudio/pa_win_ds/pa_dsound.c
portaudio/pa_win_wmme/pa_win_wmme.c
portaudio/pablio/pablio.c
portaudio/pablio/pablio.h
portaudio/pablio/ringbuffer.c
portaudio/pablio/ringbuffer.h
portaudio/pablio/test_rw.c
portaudio/pablio/test_rw_echo.c
portaudio/pablio/test_w_saw.c
portaudio/pablio/test_w_saw8.c
portmixer/px_common/portmixer.h
portmixer/px_mac/px_mac.c
portmixer/px_mac_core/px_mac_core.c
portmixer/px_none/px_none.c
portmixer/px_tests/px_test.c
portmixer/px_unix_oss/px_unix_oss.c
portmixer/px_win_wmme/px_win_wmme.c
px_tests/px_test.c
test.c
